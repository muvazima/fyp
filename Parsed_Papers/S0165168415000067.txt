@&#MAIN-TITLE@&#Sketch-based human motion retrieval via selected 2D geometric posture descriptor

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We proposed a rich 2D pose feature called 2D Geometric Posture Descriptor (2GPD).


                        
                        
                           
                           The 2GPD is effective to the changeable hand-drawn sketch.


                        
                        
                           
                           A semi-supervised feature selection algorithm based on Laplacian-Score is used to simplify our features.


                        
                        
                           
                           We proposed an efficient sketched-based human motion retrieval framework.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Motion retrieval

Sketch-based

Feature selection

Computer animation

@&#ABSTRACT@&#


               
               
                  Sketch-based human motion retrieval is a hot topic in computer animation in recent years. In this paper, we present a novel sketch-based human motion retrieval method via selected 2-dimensional (2D) Geometric Posture Descriptor (2GPD). Specially, we firstly propose a rich 2D pose feature call 2D Geometric Posture Descriptor (2GPD), which is effective in encoding the 2D posture similarity by exploiting the geometric relationships among different human body parts. Since the original 2GPD is of high dimension and redundant, a semi-supervised feature selection algorithm derived from Laplacian Score is then adopted to select the most discriminative feature component of 2GPD as feature representation, and we call it as selected 2GPD. Finally, a posture-by-posture motion retrieval algorithm is used to retrieve a motion sequence by sketching several key postures. Experimental results on CMU human motion database demonstrate the effectiveness of our proposed approach.
               
            

@&#INTRODUCTION@&#

In the last few years, motion capture technique has been widely used in various applications, such as featured films, computer games and virtual reality [1–4]. However, the process of human motion capture is very time consuming and expensive [5]. So, it is important to reuse the pre-captured human motion in database. To this end, the first and important step is to retrieve similar human motion sequences from motion database.

To retrieve a desired motion sequence from a large-scale human motion database, the user usually has to describe the character of the human motion clips to be retrieved. There are several ways to achieve this goal. The simplest way is using textual description like key-words: “kicking” and “fighting” or a more detailed sentence like “a kick of the left foot followed by a punch” [6]. The textual description is intuitive and efficient, while it requires a lot of manual work for annotating all of the motion sequences in database. To overcome this shortcoming, the content-based human motion retrieval has attracted much attention, which retrieves the motion clips via submitting a similar and short motion clip [5,7,8] as query. However, sometimes it is hard to acquire the appropriate motion clips as query. For example, if we want to retrieve a back flip and a handstand walk, it is a little difficult for the user to perform such actions. Although Numaguchi et al. [9] proposed to use a puppet interface to generate the query motion clip, such a puppet consists with several sensors and potentiometers, which is not easy to obtain for a general user.

Inspired by traditional 2D animation wherein the experienced animator sketches several key character postures, which are then used as the seeds to generate a new motion, the sketch-based human motion retrieval becomes popular in computer animation in recent years [10–13]. Different from the other kind of input, using a 2D sketch brings in the following benefits: intuitiveness, fast posture definition, quick production of sample and first-pass animated scenes [14]. In light of this, we also utilize the sketch interface to retrieve human motion from database in this paper.

As we known, there are many factors which may affect the motion retrieval performance including motion representation, matching algorithm, indexing structure and so on. Motion representation is a the core-stone in constructing an efficient motion retrieval system. It is also the bridge to connect the 2D sketch and the 3D human motion. Traditional geometric features such as joints location and joint–joint direction are effective to character 3D human posture but not for the hand-drawn sketch. The hand-drawn sketch is usually changeable because different user has diverse sketch style and the body proportion is hard to be unified for the same posture. Thus, we has to find a proper feature to represent both 2D sketch and 3D posture.

In this paper, we propose a 2D Geometric Posture Descriptor (2GPD) including four kinds of geometric features. Similar geometric feature has been applied in graphics and computer vision [15], while here we propose a new rich posture feature set to exploit the geometric properties and relationships between different human body parts. 2GPD emphasizes the relational body part configuration, which is consistent with human perception.

Taken the flexibility of human-drawn sketch into account, the features involved distance metric are normalized with respect to the human body height and all of the features are discretized into several intervals. To ensure the retrieval efficiency, the feature dimension should not be too high. In our work, the total feature dimension of 2GPD is 738 while not all of them are useful and discriminative to describe a 2D posture. Therefore, we design a semi-supervised feature selection algorithm derived from Laplacian Score algorithm to select a compact and discriminative feature subsect from the original 2GPD.

The remainder part of this paper is organized as follows. We first review some related work in Section 2. Then, a detailed description of 2DGP and our proposed semi-supervised feature selection algorithm are introduced in Sections 4 and 5, respectively. Section 5 presents the retrieval framework and algorithm. Finally, we give the experimental results and conclusions in Sections 6 and 7.

@&#RELATED WORK@&#

Sketch has been widely used in computer animation and computer graphics. Igarashi et al. [16] and Zeleznik et al. [17] proposed a sketch-based modeling system, which utilizes input strokes for mesh creation. Lee et al. [18] presented a method which can derive improved shadow image from single posture sketch. Sketch is also used for facial expressions by Lau [19] and Seol [20]. In computer animation, sketch also has been successfully used in motion synthesis, motion retrieval and posture design [21–27,14].

In order to establish a connection between a 2D sketch and a 3D posture, 3D posture reconstruction from 2D sketch is widely used in some research. Davis et al. [10] proposed a method which reconstructs several possible 3D postures from a hand-drawn key posture stick figure. Meanwhile, a set of constraints and assumptions are applied to return the most likely 3D postures to the user. Lin et al. [23] presented an intuitive sketch interface that allows the user to creating a 3D human character in a sitting position on a chair. They reduced the reconstruction solution space by considering the interaction between the character and environment and adding physics constraints. The reconstruction problem was formulated into a nonlinear optimization problem. Li et al. [27] utilized the human figure sketches corresponding to the initial and closing posture of a Kung-fu form to retrieval and refinement the Kung-fu motions. And sketch trajectory on specific moving joints helps the retrieval process. However, reconstructing the 3D posture from a 2D sketch posture is an ill-posed problem due to many possible solutions.

A few researchers [22,21] used sketch to define the trajectory constraints which the character or its specific joints move along. But some trajectories are hard to draw in 2D sketch interface. For example, if the user sketches a posture in the view plane XOY but hand joint moves along the Z-axis.

Another kind of method is also used to compare the 2D sketch with 3D posture. First the 3D posture is projected into 2D plain, and then the same geometric feature is extracted on both the projected posture and the 2D sketch. As far as geometric feature concerned, some information like limb length and joint coordinate are removed directly because each user has different sketch style and the body proportion is hard to be unified for the same posture. The direction of the limbs, an intuitional features, is usually used [21,28] on sketch. However, only the direction of the limbs cannot character a motion sufficiently. Just as the 3D posture representation [15], the relative geometry relation of the joints and the limbs is necessary. In the field of computer vision, multi-feature [29–31] is widely used and some method such as LDA is applied to select the features or information with high discrimination [32,33]. Inspired by those work, we propose a novel feature in this paper called 2GPD combining four kinds of geometry feature, which is effective to character the hand-drawn sketch.

The 2GPD contains four different types of geometry feature, which results in high dimensionality. To reduce the dimension of feature representation, a semi-supervised feature selection method derived from Laplacian Score [34] is used in our work. Generally, feature selection approaches can be roughly classified into wrapper and filter. The wrapper approaches evaluate the features using the learning algorithm. Thus, they wrap the selection process around the learning algorithm [35–37]. The filter approaches examine intrinsic properties of the data to evaluate the features prior to the learning tasks, which always rely on the class labels, most commonly evaluating correlations between features and the class label. Classic filter approaches include Pearson correlation coefficients, data variance [38], Fisher score [39], and Kolmogorov–Smirnov test [40]. He et al. [34] proposed a filter method for unsupervised feature selection, which evaluates a feature by Laplacian Score. In this paper, a semi-supervised feature selection [41] method derived from Laplacian Score is utilized, which seeks features with high score in a carefully designed nearest neighbor graph [42].

Usually, a 2D posture is obtained by projecting a 3D posture or the user׳s sketch, which is encoded as a collection of 2D joint coordinates. In this paper, we use a 12-joint skeleton model as shown in Fig. 1
                     (a). The skeleton is a tree structure, where the joints are nodes.

We define a set of joints and lines on the human skeleton as shown in Fig. 1. There are 12 joints and 26 lines in total, which are explained as below.
                        
                           
                              
                                 •
                              
                           
                           
                              Joint: Each joint J is encoded with its coordinate 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       J
                                    
                                    
                                       y
                                    
                                 
                                 )
                              . There are 12 joints in total.


                              Line: If one of the following three constraints is satisfied, 
                                 
                                    
                                       L
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             a
                                          
                                       
                                       →
                                       
                                          
                                             J
                                          
                                          
                                             b
                                          
                                       
                                    
                                 
                               is the line from joint J
                              
                                 a
                               to J
                              
                                 b
                              .
                                 
                                    1.
                                    
                                       J
                                       
                                          a
                                        and J
                                       
                                          b
                                        are directly adjacent in the skeleton model. This produces 11 lines.

If one of J
                                       
                                          a
                                        and J
                                       
                                          b
                                        is the end site (such as head, hand and foot joint), and the other one is the joint which is two steps away from that end joint (it means that one joint is an ancestor of the other and the difference of between their depths in the skeleton tree is two). For example, 
                                          
                                             
                                                L
                                             
                                             
                                                LHand
                                                →
                                                Neck
                                             
                                          
                                       , 
                                          
                                             
                                                L
                                             
                                             
                                                LFoot
                                                →
                                                Pelvis
                                             
                                          
                                        and 
                                          
                                             
                                                L
                                             
                                             
                                                Head
                                                →
                                                Spine
                                             
                                          
                                        are three valid lines. This produces 5 lines, which is presented in Fig. 1(b). The reason why considering these lines is skeleton tree towards end sites are important in pose perception.


                                       
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                →
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                        is a line if both J
                                       
                                          a
                                        and J
                                       
                                          b
                                        are end sites. This produces 10 lines, which is presented in Fig. 1(c). These lines are considered because the relation between end sites is of great importance in pose identification.

Based on the 2D sketch, we define four types of 2D geometric posture descriptors, which are shown in Fig. 2
                        .
                           
                              •
                              
                                 Joint–Joint Distance 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          JJ
                                          _
                                          d
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                J
                                             
                                             
                                                b
                                             
                                          
                                          )
                                       
                                    
                                 : This is the Euclidean distance between joint J
                                 
                                    a
                                  and J
                                 
                                    b
                                 :
                                    
                                       (1)
                                       
                                          
                                             
                                                F
                                             
                                             
                                                JJ
                                                _
                                                d
                                                (
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                ,
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          ‖
                                          
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                             
                                                →
                                             
                                          
                                          ‖
                                       
                                    
                                 
                              


                                 Joint–Joint Direction 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          JJ
                                          _
                                          dir
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                J
                                             
                                             
                                                b
                                             
                                          
                                          )
                                       
                                    
                                 : The direction from joint J
                                 
                                    a
                                  to J
                                 
                                    b
                                  is the normalized vector 
                                    
                                       
                                          
                                             
                                                J
                                             
                                             
                                                a
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          →
                                       
                                    
                                 :
                                    
                                       (2)
                                       
                                          
                                             
                                                F
                                             
                                             
                                                JJ
                                                _
                                                dir
                                                (
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                ,
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                   
                                                      →
                                                   
                                                
                                                ‖
                                             
                                          
                                       
                                    
                                 
                              


                                 Joint–Line Distance 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          JL
                                          _
                                          d
                                          (
                                          J
                                          ,
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                →
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 : This is the distance from joint J to line 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                a
                                             
                                          
                                          →
                                          
                                             
                                                J
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                 :
                                    
                                       (3)
                                       
                                          
                                             
                                                F
                                             
                                             
                                                JL
                                                _
                                                d
                                                (
                                                J
                                                ,
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      →
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          
                                             
                                                2
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      Δ
                                                      
                                                         
                                                            JJ
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      F
                                                   
                                                   
                                                      JJ
                                                      _
                                                      d
                                                      (
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    
                                       
                                          S
                                       
                                       
                                          Δ
                                          
                                             
                                                JJ
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                  is the area of the triangle. The calculation of area can be accelerated by employing Helen formula because we have already calculated all the edge length in the triangle as feature 
                                    
                                       
                                          F
                                       
                                       
                                          JJ
                                          _
                                          d
                                       
                                    
                                  in Formula (1).


                                 Line–Line Angle 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          LL
                                          _
                                          a
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                →
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                L
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      c
                                                   
                                                
                                                →
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                 : This is the angle from line 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                a
                                             
                                          
                                          →
                                          
                                             
                                                J
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                  to 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                c
                                             
                                          
                                          →
                                          
                                             
                                                J
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                 , which ranges from 0 to π:
                                    
                                       (4)
                                       
                                          
                                             
                                                F
                                             
                                             
                                                LL
                                                _
                                                a
                                                (
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      →
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            c
                                                         
                                                      
                                                      →
                                                      
                                                         
                                                            J
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          arccos
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                JJ
                                                _
                                                dir
                                                (
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      a
                                                   
                                                
                                                ,
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      b
                                                   
                                                
                                                )
                                             
                                          
                                          ⊙
                                          
                                             
                                                F
                                             
                                             
                                                JJ
                                                _
                                                dir
                                                (
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      c
                                                   
                                                
                                                ,
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      d
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 where 
                                    ⊙
                                  is the dot product operator on two vectors.

As shown in Table 1
                        , considering 12 joints, 26 lines and four kinds of 2D geometric posture descriptors , 717 kinds of feature term are measured and the total feature dimension is 783.

In the process of motion retrieval, features are first extracted from the input sketch and the projected posture. Then the distance between them is computed. The feature has to describe the similarity between the users sketch and the projected posture accurately; meanwhile, it cannot be affected by the users changeful input. Each user has different sketch style, so the body proportion is hard to be unified. To avoid this problem, the distance related feature is normalized by the height of the body: 
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       JJ
                                       _
                                       d
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             a
                                          
                                       
                                       ,
                                       
                                          
                                             J
                                          
                                          
                                             b
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             JJ
                                             _
                                             d
                                             (
                                             
                                                
                                                   J
                                                
                                                
                                                   a
                                                
                                             
                                             ,
                                             
                                                
                                                   J
                                                
                                                
                                                   b
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             body
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       F
                                    
                                    
                                       JL
                                       _
                                       d
                                       (
                                       J
                                       ,
                                       
                                          
                                             L
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   a
                                                
                                             
                                             →
                                             
                                                
                                                   J
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             JL
                                             _
                                             d
                                             (
                                             J
                                             ,
                                             
                                                
                                                   L
                                                
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         a
                                                      
                                                   
                                                   →
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                          
                                          
                                             body
                                          
                                       
                                    
                                 
                              
                           
                        where H
                        
                           body
                         equals the distance from joint hand to joint foot.

After feature normalization, the feature is discretized. The distance feature (Joint–Joint Distance and Joint–Line Distance), which ranges from 0 to 1, is discretized into n value in the interval 
                           [
                           0
                           ,
                           1
                           ]
                        . For example, the interval 
                           [
                           0
                           ,
                           1
                           ]
                         is divided into n parts averagely 
                           [
                           [
                           0
                           ,
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ]
                           ,
                           [
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ]
                           ,
                           [
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 3
                              
                           
                           ]
                           ,
                           …
                           ,
                           [
                           
                              
                                 v
                              
                              
                                 n
                                 −
                                 1
                              
                           
                           ,
                           1
                           ]
                           ]
                        , if a feature 
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           ∈
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 j
                              
                           
                           ]
                        , then set f
                        
                           k
                        =v
                        
                           j
                        . In a similar way, the angle feature (Line–Line Angle) is discretized into n value in the interval 
                           [
                           0
                           ,
                           180
                           ]
                        . For the Joint–Joint Direction feature, the direction vector interval is divided as in Fig. 3
                        , every direction feature is located in one subinterval.

The normalization and discretization processes allow the user to sketch postures not so accurately, thus increasing the robustness of the retrieval approach.

In this paper, a semi-supervised feature selection algorithm derived from Laplacian Score [34] is utilized to reduce feature dimension. Laplacian Score is fundamentally based on Laplacian Eigenmaps [43] and Locality Preserving Projection [44]. The basic idea of Laplacian Score is to assess the features according to their locality preserving power and it is based on the observation that, two data points are probably related to the same topic if they are close to each other. In many learning problems such as classification, the local structure of the data space is very important. A nearest neighbor graph is constructed to model the local geometric structure in this method and Laplacian score seeks those features which respect this graph structure [34,45,46].

Let LS
                     
                        r
                      denotes the Laplacian Score of the 
                        r
                     -th feature. Let f
                     
                        ri
                      denotes the 
                        i
                     -th sample of the 
                        r
                     -th feature, 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        n
                     . The semi-supervised feature selection algorithm can be described as follows:
                        
                           •
                           Construct a nearest neighbor graph G with n nodes. The 
                                 i
                              -th node corresponds to X
                              
                                 i
                              . We put an edge between nodes i and j if X
                              
                                 i
                               and X
                              
                                 j
                               are close, i.e. X
                              
                                 i
                               is among k nearest neighbors of X
                              
                                 j
                               or X
                              
                                 j
                               is among k nearest neighbors of X
                              
                                 i
                              . In our work, there are some labeled training data, which means we have some 2D postures and the similarity between them is known by manual observation. An edge is added between two nodes known as similar and the edge is tagged.

If nodes i and j are connected, set 
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         −
                                                         (
                                                         ∥
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               ∥
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         /
                                                         t
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Edge
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   
                                                   is
                                                   
                                                   not
                                                   
                                                   tagged
                                                
                                             
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         Edge
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   
                                                   is
                                                   
                                                   tagged
                                                
                                             
                                          
                                       
                                    
                                 
                              where t is a suitable constant.Otherwise, set 
                                 
                                    
                                       S
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0
                              . The weight matrix S of the graph models the local structure of the data space.

For the 
                                 r
                              -th feature, we define 
                                 
                                    
                                       f
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       r
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       r
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       rn
                                    
                                 
                                 ]
                               
                              
                                 D
                                 =
                                 diag
                                 (
                                 S
                                 1
                                 )
                                 ,
                                 1
                                 =
                                 
                                    
                                       [
                                       1
                                       ,
                                       …
                                       ,
                                       1
                                       ]
                                    
                                    
                                       T
                                    
                                 
                               
                              
                                 LS
                                 =
                                 D
                                 −
                                 S
                               where the matrix LS is often called graph Laplacian. Let 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             r
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   r
                                                
                                                
                                                   T
                                                
                                             
                                             D
                                             1
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                             D
                                             1
                                          
                                       
                                       1
                                       .
                                    
                                 
                              
                           

Compute the Laplacian Score of the 
                                 r
                              -th feature as follows: 
                                 
                                    
                                       
                                          
                                             LS
                                          
                                          
                                             r
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             LS
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      
                                                         ˜
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             D
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           

According to the scores of all the features, the features with highest k scores are selected.

Inspired by Tang [28], we built a retrieval system which allows the user to define a motion by sketch several key postures. The posture sketch has some simple limits such as (a) one sketch posture includes five strokes; (b) the first stroke is body; (c) the view tilt and elevation angles are set to zero and a azimuth angle that makes the motion easily distinguished is selected. Once the user׳s sketch is obtained, the joints are labeled automatically (the rules above make this process become possible). Fig. 4
                         shows a sketch example.

In the training stage, the key postures are firstly extracted for all the motions int the database. Here the key posture extraction algorithm proposed by Tang [28] is used. Then the key postures are projected into eight 2D plains, orthographic projection is applied and eight projection directions are denoted as 
                           {
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       k
                                    
                                 
                              
                              
                                 →
                              
                           
                           |
                           k
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           8
                           }
                        , where
                           
                              (5)
                              
                                 
                                    
                                       D
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 (
                                 
                                    sin
                                    (
                                    
                                       
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             8
                                          
                                       
                                       ·
                                       2
                                       π
                                    
                                    )
                                    ,
                                    0
                                    ,
                                    cos
                                    (
                                    
                                       
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             8
                                          
                                       
                                       ·
                                       2
                                       π
                                    
                                    )
                                 
                                 )
                                 .
                              
                           
                        
                        Fig. 5
                         shows an example of posture projection.

After all the projected postures are created, some similar 2D postures are labeled manually. Then the 2GPD feature is detected and the feature selection algorithm in Section 4 is used to reduced the feature dimension. What is more, some index structure such as K-D-tree or R-tree can applied to index the feature space, which can speed up the k-NN retrieval process. In this work, k-d tree is used as Tang [28] introduced.

For a sequence of input sketch postures, what the user desires is a consecutive motion, in which the similar postures should appear in the same order as input postures. When given n sketch postures 
                           {
                           
                              
                                 S
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 S
                              
                              
                                 n
                              
                           
                           }
                        , our posture by posture retrieval algorithm is presented in Algorithm 1. 
                           Algorithm 1
                           Retrieval algorithm. 
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                Input: n sketches: 
                                                   {
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                Output The motions which include all the sketches.
                                          
                                          
                                             1:
                                             
                                                Initialize 
                                                i=1.
                                          
                                          
                                             2:
                                             If 
                                                   i
                                                   >
                                                   n
                                                , the algorithm is terminated. Otherwise, search the k-d tree and return m
                                                
                                                   c
                                                 candidate postures for S
                                                
                                                   i
                                                . After selection by the user, m postures 
                                                   {
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⋯
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   }
                                                 are left.
                                          
                                          
                                             3:
                                             For each p
                                                
                                                   i
                                                
                                                
                                                   j
                                                (
                                                   1
                                                   ≤
                                                   j
                                                   ≤
                                                   m
                                                ), search all of the other sketches S
                                                
                                                   k
                                                (
                                                   k
                                                   ≠
                                                   i
                                                ) orderly in the motion m
                                                
                                                   i
                                                
                                                
                                                   j
                                                 which p
                                                
                                                   i
                                                
                                                
                                                   j
                                                 lies in. If all S
                                                
                                                   k
                                                 is found in m
                                                
                                                   i
                                                
                                                
                                                   j
                                                , then m
                                                
                                                   i
                                                
                                                
                                                   j
                                                 is added into result sets.
                                          
                                          
                                             4:
                                             If none of m
                                                
                                                   i
                                                
                                                
                                                   j
                                                (
                                                   1
                                                   ≤
                                                   j
                                                   ≤
                                                   m
                                                ) is chosen in step 3, Set i=i+1, Goto Step 2. Otherwise, the algorithm is terminated.
                                          
                                       
                                    
                                 
                              
                           


                        Fig. 6
                         shows an example of the retrieval algorithm.

Our experiments run on a desktop computer with a 3.10GHz Intel-Core-i5 cpu, 4GB RAM and Windows7 operating system. To demonstrate the efficiency of our approach, we use a subset of CMU motion database [47,48] as experimental data, which contains 1272 motion data files. Since the pure sketch-based motion retrieval method is rare, our results are compared with Choi׳s [21] method and Li׳s method [27]. A similar sketch like ours was used in Choi׳s method and a complex human figure sketch with trajectory constraints was used in Li׳s method.

The result of sketch based motion retrieval cannot be evaluate objectively. It is a good choice that the 3D motions returned by retrieval system are evaluated by the users themselves. To this end, a user study is conducted to show the effectiveness of our method. Fifteen graduate student participants are randomly chosen in our experiments.

First the effectiveness of single posture retrieval is evaluated. The participants sketching a posture and four similar candidate 3D posture results are given. If one of the results is accepted by the participant, we treat it as a successful retrieval. Each participant draw 20 different sketches in our experiment. The retrieval accuracy is shown in Fig. 7
                     . Fig. 8
                      presents some single posture retrieval examples.

Next, we evaluate the accuracy of motion sequence retrieval. First, the participants are required to browse the whole database motions. Then the participants are required to retrieve ten motions. For each motion, the participants retrieve them by sketching several key postures and our system will return several candidate motion results. It is regarded as a successful retrieval if one of the candidate motions meets the participant׳s requirement. Since the trajectory constraints is utilized in Li׳s method [27] but not in ours, we evaluate their method separately:with trajectory and with no trajectory. The experiment earlier is repeated for ten times. As shown in Fig. 9
                     , the accuracy of Li׳s method with trajectory is close to ours. But the retrieval time is doubled when the trajectory constraints is added in their method. Fig. 10
                      presents some motion sequence retrieval examples.

The selected feature dimension in the experiment earlier is set to 81, Fig. 11
                      shows how does the selected feature dimension affects the result accuracy.

@&#CONCLUSION@&#

In this paper, we present a 2D posture feature called 2D geometric pose descriptor, which describes a 2D sketch posture or projected posture by combine four kinds of geometric relation feature. The normalization and discretization to the feature make our method more robust to the different style of sketches. The semi-supervised feature selection method is designed to select a more compact and effective feature subset as feature representation, which makes the retrieval performance be more efficient.

In the future, we would like to study how to combine multiple different features like our 2GPD and spatial-temporal feature as feature representation, which would boost the algorithm׳s performance. Besides, our posture by posture retrieval algorithm can be extended to clip based retrieval algorithm.

@&#ACKNOWLEDGEMENTS@&#

This research is supported by the National High Technology Research and Development Program (2012AA011502), the National Key Technology R&D Program (2013BAH59F00), the Zhejiang Provincial Natural Science Foundation of China (LY13F020001), the Zhejiang Province Public Technology Applied Research Projects (No. 2014C33090) and partially supported by the grant of the “Sino-UK Higher Education Research Partnership for Ph.D. Students” Project funded by the Department of Business, Innovation and Skills of the British Government and Ministry of Education of P.R. China.

Supplementary data associated with this paper can be found in the online version at doi:10.1016/j.sigpro.2015.01.004.


                     
                        
                           Application 1
                           
                        
                     
                  

@&#REFERENCES@&#

