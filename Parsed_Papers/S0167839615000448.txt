@&#MAIN-TITLE@&#A normalized basis for condensed 
                  
                     
                        C
                     
                     
                        1
                     
                  
                Powell–Sabin-12 splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           B-spline basis of the quadratic condensed Powell–Sabin-12 spline space.


                        
                        
                           
                           Determination of control points.


                        
                        
                           
                           Discrete and differentiable quasi-interpolants.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

B-spline

Powell–Sabin-12 triangulation

Blossoming

Marsden's identity

Quasi-interpolation

@&#ABSTRACT@&#


               
               
                  The purpose of this article is the construction of a normalized basis for a quadratic condensed Powell–Sabin-12 macro-element space introduced by Alfeld et al. (2010). The basis functions have a local support, they are nonnegative, and they form a partition of unity. The construction of this basis is adopted from Dierckx (1997) and Speleers (2010a), and is based on the determination of a set of triangles that must contain a specific set of points. The proposed basis can only be constructed on triangulations with a maximal angle less than 
                        
                           π
                           2
                        
                     .
               
            

@&#INTRODUCTION@&#

Piecewise quadratic triangular macro-elements are very useful in the construction of 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -surfaces. Two of them are described in the original paper of Powell and Sabin (1977): the Powell–Sabin-6 triangle, subdivided into six subtriangles and the Powell–Sabin-12 triangle, subdivided into 12 subtriangles. A major advantage of the Powell–Sabin-12 macro-elements is that certain geometric constraints required in the Powell–Sabin-6 case can be removed (see Remark 7.4. in Schumaker and Sorokina, 2006). Some 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      macro-elements, such as piecewise quadratic Powell–Sabin-12 element, are refinable in the sense that nested spline spaces with stable local bases can be constructed with their help. This refinability property makes the Powell–Sabin-12 element suitable for multiresolution analysis. Jia and Liu (2008) have used a mixture of 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-6 and Powell–Sabin-12 elements in order to construct continuously differentiable wavelets on triangulations.

There exist many bases with a very similar construction based on Powell–Sabin-6 partitions with different degrees (see for example Lamnii et al., 2014; Speleers, 2010b, 2013b) and different dimensions (see for example Speleers, 2013a). Similarly a B-spline representation for bivariate reduced Clough–Tocher splines has been considered in Speleers (2010a). Recently, a simplex spline basis for the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                     -quadratics on the Powell–Sabin-12 with all the usual properties of the univariate B-spline basis was discovered (Cohen et al., 2013).

In applications, and in particular for scattered data fitting and the solution of boundary-value problems by the finite-element method, it is advantageous to work with macro-element spaces that produce a given order of approximation while involving the least number of degrees of freedom. Degrees of freedom can frequently be removed from macro-elements by a process called condensation, but typically at the cost of not preserving full approximation power. In Alfeld et al. (2010), a variant of the condensed bivariate 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-12 macro-element is defined that has the same approximation power, but only requires vertex data. This approach was used to condense the Powell–Sabin-12 macro-element in Powell and Sabin (1977), although there is no discussion of approximation power there. Numerically, the condensation has only a small effect on the error in the interpolant. The structure of the condensed 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-12 spline space is very similar to the structure of the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-6 (Dierckx, 1997) and the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      reduced Clough–Tocher space (Speleers, 2010a). Indeed, these three spaces can be characterized by means of the function values and derivative values at the vertices. This explains why it is possible to construct a normalized B-spline basis.

The purpose of this paper is to show that for the condensed 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-12 spline space, it is possible to construct a normalized B-spline basis. The basis functions have a local support, they are nonnegative, and they form a partition of unity. The construction is based on the determination of a set of triangles that must contain a specific set of points. This is an important property in CAGD applications. The fact that the basis functions sum up to 1, ensures that the surface is affine invariant: applying an affine transformation to the control points yields the same result as applying the transformation on the surface itself. The nonnegativity of the basis functions guarantees that the surface lies in the convex hull of its control points. For the construction we follow the same approach from Speleers (2010a), developed to obtain a B-spline representation for reduced Clough–Tocher splines. This means that the triangulation Δ or its refinement has to satisfy certain geometric constraints. In the Powell–Sabin-12 case we assume that the maximal angle in the triangulation Δ is less than 
                        π
                        /
                        2
                     . This assumption, however, implies that our basis cannot be defined on arbitrary triangulations, in contrast to the normalized B-spline bases for the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-6 space (Dierckx, 1997) and the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      reduced Clough–Tocher space (Speleers, 2010a).

The paper is organized as follows. Section 2 recalls some known results on the blossom of polynomials, some general concepts of polynomials on triangles, and the definition of the quadratic condensed Powell–Sabin-12 spline space. Section 3 describes the construction of the normalized basis for this space, which is based on determining a set of triangles that contain a specific set of points, and the interpolation rules for the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      quadratic condensed Powell–Sabin-12 splines. In Section 4, for some particular triangulations, we are able to define control points and we also show how to construct discrete and differentiable quasi-interpolants that reproduce quadratic polynomials.

The Bernstein–Bézier techniques are well-established tools from CAGD, and it is well known that the related Bernstein–Bézier form of the polynomial pieces plays a key role for bivariate splines, see Lai and Schumaker (2007) for details.

Let 
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         denote the linear space of bivariate polynomials of total degree less than or equal to d. Every polynomial 
                           p
                           ∈
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         can be written in its Bernstein–Bézier form, i.e. for every triangle 
                           T
                           :
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 3
                              
                           
                           〉
                         we have
                           
                              
                                 p
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       |
                                       α
                                       |
                                       =
                                       d
                                    
                                 
                                 
                                    
                                       b
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       α
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 λ
                                 )
                                 ,
                              
                           
                         with 
                           α
                           =
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                           ∈
                           
                              
                                 N
                              
                              
                                 3
                              
                           
                         a multiindex of length 
                           |
                           α
                           |
                           =
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                        , 
                           λ
                           =
                           (
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 λ
                              
                              
                                 3
                              
                           
                           )
                         the barycentric coordinates of 
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              
                                 T
                              
                           
                         with respect to 
                           T
                        , and
                           
                              (1)
                              
                                 
                                    
                                       B
                                    
                                    
                                       α
                                    
                                    
                                       d
                                    
                                 
                                 (
                                 λ
                                 )
                                 =
                                 
                                    
                                       d
                                       !
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       !
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       !
                                       
                                          
                                             α
                                          
                                          
                                             3
                                          
                                       
                                       !
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       3
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                              
                           
                         the Bernstein–Bézier polynomials of degree d on the triangle. The coefficients 
                           
                              
                                 b
                              
                              
                                 α
                              
                           
                         are called the Bézier ordinates of the polynomial p associated with the Bézier points 
                           
                              (
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           /
                           d
                        , which are sometimes also called domain points.

On the other hand, the multiaffine blossom of a polynomial p is the unique symmetric multiaffine polynomial 
                           B
                           [
                           p
                           ]
                           (
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 u
                              
                              
                                 d
                              
                           
                           )
                         for which
                           
                              
                                 p
                                 (
                                 u
                                 )
                                 =
                                 B
                                 [
                                 p
                                 ]
                                 (
                                 
                                    
                                       
                                          u
                                          ,
                                          …
                                          ,
                                          u
                                       
                                       ︸
                                    
                                    d
                                 
                                 )
                                 .
                              
                           
                         
                        Ramshaw (1989) has shown that the Bézier ordinates for a polynomial relative to a triangle 
                           T
                         can be obtained by evaluating the polynomial's blossom at the vertices of 
                           T
                        . More precisely, for all 
                           α
                           =
                           (
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           )
                           ∈
                           
                              
                                 N
                              
                              
                                 3
                              
                           
                         where 
                           |
                           α
                           |
                           =
                           
                              
                                 α
                              
                              
                                 1
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 α
                              
                              
                                 3
                              
                           
                           =
                           d
                        , we have
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       α
                                    
                                 
                                 =
                                 B
                                 [
                                 p
                                 ]
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       ︷
                                    
                                    d
                                 
                                 )
                                 .
                              
                           
                        
                     

Consider a simply connected subset 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         with polygonal boundary ∂Ω. Assume a conforming triangulation Δ of Ω is given, consisting of t triangles 
                           
                              
                                 T
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           t
                        , and having 
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                         vertices 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           i
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        .

Let 
                           V
                         and 
                           E
                         be the sets of vertices and edges, respectively. We now define the Powell–Sabin-12 (PS-12) split of interest in this paper.


                        
                           Definition 1
                           Given a triangle 
                                 T
                                 :
                                 =
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 〉
                              , for each 
                                 1
                                 ≤
                                 i
                                 ≤
                                 3
                              , let 
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                               be the midpoint of the edge 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       i
                                       +
                                       2
                                    
                                 
                                 〉
                               opposite to 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                               where we set 
                                 
                                    
                                       V
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                              . Draw in the line segments 
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 〉
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              . Then it is easy to see that these three line segments intersect at the barycenter 
                                 Z
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 /
                                 3
                               of 
                                 T
                              . The resulting partition 
                                 
                                    
                                       T
                                    
                                    
                                       
                                          PS
                                       
                                       6
                                    
                                 
                               of 
                                 T
                               into six triangles is called the Powell–Sabin-6 split of 
                                 T
                              . If we now draw in the line segments 
                                 〈
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 〉
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                               where 
                                 
                                    
                                       R
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                              , then the resulting partition 
                                 
                                    
                                       T
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                               of 
                                 T
                               into twelve triangles is called the PS-12 split of 
                                 T
                              , see Fig. 1
                               where we set 
                                 
                                    
                                       R
                                    
                                    
                                       23
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       1
                                    
                                 
                              , 
                                 
                                    
                                       R
                                    
                                    
                                       31
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                              , 
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              , 
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       31
                                    
                                 
                                 )
                                 /
                                 2
                              , 
                                 
                                    
                                       W
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       23
                                    
                                 
                                 )
                                 /
                                 2
                              , and 
                                 
                                    
                                       W
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       23
                                    
                                 
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       31
                                    
                                 
                                 )
                                 /
                                 2
                              . The triangulation obtained from Δ by applying the PS-12 split to each triangle will be denoted 
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                              .

The linear space of piecewise 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuous quadratic polynomials on 
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                         is defined as
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                                 )
                                 :
                                 =
                                 {
                                 s
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                                 
                                 :
                                 
                                 
                                    
                                       s
                                    
                                    
                                       |
                                       
                                          
                                             T
                                          
                                          
                                             ⁎
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       T
                                    
                                    
                                       ⁎
                                    
                                 
                                 ∈
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                                 }
                                 .
                              
                           
                         It is well known (cf. Theorem 6.13 in Lai and Schumaker, 2007) that the dimension of 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                           )
                         is 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                           +
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                        , where 
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                         is the number of edges in Δ.

We now consider a particular subspace of 
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                           )
                         with full approximation power, but which requires only nodal data at the vertices of Δ, see Alfeld et al. (2010). For each edge e in Δ, let 
                           
                              
                                 η
                              
                              
                                 e
                              
                           
                         be any unit vector that is not parallel to the edge. It is clear that for every 
                           s
                           ∈
                           
                              
                                 S
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                           )
                         and every edge e of Δ, 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       η
                                    
                                    
                                       e
                                    
                                 
                              
                           
                           s
                         is a piecewise linear function on e. Alfeld et al. (2010) define the associated condensed 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         quadratic PS-12 macro-element space by requiring that these cross derivatives be linear rather than piecewise linear.

The condensed PS-12 spline space is defined as
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                                 )
                                 :
                                 =
                                 {
                                 s
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                                 )
                                 
                                 :
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             η
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             |
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                  for each edge 
                                 e
                                  in 
                                 Δ
                                 }
                                 .
                              
                           
                         The dimension of this spline space equals 
                           3
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        . The following Hermite interpolation problem has a unique solution 
                           s
                           ∈
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                           )
                         for any given set of 
                           (
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 x
                                 ,
                                 k
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 y
                                 ,
                                 k
                              
                           
                           )
                        -values with 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 v
                              
                           
                        :
                           
                              (2)
                              
                                 s
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       x
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ∂
                                       s
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       y
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 .
                              
                           
                        
                     

Suppose that the PS-12-spline s is defined by means of interpolation problem (2). On each micro-triangle in 
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                        , the spline is a quadratic polynomial that can be represented in its Bernstein–Bézier formulation. The corresponding Bézier ordinates are schematically represented in Fig. 2
                        .

Then by standard Bernstein–Bézier arguments, we get the following formulae for the Bézier ordinates of s:
                           
                              (3)
                              
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          y
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       a
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          y
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    2
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          x
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          y
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       a
                                    
                                    
                                       13
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       8
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       a
                                    
                                    
                                       15
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       10
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       a
                                    
                                    
                                       19
                                    
                                 
                                 =
                                 
                                    3
                                    4
                                 
                                 
                                    
                                       a
                                    
                                    
                                       16
                                    
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       a
                                    
                                    
                                       24
                                    
                                 
                                 =
                                 
                                    3
                                    4
                                 
                                 
                                    
                                       a
                                    
                                    
                                       18
                                    
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 
                                    
                                       a
                                    
                                    
                                       4
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       a
                                    
                                    
                                       25
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             16
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             17
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             18
                                          
                                       
                                    
                                    3
                                 
                                 ,
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       a
                                    
                                    
                                       26
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       16
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       18
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       a
                                    
                                    
                                       29
                                    
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       19
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       a
                                    
                                    
                                       24
                                    
                                 
                                 .
                              
                           
                         Note that each of the formulae in (3)–(13) is to be applied to get the other coefficients of s.

We now use a similar way developed in Alfeld et al. (2010) to determine the formulae for 
                           
                              
                                 a
                              
                              
                                 16
                              
                           
                        , 
                           
                              
                                 a
                              
                              
                                 17
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 18
                              
                           
                        . Suppose 
                           e
                           :
                           =
                           〈
                           
                              
                                 V
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 V
                              
                              
                                 2
                              
                           
                           〉
                        , and let 
                           
                              
                                 η
                              
                              
                                 e
                              
                           
                         be the unit vector perpendicular to e and pointing into T. To give a formula for 
                           
                              
                                 a
                              
                              
                                 16
                              
                           
                        , we make use of our requirement that 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       η
                                    
                                    
                                       e
                                    
                                 
                              
                           
                           s
                         should be linear along the edge e. First, we write
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          e
                                       
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          e
                                       
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       β
                                    
                                    
                                       12
                                    
                                 
                                 (
                                 Z
                                 −
                                 
                                    
                                       R
                                    
                                    
                                       12
                                    
                                 
                                 )
                                 .
                              
                           
                         For details on how to get the α's and β's, see Remark 1 given in Alfeld et al. (2010). Then, we get the formulae
                           
                              (14)
                              
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       B
                                       +
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    A
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 4
                                 
                                 
                                    B
                                    A
                                 
                                 ,
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 −
                                 2
                                 
                                    
                                       B
                                       +
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    A
                                 
                                 ,
                                 
                                 
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 4
                                 
                                 
                                    B
                                    A
                                 
                                 ,
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       α
                                    
                                    
                                       12
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       +
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       .
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                    A
                                 
                                 ,
                                 
                                 
                                    
                                       β
                                    
                                    
                                       12
                                    
                                 
                                 =
                                 3
                                 
                                    B
                                    A
                                 
                                 ,
                              
                           
                         where 
                           B
                           :
                           =
                           
                              
                                 ‖
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 ‖
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                         and 
                           A
                           :
                           =
                           
                              B
                           
                           
                           |
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              −
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              )
                           
                           +
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           +
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              )
                           
                           |
                        .


                        
                           Proposition 1
                           
                              The coefficient 
                              
                                 
                                    
                                       a
                                    
                                    
                                       16
                                    
                                 
                               
                              is given by the following formula:
                              
                                 
                                    (17)
                                    
                                       
                                          
                                             a
                                          
                                          
                                             16
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             12
                                             
                                             B
                                          
                                       
                                       
                                          (
                                          4
                                          
                                             (
                                             B
                                             +
                                             C
                                             )
                                          
                                          s
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          (
                                          2
                                          C
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          B
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                          .
                                          ∇
                                          s
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       ,
                                    
                                 
                               
                              where 
                              
                                 C
                                 =
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 .
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 )
                              
                              .
                           

The coefficient 
                                 
                                    
                                       a
                                    
                                    
                                       16
                                    
                                 
                               is given by the last formula in Section 3 of Alfeld et al. (2010). Hence,
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             16
                                          
                                       
                                       =
                                       
                                          
                                             a
                                          
                                          
                                             13
                                          
                                       
                                       +
                                       (
                                       −
                                       2
                                       
                                          
                                             α
                                          
                                          
                                             12
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             8
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             13
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             8
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             5
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             7
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             5
                                          
                                       
                                       )
                                       )
                                       /
                                       2
                                       
                                          
                                             β
                                          
                                          
                                             12
                                          
                                       
                                       .
                                    
                                 
                               Then, using Eqs. (3)–(13) and (14)–(16) we obtain (17).  □

Finally, similar formulae hold for 
                           
                              
                                 a
                              
                              
                                 17
                              
                           
                         and 
                           
                              
                                 a
                              
                              
                                 18
                              
                           
                        .

In this section, we give the main results of the paper. We will look for a suitable B-spline representation of 
                        
                           
                              
                                 
                                    S
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              2
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              
                                 PS
                              
                              12
                           
                        
                        )
                     ,
                        
                           (18)
                           
                              s
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 3
                              
                              
                                 
                                    c
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ,
                           
                        
                      where the basis functions satisfy
                        
                           (19)
                           
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ≥
                              0
                              ,
                              
                              1
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 3
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              x
                              ,
                              y
                              )
                              ,
                           
                        
                      and have local support. Some properties for the basis 
                        {
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                        
                        }
                      as convex partition of unity and locality are highly desirable in CAGD applications.

Any B-spline 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                        
                      with respect to vertex 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      is required to be supported in 
                        
                           
                              Ω
                           
                           
                              i
                           
                        
                        :
                        =
                        
                           Star
                        
                        (
                        
                           
                              V
                           
                           
                              i
                           
                        
                        )
                      (for the definition of 
                        
                           Star
                        
                        (
                        
                           
                              V
                           
                           
                              i
                           
                        
                        )
                     , see Lai and Schumaker, 2007). Thus, the spline 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                        
                      is zero with its first derivatives at any vertex of Δ except for 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      and it is defined as the unique solution of interpolation problem
                        
                           (20)
                           
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       a
                                       +
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    a
                                    b
                                 
                              
                              
                              
                              for
                              
                              
                              0
                              ≤
                              a
                              +
                              b
                              ≤
                              1
                              .
                           
                        
                      We now determine for each vertex 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      a particular set of three linearly independent 
                        {
                        
                           
                              β
                           
                           
                              i
                              ,
                              j
                           
                           
                              a
                              b
                           
                        
                        ,
                        
                        0
                        ≤
                        a
                        +
                        b
                        ≤
                        1
                        }
                     , such that the corresponding B-splines 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                        
                      will form a convex partition of unity.

With each vertex 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      we associate a triangle 
                        
                           
                              t
                           
                           
                              i
                           
                        
                        (
                        
                           
                              Q
                           
                           
                              i
                              ,
                              1
                           
                        
                        ,
                        
                           
                              Q
                           
                           
                              i
                              ,
                              2
                           
                        
                        ,
                        
                           
                              Q
                           
                           
                              i
                              ,
                              3
                           
                        
                        )
                      with vertices 
                        
                           
                              Q
                           
                           
                              i
                              ,
                              j
                           
                        
                        =
                        
                           
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              )
                           
                           
                              T
                           
                        
                     , 
                        j
                        =
                        1
                        ,
                        2
                        ,
                        3
                     . Each 
                        {
                        
                           
                              β
                           
                           
                              i
                              ,
                              j
                           
                           
                              a
                              b
                           
                        
                        ,
                        
                        0
                        ≤
                        a
                        +
                        b
                        ≤
                        1
                        }
                      is then related to the function and derivative values at the point 
                        
                           
                              V
                           
                           
                              i
                           
                        
                      of one of the Bernstein polynomials of degree 1 with respect to triangle 
                        
                           
                              t
                           
                           
                              i
                           
                        
                     . They are defined as
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                             
                                                00
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                             
                                                00
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                             
                                                10
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                             
                                                01
                                             
                                          
                                       
                                       
                                          
                                             
                                                β
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                             
                                                01
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                2
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                3
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                      More precisely, from Speleers (2013b) we have
                        
                           (21)
                           
                              
                                 
                                    β
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                                 
                                    a
                                    b
                                 
                              
                              =
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       a
                                       +
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    100
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                    ,
                                    2
                                 
                                 
                                    a
                                    b
                                 
                              
                              =
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       a
                                       +
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    010
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                                 
                                    β
                                 
                                 
                                    i
                                    ,
                                    3
                                 
                                 
                                    a
                                    b
                                 
                              
                              =
                              
                                 
                                    
                                       ∂
                                    
                                    
                                       a
                                       +
                                       b
                                    
                                 
                                 
                                    ∂
                                    
                                       
                                          x
                                       
                                       
                                          a
                                       
                                    
                                    ∂
                                    
                                       
                                          y
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    001
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    V
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                           
                        
                      for all 
                        0
                        ≤
                        a
                        +
                        b
                        ≤
                        1
                     . Consequently, the B-splines 
                        
                           
                              B
                           
                           
                              i
                              ,
                              j
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      constructed using the set of triangles 
                        
                           
                              t
                           
                           
                              i
                           
                        
                      form a partition of unity.

Given a triangle 
                        T
                        ∈
                        Δ
                     , let
                        
                           
                              
                                 
                                    Θ
                                 
                                 
                                    T
                                 
                              
                              :
                              =
                               largest angle in the triangle 
                              T
                              .
                           
                        
                      Set,
                        
                           
                              Θ
                              :
                              =
                              
                                 max
                                 
                                    T
                                    ∈
                                    Δ
                                 
                              
                              ⁡
                              
                                 
                                    Θ
                                 
                                 
                                    T
                                 
                              
                              .
                           
                        
                      In the rest of this paper, we will assume that 
                        Θ
                        <
                        
                           π
                           2
                        
                     .

In order to obtain nonnegative basis functions, we follow exactly the same strategy developed in Speleers (2010a).

To derive the conditions ensuring nonnegativity, we focus on the B-spline 
                        
                           
                              B
                           
                           
                              1
                              ,
                              j
                           
                        
                        (
                        x
                        ,
                        y
                        )
                      corresponding to vertex 
                        
                           
                              V
                           
                           
                              1
                           
                        
                     . We consider again the macro-triangle 
                        T
                        (
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        )
                      depicted in Fig. 1. The Bernstein–Bézier representation of the B-spline 
                        
                           
                              B
                           
                           
                              1
                              ,
                              j
                           
                        
                      on the triangle 
                        T
                        (
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        )
                      is schematically represented in Fig. 3
                     . As presented in the above section, the coefficients 
                        
                           
                              d
                           
                           
                              7
                           
                        
                        ,
                        …
                        ,
                        
                           
                              d
                           
                           
                              19
                           
                        
                      are given by
                        
                           (22)
                           
                              
                                 
                                    d
                                 
                                 
                                    7
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    8
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    9
                                 
                              
                              =
                              
                                 3
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    10
                                 
                              
                              =
                              
                                 3
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 1
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (23)
                           
                              
                                 
                                    d
                                 
                                 
                                    11
                                 
                              
                              =
                              
                                 3
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    12
                                 
                              
                              =
                              
                                 3
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              +
                              
                                 1
                                 4
                              
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    13
                                 
                              
                              =
                              
                                 1
                                 8
                              
                              (
                              3
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              +
                              3
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (24)
                           
                              
                                 
                                    d
                                 
                                 
                                    14
                                 
                              
                              =
                              
                                 3
                                 8
                              
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    15
                                 
                              
                              =
                              
                                 3
                                 8
                              
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    16
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (25)
                           
                              
                                 
                                    d
                                 
                                 
                                    17
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    18
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                              
                                 
                                    d
                                 
                                 
                                    19
                                 
                              
                              =
                              
                                 1
                                 3
                              
                              (
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              )
                              .
                           
                        
                      To obtain conditions ensuring nonnegativity, it is sufficient to impose that all Bézier ordinates of the B-spline 
                        
                           
                              B
                           
                           
                              1
                              ,
                              j
                           
                        
                      on the triangle 
                        T
                        (
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        )
                      are nonnegative. Looking at the formulae (22)–(25), this is the case when
                        
                           (26)
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ≥
                              0
                              ,
                              
                              i
                              =
                              1
                              ,
                              …
                              ,
                              6
                              .
                           
                        
                     
                  

Let
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 
                                    R
                                 
                                 
                                    12
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 
                                    W
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 1
                                 2
                              
                              
                                 
                                    R
                                 
                                 
                                    31
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (27)
                           
                              
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    3
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    2
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       η
                                    
                                    
                                       1
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (28)
                           
                              
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    3
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    2
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    
                                       η
                                    
                                    
                                       2
                                    
                                 
                                 
                                    4
                                    (
                                    
                                       
                                          η
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          θ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              η
                           
                           
                              1
                           
                        
                        =
                        
                           
                              ‖
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ‖
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              η
                           
                           
                              2
                           
                        
                        =
                        
                           
                              ‖
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ‖
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        =
                        
                           
                              ‖
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              ‖
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              θ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              ‖
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              −
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                              ‖
                           
                           
                              2
                           
                        
                      where 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      is the orthogonal projection of 
                        
                           
                              V
                           
                           
                              3
                           
                        
                      onto the edge 
                        〈
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        〉
                     , and 
                        
                           
                              H
                           
                           
                              2
                           
                        
                      is the orthogonal projection of 
                        
                           
                              V
                           
                           
                              2
                           
                        
                      onto the edge 
                        〈
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        〉
                     . 
                        Proposition 2
                        
                           The functions 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                           , are nonnegative on 
                           
                              T
                              (
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              )
                           
                           , if the triangle 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            
                           contains the points 
                           
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           
                           , 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              4
                           
                           , and 
                           
                              
                                 
                                    T
                                 
                                 
                                    k
                                 
                              
                           
                           , 
                           
                              k
                              =
                              1
                              ,
                              2
                           
                           .
                        

Without loss of generality, we assume 
                              j
                              =
                              1
                           . We recall from (20) and (21) that
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             a
                                             +
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          β
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          a
                                          b
                                       
                                    
                                    
                                     for 
                                    
                                    0
                                    ≤
                                    a
                                    +
                                    b
                                    ≤
                                    1
                                    ,
                                 
                              
                            where
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                       
                                          a
                                          b
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∂
                                          
                                          
                                             a
                                             +
                                             b
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                a
                                             
                                          
                                          ∂
                                          
                                             
                                                y
                                             
                                             
                                                b
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          100
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                            where 
                              
                                 
                                    B
                                 
                                 
                                    100
                                 
                                 
                                    1
                                 
                              
                            is the Bernstein polynomial of degree 1 with respect to triangle 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . Let us denote 
                              f
                              (
                              V
                              )
                              :
                              =
                              
                                 
                                    B
                                 
                                 
                                    100
                                 
                                 
                                    1
                                 
                              
                              (
                              V
                              )
                           . Then
                              
                                 (30)
                                 
                                    f
                                    (
                                    V
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    (
                                    V
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                            Each Bernstein polynomial is nonnegative on its domain triangle. It follows that 
                              f
                              (
                              V
                              )
                              ≥
                              0
                            for all 
                              V
                              ∈
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . In view of the smoothness at vertex 
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                           , the Bézier ordinate 
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                            is given by
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                            Hence, imposing 
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                            to be nonnegative is equivalent to the condition that the point 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            is inside the triangle 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . From (4), we have
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    
                                       1
                                       2
                                    
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          12
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    V
                                    1
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    .
                                 
                              
                            Then, 
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                            is nonnegative if 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            is inside the triangle 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . Similarly, we can verify that 
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                            are nonnegative if 
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                            are inside the triangle 
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           .

On the other hand, from Proposition 1 we have
                              
                                 (31)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          12
                                          B
                                       
                                    
                                    (
                                    4
                                    (
                                    B
                                    +
                                    C
                                    )
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    
                                       (
                                       2
                                       C
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       B
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                       )
                                    
                                    .
                                 
                              
                            Hence,
                              
                                 
                                    
                                       
                                          3
                                          B
                                       
                                       
                                          B
                                          +
                                          C
                                       
                                    
                                    
                                    
                                       
                                          d
                                       
                                       
                                          5
                                       
                                    
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    
                                       (
                                       
                                          
                                             2
                                             C
                                          
                                          
                                             4
                                             (
                                             B
                                             +
                                             C
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          B
                                          
                                             4
                                             (
                                             B
                                             +
                                             C
                                             )
                                          
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    .
                                 
                              
                            Put,
                              
                                 (32)
                                 
                                    d
                                    =
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    +
                                    ∇
                                    f
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    
                                       (
                                       
                                          
                                             2
                                             
                                             C
                                          
                                          
                                             4
                                             (
                                             B
                                             +
                                             C
                                             )
                                          
                                       
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       
                                          B
                                          
                                             4
                                             (
                                             B
                                             +
                                             C
                                             )
                                          
                                       
                                       
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                    .
                                 
                              
                            Since 
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                            is the orthogonal projection of 
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                            onto the edge 
                              〈
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              〉
                           , it follows that
                              
                                 
                                    C
                                    =
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    .
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          3
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          ‖
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    .
                                    
                                       
                                          ‖
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Let 
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           , then
                              
                                 (33)
                                 
                                    
                                       d
                                       =
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       ∇
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       .
                                       
                                          (
                                          
                                             
                                                2
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                4
                                                (
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                4
                                                (
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       =
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       ∇
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       .
                                       
                                          (
                                          
                                             
                                                3
                                                
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                2
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                4
                                                (
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                2
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                4
                                                (
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                          
                                             
                                                V
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                4
                                                (
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                3
                                             
                                          
                                          −
                                          
                                             
                                                V
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       =
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       ∇
                                       f
                                       (
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       .
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          d
                                       
                                       =
                                       f
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                            Now the hypothesis 
                              Θ
                              <
                              
                                 π
                                 2
                              
                            implies that 
                              C
                              =
                              (
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              )
                              .
                              (
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              −
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              )
                            is nonnegative. The real 
                              B
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    ‖
                                 
                                 
                                    2
                                 
                              
                            is nonnegative, then from (31), (32) and (33) we conclude that 
                              
                                 
                                    d
                                 
                                 
                                    5
                                 
                              
                              ≥
                              0
                            if 
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . In the same way, we can show that 
                              
                                 
                                    d
                                 
                                 
                                    6
                                 
                              
                              ≥
                              0
                            if 
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           , and the proof is complete.  □

By (27) we observe that 
                        
                           
                              T
                           
                           
                              1
                           
                        
                        ∈
                        T
                      and 
                        (
                        
                           
                              3
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              +
                              2
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                           
                           
                              4
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        
                        ,
                        
                           
                              2
                              
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                           
                           
                              4
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        
                        ,
                        
                           
                              
                                 η
                              
                              
                                 1
                              
                           
                           
                              4
                              (
                              
                                 
                                    η
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        
                        )
                      is the barycentric form of 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      relative to the triangle 
                        T
                        (
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        )
                     . Now, we will see how to locate geometrically the point 
                        
                           
                              T
                           
                           
                              1
                           
                        
                      in the triangle 
                        T
                        (
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              3
                           
                        
                        )
                     .
                        
                           •
                           We draw a straight line (D) not parallel to the edge 
                                 <
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 >
                               passing through the point 
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                              .

We define the points 
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                               on (D) such that 
                                 
                                    
                                       ‖
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             M
                                          
                                          
                                             α
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 α
                              .

On the line (D), we draw the points 
                                 
                                    
                                       M
                                    
                                    
                                       4
                                       (
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                              , 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              .

We draw two straight lines parallel to the line 
                                 (
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       4
                                       (
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                                 )
                               that pass, respectively, through 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       M
                                    
                                    
                                       2
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              .

From the intersection of these two lines with the edge 
                                 〈
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       V
                                    
                                    
                                       2
                                    
                                 
                                 〉
                              , we draw two straight lines with equations 
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       2
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       4
                                       (
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                    
                                    
                                       4
                                       (
                                       
                                          
                                             η
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       )
                                    
                                 
                              .

The intersection of these last two lines gives the point 
                                 
                                    
                                       T
                                    
                                    
                                       1
                                    
                                 
                              .

On the other hand, since 
                        
                           
                              H
                           
                           
                              1
                           
                        
                      is the orthogonal projection of 
                        
                           
                              V
                           
                           
                              3
                           
                        
                      onto the edge 
                        〈
                        
                           
                              V
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              V
                           
                           
                              2
                           
                        
                        〉
                     , it follows that there exists a 
                        
                           
                              γ
                           
                           
                              1
                           
                        
                      such that 
                        
                           
                              θ
                           
                           
                              1
                           
                        
                        =
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        
                           
                              η
                           
                           
                              1
                           
                        
                     , where 
                        0
                        ≤
                        
                           
                              γ
                           
                           
                              1
                           
                        
                        ≤
                        1
                     . Hence, form (27) we have
                        
                           (34)
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    3
                                    +
                                    2
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    2
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 1
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                      Similarly, by (27) the point 
                        
                           
                              T
                           
                           
                              2
                           
                        
                      can be written in the form
                        
                           (35)
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    3
                                    +
                                    2
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    2
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 1
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              θ
                           
                           
                              2
                           
                        
                        =
                        
                           
                              γ
                           
                           
                              2
                           
                        
                        
                           
                              η
                           
                           
                              2
                           
                        
                     , 
                        0
                        ≤
                        
                           
                              γ
                           
                           
                              2
                           
                        
                        ≤
                        1
                     .
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                              =
                              
                                 3
                                 4
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 1
                                 4
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                      It follows immediately from (34) that
                        
                           (36)
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              1
                              −
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where
                        
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 1
                                 
                                    2
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    3
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    2
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              .
                           
                        
                      A similar argument shows that
                        
                           (37)
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              1
                              −
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    γ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where
                        
                           
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 1
                                 
                                    2
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    3
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    2
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    4
                                    (
                                    1
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                      We then arrive at the following result. 
                        Proposition 3
                        
                           The functions 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                           , on 
                           
                              T
                              (
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              )
                            
                           are nonnegative if 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                            
                           contains the points 
                           
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           
                           , 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              4
                           
                           , 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       T
                                       ¯
                                    
                                 
                                 
                                    
                                       
                                          γ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                           .
                        

We then establish the following corollary. 
                        Corollary 1
                        
                           In order to derive conditions for the nonnegativity of 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                           , on 
                           
                              T
                              (
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              )
                            
                           it then suffices to request that 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            
                           contains the points 
                           
                              
                                 
                                    
                                       P
                                       ¯
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              k
                              =
                              1
                              ,
                              …
                              ,
                              3
                            
                           given by (see 
                           
                              Fig. 4
                           
                           
                           )
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             ¯
                                          
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             P
                                             ¯
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          R
                                       
                                       
                                          12
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             P
                                             ¯
                                          
                                       
                                       
                                          3
                                       
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          R
                                       
                                       
                                          31
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             T
                                             ¯
                                          
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       5
                                       8
                                    
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       1
                                       8
                                    
                                    
                                       
                                          V
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          
                                             T
                                             ¯
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       5
                                       8
                                    
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       
                                          V
                                       
                                       
                                          3
                                       
                                    
                                    +
                                    
                                       1
                                       8
                                    
                                    
                                       
                                          V
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        


                           Suppose Δ is a regular triangulation consisting of equilateral triangles. Then, the points 
                           
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                            
                           coincide with 
                           
                              (
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              +
                              Z
                              )
                              /
                              2
                           
                           . Therefore, the functions 
                           
                              
                                 
                                    B
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                           
                           , 
                           
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                           , are nonnegative on 
                           
                              T
                              (
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              )
                            
                           if the triangle 
                           
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            
                           contains the following points:
                           
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    Z
                                    )
                                    /
                                    2
                                    ,
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          12
                                       
                                    
                                    )
                                    /
                                    2
                                    ,
                                    
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          31
                                       
                                    
                                    )
                                    /
                                    2
                                    .
                                 
                              
                           
                        

The PS-12 B-splines have some nice properties, which are very useful in CAGD and approximation applications. In this subsection we give some of them.

For each vertex 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                        , we have
                           
                              
                                 x
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ,
                                 
                                 
                                 y
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 .
                              
                           
                        
                     

We now define the control points as
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ,
                              
                           
                         and the control triangles as
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       3
                                    
                                 
                                 )
                                 .
                              
                           
                         The projection of the control triangles 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         in the 
                           (
                           x
                           ,
                           y
                           )
                         plane are the PS-12 triangles 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                        . Furthermore, one can prove that the control triangle is tangent to the surface at 
                           s
                           (
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                           )
                        .

In the following result, we give Hermite interpolation rules for 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         quadratic PS-12 splines in the normalized B-spline representation. 
                           Proposition 4
                           
                              Let 
                              
                                 s
                                 ∈
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       2
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       
                                          PS
                                       
                                       12
                                    
                                 
                                 )
                              
                              , then
                              
                                 
                                    
                                       s
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          3
                                       
                                       
                                          (
                                          s
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                −
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                T
                                             
                                          
                                          ∇
                                          s
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                       
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

The proof is similar to the one of Theorem 6 given in Lamnii et al. (2013b) (see also Eq. (4.2) in Speleers, 2013a).  □

As in the Powell–Sabin-6 spline case (Lamnii et al., 2013a; Sbibih et al., 2009; Speleers, 2014), it is possible to express any 
                           s
                           ∈
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       ˜
                                    
                                 
                              
                              
                                 2
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                           )
                         as a combination of the normalized B-splines, where the coefficients in that combination are given in terms of the polar forms of s. Define
                           
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 =
                                 −
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 .
                              
                           
                         Then, the following result is an immediate consequence of Theorem 7 from Sbibih et al. (2009)
                        
                           
                              
                                 s
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          n
                                       
                                       
                                          v
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 B
                                 [
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 ]
                                 
                                    (
                                    
                                       
                                          V
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             
                                                Q
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 ,
                                 
                                 ∀
                                 
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 Ω
                                 ,
                              
                           
                         where 
                           
                              
                                 s
                              
                              
                                 i
                              
                           
                         is the restriction of s to one of the triangles of 
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                         having 
                           
                              
                                 V
                              
                              
                                 i
                              
                           
                         as vertex. We then establish the following corollary (Marsden's identity). 
                           Corollary 3
                           
                              For any polynomial 
                              
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                              , we have
                              
                                 
                                    
                                       p
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                n
                                             
                                             
                                                v
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          3
                                       
                                       B
                                       [
                                       p
                                       ]
                                       
                                          (
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          )
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       ,
                                       
                                       ∀
                                       
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       Ω
                                       .
                                    
                                 
                              
                           

We have implemented the above method in some simple cases.

We now consider an important special case where the constraints of Corollary 2 are met.

Triangular hexagonal lattices or equilateral triangle lattices have been used by Kovačević and Sweldens (2000) in geometric modeling and many other fields. An example of this triangulation can be found by drawing the three lines (shown in Fig. 5
                        )
                           
                              
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                 
                                 )
                                 :
                                 
                                 
                                 y
                                 =
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 
                                 k
                                 ,
                                 
                                 k
                                 ∈
                                 Z
                              
                           
                        
                        
                           
                              
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                       ,
                                       k
                                    
                                 
                                 )
                                 :
                                 
                                 
                                 y
                                 =
                                 
                                    3
                                 
                                 
                                 x
                                 −
                                 
                                    3
                                 
                                 
                                 k
                                 ,
                                 
                                 k
                                 ∈
                                 Z
                              
                           
                        
                        
                           
                              
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       3
                                       ,
                                       k
                                    
                                 
                                 )
                                 :
                                 
                                 
                                 y
                                 =
                                 −
                                 
                                    3
                                 
                                 
                                 x
                                 +
                                 
                                    3
                                 
                                 
                                 k
                                 ,
                                 
                                 k
                                 ∈
                                 Z
                                 .
                              
                           
                         Here
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 Γ
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   3
                                                
                                                2
                                             
                                             
                                             
                                                
                                                   i
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 Γ
                                 :
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             1
                                          
                                          
                                             
                                                1
                                                2
                                             
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   3
                                                
                                                2
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        . On a hexagonal lattice, box-splines (ch. Prautzsch and Boehm, 2001) can be constructed using the three vectors 
                           
                              
                                 (
                                 
                                    1
                                    2
                                 
                                 ,
                                 −
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 (
                                 
                                    1
                                    2
                                 
                                 ,
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        .

Inspired by the Powell–Sabin-6 B-spline construction (Dierckx, 1997), we propose an extension for the PS-12 splines on the hexagonal lattice triangulation. More precisely, we show that the B-spline basis functions for uniform PS-12 splines defined on the hexagonal lattice triangulation, are the translates of three B-splines 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                           (
                           x
                           ,
                           y
                           )
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                         whose support, centered at the point 
                           
                              
                                 V
                              
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                           =
                           
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        , is shown in Fig. 6
                        . We summarize the construction of the normalized B-spline basis and show how control triangles can be associated with the B-spline coefficients:
                           
                              1.
                              The basis function 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    x
                                    ,
                                    y
                                    )
                                  is the unique solution of the interpolation problem (2) with all 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          y
                                       
                                    
                                    )
                                    =
                                    (
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    )
                                  except for 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          j
                                          ,
                                          x
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          j
                                          ,
                                          y
                                       
                                    
                                    )
                                    =
                                    (
                                    
                                       
                                          α
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          β
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          γ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 .

For vertex 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                  we start by identifying its PS-12 points, see Corollary 2. Fig. 7
                                  shows the PS-12 points for the vertex 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 .

For the vertex 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 , find a PS-12 triangle 
                                    t
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          3
                                       
                                    
                                    )
                                  containing all the PS-12 points of 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 . Denote its vertices 
                                    
                                       
                                          Q
                                       
                                       
                                          j
                                       
                                    
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          Y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 . Fig. 7 shows a PS-12 triangle containing the PS-12 points at the vertex 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 .

Given the PS-12 triangle of the vertex 
                                    
                                       
                                          V
                                       
                                       
                                          (
                                          0
                                          ,
                                          0
                                          )
                                       
                                    
                                 , three linearly independent triplets of real numbers can be found as follows:
                                    
                                       •
                                       
                                          
                                             α
                                             =
                                             (
                                             
                                                
                                                   α
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   α
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                           are the barycentric coordinates of 
                                             
                                                
                                                   V
                                                
                                                
                                                   (
                                                   0
                                                   ,
                                                   0
                                                   )
                                                
                                             
                                           with respect to t,


                                          
                                             β
                                             =
                                             (
                                             
                                                
                                                   β
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   β
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   e
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   e
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   e
                                                
                                                )
                                             
                                          ,


                                          
                                             γ
                                             =
                                             (
                                             
                                                
                                                   γ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   γ
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   γ
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                             =
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                   e
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                   e
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   e
                                                
                                                )
                                             
                                          , where
                                             
                                                
                                                   e
                                                   =
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   .
                                                
                                             
                                           Here, we have 
                                             
                                                
                                                   Q
                                                
                                                
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   −
                                                   
                                                      1
                                                      2
                                                   
                                                   ,
                                                   0
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          , 
                                             
                                                
                                                   Q
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      4
                                                   
                                                   ,
                                                   −
                                                   
                                                      
                                                         3
                                                      
                                                      4
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                           and 
                                             
                                                
                                                   Q
                                                
                                                
                                                   3
                                                
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      1
                                                      4
                                                   
                                                   ,
                                                   
                                                      
                                                         3
                                                      
                                                      4
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          . Hence, we get
                                             
                                                
                                                   α
                                                   =
                                                   
                                                      (
                                                      
                                                         1
                                                         3
                                                      
                                                      ,
                                                      
                                                         1
                                                         3
                                                      
                                                      ,
                                                      
                                                         1
                                                         3
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                   β
                                                   =
                                                   
                                                      (
                                                      −
                                                      
                                                         4
                                                         3
                                                      
                                                      ,
                                                      
                                                         2
                                                         3
                                                      
                                                      ,
                                                      
                                                         2
                                                         3
                                                      
                                                      )
                                                   
                                                   ,
                                                   γ
                                                   =
                                                   
                                                      (
                                                      0
                                                      ,
                                                      
                                                         2
                                                         
                                                            3
                                                         
                                                      
                                                      ,
                                                      −
                                                      
                                                         2
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                           
                                          Figs. 8 and 9
                                          
                                           show an example of three linearly independent PS-12 B-splines corresponding to the same vertex.

In the following, for each 
                           i
                           =
                           
                              
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                           ∈
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        , we put 
                           
                              
                                 i
                              
                              
                                 ⋆
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          i
                                       
                                       
                                          2
                                       
                                    
                                    2
                                 
                                 ,
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        . We consider the spline space
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       M
                                    
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       3
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       x
                                       −
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         This is the linear space spanned by the shifts 
                           
                              
                                 B
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           (
                           x
                           )
                           :
                           =
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                           
                              (
                              x
                              −
                              
                                 
                                    i
                                 
                                 
                                    ⋆
                                 
                              
                              )
                           
                         of the B-splines 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        .

We now define two quadratic spline quasi-interpolants in the space 
                           
                              
                                 S
                              
                              
                                 M
                              
                           
                        .

We are interested in quasi-interpolants of the following form
                           
                              (38)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 f
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    x
                                    −
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                           (
                           f
                           )
                        , 
                           i
                           ∈
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , are suitable linear functionals.

First of all we note that, if
                           
                              (39)
                              
                                 f
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       ⋆
                                    
                                 
                                 )
                                 ,
                                 
                                 ∇
                                 f
                                 (
                                 
                                    
                                       i
                                    
                                    
                                       ⋆
                                    
                                 
                                 )
                                 ,
                                 i
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         are given, set
                           
                              (40)
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          1
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    −
                                    
                                       1
                                       2
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       −
                                       
                                          3
                                       
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       +
                                       
                                          3
                                       
                                       
                                          
                                             ∂
                                             f
                                          
                                          
                                             ∂
                                             y
                                          
                                       
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    .
                                 
                              
                           
                         Then, from Proposition 4, the quasi-interpolant obtained by (38) with (40) provides the unique element in 
                           
                              
                                 S
                              
                              
                                 M
                              
                           
                         that interpolates the Hermite data (39).

For the second quasi-interpolant, we consider
                           
                              (41)
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          1
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    −
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    +
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          ⋆
                                       
                                    
                                    )
                                    −
                                    
                                       1
                                       4
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             i
                                          
                                          
                                             ⋆
                                          
                                       
                                       )
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 (
                                 
                                    1
                                    2
                                 
                                 ,
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 (
                                 −
                                 
                                    1
                                    2
                                 
                                 ,
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 (
                                 −
                                 
                                    1
                                    2
                                 
                                 ,
                                 −
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 A
                              
                              
                                 4
                              
                           
                           =
                           
                              
                                 (
                                 
                                    1
                                    2
                                 
                                 ,
                                 −
                                 
                                    
                                       3
                                    
                                    2
                                 
                                 )
                              
                              
                                 T
                              
                           
                        . Then, from Corollary 3 (Marsden's identity) and by straightforward computation, the scheme (38) with coefficients given by (41) is a quasi-interpolant (using only function values) which reproduces 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

To test our condensed PS-12 quasi-interpolants, we use the well-known Franke function f (cf. Franke, 1982)
                           
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 
                                    3
                                    4
                                 
                                 exp
                                 ⁡
                                 
                                    (
                                    −
                                    
                                       
                                          
                                             
                                                (
                                                9
                                                x
                                                −
                                                2
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                9
                                                y
                                                −
                                                2
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       4
                                    
                                    )
                                 
                                 +
                                 
                                    3
                                    4
                                 
                                 exp
                                 ⁡
                                 
                                    (
                                    −
                                    
                                       
                                          
                                             (
                                             9
                                             x
                                             +
                                             1
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       49
                                    
                                    −
                                    
                                       
                                          (
                                          9
                                          y
                                          +
                                          1
                                          )
                                       
                                       10
                                    
                                    )
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 exp
                                 ⁡
                                 
                                    (
                                    −
                                    
                                       
                                          
                                             
                                                (
                                                9
                                                x
                                                −
                                                7
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                (
                                                9
                                                y
                                                −
                                                3
                                                )
                                             
                                             
                                                2
                                             
                                          
                                       
                                       4
                                    
                                    )
                                 
                                 −
                                 
                                    1
                                    5
                                 
                                 exp
                                 ⁡
                                 
                                    (
                                    −
                                    
                                       
                                          (
                                          9
                                          x
                                          −
                                          4
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          (
                                          9
                                          y
                                          −
                                          7
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         on the unit square 
                           Ω
                           =
                           [
                           0
                           ,
                           1
                           ]
                           ×
                           [
                           0
                           ,
                           1
                           ]
                        . We compute the Hermite interpolant and discrete quasi-interpolant (q.i.) PS-12 splines on a nested sequence of hexagonal lattice triangulation associated with the vertices 
                           h
                           
                              
                                 i
                              
                              
                                 ⋆
                              
                           
                        , 
                           i
                           ∈
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        . Maximum errors between the test function and its approximations are given in Table 1
                        .

Let Δ be the uniform triangulation 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         whose set of vertices is 
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        , and whose edges are parallel to the three directions 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 (
                                 0
                                 ,
                                 1
                                 )
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 (
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 T
                              
                           
                        , see Fig. 10
                        . Let 
                           
                              
                                 S
                              
                              
                                 H
                              
                           
                         be the condensed space of 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         quadratic splines on 
                           
                              
                                 Δ
                              
                              
                                 
                                    PS
                                 
                                 12
                              
                           
                        . According to the above section, it is shown that any element of this space can be expressed as linear combination of three B-splines. Their support is the unit hexagon with vertices 
                           {
                           ±
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                           ,
                           ±
                           
                              
                                 e
                              
                              
                                 2
                              
                           
                           ,
                           ±
                           
                              
                                 e
                              
                              
                                 3
                              
                           
                           }
                        , see Fig. 11
                        .

The three B-splines 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                         associated with 
                           
                              
                                 V
                              
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                         are defined by its control triangle 
                           t
                           (
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 3
                              
                           
                           )
                        . We can show that for any choice
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    −
                                    
                                       1
                                       9
                                    
                                    ,
                                    
                                       11
                                       18
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          5
                                          −
                                          ε
                                       
                                       
                                          6
                                          (
                                          ε
                                          +
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          2
                                          ε
                                          −
                                          1
                                       
                                       
                                          3
                                          (
                                          ε
                                          +
                                          1
                                          )
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          8
                                          −
                                          ε
                                       
                                       
                                          3
                                          (
                                          2
                                          ε
                                          −
                                          7
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          5
                                          ε
                                          +
                                          14
                                       
                                       
                                          6
                                          (
                                          2
                                          ε
                                          −
                                          7
                                          )
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              2
                              7
                           
                           ≤
                           ε
                           ≤
                           1
                        , the corresponding B-splines are nonnegative.

For 
                           ε
                           =
                           
                              2
                              7
                           
                        , we have
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    (
                                    −
                                    
                                       1
                                       9
                                    
                                    ,
                                    
                                       11
                                       18
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       11
                                       18
                                    
                                    ,
                                    −
                                    
                                       1
                                       9
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 
                                    (
                                    −
                                    
                                       2
                                       5
                                    
                                    ,
                                    −
                                    
                                       2
                                       5
                                    
                                    )
                                 
                                 .
                              
                           
                         Their PS-12 triangle is shown in Fig. 12
                        . Consider three linearly independent triplets 
                           (
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 j
                              
                           
                           )
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , for the vertex 
                           
                              
                                 V
                              
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                        . The basis function 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                         is the solution of the interpolation problem (2) with all 
                           (
                           
                              
                                 f
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 k
                                 ,
                                 x
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 k
                                 ,
                                 y
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           ,
                           0
                           )
                         except for 
                           (
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 j
                                 ,
                                 y
                              
                           
                           )
                           =
                           (
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 j
                              
                           
                           )
                        . The three linearly independent triplets of real numbers 
                           (
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 γ
                              
                              
                                 j
                              
                           
                           )
                        , 
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , are then related to the function and derivative values at the point 
                           
                              
                                 V
                              
                              
                                 (
                                 0
                                 ,
                                 0
                                 )
                              
                           
                         of one of the Bernstein polynomials of degree one with respect to triangle 
                           t
                           (
                           
                              
                                 Q
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 Q
                              
                              
                                 3
                              
                           
                           )
                        . They are defined as
                           
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    4
                                    13
                                 
                                 ,
                                 −
                                 
                                    4
                                    13
                                 
                                 ,
                                 
                                    14
                                    13
                                 
                                 )
                                 ,
                                 
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    4
                                    13
                                 
                                 ,
                                 
                                    14
                                    13
                                 
                                 ,
                                 −
                                 
                                    4
                                    13
                                 
                                 )
                                 ,
                              
                           
                         and
                           
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 =
                                 (
                                 
                                    5
                                    13
                                 
                                 ,
                                 −
                                 
                                    10
                                    13
                                 
                                 ,
                                 −
                                 
                                    10
                                    13
                                 
                                 )
                                 .
                              
                           
                        
                     

We now show how the basis 
                           
                              
                                 B
                              
                              
                                 j
                              
                           
                           (
                           x
                           −
                           i
                           )
                        , 
                           i
                           ∈
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                        , can be used to give a formal solution to the interpolation problem (2). Suppose f is sufficiently differentiable so that the values 
                           
                              
                                 λ
                              
                              
                                 i
                                 ,
                                 j
                              
                           
                         can be computed as
                           
                              (42)
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          1
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    −
                                    
                                       1
                                       9
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    (
                                    i
                                    )
                                    +
                                    
                                       11
                                       18
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                    (
                                    i
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    +
                                    
                                       11
                                       18
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    (
                                    i
                                    )
                                    −
                                    
                                       1
                                       9
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                    (
                                    i
                                    )
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    −
                                    
                                       2
                                       5
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          x
                                       
                                    
                                    (
                                    i
                                    )
                                    −
                                    
                                       2
                                       5
                                    
                                    
                                       
                                          ∂
                                          f
                                       
                                       
                                          ∂
                                          y
                                       
                                    
                                    (
                                    i
                                    )
                                    ,
                                 
                              
                           
                         and set
                           
                              (43)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 f
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       
                                          
                                             Z
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    3
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 f
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                                 
                                    (
                                    x
                                    −
                                    i
                                    )
                                 
                                 .
                              
                           
                         Then it follows immediately from Proposition 4 that the quasi-interpolant obtained by (43) with (42) provides an element in 
                           
                              
                                 S
                              
                              
                                 H
                              
                           
                         which interpolates the Hermite data
                           
                              (44)
                              
                                 f
                                 (
                                 i
                                 )
                                 ,
                                 
                                 ∇
                                 f
                                 (
                                 i
                                 )
                                 ,
                                 i
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         However, in many practical applications, such information is not available. Therefore, it is interesting to construct quasi-interpolants using only function evaluations. For example, let
                           
                              (45)
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          1
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    +
                                    
                                       13
                                       36
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       i
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       i
                                       )
                                       )
                                    
                                    −
                                    
                                       11
                                       36
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       i
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       i
                                       )
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          2
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    −
                                    
                                       13
                                       36
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       i
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       i
                                       )
                                       )
                                    
                                    +
                                    
                                       1
                                       18
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       i
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       i
                                       )
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                          ,
                                          3
                                       
                                    
                                    (
                                    f
                                    )
                                    =
                                    f
                                    (
                                    i
                                    )
                                    +
                                    
                                       1
                                       5
                                    
                                    
                                       (
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       i
                                       )
                                       −
                                       f
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       i
                                       )
                                       )
                                    
                                    ,
                                 
                              
                           
                         where 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 (
                                 1
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 (
                                 1
                                 ,
                                 1
                                 )
                              
                              
                                 T
                              
                           
                        , 
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 (
                                 −
                                 1
                                 ,
                                 0
                                 )
                              
                              
                                 T
                              
                           
                         and 
                           
                              
                                 A
                              
                              
                                 4
                              
                           
                           =
                           
                              
                                 (
                                 −
                                 1
                                 ,
                                 −
                                 1
                                 )
                              
                              
                                 T
                              
                           
                        . Then it follows from Corollary 3 (Marsden's identity), that the quasi-interpolant obtained by (43) with (45) reproduces 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .

We now present numerical results confirming good approximation properties of the proposed quasi-interpolants (43). We have used the well-known Franke test function. The test is done in a sequence of uniform 3-direction mesh 
                           
                              
                                 Δ
                              
                              
                                 n
                              
                           
                         associated with the vertices 
                           (
                           k
                           h
                           ,
                           l
                           h
                           )
                        , 
                           k
                           ,
                           l
                           =
                           0
                           ,
                           …
                           ,
                           n
                        , with 
                           h
                           :
                           =
                           1
                           /
                           n
                         where 
                           n
                           =
                           4
                           ,
                           8
                           ,
                           16
                           ,
                           32
                        . The errors are presented in Table 2
                        .

@&#CONCLUSION@&#

In this paper, a normalized B-spline representation is developed for bivariate condensed 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      splines defined on a triangulation with a PS-12 refinement. The basis functions have a local support, they are nonnegative, and they form a partition of unity. For some particular triangulations, we have given explicitly a PS-12 triangle that contains all the appropriate PS-12 points. For the construction of the basis we have followed exactly the same approach as in Speleers (2010a) considering a normalized basis for reduced Clough–Tocher splines. This means that the triangulation Δ or its refinement has to satisfy certain geometric constraints. In the PS-12 case, we assume that the maximal angle in the triangulation Δ is less than 
                        π
                        /
                        2
                     . This assumption, however, implies that the proposed basis cannot be defined on arbitrary triangulations, in contrast to the normalized B-spline bases for the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      Powell–Sabin-6 space (Dierckx, 1997) and the 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      reduced Clough–Tocher space (Speleers, 2010a). A major advantage of the PS-12 macro-elements is that certain geometric constraints required in the Powell–Sabin-6 case can be removed (see Remark 7.4. in Schumaker and Sorokina, 2006). Finally, in Section 4, we have elaborated some PS-12 examples on specific uniform triangulations, namely a Hexagonal lattice and a uniform 3-direction triangulation.

@&#ACKNOWLEDGEMENTS@&#

We are grateful to the anonymous referees for their helpful comments on an earlier version of this paper.

@&#REFERENCES@&#

