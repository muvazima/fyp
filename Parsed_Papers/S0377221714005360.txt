@&#MAIN-TITLE@&#Evaluating risk of water mains failure using a Bayesian belief network model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           BBN model to evaluate the risk of failure of metallic water mains.


                        
                        
                           
                           Consider structural integrity, hydraulic capacity, water quality, and consequence factors.


                        
                        
                           
                           Captures probabilistic relationships or dependencies and historical information of variables.


                        
                        
                           
                           Capable of ranking water mains within distribution network.


                        
                        
                           
                           Identify vulnerable and sensitive pipes for maintenance/rehabilitation/replacement (M/R/R).


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Risk analysis

Water distribution network

Bayesian Belief Network (BBN)

Deterioration

Consequence

@&#ABSTRACT@&#


               
               
                  It has been reported that since year 2000, there have been an average 700 water main breaks per day only in Canada and the USA costing more than CAD 10 billions/year. Moreover, water main leaks affect other neighboring infrastructure that may lead to catastrophic failures. For this, municipality authorities or stakeholders are more concerned about preventive actions rather reacting to failure events. This paper presents a Bayesian Belief Network (BBN) model to evaluate the risk of failure of metallic water mains using structural integrity, hydraulic capacity, water quality, and consequence factors. BBN is a probabilistic graphical model that represents a set of variables and their probabilistic relationships, which also captures historical information about these dependencies. The proposed model is capable of ranking water mains within distribution network that can identify vulnerable and sensitive pipes to justify proper decision action for maintenance/rehabilitation/replacement (M/R/R). To demonstrate the application of proposed model, water distribution network of City of Kelowna has been studied. Result indicates that almost 9% of the total 259 metallic pipes are at high risk in both summer and winter.
               
            

@&#INTRODUCTION@&#

Water distribution networks (WDNs) are among the most important and expensive municipal infrastructure assets (Berardi, Giustolisi, Kapelan, & Savic, 2008), and vital to public health. Potable water and wastewater conveyance system are spatially distributed assets and 1.6 million miles of pipelines lay beneath North America’s roads (Agarwal, 2010). American Society of Civil Engineers (ASCE) (2013) Report Card for America’s Infrastructure gave a grade of “D” to water/wastewater infrastructure. Canada’s first national infrastructure Report Card (2012) indicated that a significant amount of drinking-water, stormwater and wastewater infrastructure are in “fair” to “very poor” condition. The replacement costs of these assets are $25.9, $15.8 and $39 billions, respectively. According to the Infrastructure Report (2007), there have been more than 2 million breaks in Canada and the United States since January 2000, with an average of 700 water main breaks every day, costing more than CAD 10 billions/year. Moreover, water main leaks affect other existing nearby infrastructures such as sewer, storm water, pavement, and gas pipes that may lead to catastrophic failures (US EPA, 2011). The water main failure risk mitigation has transformed reactive to preventive actions of water main maintenance. Thus, risk-based decision making is taking prominence (e.g., Anwar, Koester, & Harlow, 2005; Bennett, Bohoris, Aspinwall, & Hall, 1996; He & Huang, 2008; Kleiner, Rajani, & Sadiq, 2005; Marlow, Beale, & Mashford, 2012; Matos, 2007; Sadiq & Rodriguez, 2004; Sorge, Christen, & Malzer, 2013; Tesfamariam, Sadiq, & Najjaran, 2010; US EPA, 1995).

Failure risk is combination of probability and impact severity of a particular situation that negatively affects the ability of infrastructures to obtain municipal objectives (InfraGuide, 2006), which is in congruence with Lawrence’s (1976) risk definition. A successful risk assessment program provides predictive tools to evaluate water mains failure, assess the consequences associated with such failures, and recommend prioritization strategies for capital and operating spending (Moustafa, 2010). As well, this tool enables municipalities and other authorities to build long- and short-term management plans. It is important to determine the cause and effect of probability of failure, where failure can manifests as structural integrity, hydraulic capacity and water quality (Al-Barqawi & Zayed, 2008; Christodoulou, Deligianni, Aslani, & Agathokleous, 2009; Fares & Zayed, 2010; Sadiq, Kleiner, & Rajani, 2010) and consequences (e.g. Fares & Zayed, 2010; Francisque, Rodriguez, Sadiq, Miranda, & Proulx, 2009). These strategies should be built on scientific approaches that combine human knowledge and experience as well as expert judgment to consider the risk of water main failure.

Despite some differences, the performance objectives for risk of failure of water mains can broadly be categorized as: water quality index (WQI), hydraulic capacity index (HCI), structural integrity index (SII) and consequences index (CI) (Al-Barqawi & Zayed, 2008; Infrastructure Report, 2007). Christodoulou et al. (2009) included eight significant factors like number of observed previous breaks, diameter, length, material, traffic load, proximity to highway, proximity to subway, and proximity to roadway/block intersection in the study. Al-Barqawi and Zayed (2008) classified factors contributing to water main deterioration into physical, environmental and operational factors. Fares and Zayed (2010) categorized the model structure into four main factors and sixteen factors which represents the deterioration and post-failure factors. A summary of contributing risk factors of water main failure reported in different studies is presented in Table 1
                     .

Different water main failure models have been reported to quantify risk factors of water main failure and infrastructure deterioration. When significant historical data exist, model-free methods, such as Artificial Neural Networks (ANN), can provide insights into cause-effect relationships and uncertainties through learning from data (e.g. Christodoulou, Aslani, & Vanrenterghem, 2003; Ismail, Sadiq, Soleymani, & Tesfamariam, 2011 and Najafi & Kulandaivel, 2005). But, if historical data are scarce and/or available information is ambiguous and imprecise, other soft computing techniques can provide appropriate framework to handle such relationships and uncertainties (e.g., Bolar, Sadiq, & Tesfamariam, 2013; Cockburn & Tesfamariam, 2012; Deng, Sadiq, Jiang, & Tesfamariam, 2011; Flintsch & Chen, 2004; Ismail et al., 2011; Janssens et al., 2006; Lauría & Duchessi, 2007; Najjaran, Sadiq, & Rajani, 2005; Poropudas & Virtanen, 2011; Sadiq & Rodriguez, 2004; Sun & Shenoy, 2007; Tesfamariam & Najjaran, 2007). Table 2
                      provides a qualitative comparison between six networks based computing techniques including ANN, Analytic Network Process (ANP), Bayesian Belief Network (BBN), Cognitive Maps/Fuzzy Cognitive Maps (CM/FCM), Credal Network (CN) and Fuzzy Rule-Based Models (FRBM). Central to this comparison is an assessment of how each technique treats inherent uncertainties and its ability to handle interacting factors that encompass issues specific to failure of water mains.

The ANN has been used by Christodoulou et al. (2003) and Najafi and Kulandaivel (2005) to analyze the failure risk of water main and sewer in an urban area with historical breakage data, respectively. Christodoulou et al. (2003) indicated that the number of previous breakage, diameter, material, and length of pipe segments were the most important factors for water main failure. Modeling of breaks in the water networks was carried out using multiple regression and ANN by Jafar et al. (2003). Al-Barqawi and Zayed (2006a, 2008)developed rehabilitation priority for water mains using ANN approach. Their results showed that the breakage rate has the highest relative contribution factor followed by age. Amaitik and Amaitik (2008) developed pre-stressed concrete cylinder pipe wire breaks prediction model using ANN. Failure rate and the optimal replacement time for the individual pipes of urban water distribution system were estimated using ANN by Jafar, Shahrour, and Juran (2010).


                     Kleiner, Sadiq, and Rajani (2004) used a fuzzy rule-based nonhomogeneous Markov process to model the deterioration procedure of buried pipelines. The deterioration rate at a specific time is estimated based on the asset’s age and condition state using a fuzzy rule-based algorithm. Fuzzy sets and fuzzy-based techniques were proposed to evaluate pipeline failure risk by Kleiner, Rajani, and Sadiq (2006). For prioritizing monitoring locations (zones) in a WDN, Francisque et al. (2009) coupled the concept of risk with fuzzy synthetic evaluation and fuzzy rule-base. To evaluate the risk of water main failure considering both consequence and deterioration factors and to develop a risk scale of failure, Fares and Zayed (2010) used hierarchical fuzzy expert system framework. Christodoulou et al. (2009) proposed neurofuzzy systems to assess the risk of failure in a network. Tesfamariam, Rajani, and Sadiq (2006) have proposed a possibilistic based pipe failure risk using Rajani and Tesfamariam (2004) mechanistic models. Rajani and Tesfamariam (2007) have extended these models with fuzzy deterioration model to estimate remaining service lives.


                     Joseph, Adams, and McCabe (2010) proposed BBN to support the water quality compliance of small or rural water distribution systems. Expert judgment was used to quantify the required probability relationships. However, it is usually difficult to establish mutual relationships among nodes in the network solely based on the knowledge of experts, particularly for complex problems (Nadkarni & Shenoy, 2001). If a node in a BBN has several parent nodes or each parent node and child node has several states, the number of conditional probabilities will be increases exponentially (Tang & McCabe, 2007). For example, if a child node has three parent nodes and the number of their states is five, the total number of conditional probability table (CPT) values can be a great as 54 (625) (Lauría & Duchessi, 2007). The elicited conditional probabilities defined by experts can be inconsistent, especially under the complex and large CPT condition. Joseph et al. (2010) limited the maximum number of parent nodes for any variable into three. However it is not possible to always represent the causal effect properly with only three variables. In that situation, it is more reliable and consistent to construct CPTs training from data (Cooper & Herskovits, 1992; Hager & Andersen, 2010; Tang & McCabe, 2007). To find out the posterior probabilities of water main failure starting from the prior probabilities of failure based on the age at failure, pipe diameter, cause of break and type of soil for specific type of pipe using Bayes’ theorem proposed by Singh (2011). But the author assumed these contributing risk factors independent and the causal dependencies among the variables have not been taken into consideration. Furthermore the author did not mention what will be the failure probabilities if all these risk factors affects simultaneously and how to update posterior probabilities when new failure information available.

Objective of this research is to develop a new and effective model to evaluate the risk of water main failure considering structural integrity, hydraulic capacity, water quality, and consequence factors. This paper explores both knowledge and data based BBN model to evaluate water main failure risk index that can be used to rank or prioritize the water main in a network system for M/R/R. In this research, deterioration factors that lead to the failure event and the consequence factors that result from the failure event (failure impact) are studied. Such decision support systems will aid the utility manager to better address the structural and hydraulic failure of water mains, proactively, while meeting financial constraints, level of service, and regulatory requirements.

@&#BACKGROUND@&#

Bayesian belief network is a graphical model that permits a probabilistic relationship among a set of variables (Pearl, 1988). A BBN is a Directed Acyclic Graph, where the nodes represent variables of interest and the links between them indicate informational or causal dependencies among the variables (Cockburn & Tesfamariam, 2012; Hager & Andersen, 2010; Laskey, 1995). As depicted in Fig. 1
                        , a BBN is composed of:
                           
                              (a)
                              a set of variables (e.g. A
                                 1, A
                                 2 and B) and a set of directed links between the variables;

a set of mutually exclusive and exhaustive states for each variable (e.g. for A
                                 1, A
                                 2 and B the states are {H, M, L}); and

an assigned conditional probability for each variable with ‘parents’, which will be defined shortly (e.g. for B).

The relations between the variables in a BBN are expressed in terms of family relationships, where a variable A
                        1 is said to be the parent of B (B the child of A
                        1) if the link goes from A
                        1 to B (Fig. 1). The dependencies are quantified by conditional probabilities for each node given its parents in the network. These dependencies are quantified through a set of CPTs; each variable is assigned a CPT of the variable given its parents. In the case of a variable with no parents, the conditional probability structure reduces to the unconditional probability (UP) of that variable (e.g., A
                        1 and A
                        2, Fig. 1).

The UPs of the basic input parameters, often, are not known a priori, consequently, equal weights (1/n, where n is number of category considered for each basic input) can be assigned using the principle of insufficient reasoning (e.g., Ismail et al., 2011; Tesfamariam & Liu, 2013). For example, if the states for A
                        1 are categorized as High (H), Medium (M) and Low (L), the UPs will be P (A
                        1
                        =H)=1/3, P (A
                        1
                        =M)=1/3 and P (A
                        1
                        =L)=1/3. However, from the evaluation, with certainty, if the state of A
                        1 is determined to be M, the UPs will be P (A
                        1
                        =H)=0, P (A
                        1
                        =M)=1 and P (A
                        1
                        =L)=0. Indeed, if there is still uncertainty with the state of A
                        1, the appropriate values should be used.

BBN is based on the Bayes’ theorem that has been proven to be a coherent method to manage uncertainty by explicitly representing the conditional probability dependencies between variables (Ismail et al., 2011; Sun & Shenoy, 2007; Tesfamariam and Liu 2013). In a BBN analysis, for n number of mutually exclusive parameters X
                           
                              i (i
                              =1, 2, …, n), and a given observed data Y, the updated probability is computed by:
                              
                                 (1)
                                 
                                    p
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             Y
                                          
                                       
                                    
                                    =
                                    
                                       
                                          p
                                          
                                             
                                                
                                                   Y
                                                   |
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          ×
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   Y
                                                   |
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where p(X∣Y) represents the posterior occurrence probability of X given the condition that Y occurs, p(X) denotes the prior occurrence probability of X, p(Y) denotes the marginal (total) occurrence probability of Y and is effectively constant since the obtained data is in hand, and p(Y∣X) refers to the conditional occurrence probability of Y given that X occurs too (it is often viewed in this sense as the likelihood distribution) (Pearl, 1988).

The conditional probabilities shown in Fig. 1 which will be used in Eq. (1), can be obtained through expert knowledge elicitation (Joseph et al., 2010; Nadkarni & Shenoy, 2001), or training from data (Cooper & Herskovits, 1992; Lauría & Duchessi, 2007; Tang & McCabe, 2007). Where multiple experts are considered, credibility of each decision maker on the decision can be elicited by considering experience and confidence on the assessment (Tesfamariam et al., 2010). The credibility factor can be used to reduce the overall decision (Cockburn & Tesfamariam, 2012).

The efficacy of a BBN is realized in its flexibility to capture bottom-up inference, observing the effect (child) and inferring the possible cause (parent) (diagnostic analysis) and top-down inference, observing the cause (or parent) and inferring the possible effect (or child) (predictive analysis) (Cockburn & Tesfamariam, 2012; Ismail et al., 2011). In predictive analysis, the probability distribution of a particular variable can be found by marginalizing the joint probability distribution with respect to the variable (Tesfamariam & Liu, 2013). This calculation is called marginalization, which can be used to compute the reliability of systems based on statistical data (Cai et al., 2013; Nadkarni & Shenoy, 2001; Poropudas & Virtanen, 2011). Fundamentally, a BBN is used to update probabilities when new information is available. The network supports the computation of the probabilities of any subset of variables given evidence about any other subset (Hager & Andersen, 2010; Janssens et al., 2006; Tesfamariam & Liu, 2013).

Water mains of different materials, such as metallic, cementitious and plastic, exhibit significantly different causes of deterioration and modes of failure. Therefore different considerations have to be made in determining the system failure index for different materials. Based upon comprehensive literature review (Table 1) and expert opinions, the risk factors of failure for a metallic pipe have been identified and the proposed BBN is illustrated in Fig. 2
                        . Twenty-one different factors are incorporated in this research, which represents the deterioration and post failure factors (Al-Barqawi & Zayed, 2008; Fares & Zayed, 2010; Francisque et al., 2009; Jafar et al., 2003). The factors selected to be incorporated in the pipeline failure risk model are clustered into four main categories: (i) Water Quality Index (WQI), (ii) Hydraulic Capacity Index (HCI), (iii) Structural Integrity Index (SII) and (iv) Consequence Index (CI). These attributes can be gathered from different types of documents such as design information, visual inspection and maintenance reports, etc. The factors of consequence are hard to quantify and thus a qualitative and quantitative approach is followed. Details of the model shown in Fig. 2 will be discussed in the subsequent subsections.

Water quality in a water supply network can be described by specific microbiological, physicochemical and aesthetic attributes of the water. Water quality can be further classified into turbidity, bio film growth and water color. Turbidity (NTU) is a measure of the cloudiness of water and used to assess microbial water quality and filtration effectiveness in a water supply network (Sadiq & Tesfamariam, 2007; Sadiq, Kleiner, & Rajani, 2009). Between 0 to 1 NTU turbidity indicates good and NTU turbidity greater than 1 indicates bad.

Bio-film growth includes the following sub-factors: water age, water velocity and free residual chlorine. Water age (WA) or water residence inside the water supply network is an important water quality parameter directly linked to the network hydraulic characteristic (Fares & Zayed, 2010; Francisque et al., 2009). WA is measured by hour. Free residual chlorine (RC) represents the suitability of the water in terms of human consumption as it ensures microbial inactivation (Francisque et al., 2009; Rodriguez, Milot, & Serodes, 2003; Sadiq & Rodriguez, 2004). RC is measured by mg/L.

Color in water is aesthetically undesirable and also an indicator to track contaminant inside water (Francisque et al., 2009; Sadiq et al., 2010). Color can be measured in apparent color unit (ACU) that informs about levels of dissolved, suspended materials, iron and manganese in a water sample. The granularity of WA, RC, and ACU are given in Table 3
                           .

Hydraulic capacity of a pipe ensures that there is sufficient pressure at the point of supply to provide an adequate flow to the consumers. Hydraulic capacity of the pipe or network depends on water pressure (WP) and water velocity (WV).

WP represent hydraulic capacity failure through inadequate water supply to the customers, inadequate pressure for firefighting, etc. and possible water quantity loss by leakage (Hu & Hubble, 2007; Pickard & Levine, 2006; Rogers, 2011). WV maintains the network hydraulic capacity as well as removes microbial, physicochemical and aesthetic deterioration of water quality (Fares & Zayed, 2010; Sadiq et al., 2009). The granularity of WP and WV is given in Table 4
                           .

Structural deterioration of water mains and their subsequent failure are affected by physical factors, external factors and internal factors (Rajani & Tesfamariam, 2004; Tesfamariam et al., 2006). Physical factors include the following sub-factors: pipe diameter (PD), pipe age (PA), pipe length (PL) and pipe thickness (PT).

PD is considered one of the vital parameter for water main failure (Kettler & Goulter, 1985; Tesfamariam et al., 2006). PD is reported in mm and can be grouped as very small, small, medium, large and very large, respectively, corresponding to [0–50], [50–200], [200–400], [400–600] and greater than 600. PA or installation date is reported as the most important parameter in most of the literature (Berardi et al., 2008; Hu & Hubble, 2007; Kim, Bae, & Kim, 2006; Kleiner et al., 2004; Rajani & Tesfamariam, 2007) causing pipe deterioration. PA is measured by years. PL has been considered as one of the basic static parameter for structural integrity and is measured by m (Christodoulou et al., 2009; Hu & Hubble, 2007; Jafar et al., 2003; Najafi & Kulandaivel, 2005). PT or wall thickness is another important factor for the metallic pipe (Tesfamariam et al., 2006) and measured by mm. The granularity of PA, PL and PT are given in Table 5(a)
                           .

External factors deteriorate the exterior portion of pipe through electrochemical corrosion with the damage occurring in the form of corrosion pits. External factors can further be classified into soil corrosivity, freezing index, type of traffic and type of road.

Soil Corrosivity (SC) plays a very significant role in the corrosion process of different types of pipe material (Al-Barqawi & Zayed, 2006b; Gorji-Bandpy & Shateri, 2008; Rogers & Grigg, 2006; Sadiq, Veitch, Husain, & Bose, 2005). Different soil properties like soil resistivity, soil pH, redox potential, soil sulphide content and moisture content are mainly responsible of the external corrosion of water mains (DIPRA, 2000; Jafar et al., 2010; Najjaran et al., 2005; Sadiq et al., 2005; Singh, 2011). Soil resistivity (SR) is a measure of how strongly a soil opposes to pass the flow of electric current (Najjaran et al., 2005; Rogers & Grigg, 2006; Sadiq et al., 2005). Soil pH (SpH) is a measure of the acidity or alkalinity in the soil. Redox potential (RP) is a measure of the degree of aeration in a soil. Low redox values may provide an indication that conditions are conducive to anaerobic microbial activity (Najjaran et al., 2005; Sadiq et al., 2005). RP are measured by mV. Sulfide content (SC) is responsible for microbiological corrosion which results metallic pipe deterioration (Hu & Hubble, 2007; Najjaran et al., 2005; Sadiq et al., 2005). Moisture content (MC) is a measure of drainage conditions for different type of soil (Najjaran et al., 2005; Sadiq et al., 2005). The granularity of SC, SpH, RP, SC and MC are shown in Table 5(b)
                           .

Freezing index (FI) is a surrogate measure for cold temperature effects on water main breaks. FI can be considered as a surrogate measure for live load induced by frost water and expressed in degree-days (Hu & Hubble, 2007; Kleiner & Rajani, 2002). Type of Traffic (TT) indicates the average daily traffic into the road (Al-Barqawi & Zayed, 2008; Christodoulou et al., 2003; Christodoulou et al., 2009). Type of Road (TR) indicates the condition of road under which the pipe passes (Al-Barqawi & Zayed, 2006b; Al-Barqawi & Zayed, 2008; Fares & Zayed, 2010). The granularity of FR, TT and TR are given in Table 5(b).

Internal factors deteriorate the interior of a pipe by tuberculation, erosion and crevice corrosion, which resulting in a reduced effective inside diameter, as well as a breeding ground for bacteria (Sadiq et al., 2009). Water pH (WpH) and free residual chlorine (RC) are two most important internal factors (Table 5(c)
                           ). WpH indicates aggressively of the internal water which may cause leaching and deterioration of the water main (Francisque et al., 2009; Sadiq & Tesfamariam, 2007). WpH between 0 and 5.5 indicates low, between 5.5 and 8.75 indicates medium and greater than 8.75 indicates high. Classification of RC has been defined in Table 3.

In case of failure of a water main, the consequences depend on various factors such the land use around the water main, the population that might be affected, the diameter and the length of the water main. Consequence index are further classified into pipe diameter (PD), population density (PP) and land use (LU) (Table 6
                           ).

The PD has an important impact on the consequence level in the event of a water main failure. Classification of PD has been defined in Table 6. PP is used as a surrogate measure to quantify the number of people that will be affected due to the water main failure (Fares & Zayed, 2010). The PP is measured by person/km2 and their extents are quantified very low, low, medium, high and very high, respectively, corresponding to [0–415], [415–595], [595–830], [830–1195] and greater than 1195. LU indicates the usage of the territory that will be affected due to the water main failure (Fares & Zayed, 2010). The impact on a land used for hospital or school or a day to day vital activity for the city will be more important than the impact of the same failure on an agricultural land (Francisque et al., 2009). LU or zoning system is classified into low, medium and high, respectively.

The propagation of the Bayesian belief network model for risk of metallic water main failure is performed using the commercially available software package Netica (Norsys Software Corp, Vancouver, Canada, 2006). Using this software, the overall graphical representation of proposed BBN model for the metallic water main failure is generated (Fig. 2).

The Aggregated Failure Risk Index is defined using three states, AggreFailureRiskIn
                        
                           L
                        
                        , AggreFailureRiskIn
                        
                           M
                         and AggreFailureRiskIn
                        
                           H
                        , which are related to low (L), medium (M), and high (H) risk. Similarly, Structural Integrity Risk Index, Hydraulic Capacity Risk Index, Water Quality Risk Index, Consequence Risk Index, Structural Integrity Index, Hydraulic Capacity Index, Water Quality Index, Physical Factors, Internal Factors, External Factors, Impact of Freezing Index, Impact of Corrosion, Impact of Traffic, Bio Film Growth and Soil Corrosivity are also defined as low (L), medium (M), and high (H) states. Based on an algorithm provided in Netica, 38 Nodes (16 parent or independent nodes and 22 child or dependent nodes), 47 links, and 4108 conditional probabilities are generated. It is possible to compile and update nets whose CPTs are absent or incomplete. Netica takes missing entries as uniform probabilities. A snapshot of these conditional probabilities is shown in Table 7
                        . It should be noted that these CPT values can also be obtained through expert knowledge elicitation. Interpretation of the CPT values summarized in Table 7 can be explained as follows.

Assume the values for input set (HydraulicCapRiskIn, WaterQuaRiskIn, StructuralInteRiskIn) are defined as (Medium, Low, High). Consequently, the corresponding CPT values generated for Aggregated Failure Risk Index are (Table 7): (AggreFailureRiskIn
                        
                           L
                        
                        , AggreFailureRiskIn
                        
                           M
                        
                        , AggreFailureRiskIn
                        
                           H
                        )=(30, 40, 30). Based on this information, the conditional probability for Aggregated Failure Risk Index being in the state of low, medium and high are 30%, 40% and 30% respectively.

Sensitivity analysis assumes that input parameters to the model are uncertain; it shows the designer the variation of the system reliability, given some variation of the input parameters values (Yang, Wang, Bonsall, & Fang, 2009). It refers to how sensitive the performance of a model is to minor changes in the input parameters (Nadkarni & Shenoy, 2001). Since the final output of BBN is dependent on a priori assigned probabilities, there is a need to carry out sensitivity analysis to identify critical input parameters that have a significant impact on the output results (Ismail et al., 2011). The sensitivity analysis based on Bayesian network also serves as an aid to identify uncertainties to prioritize data collection (Laskey, 1995).

Various methods have been proposed for carrying out sensitivity analysis in a Bayesian network (Castillo, Gutiérrez, & Hadi, 1997; Jensen, 1996; Laskey, 1995; Pearl, 1988; Spiegelhalter & Lauritzen, 1990). Since the input parameters required evaluating failure risk, which has discrete and continuous values, the variance reduction method (Cheng, 1986; Janssens et al., 2006; Norsys Software Corp, 2006; Pearl, 1988) is used here to determine the sensitivity of the BBN model’s output to variation in a particular input parameter. The variance reduction method works by computing the variance reduction of the expected real value of a query node Q (e.g., aggregated failure risk index) due to a finding at varying variable node F (e.g., water quality index, WQI). Thus, the variance of the real value of Q given evidence F, V(Q∣f) is computed using the following equation (Norsys Software Corp, 2006; Pearl, 1988):
                           
                              (2)
                              
                                 V
                                 
                                    
                                       
                                          Q
                                          |
                                          f
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                       
                                    
                                 
                                 p
                                 
                                    
                                       
                                          q
                                          |
                                          f
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   q
                                                
                                             
                                             -
                                             E
                                             
                                                
                                                   
                                                      Q
                                                      |
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        where q is the state of the query node Q, f is the state of the varying variable node F, p(q∣f) is the conditional probability of q given f, X
                        
                           q
                         is the numeric value corresponding to state q, and E(Q∣f) is the expected real value of Q after the new finding f for node F.

Result of the sensitivity analysis for the model illustrated in Fig. 2 is summarized in Table 8
                        . For theAggregated Failure Risk Index, Table 8 shows the variance reduction and percentage of variance reduction of the parent node or independent input factors. For theAggregated Failure Risk Index (AggreFailureRiskIn node), the Pipe Age shows the highest contribution 54.41% towards the variance reduction. To a lesser degree, Pipe Diameter and Population, and Turbidity show sensitivities of 15.39%, and 11.89% respectively. Finally, Water Pressure, Resistivity, Pipe Length and Water Velocity showed sensitivity in the range of 1.54% to 6.03%. Sensitivity of the other nodes is comparatively small. Total contribution of the parent node or independent node for the total percentage of variance reduction of Aggregated Failure Risk Index is only 12.10%. Results of this analysis indicate that the sensitivity of the parent node significantly depends on the variability of the dependent children.

Proposed BBN model presented in this paper has been checked with three hypothetical scenarios. The states of the criteria for the three scenarios are summarized in Table 9
                        . Scenario 1 depicts a water distribution situation when all the criteria in worst condition states, Scenario 2 represents all the criteria in medium or moderate condition states and Scenario 3 shows all the criteria in favorable condition states. The proposed BBN is applied to these different scenarios and the results are summarized in Table 9. For example, for scenarios 1 to 3, the three states for AggreFailureRiskIn are estimated as (AggreFailureRiskIn
                        
                           L
                        
                        , AggreFailureRiskIn
                        
                           M
                         and AggreFailureRiskIn
                        
                           H
                        )=(0.34, 10.6, 89.1), (48.7, 32.3, 19.0) and (89.9, 9.84, 0.24), respectively. Table 9 shows that scenario 1 has the highest probability mass of 59.0% was assigned to High condition state, where as for scenario 2 and 3, the highest probability mass of 72.2% and 52.3% were assigned to Low condition state. That indicates failure risk of a water main will be very high if it is having poor structural (due to very high age, and very large diameter and length) and hydraulic condition (due to low pressure and velocity), and lying in a highly soil corrosive (due to high pH, low resistivity and redox potential, and poor drainage condition) and populated area (due to high population and land use).

City of Kelowna (BC, Canada) water distribution network has been selected to demonstrate the application of BBN model. For prioritizing water mains for maintenance, repair or replacement (M/R/R), a BBN based water main prioritization tool has been developed combining the likelihood of failure of each water main and the associated consequences in case of failure. The risk index supports the water utility managers to take informed decision related to M/R/R about each water main, and, consequently, about all the metallic pipes in the network (graphics and maps for the whole network illustrate the situation for Summer 2012 but only the aggregated risk indices if the metallic pipes are shown here.

City of Kelowna’s pipe inventory includes numerous pipe materials and diameters of highly variable age and condition (Table 10
                     , Fig. 3
                     ). In this study, 259 metallic water mains (cast iron (CI), ductile iron (DI), Galvanized and steel) of City of Kelowna are considered for further analysis.

Pipe attributes (e.g., age, diameter, length, material, breakage history) and water quality parameter are collected from City of Kelowna’s pipe inventory and water quality department- sampling station data. Geographic Information System (GIS)-based data related to water main pipe characteristics have been collected from the database.

Monthly water quality data have been collected (for 2005 to 2012) from City of Kelowna water quality department. To consider seasonal variations, for simplicity the year is divided into two seasons: summer and winter. Summer goes from May to October whereas winter starts in November and ends in April. Free residual chlorine, water turbidity, and color have been collected from 14 water quality monitoring stations/sampling points (Table 11
                           ). The average parameter value has been calculated for summer and winter.

Hydraulic EPANET-based model is used to predict WDN nodal pressure and water velocity after defining the pipe elevation, flow demand pattern, and basic characteristics of the pipes. A particular pipe average pressure (P
                           
                              avg
                           ) can be calculated by taking the average of its two corresponding nodal pressures (P
                           
                              i
                            and P
                           
                              j
                           ) as shown by Eq. 3.
                              
                                 (3)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          avg
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        


                           Table 12
                            shows the available metallic pipes and their features like range of pipe diameter, pipe length, installation year, pipe thickness, water velocity, water pressure, water age, water pH, free residual Cl, turbidity and color.

Water distribution network has been divided into 15 zones based on the position of 15 bore holes used to conduct investigations about soil and groundwater. Soil property data, e.g., resistivity, pH, redox potential, sulphide and moisture content have been collected for each of the 15 zones. Soil properties are classified according to the 10- point scoring method introduced by DIPRA (2000) and American Water Work Association (AWWA, 1999). If the total point (Table 5(b)) is greater than 13, 13–4.5 and less than 4.5 indicate that there are high, medium and low soil corrosivity respectively (Najjaran et al., 2005; Sadiq et al., 2005). As a pipe may intersect many soil zones the higher soil corrosiveness value is assigned to this pipe for security purpose. After generating soil corrosiveness of each water main, parameter learning method used to determine the CPTs at each node, given the link structures and the data using Expectation–Maximization (EM) algorithm.

In case of water main failure the consequences will depend on land use above the water main, population that might be affected, and water main diameter are considered. The procedure to assign those factors, particularly land use and population, to each water main is described in the following sections.

The impacts of a water main failure will vary according to the usage of the territory that will be affected. Land use or zoning system for City of Kelowna has been collected from GIS coordination department. The GIS database named Zoning has 96 land use codes, which are described in “Bylaws” (2012) and regrouped under agricultural, rural residential, urban residential, commercial, industrial, public & institutional, health district, and comprehensive development. Each land use received a weight expressing its relative importance. Using the analytic hierarchy process (AHP) developed by Saaty (1988), this relative weight has been attributed to each land use based on different information on each of the 96 land uses gathered from the documents provided by the City of Kelowna and different other sources.

AHP uses pairwise comparisons to estimate the preference weights (w
                           
                              i
                           ) of each factor of a group (Saaty, 1988). These preference weights (w
                           
                              i
                           ) are normalized to 1, for n contributory factors:
                              
                                 (4)
                                 
                                    W
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    1
                                    ;
                                    
                                    0
                                    ⩽
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    ⩽
                                    1
                                 
                              
                           
                        

Using the geometric mean of each row and normalizing this value according to the sum of the geometric means of all the rows, a relative weight (w
                           
                              i
                           ) for each land use has been estimated. However, a water main can be buried under various land uses. To determine all the land uses that a pipe is related to and the consequence on these land uses in case of its failure following equation is used:
                              
                                 (5)
                                 
                                    FLUCW
                                    =
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                LUW
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          ×
                                          
                                             
                                                LUW
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                n
                                             
                                          
                                          ×
                                          
                                             
                                                LUW
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          ⋯
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           where, FLUCW is the final land use consequence weight; L
                           
                              i
                            is the length of the water main portion i that intersects the land use i; LUW
                           
                              i
                            is the relative weight of the land use i; and n is the number of land uses intersected by the water main. For example, the FLUCW for water main 125,566 (Fig. 4
                           ) can be calculated from Eq. 5 using LUW
                           1
                           =weight assigned to I4=0.006; LUW
                           2
                           =weight assigned to I2;=0.006; and LUW
                           3
                           =weight assigned to RU2
                           =0.025:
                              
                                 
                                    FLUCW
                                    =
                                    
                                       
                                          31.96
                                          ×
                                          0.006
                                          +
                                          60.66
                                          ×
                                          0.006
                                          +
                                          4.87
                                          ×
                                          0.025
                                       
                                       
                                          31.96
                                          +
                                          60.66
                                          +
                                          4.87
                                       
                                    
                                    =
                                    0.01
                                 
                              
                           For a qualitative approach, three classes or granularities such as Low (L), Medium (M), and High (H) have been defined by using lower and upper limits as shown in Table 6.

The impacts of a water main failure will also vary according to the population size of the given area that will be affected. Population density (Persons/km2) for each dissemination area (DA) within the territory served by the city water supply network has been calculated (Fig. 5
                           ). A DA is a small, relatively stable geographic unit composed of one or more adjacent dissemination blocks (Statistics Canada, 2001). It is the smallest standard geographic area for which all census data of Statistic Canada are disseminated. DAs are uniform in terms of population size, which is targeted from 400 to 700 persons to avoid data suppression. GIS file from Statistic Canada census 2006 containing each DA size and its population has been used.

However, a water main can be related to many DAs. To determine all the DAs that a pipe is related to, and, in case of its failure, the consequences on the DAs’ population, the following equation is used:
                              
                                 (6)
                                 
                                    FPCW
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          ×
                                          
                                             
                                                PD
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           where, FPCW is final population consequence weight; L
                           
                              i
                            is the length of the pipe ith portion that intersects the ith DA; PD
                           
                              i
                            is the population density of the ith intersected DA; and n the number of DAs intersected by the pipe.

After determining the data of different criteria of each water main, the proposed BBN is applied to determine the aggregated failure risk index of individual water mains of City of Kelowna. Aggregated failure risk index are converted into three states namely low (0⩽
                           AggreFailureRiskIn
                           <30), medium (30⩽
                           AggreFailureRiskIn
                           <60) and high (60⩽
                           AggreFailureRiskIn). The user can fine-tune these thresholds if needed.

@&#RESULTS AND DISCUSSIONS@&#

In the case of the BBN, the conditional dependencies are retained in the network structure and the interactive links quickly enable incorporation of “evidence” into the model. Simply by selecting a particular State (i.e. by specifying that the probability of high pipe diameter is 100%) for the “Pipe Diameter”, which is a root Node, provides an immediate estimate of the flow-on effects of that change to all Nodes in the network. For example, for a very small diameter pipe in water distribution systems, the BBN suggests (Fig. 2), that the structural integrity risk index will be 50.1 with maximum 43.1% high probability and aggregated pipe failure risk index will be 48.4 with maximum 36.2% high and 36.1% low probabilities. Whereas for very large diameter pipe, the structural integrity risk index and aggregated pipe failure risk index will be 56.9 with maximum 54.4% high probability and 54.7 with maximum 46.5% high probabilities respectively. The above cases would suggest that very large diameter pipes have a higher consequence or overall failure risk than small diameter pipes considering all other variable constant, as water main with larger diameter is expected to have higher thickness compared to smaller diameter water main.


                        Fig. 6
                         shows the aggregated risk index of City of Kelowna water mains for summer and winter 2012. Only 8% of the total 259 metallic pipes are in low risk. That means almost 8% of the water mains have a level of risk that can be qualified acceptable. Almost 84% of the water main incurs a medium risk. Nevertheless, around 8% of the water mains are at high risk in both summer and winter. The utility managers must give immediate and very special attention to those pipes and take appropriate preventive action (e.g., maintenance, or replacement after inspection), to avoid their failure. A risk index map is also created for summer 2012 above the city GIS WDN frame as shown by Fig. 7
                         for improving the spatial comprehension of the risk distribution and therefore facilitating the appropriate intervention of the utility managers.

@&#CONCLUSIONS@&#

A detailed literature review is performed to identify the major deterioration and consequence factors that represented as the nodes in the proposed model. As it is widely acknowledged that the relationship among these factors are not linear and requires a sophisticated process to represent the relationships and determine pipe failure risk index. In this paper, we proposed a proof-of-concept BBN model to prioritize metallic water mains for maintenance, repair, and replacement using structural integrity, hydraulic capacity, water quality, and consequence factors. The casual relationships among these factors were established based on expert knowledge, published literature and training from available data or information. The proposed method is flexible to include more contributing factors, new information (consequences) as well as incorporate priorities set by concerned agencies. Water distribution network of City of Kelowna is investigated to demonstrate the applicability of the proposed concept. The model is capable to provide qualitative and quantitative information of different factors on the pipe failure risk index.

The proposed model can provide information at pipe level and network level, able to visualize the most ‘vulnerable’, the most ‘sensitive’ and the ‘highest risk’ pipes within the distribution network and able to handle missing data. In the context of medium and small WDNs, it is likely that data or information scarcity and the number of experts for a given system would be small. The critical element in BBN model involves the use of experts in the generation of probabilities for various system conditions for which data are not available. Using BBN, it is possible to investigate changes to the distribution of States within Root Nodes by modifying the underlying probability distribution. By propagation of new observations through the network, BBN updates the prior probabilities, yielding posterior probabilities. These posteriors, unlike priors that are based mainly on generic data and expert knowledge, are more specific to the failure risk studied and better reflect its characteristics. This flexibility is particularly useful for modeling natural processes where the complexity of the interactions may preclude collection of large data sets upon which testing of a model can be based. BBN can be used for both forward (i.e., prognostic) and backwards (diagnostic) reasoning. For BBN, model validation is relatively simple, though not necessarily rigorous, especially in data poor environments.

The proposed BBN model can be a unique tool for small and medium utilities given the scarcity of data/information, lack of technical and financial resources, and limited experience. Furthermore, the proposed water main failure BBN model can be integrated with Markov deterioration process and life cycle costing analysis to arrive at some rational decision about when to replace, renew or re-inspect the pipe and to perform risk–benefit analysis. The proposed model will be extended into a multi-hazard framework, where external factors, such as earthquake (Jeon & O’Rourke, 2005; Pineda-Porras & Najafi, 2010; Tesfamariam & Liu, 2013), seismic ground movement (Liu & Tesfamariam, 2012; O’Callaghan, 2012; Pineda-Porras & Ordaz, 2010), ground rupture (Da, 2007), landslides (Kinash & Najafi, 2012), scouring (Rajani & Tesfamariam, 2004), and climate change (Wols & van Thienen, 2013) will be incorporated within structural integrity index to find out their effect on water main failure.

@&#ACKNOWLEDGEMENTS@&#

The financial support to the second and fourth authors from Natural Sciences and Engineering Research Council of Canada (NSERC) under Discovery and CRD grant programs is acknowledged.

@&#REFERENCES@&#

