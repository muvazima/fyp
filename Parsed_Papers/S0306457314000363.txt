@&#MAIN-TITLE@&#A new decision to take for cost-sensitive Naïve Bayes classifiers

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A study of a conditional risk based on both variable and constant losses.


                        
                        
                           
                           A geometrical interpretation of the decision function of a classifier.


                        
                        
                           
                           An analysis of performance of different Naïve Bayes classifiers compared to SVM.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cost sensitive learning

Bayesian decision theory

Binary classification

Classical probabilistic models

@&#ABSTRACT@&#


               
               
                  Practical classification problems often involve some kind of trade-off between the decisions a classifier may take. Indeed, it may be the case that decisions are not equally good or costly; therefore, it is important for the classifier to be able to predict the risk associated with each classification decision. Bayesian decision theory is a fundamental statistical approach to the problem of pattern classification. The objective is to quantify the trade-off between various classification decisions using probability and the costs that accompany such decisions. Within this framework, a loss function measures the rates of the costs and the risk in taking one decision over another.
                  In this paper, we give a formal justification for a decision function under the Bayesian decision framework that comprises (i) the minimisation of Bayesian risk and (ii) an empirical decision function found by Domingos and Pazzani (1997). This new decision function has a very intuitive geometrical interpretation that can be explored on a Cartesian plane. We use this graphical interpretation to analyse different approaches to find the best decision on four different Naïve Bayes (NB) classifiers: Gaussian, Bernoulli, Multinomial, and Poisson, on different standard collections. We show that the graphical interpretation significantly improves the understanding of the models and opens new perspectives for new research studies.
               
            

@&#INTRODUCTION@&#

The task of data classification is today commonly applied in many contexts, ranging from customer target marketing to medical diagnosis, from biological data analysis to document categorisation. Practical classification problems often involve some kinds of constraints with respect to the effectiveness of the classifier, which is usually measured in terms of false-positive and/or false-negative rates. In some domains, these two rates may not be equally important. For example, for a spam classification system, a mis-classified legitimate email is generally considered unacceptable, while a spam message classified as non-spam is less serious (Kolcz, 2005).

Bayesian decision theory is a fundamental statistical approach to the problem of pattern classification (Duda, Hart, & Stork, 2001). The objective is to quantify the trade-off between various classification decisions using probability and the costs that accompany such decisions. In this cost-sensitive framework, we can choose a learning algorithm and optimise its performance by tuning not only its parameters but also its misclassification costs. For example, in binary classification problems, i.e. when we have only two categories 
                        
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                        
                     , the Bayes decision rule can be interpreted as calling for deciding one category for an object o if the likelihood ratio (which is the ratio between the two probabilities 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           )
                        
                     ) exceeds a threshold value t. This threshold is independent of the observation o and can be tuned by means of the misclassification costs (the details of this formulation are presented in Section 3):
                        
                           (1)
                           
                              t
                              <
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where t is the threshold that depends on the misclassification costs and on the priors of the two categories, 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           )
                        
                      and 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 2
                              
                           
                           )
                        
                     . This way of optimising classifiers is very effective for unbalanced binary classification tasks (Almeida, Almeida, & Yamakami, 2011; Metsis, Androutsopoulos, & Paliouras, 2006).

In the literature of pattern classification (Duda et al., 2001), NB classifiers have been shown to be one of the most efficient and effective inductive learning algorithms for classification tasks, despite the strong unrealistic assumptions (see Appendix A). The work by Domingos and Pazzani (1997) and the further study by Zhang (2005) define the conditions under which the NB classifier is an optimal classifier. An important consideration to take into account when working with NB classifiers is that there are simple linearly separable cases where the Bayesian classifier fails to predict the correct class; however, quoting (Domingos & Pazzani, 1997) “a simple modification of the Bayesian classifier will allow it to perfectly discriminate all positive examples from negatives: adding a constant to the discriminant function for the concept, or subtracting the same constant from the discriminant function for its negation”. This decision can be written in the following way:
                        
                           (2)
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              )
                              <
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              )
                              +
                              l
                           
                        
                     This constant l, which has an empirical justification, hides a more complex interpretation of the costs in the context of cost-sensitive learning. In fact, it cannot be directly derived from the definition of costs in the cost-sensitive learning context. To the best of our knowledge, this simple step, which has been empirically shown to be very effective, has never been formally proven.

The main contributions of this paper are:
                        
                           •
                           A formal justification for a decision function under the Bayesian decision framework that comprises both (i) the minimisation of Bayesian risk and (ii) an empirical decision function found by Domingos and Pazzani (1997). The decision have the following linear form:
                                 
                                    
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       <
                                       mP
                                       (
                                       o
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       +
                                       q
                                    
                                 
                              where m and q depend on the mis-classification costs and can be seen as the angular coefficient and the intercept of a linear function. Note that for 
                                 
                                    q
                                    =
                                    0
                                 
                               we can derive Eq. (1) with 
                                 
                                    m
                                    =
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    t
                                 
                              , while for 
                                 
                                    m
                                    =
                                    1
                                 
                               we obtain Eq. (2) with 
                                 
                                    q
                                    =
                                    l
                                 
                              .

Since this new decision function has a very intuitive geometrical interpretation that can be explored on a Cartesian plane, we present an adaptation of the Angular Region algorithm (Di Nunzio & Micarelli, 2004) that can efficiently find a (sub)optimal decision on a two-dimensional space.

We use this graphical interpretation to analyse different approaches to find the best decision on four different Naïve Bayes (NB) classifiers: Gaussian, Bernoulli, Multinomial, and Poisson, on different standard collection. We show that the graphical interpretation significantly improves the understanding of the models and opens new perspectives for new research studies.

The paper is organised as follows: in Section 2, we define the task of binary classification for NB classifiers. In Section 3, we present the Bayesian decision theory framework that is at the base of our formulation of the problem. Section 4 defines the new conditions and costs under which an optimal decision function which merges both Eqs. (1) and (2) can be found. In Sections 5 and 6 we present the experimental analysis and the discussion of the results, respectively. In Section 7, we suggest some of the related works, while in Section 8, we give our final remarks.

Binary classification is the task of classifying objects into two classes on the basis of some properties of the objects. The usual notation to indicate these two classes is: c for the class of ‘positive’ examples, and 
                        
                           
                              
                                 c
                              
                              
                                 ¯
                              
                           
                        
                      for the class of ‘negative’ examples. Often, real world classification problems have more than two classes, for example a set of classes 
                        
                           C
                           =
                           {
                           
                              
                                 c
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 c
                              
                              
                                 n
                              
                           
                           }
                        
                     . In these cases, a common approach in machine learning is to define n binary classification problems, one for each class in the set C. Given an object o and a set of categories C, if we want to decide whether o should be assigned to category 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           ∈
                           C
                        
                     , we can build a simple probabilistic classifier that checks the following statement:
                        
                           (3)
                           
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              <
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                           
                        
                     where 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           =
                           C
                           ⧹
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                     . Therefore, if the probability of the class 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      is greater than the probability of its complement 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                        
                      we can assign the object to 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                     .
                        1
                        You may have noticed an inverted use of the inequality, which is usually written as 
                              
                                 P
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 o
                                 )
                                 >
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 o
                                 )
                              
                           . This will help us maintain the same order (less than) when presenting the Bayesian conditional risk in Section 3.
                     
                     
                        1
                      Since we do not know the value of 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                        
                      of unseen objects (unless an ‘oracle’ tells us what the value of 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                        
                     ), in order to predict the probability 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                        
                      we need to reverse it by using the Bayes rule:
                        
                           (4)
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              =
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    )
                                 
                              
                           
                        
                     where 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      is the probability of choosing the category 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      independently of the object, 
                        
                           P
                           (
                           o
                           )
                        
                      is the probability of drawing one object o randomly, and 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      is the likelihood function. 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      is the mathematical model of our problem that we need to estimate by means of some training examples. The hypothesis we make about how the mathematical model influences the type of function and parameters we need to estimate. For example, if the objects we want to classify have binary properties, we can model the object as a set of Bernoulli variables, or if the objects have real values we may decide to model the objects as a set of Normal distributions (see Appendix A for examples of different models and details about the use of the independence assumption). In any case, once we have the model we are able to compute the probability 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      and predict the probability of the category given the object.

The probability 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                        
                      is a combination of three variables: 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           ,
                           
                           P
                           (
                           o
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                     , and 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                     .
                        2
                        
                           
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            is not a parameter since it can be calculated from its complement 
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 1
                                 -
                                 P
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           .
                     
                     
                        2
                      When the marginal probabilities of the two categories are not balanced, i.e. 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           
                           ≄
                           
                           P
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                     , and/or the number of properties that describe the object is very large, the Bayes classifier tends to “squeeze” probabilities either to one or zero making the prediction of classification highly biased, usually towards the “stronger” category (Domingos & Pazzani, 1997). For example, suppose that 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                     
                     =0.8, 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                     
                     =0.2, 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                     
                     =0.7. In this situation, category 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      is more likely than the other (if we pick a random object, it belongs to 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      80% of the time), but the particular object o we are observing is much more likely to be generated by 
                        
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                        
                     . If we predict the category of this object, we obtain:
                        
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              =
                              
                                 
                                    0.2
                                    ·
                                    0.8
                                 
                                 
                                    0.2
                                    ·
                                    0.8
                                    +
                                    0.7
                                    ·
                                    0.2
                                 
                              
                              =
                              0.53
                           
                        
                     so we would classify it under 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      even though there is a high chance of it being a false positive. This example may seem trivial, but, as discussed in depth by Domingos and Pazzani (1997) and Zhang (2005), there are some important consequences for a Bayesian classifier. One consequence, in particular, is that there are simple linearly separable cases where the Bayesian classifier fails to predict the correct class; however, quoting (Domingos & Pazzani, 1997): “a simple modification of the Bayesian classifier will allow it to perfectly discriminate all positive examples from negatives: adding a constant to the discriminant function for the concept, or subtracting the same constant from the discriminant function for its negation”. Which means:
                        
                           (5)
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              <
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              l
                           
                        
                     where 
                        
                           P
                           (
                           o
                           )
                        
                      can be ignored “since it is the same for all classes and does not affect the relative values of their probabilities” and l is some real number that we can adjust to optimise the performance of the classifier. In Section 4, we provide a formal justification of this constant within a Bayesian decision theory framework.

Bayesian decision theory is a fundamental statistical approach to the problem of pattern classification (Duda et al., 2001). The objective is to quantify the trade-off between various classification decisions using probability and the costs that accompany such decisions. Whenever we have an object to classify, if we take the decision to classify it under 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                     , we are actually “taking a risk” because we may choose the wrong category. In a decision-theoretic framework, we define a loss function 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           )
                        
                      which tells us what is the loss in taking the decision 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      when the ‘true’ decision is 
                        
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                        
                     ; therefore, it represents the quantity of risk we are taking in choosing that decision. A conditional risk 
                        
                           R
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                        
                     , or expected loss, is defined as the average loss for choosing class 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      for the object o, and the definition is (we use the same notation as (Duda et al., 2001)):
                        
                           (6)
                           
                              R
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              λ
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              |
                              o
                              )
                           
                        
                     
                  

In this framework, the classification of an object becomes the problem of choosing the ‘less risky’ category given some loss function 
                        
                           λ
                           (
                           ·
                           |
                           ·
                           )
                        
                     . For a binary classification problem, the Bayes decision rule is selecting the action for which the risk is minimum:
                        
                           (7)
                           
                              R
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              <
                              R
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                           
                        
                     which, by using Eq. (6), is equal to
                        
                           (8)
                           
                              λ
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              +
                              λ
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              <
                              λ
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              +
                              λ
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                           
                        
                     We can group common terms and obtain:
                        
                           (9)
                           
                              [
                              λ
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              λ
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              ]
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              <
                              [
                              λ
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              λ
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              ]
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                           
                        
                     In binary classification problems, it is very common to use a zero–one loss function. This function has the terms 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           =
                           λ
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                           =
                           0
                        
                      which means that we have no loss when we give the correct answer, and 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                           =
                           λ
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           =
                           1
                        
                      which means that we have a cost equal to one every time we assign the object to the wrong category. A zero–one loss function leads to Eq. (3).

Different costs can be used to balance the marginal probabilities of the categories:
                        
                           (10)
                           
                              P
                              (
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              <
                              
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                              
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    )
                                 
                              
                              <
                              
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                              
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              <
                              
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                              
                              
                                 
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     For example, we can decide to set the costs of the loss function to completely cancel out the marginal probabilities, 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                           -
                           λ
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                           =
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      and 
                        
                           λ
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           -
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                           =
                           P
                           (
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 i
                              
                           
                           )
                        
                     . From a conditional risk point of view, the last solution means considering the class with the highest marginal probability as the one with the highest risk of error.

If 
                        
                           
                              
                                 [
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ]
                              
                              
                                 [
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ]
                              
                           
                           >
                           1
                        
                     , we can write the discriminant function in terms of the likelihood ratio (Duda et al., 2001):
                        
                           (13)
                           
                              
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                              
                              
                                 
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              <
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                              
                           
                        
                     Thus, we can decide to assign o to 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                      if the likelihood ratio exceeds a threshold that is independent of the observation o. We can further simplify the decision by assuming that we are interested only in the ratio of the differences of the costs, that is, we are not interested in knowing the exact cost of a mis-classification, but we do want to know the proportion between the two differences. Therefore, we have only one parameter, and this parameter can incorporate the ratio 
                        
                           
                              
                                 P
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     :
                        
                           (14)
                           
                              t
                              <
                              
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                           
                        
                     where 
                        
                           t
                           =
                           
                              
                                 [
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ]
                              
                              
                                 [
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 -
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ]
                              
                           
                           
                              
                                 P
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              
                                 P
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                      is any real number that can be used as a threshold to optimise the performance of the classifier.
                        3
                        It is very important to remember that the ratio 
                              
                                 
                                    
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                            does not represent the odds of 
                              
                                 o
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           .
                     
                     
                        3
                     
                  

By following the definition of conditional risk and manipulating the equation, we found a multiplication factor which can be interpreted either as a balancing factor for unbalanced categories or a threshold. In the following section, we use some algebra to generalise (12) by including the additive factor as suggested by Domingos and Pazzani (1997).

Domingos and Pazzani suggest using a constant to adjust the decision function of the Bayes classifier (Domingos & Pazzani, 1997). In this Section, we elaborate this idea by adding an additional cost to the definition of loss function, then we isolate this term from the definition of conditional risk by employing some algebra. First, we describe in words what this additional cost means in this framework. The conditional risk of one decision is the sum of all the probabilities of each possible decision weighted by the respective loss. In this context, a constant loss would mean that, given our decision, we always lose something no matter what the ‘true’ decision is. We can give an intuitive explanation of this hypothesis by associating a monetary cost to each decision (Elkan, 2001). For example, when we classify emails into spam and non-spam, we can assign the following costs to the decision ‘categorise as spam’ (numbers are purely indicative): if the message is truly spam, we estimate the cost of CPU power used to perform the classification equal to 0.01$ and the cost of storing the message equal to 0.50$; if the message was non-spam, we add to the cost of processing power 0.01$, a cost for storing the message equal to 0.05$ (this is less than the spam message because spam wastes useful disk space), and a cost for recovering the message equal to 10$. In this simple case, the constant cost that we have to pay regardless the true category of the message is 0.03$.

Moreover, in this new elaboration, we also want to weight this constant loss by the probability 
                        
                           P
                           (
                           o
                           )
                        
                     . In fact, 
                        
                           P
                           (
                           o
                           )
                        
                      is not equal for all the classes, and we can verify it by just computing it with the law of total probability. This decision is inline with standard approaches for developing cost-sensitive classifiers which weight the training examples according to the ‘costliness’ of misclassifying that example (Zadrozny, Langford, & Abe, 2003).

Therefore, we can rewrite the loss function as the sum of two terms: one term is the original loss function, and the other term is proportional to some constant value and inversely proportional to 
                        
                           P
                           (
                           o
                           )
                        
                     . The idea is that the lower the probability 
                        
                           P
                           (
                           o
                           )
                        
                     , the higher risk we take. The following formula adapts these two terms in the definition of conditional risk:
                        
                           (15)
                           
                              R
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              )
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              |
                              o
                              )
                           
                        
                     
                     
                        
                           (16)
                           
                              R
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       λ
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             P
                                             (
                                             o
                                             )
                                          
                                       
                                    
                                 
                              
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                              
                              |
                              o
                              )
                           
                        
                     where the new cost 
                        
                           
                              
                                 λ
                              
                              
                                 ′
                              
                           
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           )
                        
                      has been expanded in two addends 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           )
                           +
                           
                              
                                 
                                    
                                       l
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 P
                                 (
                                 o
                                 )
                              
                           
                        
                     : (i) the original loss 
                        
                           λ
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                           )
                        
                     , (ii) a constant 
                        
                           
                              
                                 l
                              
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                      which indicates that for the decision “categorise under 
                        
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                        
                     ” we have a constant loss, no matter what the true category 
                        
                           
                              
                                 c
                              
                              
                                 j
                              
                           
                        
                      is, divided by the probability 
                        
                           P
                           (
                           o
                           )
                        
                      which takes into account the fact that the risk in categorising unfrequent objects is higher.
                        Proposition 1
                        
                           Let us consider a set of categories 
                           
                              
                                 C
                                 =
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           
                           , a decision, for example categorise an object o under 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           
                           , and a loss function 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                           , if we can find for each category 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                              
                            
                           a decomposition of the loss function into two terms 
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       P
                                       (
                                       o
                                       )
                                    
                                 
                              
                            
                           such that one term is the original loss function 
                           
                              
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                            
                           and the other term is a constant equal for all 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                              
                            
                           divided by the probability 
                           
                              
                                 P
                                 (
                                 o
                                 )
                              
                           
                           , then the conditional risk is
                           
                              
                                 (17)
                                 
                                    R
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                 
                              
                           
                        

By expanding Eq. (16), we obtain:
                              
                                 (18)
                                 
                                    R
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                             +
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   P
                                                   (
                                                   o
                                                   )
                                                
                                             
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    o
                                    )
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   P
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   |
                                                   o
                                                   )
                                                
                                                
                                                   ︸
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             o
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    
                                    □
                                 
                              
                           
                        

At this point, we can show how our new definition of conditional risk in terms of this new loss function is the bridge between the empirical definition of the discriminant function of Domingos and Pazzani (1997) and the likelihood ratio (Duda et al., 2001).
                        Proposition 2
                        
                           Let us consider a set of categories 
                           
                              
                                 C
                                 =
                                 {
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           
                           , and a binary classification problem where 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 C
                              
                            
                           is the class of positive examples and 
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 C
                                 ⧹
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           is the class of negative examples. Provided that we can write the conditional risk for both 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                            
                           with Eq. 
                           
                              (17)
                           
                           , the optimal decision function which minimises the Bayesian risk is:
                           
                              
                                 (22)
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    <
                                    
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        

Let us assume that the original cost function meets the “reasonableness” conditions (Elkan, 2001) where 
                              
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 >
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and 
                              
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 >
                                 λ
                                 (
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           .
                              4
                              These are reasonable conditions in the sense that the loss of a misclassification is always greater than the loss of a correct classification.
                           
                           
                              4
                            If we want to minimise the risk, we assign a new object o to 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            if:
                              
                                 (23)
                                 
                                    R
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    <
                                    R
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    <
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             -
                                             λ
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    <
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (26)
                                 
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    <
                                    
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    P
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    o
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                       
                                          P
                                          (
                                          o
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    <
                                    
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          P
                                          (
                                          o
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          P
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          P
                                          (
                                          o
                                          )
                                       
                                    
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    <
                                    
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          [
                                          λ
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          -
                                          λ
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    P
                                    (
                                    o
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          P
                                          (
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                    □
                                 
                              
                           
                        

A ‘pseudo’ zero–one loss function is a loss function 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                            which can be rewritten as the sum of two addends 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       P
                                       (
                                       o
                                       )
                                    
                                 
                              
                           , with 
                              
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 0
                              
                            for 
                              
                                 i
                                 =
                                 j
                              
                            and 
                              
                                 λ
                                 (
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 1
                              
                            for 
                              
                                 i
                                 
                                 ≠
                                 
                                 j
                              
                           .

Eq. (22) contains two important results:
                        
                           •
                           First, it gives a mathematically sound justification for the constant found empirically by Domingos and Pazzani (1997). In particular, whenever we use a decision function like:
                                 
                                    (29)
                                    
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       P
                                       (
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       <
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       P
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       +
                                       l
                                    
                                 
                              it means that we are using a ‘pseudo’ zero–one loss function (Definition 1), and not a proper zero–one loss function. The parameter l incorporates the difference 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          l
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              , the difference 
                                 
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               and the probability 
                                 
                                    P
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              .

Second, it is a generalisation of Eq. (12). In fact, when 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    =
                                    0
                                 
                              , that is when we do not have any additional constant cost for a mis-classification, we obtain:
                                 
                                    (30)
                                    
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       <
                                       
                                          
                                             [
                                             λ
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             -
                                             λ
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             ]
                                          
                                          
                                             
                                                
                                                   
                                                      λ
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      -
                                                      λ
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             P
                                             (
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             P
                                             (
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       P
                                       (
                                       o
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           

In this section, we discuss how Eq. (22) can produce a significant difference in terms of classification performance for a binary classifier. To better appreciate this difference, we will interpret the decision function from a different perspective by following the approach named ‘likelihood projections’ (Singh & Raj, 2004). A ‘Likelihood projection’ uses the likelihood functions 
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         for nonlinear projections into a two-dimensional space (Duan, Jiang, & Man, 2006). The coordinates of an object in this two-dimensional ‘likelihood space’ are 
                           
                              x
                              =
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              y
                              =
                              P
                              (
                              o
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . In this new space, the Bayesian classifier can be viewed as a simple linear discriminant.
                           5
                           Non-linear discriminant functions are also possible but are not presented in this paper.
                        
                        
                           5
                         This linear discriminant function was already implicitly written in Eq. (12); here, we rewrite the equation and group some terms to highlight the terms of the linear function:
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             P
                                             (
                                             o
                                             |
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                                 <
                                 
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ]
                                                
                                                
                                                   [
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ]
                                                
                                             
                                             
                                                
                                                   P
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   P
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                             (
                                             o
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       x
                                    
                                 
                              
                           
                        where x and y are the coordinates of the likelihood space, and m is the angular coefficient of the function 
                           
                              y
                              =
                              mx
                           
                        . With a classical conditional risk approach, we can only adjust the slope m of the linear function.

On the other hand, if we group the terms of Eq. (22), we obtain:
                           
                              (32)
                              
                                 
                                    
                                       
                                          
                                             P
                                             (
                                             o
                                             |
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                                 <
                                 
                                    
                                       
                                          
                                             
                                                
                                                   [
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ]
                                                
                                                
                                                   [
                                                   λ
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   λ
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ]
                                                
                                             
                                             
                                                
                                                   P
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                
                                                   P
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       
                                          
                                             P
                                             (
                                             o
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       x
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            λ
                                                            (
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            -
                                                            λ
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   P
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       q
                                    
                                 
                              
                           
                        
                     

In order to show how the intercept q of the linear discriminant function can radically change the decision of a binary classifier, we present two very simple examples. In both cases, we have two classes: the class of triangles with two examples, and the class of circles with only two examples. The class of triangles is our ‘positive’ class 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                           . The class of circles is the ‘negative’ class 
                              
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                           . The points are shown in Fig. 1
                           a and b and the coordinates of the points are the values of the Likelihood functions. The solid line represent a possible solution which can be found by Eq. (31), the dashed line another possible solution found by Eq. (22).

In Fig. 1a, we can perfectly separate the two classes by adjusting the slope of the line. However, you may notice that a shift of the discriminant line can maximise the distance between the points and the separating plane (in this case the dashed line). In Fig. 1b, we have the same classes and objects, but one of the points of the negative class has just a slightly smaller likelihood 
                              
                                 P
                                 (
                                 o
                                 |
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           . This small change does not allow us to find a separation between the two classes by only adjusting the slope of the discriminant function. This simple example shows the big advantage of reformulating the conditional risk in terms of constant costs.

@&#EXPERIMENTS@&#

The experiments we present in this section are designed to tackle the following research questions:
                        
                           •
                           whether the new decision function outperforms both the zero–one loss function, Eq. (3) and the “classic” minimum risk decision, Eq. (10);

how to find the new decision function in the two-dimensional space;

compare the results of the new decision function with a state-of-the-art machine learning technique; in particular, the Support Vector Machines (SVM) trained on the full feature space and on the two-dimensional space.

Moreover, in the following section, we will analyse in detail the results and consider possible factors that influences the performance of the classifier, e.g. the sample size, the learning model, the algorithm to find the decision function.

For the experimental analysis of this new interpretation of conditional risk, we chose four widely dataset for the task of binary classification: the Iris dataset, the Reuters-21578 text collection, the 20 Newsgroup collection, the Reuters Collection Volume I (RCV1) dataset. The two Reuters datasets and the 20 Newsgroup dataset are so sparse that we could not work directly on the likelihood space. Instead, we had to use the log transformation to avoid arithmetical anomalies and transform the product of probabilities into sums of logarithms. This non-linear transformation into a log-likelihood space does not change anything in the formulation of the problem, but we need to be more careful when we interpret the decision line. See Section 6.6 for more thoughts on this issue.

We implemented the cost sensitive learning for NB binary classifier code in R, and we made available all the processed datasets for future analysis (details of the URL in the following sections).

In every experiment, in order to avoid zero-probabilities we used Laplacian smoothing. We compare the results of our approach with the R interface to libsvm,
                        6
                        
                           http://www.csie.ntu.edu.tw/cjlin/libsvm/.
                     
                     
                        6
                      an implementation of SVM in the R package e1071 (Meyer, Dimitriadou, Hornik, Weingessel, & Leisch, 2012). We used a linear kernel for most of the experiments; we also discussed the performance of non-linear kernel in some cases.

For each category and for each model, we found the best parameters by optimising the F1-measure on the training set. The F1-measure is defined as the harmonic mean between Recall (R) and Precision (P):
                        
                           (33)
                           
                              F
                              1
                              =
                              2
                              RP
                              /
                              (
                              R
                              +
                              P
                              )
                           
                        
                     where Recall is the fraction of true positive examples classified in a category over the total number of positive examples for that category, while Precision is the fraction of positive examples classified in a category over the total number of examples classified in that category (true positives and false positives). As an overall quality measure, we used the standard macro-averged F1 measure (Sebastiani, 2002) which is the average of the F1-measure across all the categories.

This is one the best known dataset in the pattern recognition literature for studying non-linearly separable data, and it contains real value data, which make this dataset a good benchmark for a Gaussian NB classifier. Introduced by Fisher (1936), the dataset contains the morphologic variation of three species of the Iris flower. There are 3 classes with 50 instances each, where each class refers to a type of Iris flower, see Table 1
                           . One class, ‘Iris setosa’, is linearly separable from the other two, ‘Iris virginica’ and ‘Iris versicolor’; the latter are not linearly separable from each other. We used the Iris dataset available with the standard R installation.
                              7
                              
                                 http://archive.ics.uci.edu/ml/datasets/Iris.
                           
                           
                              7
                           
                        

Reuters-21578 dataset is a standard benchmark for testing automated text classification techniques. For this dataset: (i) there are numerous experiments in the literature to compare the results with; (ii) we can use three different hypotheses to model the documents (Bernoulli, multinomial, Poisson) and compare the three probabilistic models.

The top 10 most frequent categories of the Reuters-21578
                              8
                              
                                 http://www.daviddlewis.com/resources/testcollections/reuters21578/.
                           
                           
                              8
                            corpus were chosen as a benchmark. The training set was composed of 6494 documents and the test set of 2548 documents. Table 2
                            shows the number of training and test documents for each category. Some text preprocessing was done: a first cleaning was done to remove all the punctuation marks and convert all the letters to lowercase. A stoplist of 571 words and contractions (that is, ’re, don’t, etc.) was used to remove the most frequent words of the English language.
                              9
                              
                                 http://jmlr.org/papers/volume5/lewis04a/a11-smart-stop-list/english.stop.
                           
                           
                              9
                            Finally, the English Porter stemmer
                              10
                              
                                 http://www.tartarus.org/martin/PorterStemmer/.
                           
                           
                              10
                            was used as the only method to reduce the space of terms. We used the sparse matrix representation in R to implement the document-term matrix, and the processed data are available online.
                              11
                              
                                 http://www.purl.org/reuters21578.
                           
                           
                              11
                           
                        

The 20 Newsgroup is another standard dataset for classification. It contains approximately 20,000 newsgroup documents, partitioned almose evenly across 20 different categories.
                              12
                              
                                 http://qwone.com/jason/20Newsgroups/.
                           
                           
                              12
                            In Table 3
                           , the name of the 20 categories and the number of training and test documents are shown. Some of the categories are closely related to each other (i.e. comp.sys.ibm.pc.hardware/comp.sys.mac.hardware), while others are highly unrelated (i.e. misc.forsale/soc.religion.christian). We downloaded the sparse matrix “bydate” version which is sorted by date into training (60%) and test (40%) sets, does not include cross-posts (duplicates) and does not include newsgroup-identifying headers.
                              13
                              
                                 http://qwone.com/jason/20Newsgroups/20news-bydate-matlab.tgz.
                           
                           
                              13
                           
                        

Reuters Corpus Volume I (RCV1) is an archive of over 800,000 manually categorised newswire stories made available by Reuters, Ltd. in 2004 for research purposes (Lewis, Yang, Rose, & Li, 2004). It consists of news stories produced by Reuters over a period of one year (from August 20, 1996 to August 19, 1997). A hierarchy of topics is defined, with 103 leaf nodes under four super categories (Corporate/Industrial, Economics, Government/Social, Markets). In Table 4
                           , the number of training and test documents of the four super categories used in these experiments are reported. The preprocessed files made available by the original authors of the collection were used to train the categorisation system.
                              14
                              
                                 http://www.ai.mit.edu/projects/jmlr/papers/volume5/lewis04a/lyrl2004_rcv1v2_README.htm.
                           
                           
                              14
                           
                        

In the experiments, we used the following three approaches: a zero–one (0–1) loss function, a simple learning (sim) approach to find the best parameters of the classifier using Eq. (31), and an advanced learning (adv) approach to find the best parameters of the classifier using Eq. (22). In the last two cases, we used the training data to find the best angular coefficient m for the simple learning, and the best intercept q together with m for the advanced learning, to separate the objects and compute the performances on the test set.

In order to find the best parameters m and q, we adapted the ‘Angular Region’ algorithm presented in (Di Nunzio & Micarelli, 2004) in the following way:
                           
                              •
                              fit a linear model for the positive training examples 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 ,

and another linear model for the negative training examples 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       ·
                                       
                                          
                                             X
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 ,

find the bisecting line 
                                    
                                       y
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             ∗
                                          
                                       
                                       x
                                       +
                                       
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                  of the angular region created by 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Y
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 , see Fig. 2
                                 a.

The pseudo-code of the algorithm is shown in Algorithm 1. Sometimes, the bisecting line is already very close to the optimal solution (especially with balanced datasets) so we just need to adjust it by varying the coefficient 
                           
                              
                                 
                                    m
                                 
                                 
                                    ∗
                                 
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    ∗
                                 
                              
                           
                         in a small range until we find the best 
                           
                              F
                              1
                           
                         score on the training set. The range of variation of these parameters changes from dataset to dataset and it can be set empirically. In our experiments, we searched for the best m in the range between, at most, 15 degrees and 75 degrees, and the best q in the range 
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       0.5
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       0.5
                                    
                                 
                              
                           
                         for the likelihood space, while 
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                       -
                                       100
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       100
                                    
                                 
                              
                           
                         for the log-likelihood space. The parameter q is fixed and equal to zero for the simple learning algorithm. In Fig. 2b, we show an example of angular region and the solutions found by the simple and the advanced learning approach on the same random generated dataset.

It is important to note that the training time is proportional to both the range and the density of points in the range of the parameters m and q. For example, in our experiments we divided the range of m in steps of 
                           
                              0.01
                           
                         radiants, and the range of q in steps of 10. This choice leads to a training time which is almost equal to the training time of a linear SVM with default values. By adjusting these values, we can obtain faster training times (even one order of magnitude faster than a linear SVM) with performances that are very close to the optimal ones.
                           Algorithm 1
                           Angular Region algorithm (Di Nunzio & Micarelli, 2004) adapted to the case of Likelihood Spaces 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Require: 
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                      
                                                      ∊
                                                      ,
                                                      
                                                      δ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Ensure: 
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 find linear interpolation 
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 find linear interpolation 
                                                   
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      ·
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 find bisecting line 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  m
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              ¯
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  
                                                                     
                                                                        c
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  q
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              c
                                                                           
                                                                           
                                                                              ¯
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 store initial optimal values 
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ,
                                                      
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 compute initial F1 score for decision line 
                                                   
                                                      Y
                                                      <
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      X
                                                      +
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                 store initial 
                                                   
                                                      maxF
                                                      1
                                                   
                                                 score
                                          
                                          
                                             
                                                 
                                                for 
                                                
                                                   
                                                      m
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      ∊
                                                   
                                                 to 
                                                   
                                                      m
                                                      =
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      +
                                                      ∊
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                 
                                                for 
                                                
                                                   
                                                      q
                                                      =
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      -
                                                      δ
                                                   
                                                 to 
                                                   
                                                      q
                                                      =
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      +
                                                      δ
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             
                                                
                                                 compute F1 score for decision line 
                                                   
                                                      Y
                                                      <
                                                      mX
                                                      +
                                                      q
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                 
                                                if 
                                                
                                                   
                                                      F
                                                      1
                                                      >
                                                      maxF
                                                      1
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                
                                                 
                                                
                                                   
                                                      maxF
                                                      1
                                                      =
                                                      F
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                 
                                                
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      =
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                 
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            opt
                                                         
                                                      
                                                      =
                                                      q
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                 
                                                end if
                                             
                                          
                                          
                                             
                                                 
                                                end for
                                             
                                          
                                          
                                             
                                                 
                                                end for
                                             
                                          
                                       
                                    
                                 
                              
                           

@&#RESULTS AND DISCUSSION@&#

In this Section, we present the results on the three chosen datasets. We first give a detailed description of the Iris dataset experimental results (Section 6.1) focusing on the interpretation of the two dimensional decision line. Then, we present an overview of the performances of the classifiers on the Reuters and the 20 Newsgroups datasets (Sections 6.2 and 6.3). Finally, a more specific analysis of the factors that can affect the performances (Section 6.5).

The overall results of the experiments on the Iris dataset are shown in Table 5
                        . For each class, a type of Iris flower, we show the F1 values of:
                           
                              •
                              the NB Gaussian model for (i) the approach with a zero–one (0–1) loss function, (ii) the simple (sim) learning approach, (ii) the advanced (adv) learning approach;

the linear SVM with (i) default values (def), (ii) weighted classes (wei);

the non-linear SVM using a polynomial kernel (cubic polynomial with optimised class costs) and a radial kernel (with default values).

The Iris setosa is the class which can be linearly separated from the other two classes. This is why we obtained a perfect score for all the approaches.
                           15
                           Remember, however, that the NB model performs very well in this case because classes are balanced and there are only four features.
                        
                        
                           15
                         For the Iris virginica and Iris versicolor, there is a clear improvement for the NB model when we use the angular coefficient m over the simple zero–one loss function, and there is still some margin of improvement when we adjust both m and the intercept q. We also doubled checked our results of the classic NB model with the implementation of the NB in R (function naiveBayes() of the same R package e1071) which uses a zero–one loss function and the results are exactly the same. On the other hand, it was surprising to see the default linear SVM with such a bad performance on the third category. For this reason, we performed another set of experiments with a weighted linear SVM, in which we can control the cost of misclassifications of the positive and negative class. Since the aim of the experiment was not to find an optimised approach, we tried a brute force algorithm and we varied the costs of the two classes from 1 to 10, with steps of 0.1 until the best F1 score was found. For the Iris virginica we were able to find a weighted SVM which reaches the best possible performance (compared to the polynomial and radial SVM), while for the Iris versicolor we were unable to find a F1 score greater than.72. Therefore, even though this dataset is non-linearly separable, we found the linear kernel to be the best trade-off between performance and training time. We could not find a better solution for the polynomial kernel only because we optimised only the weights of the classes. A more detailed optimisation, for example by taking into account the cost of constraints violation of the SVM, would produce better results, but with a very slow training time.

To appreciate the differences between the solutions found with the three decision function of the NB model, we plotted in Fig. 3
                         the likelihood space of the NB classifier for the Iris virginica class. The coordinates of each point are the likelihood values of one example of a flower, 
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        . Triangles are the positive class (the examples of the Iris virginica) while circles are the negative class (the examples of the Iris setosa and Iris virginica). The three lines represent the three solutions. The solid line is the solution with a zero–one loss function; in this case, we are constrained to the parameters 
                           
                              m
                              =
                              1
                           
                         and 
                           
                              q
                              =
                              0
                           
                        . It is immediately evident from this plot that a best decision line is reachable by changing these two parameters. The dashed line represents the solution found by Eq. (31) where we can adjust the angular coefficient but we are still anchored to the origin of the axis. The dash-dotted line represents the solution found by Eq. (22) where we are free to adjust both m and q. Note that since we are optimising the performance of the F1 measure, this solution prefers to increase recall (one more triangle below the line) and decrease precision (one more circle below the line).

There is one last thing we need to remark regarding the comparison between NB and SVM. In this experiment, we transform the multi class classification problem of n classes into n binary classification problems. However, The SVM implementation of the e1071 R package can solve a multi class classification problem with a one-against-one-approach, in which 
                           
                              n
                              (
                              n
                              -
                              1
                              )
                              /
                              2
                           
                         binary classifiers are trained, and the appropriate class is found by a voting scheme. It seems reasonable in this case with only three classes to use this approach too. The results are shown in Table 6
                        . A tuned linear SVM can reach the best performance, and the difference between SVM and NB is just three objects that are misclassified by NB. Nevertheless, the one-against-one approach is not so frequent in literature because for very large dataset with many categories does not perform as well as the binary classification; moreover, it requires a careful analysis on the procedure to follow in those cases where an object belongs to more than one class (like the Reuters-21578 dataset).

In this first experiment, we were able to show the impact of the reformulation of the conditional risk in terms of constant costs on a very well known dataset. The aim of this first part was to show that even for a very simple and very well known problem, the reformulation of conditional risk is a very promising approach which can make a big difference on the performance of a NB classifier. In the following sections, we analyse the performances of three variants of the NB classifier on bigger and more sparse datasets.

The overall results of the experiments on the Reuters-21578 dataset are summarised in Table 7
                        . For each category, we reported the F1 measures of the following models (both trained with the simple and the advanced approaches): a Bernoulli NB model, a multinomial NB model, and a Poisson NB model. The last column reports the results for the default linear SVM. We did not optimise any costs for SVM because the performance with the default training were in most cases already perfect (half of the classes have 100% accuracy on the training examples, the other half an accuracy greater than 90%). We did not report the results of the non-linear SVM, polynomial and radial, for two reasons: (i) the performance of these kernels with default values are very poor; with default values SVM act like perfect rejectors, that is almost all the documents are classified as negative examples; (ii) the training time of a non-linear SVM is four times the linear SVM both with default values; if we had to optimise the parameters to reach a comparable performance we would have a training time of at least one order of magnitude greater than the linear SVM.

The overall picture of the results tells us one thing: when the NB models are trained with a zero–one loss function, there is a clear advantage in using the multinomial approach. This result has been confirmed by many experiments in the past (Eyheramendy, Lewis, & Madigan, 2003; Sebastiani, 2002; McCallum & Nigam, 1998). But when we use the reformulation of the conditional risk, the difference among the three NB models almost disappears, and it turns out that the Poisson model has a slight advantage over the others. Results with SVM are comparable and the magnitude of the difference between NB and SVM it is very similar to the one found for the Iris dataset.

The overall results of the experiments on the 20 Newsgroups dataset are shown in Table 7. For each category, we reported the F1 measures of the following models (both trained with the simple and the advanced approaches are summarized in Table 8
                        ): a Bernoulli NB model, a multinomial NB model, and a Poisson NB model. The last column reports the results for the default linear SVM. We did not optimise any costs for SVM because the performance with the default training were in most cases already perfect (most of the classes have 100% accuracy, while very few classes have an accuracy lower than 95%). We do not show the performances of the non-linear SVM for the same reasons discussed earlier for the Reuters dataset.

The overall results are very similar to the Reuters dataset. With a zero–one loss function, the best NB model is still the multinomial model. Note that the other two models, Bernoulli and Poisson, have a macro-averaged F1 which is even lower compared to the Reuters collection since the 20 Newsgroups categories are all equally unbalanced (that is, there are no “big” categories that help to increase the average performance). When we use the reformulation of the conditional risk, the difference among the three NB models disappears. It is very hard to tell what is the best among these models since there is almost a perfectly even distribution of best performances: Bernoulli is the best classifier on 6 categories, Multinomial on 6 categories, Poisson on 8 categories. For the multinomial NB, the advanced learning algorithm is as good as the zero–one loss function. Results with SVM are comparable and the magnitude of the difference between NB and SVM it is very similar to the one found or the previous datasets. One thing changed significantly: the difference between the training time of the SVM and the NB. The space of feature of the 20 Newsgroups dataset is twice the Reuters one: around 60,000 features for the former, and around 30,000 features for the latter. The number of documents is also twice the number of documents of the Reuters. The result is that, while for the Reuters dataset the training time is the same between NB and SVM, for the 20 Newsgroups there is one order of magnitude of difference: around 10s to train one category for NB with the advanced learning algorithm, around 90s to train one category for SVM with default values.

The overall results of the experiments on the RCV1 dataset are shown in Table 9
                        . For each category, we reported the F1 measures of the three NB models. The last column reports the results for the default linear SVM. We did not optimise any costs for SVM because the performance with the default training were in most cases already perfect (all the classes have an accuracy close to 97%). We do not show the performances of the non-linear SVM. The overall results are inline with the results on previous dataset as far as the NB models are concerned. With a zero–one loss function, the best NB model is the multinomial model. The hardest category to learn is the one with the least number of training documents, category ecat. When we use the reformulation of the conditional risk, the difference among the three NB models almost disappears. For this dataset, the multinomial model still has a slight advantage over the other two NB models. The results with the SVM are less accurate when compared to the previous datasets. Moreover, the difference between the training time of the SVM and the NB becomes very significant for this dataset. Training an SVM with default values for one category takes around 120min, compared to the 10s of the NB models with the advanced learning algorithm. At this point, we suspect that the implementation of the SVM in the e1071 R package is not well optimised. We will further investigate these issues in future experiments.

In order to analyse these results carefully, we discuss four important issues separately and in the following order: influence of the sample size, influence of the model, influence of the conditional risk, influence of the learning algorithm. We will use Figs. 4–6
                        
                        
                         to illustrate some of the points about these three issues.

There are several reasons which explain why the number of training examples of a class influences the classification performance. The first reason, and probably the most important one in a probabilistic setting, is that the number of examples corresponds to the sample size. Therefore, when we estimate the parameters of our NB model, we have some uncertainty which is related to the sample size: the smaller it is, the more uncertain the estimate of the parameters (see Smith, 1993 for a discussion on populations and selections). Secondly, the quality of the sample is another important factor. By quality we mean to what extent the sample is generalizable and representative of the entire population. The Reuters-21578 is a collection of newswires that were manually classified by a few experts (Hayes, Knecht, & Cellio, 1988). In this dataset, the training and test sets belong to two different time periods and, for some categories, this difference may affect the performance of the classifier, especially on smaller categories. For example, the distribution of unique words in the documents changes dramatically: in the training set, there are almost 28,000 unique features in about 6500 documents, while in the test set we have 7000 new unique words, which is almost 25% more, in only 2500 documents. This problem is also present in the 20 Newsgroups dataset but it is less noticeable. For the 12,000 training documents we have about 54,000 thousands features, for the 8000 test documents we have about 7000 additional unique words, which is almost 12% more. For the RCV1 dataset the percentage of unique words in the test set that are not in the training set increases drastically. In the training set, about 23,000 documents, there are 46,659 unique words; in the test set, about 780,000 documents, there are about 240,000 unique words that are not present in the training set. This problem may be less perceivable for complex machine learning approaches like SVM which work on a higher dimensional space, but for a NB classifier this issue causes some problems since the estimates on smaller categories are much more sensitive to changes (see next section): the smaller the category, the lower the performance.

The two biggest categories of the Reuters collection, in terms of the number of training documents, are acq and earn. For these categories, there is not a big difference between the performances of the three different NB models. The advanced learning approach just slightly improves the already good initial performances of the Bernoulli and Poisson models while it decreases the performance of the multinomial model. In the latter, the problem is that we are overfitting the training data. By performing some double-check on the quality of the coefficients we found (intercept q and angular coefficient m), we could confirm that there are indeed some combinations that would produce a better performance on the test set; however, these combinations are not optimal on the training set. Hence we claim this behaviour to be due to parameters overfitting. In fact, A more careful training would require a training and a validation set to avoid, at least partially, this problem and find a solution which generalises better on the test set. In Figs. 4a, 5a, and 6a, we show the likelihood space of the category acq and the decision functions of the three models. The difference between the decision lines is minimal since the distribution of the documents is ‘aligned’ with the bisecting line of the first and third quadrant, which corresponds to the zero–one loss function. This is the effect of: (i) balanced categories, (ii) a well represented category with a numerous sample size. For all the other categories, and in general for the 20 Newsgroup dataset, the unbalance between the positive and the negative class becomes an issue for two of the models: the Bernoulli NB model and the Posson NB model.

In Figs. 4b, 5b, and 6b, we show the log-likelihood space of the category corn, the smallest category among the top ten Reuters categories. This is the first time that we can actually ‘see’ the difference between the three models instead of just presenting the numbers of the performances. We can clearly see that in two cases, Bernoulli and Poisson, documents are shifted along the X axis, while in the multinomial model documents are aligned with the zero–one loss function decision line. The reason for this shift can be found in the definition of the likelihood for each model (see Appendix A): in the Bernoulli model we have the term 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 log
                                 (
                                 1
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                            (Eq. (A.4)), and in the Poisson model we have the term 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                            (Eq. (A.10)), while in the multinomial model a summation over the whole terms is absent.

The following question is: why are these addends only affecting the X axis? Usually, Y remains quite stable since it approximates the estimate of the entire collection. The X axis represents the likelihood of the object of the positive class which is the smallest class between the two. Since we have a smaller sample size, the uncertainty of the estimate of the parameters of the model increases, and sometimes these estimates can be wrong. The shift on the X axis is the consequence of an over-estimate of the parameters of the model for smaller categories. Let us present an example of what happens with the Reuters dataset.
                              16
                              The numbers we use are simplified for the sake of the argument, but they are very close to what we obtained with the real dataset.
                           
                           
                              16
                            Suppose that we choose a Bernoulli model and that for 500 features of the positive category 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                              
                            we obtain an estimate 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 0.3
                              
                           , which means that we find these features in about one third of the training examples. The contribution of this 500 features in the term 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 log
                                 (
                                 1
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                            (Eq. (A.4)) for the coordinate X is equal to 
                              
                                 500
                                 ·
                                 log
                                 (
                                 1
                                 -
                                 0.3
                                 )
                                 ≃
                                 -
                                 178
                              
                           . Suppose that for the same 500 features we get an estimate equal to 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 =
                                 0.01
                              
                            for the negative class. The contribution to the coordinate Y of this set of features is 
                              
                                 500
                                 ·
                                 log
                                 (
                                 1
                                 -
                                 0.01
                                 )
                                 ≃
                                 -
                                 5
                              
                           . So the shift on the X axis is two orders of magnitude greater than the shift on the Y axis. This is exactly the effect we see in Fig. 4b and the reason why neither a zero–one loss function nor a simple learning approach will be able to separate the two classes. The same reasoning can be done for the Poisson model where for smaller categories we usually have an over-estimate of the average frequency of the words. The exact same pattern can be found for all the categories of the 20 Newsgroups dataset and the RCV1 dataset.

At this point, the question is whether the multinomial model can be considered the state-of-the art NB model for dataset with categorical features. If we use a “classical” definition of conditional risk and use Eq. (31), the answer will be yes. The reason is that the other two models, the Bernoulli model and the Poisson model, have likelihoods that are not well balanced which, in terms of likelihood spaces, it means the objects are projected too far from the diagonal of the third quadrant. If we use the new reformulation of conditional risk Eq. (22), the answer will be no. In fact, all the three models have more or less the same capability of separating the positive and negative class, but with the Bernoulli and Poisson models we need to recover the fact that the points are shifted along the X axis by adjusting the costs of the conditional risk.

What if instead of the adapted angular region algorithm which is a very simple brute-force algorithm that keeps the first available solution among the many possible ones,
                              17
                              There are many situations in which different combinations of angular coefficient and intercept produce the same F1-score. In these cases, the angular region algorithm retains the first solution it encounters.
                           
                           
                              17
                            we use an SVM to find the maximum margin hyperplane on the two dimensional space? The results of this experiment are reported in Tables 10–13
                           
                           
                           
                           . We trained a linear SVM on the three two-dimensional space generated by each NB model (Gaussian in the case of the Iris dataset, Bernoulli, multinomial and Poisson in the case of Reuters-21578, 20 Newsgroups, and RCV1), first with default values, and then by optimising the costs of the two classes using the same brute-force approach of the first experiment. Like our approach, SVM with default values performs well on bigger categories and on categories that are well separated from the negative examples (for example, the case of the Reuters-21578 on the two dimensional space generated by the multinomial model), while it requires some optimisation for smaller categories. Differences among the two approaches on the Iris dataset and the optimised Reuters-21578 collection are very subtle and not statistically significant. On the other hand, on the 20 Newsgroup dataset the performance of the SVM is still lower compared to the angular region algorithm, and it would require more optimisation to get the best performances possible. The same thing happens for the RCV1 dataset. The performance of the SVM on the two-dimensional space is significantly lower compared to the angular region algorithm.

In general, the optimisation of the SVM requires a training time which is one order of magnitude greater than the time to train the angular region algorithm. Consequently, the angular region algorithm guarantees on the two dimensional space a better compromise between training time and efficacy of the classifier.

There is something important about the quality of the distribution of points on the log-likelihood space that can be inferred indirectly form the result of the SVM. The log-likelihood space of the multinomial NB is the hardest to learn and the macro-F1 is the worst of the three models for all the dataset we considered. In fact, the points of the two classes on this space are very close to each other and there is a lot of overlapping between the positive and negative class (see Fig. 5a and b); therefore, it is difficult to find the correct tuning to generate the best hyperplane. By contrast, the Bernoulli and Poisson model scatters points further apart and it is easier to find the space for a solution.

In this section, we want to give some final remarks about the experiments we presented and reflect on possible future work.

The first important thing is to understand the meaning of a linear decision in the log-likelihood space. In Section 5, we said that there is no difference between the likelihood space and the log-likelihood space. In theory, when we apply the logarithm, we are using a non-linear transformation; consequently, the linear decision function becomes a non-linear decision function. This non-linear decision function has the following equation:
                           
                              (34)
                              
                                 log
                                 (
                                 Y
                                 )
                                 <
                                 log
                                 (
                                 mX
                                 +
                                 q
                                 )
                              
                           
                        Since finding the parameters of 
                           
                              log
                              (
                              mX
                              +
                              q
                              )
                           
                         would require a more complex strategy compared to the simple linear function, we can use the first order Taylor series expansion of the logarithm as a rough approximation of the logarithm:
                           
                              (35)
                              
                                 log
                                 (
                                 mx
                                 +
                                 q
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          +
                                          ∞
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             (
                                             -
                                             1
                                             )
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             (
                                             mx
                                             +
                                             q
                                             -
                                             1
                                             )
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       ≈
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                 
                                 mx
                                 +
                                 q
                                 -
                                 1
                                 ∼
                                 mx
                                 +
                                 q
                              
                           
                        where in the last passage we further approximate by relaxing the constant one.
                           18
                           Consider that on the log-likelihood space the magnitude of the numbers is at least 
                                 
                                    
                                       
                                          10
                                       
                                       
                                          2
                                       
                                    
                                 
                               or 
                                 
                                    
                                       
                                          10
                                       
                                       
                                          3
                                       
                                    
                                 
                               since we are projecting points that are very close to zero. Consequently, the magnitude of the intercept is often around 
                                 
                                    
                                       
                                          10
                                       
                                       
                                          2
                                       
                                    
                                 
                               and subtracting one does not significantly change the value of q.
                        
                        
                           18
                         We leave open the problem of finding the best logarithmic curve, instead of its approximation, for future work.

Another aspect that was not tackled in this paper is the question of feature selection. In (McCallum & Nigam, 1998), the authors compare the performance of the multinomial and the multivariate (Bernoulli) model by varying the vocabulary size on the Reuters dataset. The interesting result is that when a small number of features is selected, the performance of the Bernoulli model increases and the difference between the two models is almost negligible. We believe that this result is a consequence of the reduction of the shift on the X axis since we are reducing the contribution of the sum 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              log
                              (
                              1
                              -
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              )
                           
                         (Eq. (A.4)). Nevertheless, the best results obtained by McCallum and Nigam (1998) by reducing the vocabulary are worse than the results we could find without any feature selection approach, even though their performance measure is the precision–recall break-even point which is usually higher than F1. For this reason, we believe that this problem is an important future work that requires a careful analysis.

Another problem is the question of how probability smoothing affects the performance of the NB model. In (Eyheramendy et al., 2003), the authors present a study on different NB models and use priors to smooth probabilities. The results on the Reuters dataset are very close to our best ones and show that the difference between the multinomial, Bernoulli and Poisson models are very small when priors are used. This suggests that smoothing is another possible solution for mitigating the effect of the shift on the X axis, which is also confirmed by recent experiments (Di Nunzio & Sordoni, 2012).

Finally, we think that there are some connections between the optimal hyperplanes and hard margin separating hyperplanes of Support Vector Machines (Burges, 1998) and the definition of the linear decision function of Eq. (22). In fact, if we were to add constraints to the linear decision function, like maximising the distance between the points and the decision line, we should find almost the same solution as an SVM with the same constraints. This is what we expected to find with the weighted SVM, but we believe we need a better approach for parameter optimisation to better understand the relation between the two.

@&#RELATED WORKS@&#

The literature of Bayesian decision theory is vast. For the definition of the mathematical framework and the problem of the minimisation of the risk, we suggest two very well known books: one classical work on pattern classification (Duda et al., 2001) and, for a different view of the same problem, another on signal detection theory (Van Trees, 2004).

On of the best papers to study the optimality of NB models is the seminal paper by Domingos and Pazzani (1997) and the further study by Zhang (2005). These two works to study the conditions under which the NB classifier is an optimal classifier under the zero–one loss function even though the conditional independence assumption is clearly violated. An additional reading is the work of Lewis (1998) which makes a parallel between the binary classifier and the binary independence model used in Information Retrieval is presented. It raises some interesting questions like how to state sufficient conditions for NB to produce optimal ranking of documents. Lewis also defined the Probability Thresholding Principle for automated text classification in (Lewis, 1995), which strengthens the Probability Ranking Principle defined in IR (Robertson, 1997). The definition of a decision-theoretic loss measures is derived resulting in the same formulation of Eq. (9) but with the focus on the probability of the positive class:
                        
                           (36)
                           
                              P
                              (
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              |
                              o
                              )
                              >
                              
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                                 
                                    [
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                    +
                                    [
                                    λ
                                    (
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    -
                                    λ
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ]
                                 
                              
                           
                        
                     An important issue is that, since the threshold value depend on the loss function 
                        
                           λ
                           (
                           ·
                           |
                           ·
                           )
                        
                     , which in turn depends on what the users wants from the system, there is no single threshold that is best for all purposes. In both (Almeida et al., 2011; Metsis et al., 2006), the authors present a spam filtering approach with NB classifiers which uses formulation 
                        
                           P
                           (
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           |
                           o
                           )
                           >
                           T
                        
                      to optimise the system.

In (Dmochowski, Sajda, & Parra, 2010), an important result about the relation between the maximum likelihood and the risk minimisation was given. It was shown that in the case of the model family including the true posterior, thresholding the ML solution is guaranteed to asymptotically minimise risk. In this case, cost-sensitive learning is synonymous with threshold adjustment.

About NB models and binary classification we can identify the following works which study: the mathematical model, the selection of features, the smoothing of probability. In (Eyheramendy et al., 2003), the authors compare the multinomial NB model with other three NB model. In particular, they explain the relations between the multinomial model and the Poisson model and propose a variation to incorporate document length in the models. The work presented by McCallum and Nigam (1998) makes a very clear presentation on NB models in general. In particular, they compare the multinomial and the Bernoulli models on different collections by varying the size of the vocabulary. Their results indicate Bernoulli model sometimes performs better than the multinomial at small vocabulary sizes. However, the multinomial usually outperforms the Bernoulli model at large vocabulary sizes, and almost always beats the Bernoulli model when vocabulary size is chosen optimally for both. A full Bayesian approach for feature selection is presented in (Feng, Guo, Jing, & Hao, 2012). The authors discuss a probability-based objective function for identifying the best feature subset by learning from a training document set. In (Kolcz, 2005), the problem of dealing with extremely misclassification costs is presented. The paper investigates the merits of using local and document feature selection rather than global feature selection. In (Rennie, Shih, Teevan, & Karger, 2003), the authors review the systemic problems of the NB classifier, in particular when one class has more training examples than another, NB selects poor weights for the decision boundary. They propose a method to smooth the estimates of the parameter by using a more even amount of training data per class which is directly feed into the estimate as a prior.

Finally, ‘Likelihood projections’ was presented in (Singh & Raj, 2004), and it has been used in the past mainly for the classification of multimedia data (Duan et al., 2006; Raj & Singh, 2003), and more recently to understand text classification and retrieval problems (Di Nunzio, 2009).

@&#CONCLUSIONS@&#

In this paper, we have elaborated a formal definition for a new decision function the parameter of which are related to the misclassification costs of a binary classification problem. This new function it is both a generalisation of the likelihood ratio (Eq. (12)) and a mathematically sound justification for the constant found empirically by Domingos and Pazzani (1997).

By means of a two-dimensional representation of objects based on likelihood spaces, we have proposed a graphical interpretation of the decision function for differen NB models. This showed, for the first time, why some NB classifiers perform better than other, and how far the optimal solution is compared to classical decision function, for example the zero–one loss function. By having an additional parameter (the intercept of the linear function), we have shown a strategy to improve the performance of each of the classifiers.

Finally, we presented a thorough analysis of the influence of each step (choice of the dataset, the model, the background knowledge, and learning algorithm) to the classification performance of NB classifiers. We believe that this new geometrical interpretation of the decision function will open new perspectives on the study and understanding of probabilistic binary classifiers.

@&#ACKNOWLEDGEMENTS@&#

The author gratefully acknowledge Massimo Melucci from University of Padua for the fruitful discussions during the preparation of this paper. The author wish to thank Emanuele Di Buccio and Gianmaria Silvello from the University of Padua for their comments and suggestions. This work has been partially supported by the QONTEXT project under grant agreement N. 247590 (FP7/2007-2013).

A Naïve Bayes classifier is a kind of probabilistic classifier which makes a strong assumption, the naïve independence assumption. This assumption states that the attributes of an object are independent given the value of the class variable. This allows the NB model to write the likelihood function as a product of the probability of the single attributes of the objects:
                        
                           (A.1)
                           
                              P
                              (
                              o
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                              
                              P
                              (
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     This formulation is very convenient if we apply the log transformation because it transforms the probability 
                        
                           P
                           (
                           o
                           |
                           
                              
                                 c
                              
                              
                                 i
                              
                           
                           )
                        
                      into a linear function. In the following sections, we present four NB models: the Bernoulli, the multinomial, the Poisson and the Gaussian model and the mathematical expression of each log-likelihood.

In the multivariate Bernoulli model, an object is a binary vector over the space of features. Given a set of features 
                           
                              F
                              ,
                              |
                              F
                              |
                              =
                              m
                           
                        , each object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                         is represented as a vector of m Bernoulli random variables 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                              ≡
                              (
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         such that:
                           
                              (A.2)
                              
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 ∼
                                 Bern
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       c
                                    
                                 
                                 )
                              
                           
                        We can write the probability of an object by using the NB conditional independence assumption which states that feature variables are independent given the class variable. Formally:
                           
                              (A.3)
                              
                                 P
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 θ
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 P
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 θ
                                 )
                                 =
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       -
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       1
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           
                         is either 0 or 1 indicating whether feature 
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                           
                         is present or absent in object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                        . When the number of features is very large, this product goes quickly to zero. For this reason, a monotonic transformation, such as a log transformation, is usually performed:
                           
                              (A.4)
                              
                                 log
                                 (
                                 P
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 θ
                                 )
                                 )
                                 =
                                 log
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∏
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          P
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          ;
                                          θ
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 log
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                1
                                                -
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 log
                                 (
                                 1
                                 -
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     

In the multinomial model we have one single random variable F which can take values over the set of features. By assuming that each feature event is independent of each other, an object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                         is represented as a vector of frequencies whose entries correspond to features. This vector is drawn from a multinomial distribution:
                           
                              (A.5)
                              
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 ≡
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       1
                                       ,
                                       j
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       m
                                       ,
                                       j
                                    
                                 
                                 )
                                 ∼
                                 Multinomial
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       c
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    N
                                 
                                 
                                    k
                                    ,
                                    j
                                 
                              
                           
                         indicates the number of times feature 
                           
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                           
                         appears in the object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                        . Note that, in this case, 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    c
                                 
                              
                              =
                              1
                           
                        . The probability is proportional to (for the sake of clarity of notation, we do not show constants that can be deleted when 
                           
                              P
                              (
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                              |
                              
                                 
                                    c
                                 
                                 
                                    i
                                 
                              
                              ;
                              θ
                              )
                           
                         is plugged into the decision function):
                           
                              (A.6)
                              
                                 P
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 θ
                                 )
                                 ∝
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                             ,
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        We apply the log transformation to avoid zero-probabilities:
                           
                              (A.7)
                              
                                 log
                                 
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          ;
                                          θ
                                          )
                                       
                                    
                                 
                                 ∝
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       N
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 log
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     

In the Poisson model, an object is generated by a multivariate Poisson random variable. Each object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                         is represented as an m-dimensional vector of frequencies, 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                              ≡
                              (
                              
                                 
                                    N
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    m
                                    ,
                                    j
                                 
                              
                              )
                           
                        , and each feature count is governed by a Poisson random variable:
                           
                              (A.8)
                              
                                 
                                    
                                       N
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ∼
                                 Pois
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       c
                                    
                                 
                                 )
                                 .
                              
                           
                        Using the NB conditional independence assumption, we can write the probability of the object as:
                           
                              (A.9)
                              
                                 P
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 θ
                                 )
                                 ∝
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             k
                                             ,
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                             
                                                
                                                   c
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and, by taking the logs we obtain:
                           
                              (A.10)
                              
                                 log
                                 
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          ;
                                          θ
                                          )
                                       
                                    
                                 
                                 ∝
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                N
                                             
                                             
                                                k
                                                ,
                                                j
                                             
                                          
                                          log
                                          
                                             
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         |
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the Gaussian model, an object is generated by a multivariate Gaussian random variable. Each object 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                           
                         is represented as an m-dimensional vector of real values, 
                           
                              
                                 
                                    o
                                 
                                 
                                    j
                                 
                              
                              ≡
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                    ,
                                    j
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    g
                                 
                                 
                                    m
                                    ,
                                    j
                                 
                              
                              )
                           
                        , and each feature value is governed by a Gaussian random variable:
                           
                              (A.11)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ∼
                                 N
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       k
                                       |
                                       c
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                       |
                                       c
                                    
                                 
                                 )
                              
                           
                        Using the NB conditional independence assumption, we can write the probability of the object as:
                           
                              (A.12)
                              
                                 P
                                 (
                                 
                                    
                                       o
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 μ
                                 ,
                                 σ
                                 )
                                 ∝
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             k
                                             |
                                             c
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   k
                                                   ,
                                                   j
                                                
                                             
                                             -
                                             
                                                
                                                   μ
                                                
                                                
                                                   c
                                                   |
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       /
                                       (
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             k
                                             |
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        and, by taking the logs we obtain:
                           
                              (A.13)
                              
                                 log
                                 
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                o
                                             
                                             
                                                j
                                             
                                          
                                          |
                                          
                                             
                                                c
                                             
                                             
                                                i
                                             
                                          
                                          ;
                                          μ
                                          ,
                                          σ
                                          )
                                       
                                    
                                 
                                 ∝
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          log
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                c
                                                |
                                                k
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            k
                                                            ,
                                                            j
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            c
                                                            |
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      k
                                                      |
                                                      c
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

@&#REFERENCES@&#

