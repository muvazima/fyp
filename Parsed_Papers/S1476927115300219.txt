@&#MAIN-TITLE@&#Comparison of non-sequential sets of protein residues

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           The vast majority of binding sites for small ligands are shown to be set of sparsely distributed amino-acids.


                        
                        
                           
                           A method for the comparison of non-sequential protein segments based on a genetic algorithm is introduced.


                        
                        
                           
                           The sequence-independent method presented is shown to be better suited than sequence based approaches for comparing ligand-binding sites.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Structural alignment

Sequence-independent

Structural similarity

FAD

NAD

TM-SITE

@&#ABSTRACT@&#


               
               
                  A methodology for performing sequence-free comparison of functional sites in protein structures is introduced. The method is based on a new notion of similarity among superimposed groups of amino acid residues that evaluates both geometry and physico-chemical properties. The method is specifically designed to handle disconnected and sparsely distributed sets of residues. A genetic algorithm is employed to find the superimposition of protein segments that maximizes their similarity. The method was evaluated by performing an all-to-all comparison on two separate sets of ligand-binding sites, comprising 47 protein-FAD (Flavin-Adenine Dinucleotide) and 64 protein-NAD (Nicotinamide-Adenine Dinucleotide) complexes, and comparing the results with those of an existing sequence-based structural alignment tool (TM-Align). The quality of the two methodologies is judged by the methods’ capacity to, among other, correctly predict the similarities in the protein-ligand contact patterns of each pair of binding sites. The results show that using a sequence-free method significantly improves over the sequence-based one, resulting in 23 significant binding-site homologies being detected by the new method but ignored by the sequence-based one.
               
            

@&#INTRODUCTION@&#

The overall structure of a protein is determined by its full sequence. Various types of interactions between residues on the one hand and between the residues and the solvent on the other hand guide the folding process. Once a protein acquires its native structure, its biologically relevant functions, including binding to other molecules and catalytic activity, are carried out by functional elements. Depending on the degree of which the mechanism of action of a particular function is known, these elements can be narrowed down to a specific chain in a multimer, a particular domain of the protein, or even to groups of residues localized in a particular region of the structure. As a consequence, the functions of a given protein may be identified by the presence of various residue patterns in its sequence (Whisstock and Lesk, 2003).

Ligand-binding sites (LBSs) in monomeric proteins are one of the most typical (and classical) examples of functional elements in proteins. They are located in a specific region of the structure, and are directly linked to the catalytic activity of enzymes. There is already a very large body of structures available for which biologically relevant protein–ligand interactions have been identified. However, there is no consensus on how the LBSs are defined on the basis of crystal or NMR structures. A number of databases that compile ligand–protein complexes exist (Hu et al., 2005; Liu et al., 2007).

Some of the experimentally determined structures include data about the LBSs. In some other cases, only the structure is available, with no immediate evidence available about which residues are involved in ligand binding. For protein–ligand complexes, the LBS residues can be defined using a simple ligand–residue distance criterion. For instance, in the LigASite database (Dessailly et al., 2008), any residue with an atom closer than a given cutoff distance to a ligand is considered to be part of the LBS. The cutoff distance should take into account that there is some uncertainty in the positions of atoms in the structures, while proteins are also inherently flexible. As a consequence, the protein–ligand interactions might not have the exact range as observed in a given structure or are simply a product of the crystallization process. A cutoff that is too short (e.g. based on ideal bond lengths) might leave out some meaningful residues or include irrelevant ones.

Other databases (Binkowski et al., 2003) instead opt for defining a ligand cavity. The definition of a cavity is based on similar principles as in LigASite, but relies on surface properties instead of distances to the ligand and does not assume that all the residues included in the cavity definition will be in direct contact with the ligand.

Proteins with the same function tend to share high sequence and/or overall structural similarity. However, proteins with divergent structures and sequence may still present homologous functional elements and be involved in similar functions (Bruns et al., 1997; Rosen et al., 1998). Generally, comparisons of sequence and structure are required for template-based predictions of protein functions. Many of the structural alignment tools currently available are restricted to three-dimensional structures that are continuous in sequence (Zhang and Skolnick, 2005; Hasegawa and Holm, 2009). Clearly, such comparisons are of little value when dealing with functional elements consisting of disconnected and sparsely distributed residues.

A number of methods have been developed to overcome this limitation by conducting sequence-independent structural alignments. Current methods for comparing two structures can be generally classified according to three different criteria: (i) the way the structures are represented, (ii) how the similarity between the structures is defined, and (iii) which method is used to find the superimposition of structures that maximizes the similarity. A representation of the structures can be obtained by employing all atoms in the structures (Gold and Jackson, 2006; Sehnal et al., 2012), C
                     
                        α
                     -atoms only (Nussinov and Wolfson, 1991; Wolfson and Rigoutsos, 1997), a combination of C
                     
                        α
                     -atoms and side chain averages (Ausiello et al., 2005), molecular surfaces (Coleman and Sharp, 2010) or functional groups (Konc and Janežič, 2010). Similarity between two structures can be established by employing different combinations of a number of factors, including geometry (Shatsky et al., 2002; Chang et al., 2004), surface shape (Chang et al., 2004), physico-chemical properties (Shulman-Peleg et al., 2005) or matching atom element types (Gold and Jackson, 2006). Finally, there are several methods for finding the superimposition that maximizes the similarity, the most common ones being geometric hashing (Nussinov and Wolfson, 1991; Wolfson and Rigoutsos, 1997; Chang et al., 2004; Gold and Jackson, 2006), maximum clique techniques (Konc and Janežič, 2010; Nguyen et al., 2011) and exhaustive searches (Ausiello et al., 2005; Feldman and Labute, 2010; Sehnal et al., 2012).

The method of the present work makes use of a C
                     
                        α
                     -atom representation of the structures. Feldman and Labute (2010) demonstrated that this is enough to develop a reliable method for comparing binding pockets. Moreover, in the vast majority of cases the C
                     
                        α
                     -atoms undergo very limited displacements (root mean square deviation≤2Å) even in the event of ligand binding (Brylinski and Skolnick, 2008), whereas for the side-chain atoms significant changes are observed (Najmanovich et al., 2000; Gaudreault et al., 2012). The similarity function of the present work is based on a combination of geometrical and physical–chemical similarities between structures, following an idea somewhat similar to the function used by CPASS (Powers et al., 2011), but without any notion of distances to ligand (therefore extending its use to any pair of structures, not only ligand-bound ones) and a rather different treatment of geometrical similarities. The similarity between pairs of structures is maximized by means of a genetic algorithm (Davis, 1991), which does not require the establishment of a pairing of residues or atoms prior to the structural comparison. In addition, it does not impose the optimal overlap of any pair of residues.

The BioLIP database (Yang et al., 2013) contains a non-redundant collection of all the structures of protein–ligand complexes available from the Protein Data Bank (Berman et al., 2002) (PDB). For each binding site in each complex, the database holds a list of residues that form the LBS and its associated so-called Shortest Sequence from First to Last binding residue (SSFL). The continuous substructure corresponding to the SSFL can be used instead of the full protein to perform a local structural alignment. This causes the alignment to be driven by the region surrounding the LBS, removing the influence of other regions of the protein far away from it. Such local alignments have already proven to be a much better approach for comparing LBSs (Yang et al., 2013).

TM-SITE (Yang et al., 2013) is a recently developed method for the prediction of LBSs. It makes use of ConCavity (Capra et al., 2009) to analyze the surface of a query protein and predict possible ligand cavities. The SSFLs of these predicted cavities are subsequently employed to perform structural alignments to the SSFLs of known LBSs. The outcome of the alignments is then evaluated according to a composite function that takes into account local and global similarities. The templates that produce high scores on the evaluation function are taken as putative templates for the prediction of the LBS residues.

A possible drawback of SSFLs is that they may contain residues other than the ones in the LBS, which in some cases may mean that the residues relevant to the comparison represent only a small fraction of the substructure used in the alignment. Thus, just like the alignment of SSFLs for comparing LBSs is an improvement over the global alignment by not taking into account regions distant from the LBS, the use of only those residues actually involved in ligand binding represents an even further increase of the sensitivity of such comparisons. This was already pointed out by Zhang et al. in Yang et al. (2013), but the same study claimed that such a method would result in a high false positive rate as a consequence of a too small number of residues involved in the comparisons, in reference to a previous work (Roy et al., 2012).

Any comparison of two structures or sets of possibly disconnected residues requires a definition of similarity. Clearly, the similarity can be measured using a virtually infinite number of different criteria. The simplest approach is to rely solely on geometry: the more residues of both structures can overlap, the more similar the structures are supposed. Due to the small size of protein functional sites, such a measure would provide limited information and only a few reliable assumptions about the shared properties of the two structures can be made. Alternatively, defining the similarity on the basis of the physico-chemical properties of those residues that can be superimposed, would make it a more strict criterion as it compares the local chemical environments of the structures. A main hypothesis of the present work is that such a definition of similarity allows for making more reliable assumptions as to whether or not two sets of non-sequential residues share common properties.

The purpose of the present work then is to introduce an alternative procedure for measuring the similarity between any two given sets of residues. The method introduced in this study is capable of handling interfaces or functional elements that are composed of disconnected and sparsely distributed residues. The similarity is defined in terms of specific common properties of the interfaces, as defined by chemical distance matrices. These matrices are built by establishing a distance between each pair of amino acid types, which reflects their differences on a number of given physico-chemical features (Grantham, 1974).

The method relies a non-deterministic search heuristic by means of a genetic algorithm (GA) (Davis, 1991) to generate superimpositions of one template structure over a query and finds the one that maximizes their similarity. The quality of the new methodology is demonstrated by comparing its results with those of TM-SITE (Yang et al., 2013). The cross-comparison of the two methods was performed by measuring the contact conservation rate (CCR), the ligand displacement (LD), and the value of a modified version of the TM-SITE scoring function (
                        
                           q
                           str
                           R
                        
                     ) for each alignment. Various chemical distance matrices were employed.

@&#METHODS@&#

The quality of the procedure for measuring the similarity between any two given sets of residues (forming substructures, interfaces, cavities, and so forth) was tested by employing the new method for an all-to-all comparison of two separate sets of ligand–protein complexes. Below we first present a very short summary of the various steps of the analysis, followed by a more detailed explanation of each part in subsequent subsections.


                     Data sets and definitions for LBSs and SSFLs: Two sets of ligand–protein complexes were compiled from the BioLIP database. For each ligand–protein complex, the LBS and its corresponding SSFL were defined according to the BioLIP criteria. Also, a ligand cavity was identified using a simple distance cutoff between the protein and the ligand. See also Fig. 1
                      for a graphical overview.


                     LBSs and cavities comparison: A GA was employed to find the best fit of the different LBSs onto each of the ligand cavities. The GA was used in combination with various definitions of chemical distance matrices resulting in different measures for the similarity between two sets of residues. In total three different sets of results were obtained.


                     Structural alignment of SSFLs: In order to establish the quality and relevance of the newly developed method, TM-Align (Zhang and Skolnick, 2005) was employed to perform a local structural alignment of the same complexes based on the SSFLs corresponding to their LBSs.


                     Cross-comparison: The outcome of the GA-based results and the structural alignment of SSFLs were evaluated by their CCR, LD, and 
                        
                           q
                           str
                           R
                        
                      values. An overview of the process is presented in Fig. 2
                     .

The quality of the methodology for computing the similarity was evaluated employing two different test sets of protein–ligand complexes. Each set consisted of a collection of protein–ligand complexes that were obtained from the BioLIP database. Each protein structure had two associated substructures: a LBS and its SSFL. Additionally, a ligand cavity was defined as consisting of all residues with at least one atom closer than 5Å to the ligand (see Fig. 1). This value produces a larger set of residues than the one obtained using the BioLIP definitions (0.5Å plus the sum of the Van der Waals radii) and aims to include those interactions that may be excluded in the LBS due to a degree of uncertainty in the atom positions in the structure or the inherent flexibility of the proteins.

In order to find unbiased protein–ligand sets, an analysis of the LBSs sizes distribution was conducted on the BioLIP database. To evaluate the relevance of the LBS residues within their SSFLs, first the distribution of the LBS sizes (defined as the number of residues) was computed for the database and subsequently the ratio between LBS and SSFL length was calculated for every entry in the database. Based on the results of this analysis (presented below), the protein–ligand sets used for the present comparison were restricted to complexes with LBSs of size 24. Among these complexes FAD (Flavin-Adenine Dinucleotide) and NAD (Nicotinamide-Adenine Dinucleotide) are two of the most frequent ligands.

Therefore one set of protein–ligand complexes was built using all proteins in complex with NAD (Nicotinamide-Adenine Dinucleotide) whose LBSs contains 24 residues (64 complexes in the BioLIP database were selected). The second set was constructed from all proteins bound to FAD (Flavin-Adenine Dinucleotide) with LBSs of size 24 (47 complexes were identified in BioLIP). Note that one of FAD proteins (with PDB identifier ‘2cyfE’) had to be left out from the original set because its ligand was missing several atoms.

A GA-based method was employed for comparing the LBSs to the ligand cavities. It was used in combination with three different chemical distance matrix.

The GA implemented for the comparison evaluates transformations (combined translation and rotation) of a template LBS over a query ligand cavity. It returns the geometrical transformation that maximizes the similarity S between the two sets of residues under a given transformation of the template. The similarity is defined as
                              
                                 (1)
                                 
                                    S
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   M
                                                   RT
                                                
                                             
                                          
                                          
                                             s
                                             ij
                                          
                                       
                                       M
                                    
                                    ,
                                 
                              
                           where M
                           
                              RT
                            is the number of residues of the template whose C
                           
                              α
                            atom is closer than a given cutoff distance R
                           c to the C
                           
                              α
                            of any query residue, M is the total number of residues in the template and s
                           
                              ij
                            is the score of the pair of residues i (template) and j (query), where j refers to the residue in the query that is geometrically the closest to residue i in the template. The score s
                           
                              ij
                            is calculated based on a chemical distance matrix D (see next subsection) for the amino acid types associated with residues i and j, according to
                              
                                 (2)
                                 
                                    
                                       s
                                       ij
                                    
                                    =
                                    
                                       
                                          max
                                          (
                                          D
                                          )
                                          −
                                          
                                             D
                                             ij
                                          
                                       
                                       
                                          max
                                          (
                                          D
                                          )
                                       
                                    
                                    ,
                                 
                              
                           where max(D) is the maximum value of all elements of the matrix and the matrix element D
                           
                              ij
                            refers to the “chemical distance” between the residue types of residues i and j.


                           Chothia and Lesk (1986) established a relationship between the root mean square deviation (RMSD) in the positions of the main chain atoms and the fraction of mutated residues in the core of homologous proteins according to the formula
                              
                                 (3)
                                 
                                    RMSD
                                    =
                                    0.4
                                    ×
                                    
                                       e
                                       
                                          1.87
                                          ×
                                          H
                                       
                                    
                                    ,
                                 
                              
                           where H is the fraction of mutated residues. Here, the RMSD in given in Å. According to Rost (Rost, 1999), the vast majority of proteins sharing 30% sequence identity or more are homologs. A 30% sequence identity corresponds to a H value of 0.7 and, according to Eq. (3), to an average RMSD of 1.48Å for the backbone atoms. The cutoff value R
                           
                              c
                           , used to define M
                           
                              RT
                            in Eq. (1) has its lower bound set based on these numbers. The lower bound of R
                           
                              c
                            is set to 1.48Å so that the small structural deviations existing among homologs are ignored. The ideal distance between two consecutive C
                           
                              α
                            atoms in proteins is 3.8Å, with small deviations that appear independent of the structure resolution (Chakraborty et al., 2013), according to which the upper limit for the R
                           c value should be 3.8Å. In the present study, a compromise between these two limits was used, and R
                           c was set to 2.5Å.

The GA maximizes S as follows. The algorithm generates G successive generations of N individuals, where each individual is a geometric transformation of the template. The transformation consists of three translations along three perpendicular axes and three rotations about these axis, performed in the z–y–x order (yaw, pitch and roll). The combined set of values for the six “coordinates” for a given transformation is referred to as the “genome” and single coordinate within the genome is a “gene”. A gene is consequently referring to a single translation along a specific axis or a single rotation about a particular axis. Each translation is initiated from the center of mass of the query ligand cavity and ranges from 0 to twice its largest dimension. Rotations were generated using a quaternion formulation (Hamilton, 1853).

For a given generation g, the fitness of each individual i is assessed by the value of S
                           
                              i
                            yielded by its genome. From all S
                           
                              i
                            values of g, a probability density is generated that is normally distributed with the mean being the maximum value of all S
                           
                              i
                           's. The standard deviation is taken to be the difference between the maximum and minimum values of the S
                           
                              i
                           's. This density is subsequently employed to compute a probability P
                           
                              i
                           , which represents the probability of each individual i being passed on to the next generation. This probability is computed as the normalized value of the density function at S
                           
                              i
                           , such that 
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 P
                                 i
                              
                              =
                              1
                           . Each individual j of the following generation g
                           +1 will then have a probability P
                           
                              i
                            of adopting the genome of the individual i from g. In this way, the genomes that produce the largest values of S have the highest chances of perpetuating themselves in the successive generations.

After the genomes are passed on to the next generation, any gene of each individual i has a mutation (M) probability P
                           
                              M,large
                            that randomizes the gene's value (i.e., the value of the coordinate it represents) to any new value between 0 and the maximum possible value for that gene (a maximum displacement or a maximum angle in case of a rotation). In addition, a gene has a mutation probability P
                           
                              M,small
                            to suffer from a small change that modifies its current value by a random quantity between 0 and L (in %) of the maximum possible value for that gene. The purpose of P
                           
                              M,small
                            is to allow for frequent small mutations, instead of fully randomizing the values on the genome to any possible value as in the case of large mutations.

The process above is repeated for G generations. When completed, the individual that produces the highest value for S is selected. Due to the high chance of the algorithm of being trapped into sub-optimal solutions, the process is repeated iteratively K times. After a new solution is found subsequent an iteration, the search space is restricted. That is, the new individuals are required to have a center of mass displacement larger than 3.0Å or a divergence in rotation larger than 0.2 in the quaternion space (Hamilton, 1853) with respect to the known solutions. When an individual fails to meet these criteria, its genotype is fully randomized before passing on to the next generation.

The following values for the GA parameters were employed: G
                           =250, N
                           =350, K
                           =350, P
                           
                              M,large
                           
                           =0.05, P
                           
                              M,small
                           
                           =0.1, L
                           =10%. Due to the stochastic nature of the method and the diversity of all the possible inputs, these parameters cannot be truly optimized. The values used in the present study were found by trial and error, using increasing values for G, N, K, and M until they proved to be sufficient for obtaining convergence in the test sets.

The properties of two amino acids can be compared through a chemical distance matrix. In the present study, the GA was combined with a number of different chemical distance matrices: a “naïve” matrix that assumes that all residues are equal, a matrix B based on BLOSUM62 (Henikoff and Henikoff, 1992) and a matrix R based on the work by Atchley et al. (2005).

For the naïve matrix, the only criterion for the similarity between two sets of residues relies on geometry, by assigning the same value D
                           
                              ij
                            to all residue pairs, independently of their types. With the scores of all pairs being equal, the similarity between a template and a query simply follows from Eq. (1) as
                              
                                 (4)
                                 
                                    S
                                    =
                                    
                                       
                                          
                                             M
                                             RT
                                          
                                       
                                       M
                                    
                                    .
                                 
                              
                           Thus, the naïve matrix produces the transformation that maximizes the number of query residues overlapping with template residues.

The matrices B and R base the comparison on the actual types of residues that are superimposed. The BLOSUM62 matrix represents the log-likehood ratios of one amino being replaced by another in homologous sequences. This assumes that the possibility of a replacement of one amino acid by another would correlate to their physico-chemical similarities. Therefore, B finds the transformation for which the local chemical environments have the maximum overlap.

To obtain a distance matrix D suitable for the purpose of this work, the original BLOSUM62 matrix values were normalized to positive values B
                           
                              ij
                           , such that the average distance between pairs is 100. The maximum distance of 189.2023 was found between Trp and Pro. For each pair of residue types, the distance D
                           
                              ij
                            is calculated as
                              
                                 (5)
                                 
                                    
                                       D
                                       ij
                                    
                                    =
                                    
                                       
                                          max
                                          (
                                          
                                             B
                                             i
                                          
                                          )
                                          max
                                          (
                                          
                                             B
                                             j
                                          
                                          )
                                          −
                                          
                                             B
                                             ij
                                          
                                       
                                    
                                    ,
                                 
                              
                           where max(B
                           
                              i
                           ) and max(B
                           
                              j
                           ) are the maximum values of the normalized matrix B for the residues i and j and B
                           
                              ij
                            is the value for the pair ij.

The matrix R was exclusively based on physico-chemical properties of amino acids. The data provided by a meta-analysis of all known amino acid properties performed by Atchley et al. (2005) was employed. Atchley et al defines five different uncorrelated factors that summarize known amino acid properties available from the AAindex (Kawashima et al., 2008). Out of those, factors I, III and V contain the physico-chemical properties. Factor I is designated as the polarity index, factor III relates to the volume, bulkiness and weight of the amino acids and factor V represents the electrostatic properties of the different residues. The matrix was built using these three factors and thus named the Reduced Atchley matrix A, the elements A
                           
                              ij
                            of which are obtained by employing the procedure of Grantham Grantham (1974),
                              
                                 (6)
                                 
                                    
                                       A
                                       ij
                                    
                                    =
                                    [
                                    α
                                    
                                       
                                          (
                                          
                                             F
                                             
                                                
                                                   I
                                                   i
                                                
                                             
                                          
                                          −
                                          
                                             F
                                             
                                                
                                                   I
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    +
                                    β
                                    
                                       
                                          (
                                          
                                             F
                                             
                                                
                                                   III
                                                   i
                                                
                                             
                                          
                                          −
                                          
                                             F
                                             
                                                
                                                   III
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    +
                                    γ
                                    
                                       
                                          (
                                          
                                             F
                                             
                                                
                                                   V
                                                   i
                                                
                                             
                                          
                                          −
                                          
                                             F
                                             
                                                
                                                   V
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       2
                                    
                                    ]
                                    ,
                                 
                              
                           where 
                              α
                              =
                              1
                              /
                              
                                 
                                    
                                       d
                                       ¯
                                    
                                    I
                                    2
                                 
                              
                           , 
                              β
                              =
                              1
                              /
                              
                                 
                                    
                                       d
                                       ¯
                                    
                                    III
                                    2
                                 
                              
                           , 
                              γ
                              =
                              1
                              /
                              
                                 
                                    
                                       d
                                       ¯
                                    
                                    V
                                    2
                                 
                              
                            and 
                              
                                 
                                    
                                       d
                                       a
                                    
                                 
                                 ¯
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            F
                                                            
                                                               
                                                                  a
                                                                  i
                                                               
                                                            
                                                         
                                                         −
                                                         
                                                            F
                                                            
                                                               
                                                                  a
                                                                  j
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    n
                                    2
                                 
                              
                           . Here F
                           
                              a
                            is the values of the factor a
                           ∈{I, III, V} for atom i.

The Reduced Atchley matrix was subsequently normalized to R in quite the same way as before such that the average distance between pairs is 100. A maximum distance of 227.439 was found between Arg and Ser. This distance matrix also finds the transformation for which the local chemical environments have the maximum overlap.

A local structural alignment of the complexes was completed based on the SSFLs corresponding to the LBSs. TM-Align was employed to find the optimal structural alignments. It finds an initial set of three alignments between the two sequences. The first one finds the best secondary structure match between the two sets of residues, the second one fits them based on gapless threading and the last one is a combination of the first and second alignment, each of which is given equal weight. The initial alignments are then refined using dynamic programming to maximize the function
                           
                              (7)
                              
                                 TM-score
                                 =
                                 max
                                 
                                    
                                       
                                          
                                             1
                                             L
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   L
                                                   a
                                                
                                             
                                          
                                          
                                             1
                                             
                                                1
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     d
                                                                     i
                                                                  
                                                               
                                                               
                                                                  
                                                                     d
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where L is the length (number of residues) of the query, L
                        
                           a
                         is the number of aligned residue pairs, d
                        
                           i
                         is the distance between the ith pair of C
                        
                           α
                         atoms of the query and the template, and d
                        0 is a normalization factor computed as 
                           
                              d
                              0
                           
                           =
                           1.24
                           
                              
                                 L
                                 −
                                 15
                              
                              3
                           
                           −
                           18
                        . TM-score measures the structural similarity between the SSFLs. Additional details can be found in the paper by Zhang and Skolnick (2004). As for the GA-based methods, the comparison was performed for all possible pairs within each of the test sets. In all cases, the SSFLs were used both as templates and as queries.

Given that the S and the TM-score values are not directly comparable to each other, three different independent measures were developed to compare the results. Afterwards, the correlation between these “raw” values and the measures used in the cross-comparison was studied.

The similarity measures employed by each of the comparison methods used in this study are different. TM-Align evaluates its results by the TM-score, which details the structural similarity between two structures as described in Eq. (7). The GA-based methods use S as defined in Eq. (1) to rank its solutions. This measure assesses the geometrical and physico-chemical similarities of two sets involved in the comparison, according to the chemical-distance matrix (BLOSUM62, Reduced Atchley or Naive).

These measures have different meanings and cannot be compared directly. To overcome this limitation and to be able to asses the implications derived from using one over another, a common measure was defined: the contact conservation rate (CCR). The CCR is calculated as follows. For each pair of complexes, each similarity measure generates a transformation of the full substructure of the template over the query. For each of the transformed templates, we calculated the number of residues from the BioLIP-defined LBS of the template that fulfilled the following criteria:
                              
                                 •
                                 Its C
                                    
                                       α
                                     must be closer than 2.5Å to the C
                                    
                                       α
                                     of a query residue. This cutoff follows the same rationale as R
                                    c in Eq. (1).

Its residue type must be the same as the closest residue from the query, either aliphatic, polar, aromatic, positively or negatively charged.

Any of its atoms must be closer than 5Å to the query ligand molecule. This value is the same as the one used for defining ligand cavities (see above). It intends to capture all protein–ligand interactions, including those that might be obscured by uncertainties in the atom positions in the structure or the inherent flexibility of the proteins.

The template residues that met all criteria consequently do occupy the same space and share similar chemical characteristics as a query residues. Thus, they must have a homologous contact with the ligand, therefore they are conserved contacts. The CCR was computed as the ratio between the number of conserved contacts and the total number of LBS residues of the template. In other words, the CCR illustrates the similarity of the protein–ligand contact patterns between the template and the query structures.

Unlike the TM-score or S, the CCR requires information about the location of the ligand in both structures, so that it cannot be used to perform template-based predictions. After the superimpositions were performed with the GA-based methods and TM-Align, the reference structures containing the ligands were transformed in the same way such that the CCR could be computed.

After each comparison was completed by either method, a transformation of the residue set involved (either the LBSs or the SSFLs) was produced. This transformation was applied to the full template complexes. Subsequently, the distance between the Center Of Mass (COM) of the template and query ligands was measured. The resulting value was named Ligand Displacement (LD). For proteins whose binding-sites have a large number of superimposed residues, this displacement should be small, whereas a large displacement on the ligand position would imply that the residues of such two sites are not superimposed correctly. However, a small displacement does not imply a high degree of similarity: it is a necessary condition but not the only one. A high LD in combination with a high CCR and/or high 
                              
                                 q
                                 str
                                 R
                              
                            (see below) is an indication of a false positive, i.e. either (or both) the CCR and 
                              
                                 q
                                 str
                                 R
                              
                            overrate the similarity. Therefore, the LD was mainly used to detect false positives.

The TM-SITE method developed by Yang et al. (2013) uses a compound function that takes into account local and global alignments to asses the similarity of two ligand binding sites. The function produces a value in the range of 0–1 that is calculated from
                              
                                 (8)
                                 
                                    
                                       q
                                       str
                                    
                                    =
                                    
                                       2
                                       
                                          1
                                          +
                                          
                                             e
                                             
                                                −
                                                
                                                   
                                                      [
                                                      
                                                         L
                                                         c
                                                      
                                                      (
                                                      0.4
                                                      
                                                         L
                                                         g
                                                      
                                                      +
                                                      0.3
                                                      
                                                         L
                                                         s
                                                      
                                                      +
                                                      0.2
                                                      
                                                         D
                                                         JSD
                                                      
                                                      )
                                                      +
                                                      TM
                                                      ]
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    −
                                    1
                                    ,
                                 
                              
                           where L
                           
                              c
                            is the fraction of LBS template residues aligned to the query, L
                           
                              g
                            measures the local structural similarity between the binding pockets, L
                           
                              s
                            accounts for their evolutionary relation through the BLOSUM62 matrix, D
                           
                              JSD
                            is the Jensen–Shannon Divergence (JSD) score and TM is the harmonic average of the two TM-score values obtained when the SSFLs are aligned and the measure is normalized by the template or the query lengths. The TM factor reflects the structural similarities of the two SSFLs.

In the present study, q
                           
                              str
                            was used as a measure to compare the GA-based methods and the results obtained by the structural alignments generated by TM-Align. However, TM-Align computes the factors L
                           
                              c
                           , L
                           
                              g
                            and L
                           
                              s
                            based on a sequence alignment, which is not possible for the GA-based method. To overcome this problem and make both measures comparable, spatial superimposition was used instead of alignment to calculate L
                           
                              c
                           , L
                           
                              g
                            and L
                           
                              s
                            for both methods using a 2.5Å cutoff distance. By doing so, two residues are considered to be aligned only if their C
                           
                              α
                            atoms are closer than 2.5Å, independently of their relationship at the sequence level. The measure obtained is much more restrictive in terms of which residues contribute to it and therefore it was named Restricted q
                           
                              str
                           , referred to as 
                              
                                 q
                                 str
                                 R
                              
                           .

In order to understand the meaning and usefulness of the similarity measures computed by the GA-based methods and TM-Align, TM-Score and S were compared to the CCR and 
                              
                                 q
                                 str
                                 R
                              
                           . A linear regression was performed for each pair of values and the precision of each of the regression curves was subsequently computed as
                              
                                 (9)
                                 
                                    precision
                                    =
                                    
                                       TP
                                       
                                          
                                             N
                                             obs
                                          
                                       
                                    
                                    ,
                                 
                              
                           where TP is the number of observations that deviate less than a given threshold from the values predicted by the regression curve and N
                           
                              obs
                            is the total number of observations. The threshold was in principle set to 5% of the total possible value of either q
                           
                              str
                            or CCR, defining the precision value as the fraction of estimated values that have an error smaller than 5% with respect to the observed value. Different values for the threshold were explored in order to observe general trends.

The CCR and 
                              
                                 q
                                 str
                                 R
                              
                            values obtained by the different approaches were additionally compared by means of a statistical test. Given that the values obtained presented similar but non-normal distributions, a non-parametric Mann–Whitney test (McKnight and Najab, 2010) was chosen to compare them. It tests the null hypothesis that two samples represent the same population against an alternative hypothesis, for instance that one of the samples is from a population with larger values.

@&#RESULTS@&#

The BioLIP database contains a non-redundant set of all the available structures of protein–ligand complexes available in the PDB database. The ligands comprise different kinds of molecules, from single ions to small peptides. Consequently, the sizes of the ligands sites are very diverse. The frequency of binding sites sizes shown in Fig. 3
                         is consistently decreasing in the 12–37 interval.

Knowing that the PDB is not a complete set of all the existing protein–ligand complexes, this distribution seems to indicate that the LBSs with sizes below 12 and above 37 are underrepresented. The known LBSs with these sizes in the databases might not be very diverse and thus we have chosen to focus our study on proteins with a size of 24 residues (i.e. the average size of the 12–37 range).

As already noted in Section 1, a possible problem of using global structural alignment for the comparison of LBSs (or any other non-sequential functional element) is that the alignment might be driven by regions far away from the LBS. To overcome this issue, a local alignment can be used instead. This type of alignment can be carried out using SSFLs, increasing the precision of the comparison. However, in some cases the SSFL is not much shorter than the full sequence and/or the LBS residues represent a small fraction of its residues. Fig. 4
                         displays the average percentage/fraction of LBS residues in the SSFL versus the LBS size.

The size of LBSs for ligands other than nucleic acids or proteins present in the BioLIP database was in the range 2–39. This shows that the LBSs of size 40 and above are only relevant for peptides, DNA or RNA whereas small molecules are only found in binding-sites of 39 residues or less. Below 39, the average percentage residues in the SSFL that in fact take part in the LBS is always below 0.4, indicating that the binding-sites for small ligands represent only a small portion of their SSFLs. When these numbers are weighted by the number of observations, the result is even more clear: the average fraction of LBS residues in their SSFLs for LBSs of sizes 2–39 is 0.1647. In conclusion, a large number of small ligand binding sites form only a small fraction of their SSFLs.

Besides being relatively small in comparison to their SSFLs, the LBSs residues are often sparsely distributed. As Fig. 5
                         illustrates, the average distance between LBS residues in a SSFL decreases rapidly between LBS sizes 2 and 36. Above size 36, this distance is fluctuating, with values ranging from 3.56 to 0.769 residues. Above size 67 all the values are below 2, indicating that most of the LBS residues are sequential.

Within the 12–37 range, the LBSs of larger sizes make up a larger fraction of the SSFLs and have smaller distances between LBS residues. These nearly-sequential structures are well suited for sequence-based analysis. However, the majority of the LBSs in the 12–37 range are contained within large SSFLs and are sparsely distributed in the sequence. This is more pronounced for the smaller LBSs. In these cases, the sequence-based methods might have a very strong bias caused by the non-LBS parts of the SSFLs. The present study focuses on LBSs with average size, which avoids leaning neither towards nearly sequential structures nor towards highly sparse ones.

The LBSs of size 24, used in the present study, showed an average inter-residue distance of 7.95. The typical size of a SSFL with LBS size of 24 is 150, indicating that just 24 residues on a total 150 residues (i.e. 16%) in the SSFL take part in ligand binding. The majority of the LBSs have even smaller LBS to SSFL ratios.

Within each set of NAD and FAD complexes, an all-to-all comparison of sets of residues was completed using TM-Align and GA-based methods. The latter was employed to compare ligand cavities (queries) with LBSs (templates), while TM-Align was used to carry out a structural alignment of SSFLs (queries) with all other SSFLs (templates) corresponding to the LBSs. The quality of the comparisons was judged by evaluating the CCR, 
                           
                              q
                              str
                              R
                           
                         and the LD for each set of results. In what follows, we employ the following abbreviations: N-GA, GA-based comparison using the naive matrix; B-GA, GA-based comparison employing the chemical distance matrix derived from the BLOSUM62 scores; R-GA, GA-based comparison using the Reduced Atchely chemical distance matrix.

The CCR measures the percentage of LBSs residues of the template that have a homologous residue in the query in contact with the ligand. Table 1
                         summarizes the average CCR produced for each of the complex sets using GA-based and TM-Align comparisons. The results indicate that the CCR displays an increase when a GA-based method is employed instead of the structural alignment of the SSFLs. Even when the simple N-GA is relied upon, the average CCR already increases from 0.25 to 0.34 for the NAD set and from 0.22 to 0.32 for the FAD set, respectively.

A statistical analysis of these results, based on the Mann–Whitney test (McKnight and Najab, 2010), also confirms these observations: all the GA-based methods produce significantly higher CCR values than TM-Align (α
                        =0.05, p
                        =0, where α is the significance level and p is the p-value). N-GA yields significantly lower values than B-GA or R-GA (p
                        =0 in both cases). B-GA shows significantly higher values for the NAD library only, with its results showing no significant difference to those of R-GA for the FAD library (p
                        =0.1083).


                        Table 2
                         summarizes the total number of cases for which the structural alignment resulted in a higher CCR than the one obtained using the GA-based methods and vice versa. Since the B-GA resulted in the highest CCR, the B-GA based results are also graphically displayed in Fig. 6
                        . It shows that for the full range of the CCR, the GA-based methods generally reports more observations with higher CCR values. In conclusion, in all cases the GA-based comparisons yield a higher CCR than the structural alignment of SSFLs using TM-align, with the B-GA having the highest values.

To further cross-compare the results from the different similarity methods, the 
                           
                              q
                              str
                              R
                           
                         value was calculated for all the comparisons produced by the different methods. This measure is derived from q
                        
                           str
                        , which was originally described in (Yang et al., 2013). Table 3
                         shows the average values obtained with the different methods. As for the CCR, the 
                           
                              q
                              str
                              R
                           
                         values are higher when GA-based methods are employed, although the differences with the values of the structural alignment by TM-Align are much smaller. The highest values are observed for N-GA, which indicates that the total number of “aligned” (spatially superimposed in this case) residues is a very relevant factor for the 
                           
                              q
                              str
                              R
                           
                         value. The Mann–Whitney test confirms also these observations. The 
                           
                              q
                              str
                              R
                           
                         values obtained using N-GA are significantly higher than those of any other method. The results from B-GA and R-GA do not show significant differences between them (p
                        =0.6069 for the FAD library and p
                        =0.3112 for the NAD library) but both are significantly higher than the values obtained with TM-Align (p
                        =0).

A more detailed comparison of the results obtained by N-GA and TM-Align is shown in Fig. 7
                        . Although the values from N-GA are higher, both methods produce very similar and only two outliers were found. These are described in detail in the case example number 3 below. According to the criteria used by the TM-SITE method, a template that yields a q
                        
                           str
                        
                        >0.65 for a given query is considered a putative template. Although this threshold cannot be applied directly to 
                           
                              q
                              str
                              R
                           
                        , this measure does illustrate the effect of the different methods. Table 4
                         summarizes the number of cases in which the structural alignment gave a 
                           
                              q
                              str
                              R
                           
                         above the threshold and the GA-based methods did not and vice versa. Again, these results show that the GA-based methods produce higher values, although the difference between them is not so evident as in the case of CCR.

As a final measure for quality, the LD between template and query complexes was calculated after each of the GA-based and TM-align comparisons were completed. As noted earlier, a high LD values indicate that the ligands from template and query are distant from each other, implying that the LBSs are not superimposed correctly. Also, a high LD in combination with a high CCR and/or a high 
                           
                              q
                              str
                              R
                           
                         is indicative of a false positive.


                        Fig. 8
                         shows a comparison of the LD values obtained for TM-Align and B-GA comparisons for those cases with high values for either 
                           
                              q
                              str
                              R
                           
                         or CCR (
                           
                              q
                              str
                              R
                           
                         or CCR above 0.5). The B-GA LD values for the cases with a significant 
                           
                              q
                              str
                              R
                           
                         (top row) are well correlated with TM-Align and so are most of the 
                           
                              q
                              str
                              R
                           
                         values (in accordance with the results presented in Fig. 7). Only one outlier (labeled A) was found. This particular case is presented in more detail below as case example 3.

For those cases with a CCR above 0.5 (bottom row) a number of relevant cases were found. Labeled as B are two cases where B-GA resulted in high CCR and LD values (case examples 4 and 5), whereas labels C and D are 23 cases in which B-GA produced higher CCR and lower LD than TM-Align. These are illustrated by the case examples 1 and 2.

A comparison between the q
                        
                           str
                         and CCR values from all methods and sets is provided in Supplementary Fig. 14.

A comparison between the q
                        
                           str
                         and CCR values from all methods and sets is provided in Supplementary Fig. 14.

Five relevant cases are presented below in detail. The values for the CCR, 
                              
                                 q
                                 str
                                 R
                              
                            and LDs produced by the superimpositions generated by TM-Align and B-GA are presented in Table 5
                           
                        

This case illustrates how parts of the sequence outside the LBS can force the sequence-based method to produce a transformation of the template that does not reflect any of its homologies with the query. It also shows how non-LBS residues can cause a low 
                              
                                 q
                                 str
                                 R
                              
                           , independently of the quality of the LBSs superimposition.

TM-Align does not superimpose any of the LBS residues that have homologous contacts with the ligand, as reflected by the CCR value of 0. On the other hand, in the template transformation generated by B-GA, up to 15 residues of the template are superimposed to an homolog in the query structure, resulting in a CCR of 0.625. The LD values further confirm that TM-Align places the template LBS far apart from the query LBS whereas B-GA places both sites close to each other. The low LD value from B-GA indicates that the orientation of both LBSs is also similar, as illustrated in Fig. 9
                           .

This example is similar to the previous one: B-GA produces a superimposition in which the template binding site is on top of the query (LDGA
                           =0.249nm) whereas the structural alignment of the SSFLs places them further apart from each other (LDTM
                           =0.654nm). B-GA reveals a number of homologies between the two LBSs (as reflected by the CCR value of 0.583), while TM-Align only finds one pair of homologous contacts with the ligand in the two structures, yielding a CCR of just 0.041.

The value of 
                              
                                 q
                                 str
                                 R
                              
                            is rather low for both comparison methods and does not reflect the differences in the solutions presented by each of them nor the similarities between the two LBSs. Instead, the 
                              
                                 q
                                 str
                                 R
                              
                           value is guided mostly by the lack of global similarity between the two structures involved.

3ozv has two chains with FAD-binding sites. When comparing them with the FAD-binding site of 1qx4 using TM-Align, both produce larger 
                              
                                 q
                                 str
                                 R
                              
                            values than B-GA (or N-GA, as illustrated in Fig. 7). However, the LD values are also quite large for both TM-Align and B-GA.

Both comparison methods place the ligands from the template and the query more than 1nm away from each other, therefore none of the two LBSs superimpositions suggest a high degree of homology between the two sites. The CCR effectively reflects this fact, assigning low values to the results of both methods, but the 
                              
                                 q
                                 str
                                 R
                              
                           significantly overestimates the quality of the TM-Align result.

TM-Align finds a close geometrical homolog in the query complex for each residue of the template LBS, making the L
                           
                              c
                            and L
                           
                              g
                            factors in Eq. (8) equal to 1 and 0.79 respectively. As illustrated in Fig. 10
                           , both proteins are close structural homologs. However, the chemical similarity is rather low (L
                           
                              s
                           
                           =0.45) and only a few of the homolog residues in the query structure are part of its LBS. Therefore, the solution generated by TM-Align indicates that the FAD-binding site of 1qx4 has a structural homolog in chain A of 3ozv that is not chemically similar nor a FAD-binding site. Since the 
                              
                                 q
                                 str
                                 R
                              
                            does not evaluate whether the residues that the template LBS is superimposed to are part of a binding site, its value for this solution is exceedingly high. Consequently, the use of SSFLs in these cases strongly overestimates the similarity.

The solution proposed by B-GA in this case achieves a higher CCR than the one from TM-Align. The LD, although lower for B-GA than for TM-Align, is also rather high. The result indicates that the best solution found by B-GA orients the LBS of the template opposite to that of the query. This was found twice in the dataset and is a consequence of the fact that the GA-based methods cannot discriminate solutions based on their orientations.

As in the previous example, B-GA results in a larger CCR value than TM-Align, but the LD indicates that the binding sites are not correctly superimposed. From Fig. 11
                            it can be seen that although there is an overlap of LBS residues from both complexes, the binding-sites have different orientations and are occluded by the protein cores in the superimposition.

The S and TM-score values produced by each of the methods were compared with the CCR and the 
                           
                              q
                              str
                              R
                           
                        . The R
                        2 values of the linear regressions shown in Fig. 12
                         suggest that in general terms both S and TM
                        −
                        score are well correlated with CCR and the 
                           
                              q
                              str
                              R
                           
                        . This confirms that in general SSFLs with similar structure (high TM-score values) will also have similar binding sites (high S, 
                           
                              q
                              str
                              R
                           
                         and CCR values).

The fact that many cases do not follow this general trend is highlighted by the precision values associated with each of the regression curves. The structural similarity of SSFLs, assessed by the TM-score values, could only infer 42.8% of the 
                           
                              q
                              str
                              R
                           
                         and 31.6% of the CCR values with an error smaller than the threshold value of 0.05. Using the values of S as predictors produced significantly better results: 46.1% in the case of 
                           
                              q
                              str
                              R
                           
                         and 54.5% in the case of CCR. These precision values of course depend on the definition of true positives. If the threshold value is set to larger values, the precision increases. Using different thresholds shows that both S and TM-score have similar precision when predicting 
                           
                              q
                              str
                              R
                           
                         whereas S always exhibits higher precision values when used to estimate the CCR (Fig. 13
                        ).

Although the R
                        2 values show that in general structural similarities between SSFLs imply similarities in the LBSs in terms of physico-chemical properties and ligand-binding properties, the precision values clearly illustrate that the correlation does in fact not hold in most cases.

@&#DISCUSSION@&#

The present works introduces a method for the comparison of non-sequential protein segments. In order to evaluate the quality of the methodology, it was employed to perform an all-to-all comparison of a set of NAD- and FAD-binding sites. A similar analysis was carried out by means of local structural alignment, using the SSFLs corresponding to each of the binding sites. To asses the results of both methods, the contact conservation rate (CCR), the ligand displacement (LD), and the (‘restricted’) value of the TM-SITE scoring function (
                        
                           q
                           str
                           R
                        
                     ) for each alignment were computed. These measures reflect different aspects of the comparison between binding sites, as may be concluded from the results.

The analysis of the ligand–protein complexes in the BioLIP database convincingly demonstrates that a large number of small ligand binding sites represent only a small fraction of their SSFLs. In other words, the binding sites for ligands other than nucleic acids or peptides are small groups of residues (<40) that are structurally close but separated in the protein sequence. Consequently, relying on the full sequence or the full structure of two proteins to compare their ligand binding sites for estimating their similarity is not the best possible approach. Such an analysis will in most cases lack significant precision, as the vast majority of the residues involved in the comparison are not part of the binding-site. As a result, conclusions based on such a comparison might be incorrect. Relying on sub-sequences or sub-structures such as the SSFLs does improve the precision of these comparisons, as was also demonstrated by Zhang and Skolnick (2004, 2005). However, the LBSs of small ligands are on average less than 17% of the residues in these subsequences. Therefore, the residues that are not part of the binding-sites will still carry most of the weight in the comparison even in these local sequence alignments. Thus, the comparison is largely driven by residues outside the LBS. The present approach resolves this issue by focusing entirely on residues in the LBS that are in direct contact with the ligand.

As already stated by Hoffmann et al. (2010), one cannot define an intrinsic quality for a similarity measure, because there is no absolute reference. Similarity measures can only be judged in context of a particular question of interest. Therefore, one cannot immediately claim that any of the similarity measures presented in the present work is better than the others. Nevertheless, the results of this study illustrate the criteria employed by each similarity measure and how the measured properties relate to each other.

As noted earlier, 
                        
                           q
                           str
                           R
                        
                      is highly affected by its L
                     
                        c
                      factor, emphasizing the number of aligned (superimposed in this case) residues, regardless of their chemical similarities or the geometrical distance between them. Optimizing only the geometrical similarities between sites produces the best results in terms of 
                        
                           q
                           str
                           R
                        
                     . Consequently, N-GA was the method that yielded the highest overall 
                        
                           q
                           str
                           R
                        
                      values. The TM factor in Eq. (8) also significantly affects the final result, giving quite some relevance to the residues that are not directly involved in binding. This is reflected by the fact that the 
                        
                           q
                           str
                           R
                        
                      values obtained by the different methods tend to be rather similar in the vast majority of the cases, simply indicating that the 
                        
                           q
                           str
                           R
                        
                      is rather insensitive to the actual details of LBSs. Moreover, the two example cases for which the values obtained from TM-Align and the GA-based methods were significantly divergent (Fig. 7, case examples 3A and 3B in Table 5) are extreme examples of how the 
                        
                           q
                           str
                           R
                        
                      is influenced by residues outside the LBS.

The process of ligand-binding in proteins is usually very complex, affected by a number of factors unrelated to the crystal structure of LBSs (such as conformational flexibility of the proteins and/or ligands involved, the properties of the surfaces around the LBSs, the influence of long-ranged electrostatic interactions, and so forth). However, one expects that the set of local protein–ligand interactions captured by X-ray or NMR structures of protein–ligand complexes will reveal the most relevant information about the binding process. The CCR defines conserved contacts on the basis of geometry and physico-chemical properties, with the added requirement for residues in both the query and template proteins to be within 5Å from the ligand. Therefore, the CCR is a sensible measure for establishing the similarity in terms of protein–ligand contact patterns in the context of experimentally determined structures. This in turn makes it a very reasonable measure for evaluating the general similarities between two LBSs with respect to their binding properties.

The CCR relies on binding site residues only and thus it is not affected by the rest of the protein. This makes the CCR and 
                        
                           q
                           str
                           R
                        
                      effectively uncorrelated, with several cases exhibiting discrepant values. The results revealed several cases where a high CCR was not reflected by a high value of the 
                        
                           q
                           str
                           R
                        
                      (case examples 1 and 2 in Table 5). Most importantly, the CCR highlights the differences between the results of the GA-based methods and those obtained by local structural alignment of SSFLs.

The values of R
                     2 obtained from the linear regressions shown in Fig. 7 show that both TM-score and S have a strong correlation with 
                        
                           q
                           str
                           R
                        
                     , meaning that in general SSFLs with similar structures will include LBSs with similar geometry and physico-chemical features. The CCR is strongly correlated with S but notedly not with TM
                     −
                     score. This implies that, in general, sites with similar structure and physico-chemical properties will exhibit similar patterns of protein–ligand contacts, independent of the structural similarities of their SSFLs.

The precisions computed for each of the linear regressions in Fig. 7 give insight in the relations between the different similarity measures. Although there are some clear general trends, the low precision of the correlations indicate that in the vast majority of cases neither the 
                        
                           q
                           str
                           R
                        
                      nor the CCR values can be inferred correctly by the values of S or TM-score. According to these results, however, S is clearly the best predictor for CCR, but using S to estimate the CCR will still incur significant errors when a very high precision is required (i.e. ≪0.05). Even though there is no precise numerical relation between S and CCR, the results in this study clearly show that the transformations that maximize S are also the ones that obtain the highest CCR values (Tables 1 and 2 and Fig. 6).

The lack of information about the similarity of the local structure surrounding the LBS makes it possible for irregular overlaps to obtain high CCR values. Binding sites that are superimposed partially or fully occluding each other may still result in a high CCR value, if a large number of their residues overlap. The LD values confirmed that this situation occurred in two cases where the GA-based methods were used (see case examples 4 and 5). The fact that the binding sites are superimposed with different orientations does not necessarily imply that one is dealing with a false positive, but it is of course a meaningless one in the context of most applications. Therefore it would be very useful to be able to discriminate those solutions that imply divergent orientations so that suboptimal solutions in terms of S that maintain the “correct” orientation could be presented. This possibly could be achieved either by extending the structures, including residues outside the LBS, although that introduces a bias in the method, as noted above, or by keeping track of the orientation of each residue in the LBS with respect to the surface, which might not be a trivial task.

The results presented in this work indicate that the BLOSUM62 matrix appears to be the most adequate similarity matrix to compare residue types and maximize the CCR. The Reduced Atchely matrix R produced lower numbers when the results were evaluated both by the CCR and the 
                        
                           q
                           str
                           R
                        
                     , although significant differences with the B-GA results were observed only for CCR for the NAD library. Both the CCR and the 
                        
                           q
                           str
                           R
                        
                      are biased towards BLOSUM62: the L
                     
                        s
                      factor of 
                        
                           q
                           str
                           R
                        
                      is in fact explicitly based on it and the residue homology criteria used in the CCR (“aliphatic”, “polar”, and so forth) fits BLOSUM62 better than the R matrix. Because of the rationale used in building the R matrix, the “raw” results based upon R-GA (Eq. (1)) might show a better correlation with empirical measures than B-GA, such as the affinity for a specific ligand, given that it is based exclusively on physico-chemical properties and does not consider residue conservation.

Applying the GA-based methods to the proteins of each of the test sets revealed similarities in the binding sites of proteins with divergent structures and sequences. In a number of cases, these similarities were found among proteins that did not even share local structural similarities and therefore cannot be detected by the structural alignment of their SSFLs (e.g. case examples 1 and 2). The LD for these case indicated that the binding sites also shared the same orientation, meaning that they are in fact homologs. In total, 21 relevant (CCR≥0.5) LBSs homologies were detected by the GA-based methods that were overlooked (CCR≤0.25) by the structural alignment of their SSFLs. This suggests that the similarity analysis presented in this work should provide a more sensitive way of comparing disparate sets of residues.

The success of the GA-based methods validates two important aspects of the approach taken in this study to solve the problem of comparing non-sequential protein fragments: the representation of LBSs and the definition of similarity implied by function (1). As a minimal requirement, using C
                     
                        α
                      atoms to represent protein fragments appears to be already sufficient to carry out fairly accurate comparisons, as suggested by Feldman and Labute (2010). More refined representations that make use of all the atoms present in the structures (Sehnal et al., 2012; Gold and Jackson, 2006) assume that the structural information is reliable to a level which can be beyond their actual level of precision. These approaches neglect the fact that
                        
                           •
                           There is some uncertainty in the position of the atoms in the X-ray structures. For instance, the B-factor values of the structures used in the present study have an average value of 35.151Å2 for the whole structure (protein and ligand). According to (McRee, 1999)


                              
                                 
                                    (10)
                                    
                                       
                                          B
                                          i
                                       
                                       =
                                       8
                                       
                                          π
                                          2
                                       
                                       
                                          U
                                          i
                                          2
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    U
                                    i
                                    2
                                 
                               is the mean square displacement of atom i, the B-factor values observed correspond to an average displacement of 0.667Å. The protein atoms closer than 5Å to the ligand were only slightly more stable and presented similar values. Their average B
                              
                                 i
                               was of 31.256Å2, which corresponds to an average displacement of 0.629Å.

Protein structures are flexible. The crystallization conditions restrict this flexibility and may alter protein structures, thus the atomic positions observed in the X-ray structures might be different from those in solution. Sikic et al. (2010) and Andrec et al. (2007) illustrated this by computing differences between X-ray and NMR structures obtained for the same proteins. According to their results, the average RMSD for the backbone atoms is at least 1.4Å (depending on the method used to superimpose structures) between the X-ray structures and the averaged NMR ones. Thus, the interatomic distances for different structures of the same protein can differ depending on the method used to obtain them.

The atomic positions diverge among homologous structures (Chothia and Lesk, 1986).

A similar assumption is made by Powers et al. (2011), where the minimum distance from each residue to a ligand is included as part of the representation. Such very detailed descriptions are clearly not suitable for the purpose of computing similarity.

The definition of similarity used by the GA-based methods does not treat geometrical similarity as a continuous value but rather as a threshold. This approach is different from the one used in most of the other methods, where a distance of zero between residues is seen as maximum geometrical similarity and larger distances are given decreasing similarity values. Using a threshold is both a more strict and a more relaxed criteria: superimposed residues do not contribute to the total value of S unless their C
                     
                        α
                      are closer than 2.5Å but on the other hand any two residues whose C
                     
                        α
                     are closer than the cutoff are considered identical in terms of spatial location. This attempts to reconcile the need for geometrical similarity with the fact structures are imperfect, diverge among homologs and represent flexible proteins.

This treatment of geometrical similarities somewhat resembles that of CPASS (Powers et al., 2011), although in the present work the 2.5Å cutoff is justified by the quality and the nature of the data. CPASS judges residues to be geometrically identical if the RMSD is smaller than 1.0Å. Pairs of residues separated by larger distances after superimposition have their contribution to the similarity function reduced exponentially. According to the studies by Chothia and Lesk (1986) and by Rost (1999), the average RMSD of the backbone atoms of homologous structures can be as high as 1.48Å. Using the CPASS criteria, a pair of aligned residues separated by 1.48Å contributes only 61.87% of its original score to the similarity. Therefore, a cutoff of just 1Å followed by an exponential decay is rather questionable. Query3D (Ausiello et al., 2005) uses a 0.7Å cutoff to establish geometrical similarity, an even more stricter and more questionable value. Moreover, it is measured using the C
                     
                        α
                     atoms and the geometric average of the side chain atoms, which requires not only the positions but also the orientation of the residue's side chains of the two structures being compared to be homologous.

The approach taken here to compare physico-chemical properties is the opposite. The differences in these properties are measured here in a continuous scale through a chemical similarity matrix whereas other methods generally use binary functions which consider two residues either identical if they belong to the same “type” and different otherwise. For instance, ProteMiner-SSM (Chang et al., 2004) and Query3D (Ausiello et al., 2005) make use of a substitution matrix to discard those pairings of residues below a given score threshold. Therefore, the contribution to the similarity function of different amino acid pairs is the same for many different pair types. Consequently, such approaches offer a limited improvement over methods that consider geometrical features only. Methods relying on an all-atom representation of the structures generally do not use substitution matrices and instead require the atom elements of all paired atoms to be the same (Gold and Jackson, 2006; Sehnal et al., 2012). This is a very restrictive approach, especially in the case of SiteBinder (Sehnal et al., 2012), which requires that the two structures being compared have the same number of atoms of each atom element in both structures. Homologous sites might present substitutions of one residue for another of a different type that has a similar functionality. These changes would be seen as significant divergences by methods using an all-atom representation, although at the residue level they may not have any biological relevance.

Among the existing methodologies, CPASS relies on a similarity function that is the closest to the one used in this study. However, it significantly weights down the contribution of aligned or paired residues not only by their geometrical divergence (as discussed above), but also by the closeness of the residues to a ligand. The definition of similarity always requires a measure of the distance to ligand for each residue. This can either be computed directly if a ligand is present in the structures or estimated by the distance from the residues to the COM of an user-defined LBS. The use of a “distance to ligand” was justified by the claim that the residue closest to the ligand should be given more relevance. But no evidence in support of this claim is presented and, again, the fact that one residue has the smallest distance in a given X-ray or NMR structure does not necessarily imply that this is also the case in solution or in the normal biological environment of the proteins (Laskowski, 2005; Spronk et al., 2004). Also, long range electrostatic interactions between distant residues or chemical group in the protein and the ligand are know to have significant contributions to the free energy of binding (Juffer et al., 1991; Xin and Juffer, 2007), further limiting the validity of such approaches. Moreover, it has not been demonstrated that using the COM of the LBS is an effective substitute for computing a distance to ligand. As this distance is always required for CPASS’ similarity function, CPASS in its current form may not be suitable for comparing structures other than ligand-binding sites, for which the “distance to ligand” concept is completely irrelevant or where weighting the residues by their COM would not make any sense. In addition, CPASS assumes that the atom to atom or the atom to COM distances measured for the structures are entirely precise, ignoring the uncertainty in the atom positions, the crystallization effects and that both ligands and proteins have inherent flexibility.

The effectiveness of the different approaches to the sequence-independent structural alignment problem is yet to be further examined. The quality of the different available methods can only be determined from a purely pragmatic point of view, for instance assessing their ability to perform template-based predictions of ligand-binding sites on protein surfaces. This question will be addressed in an forthcoming study that compares the predictive power of several methods on a large dataset of ligand-binding sites.

A method able to evaluate the similarity among binding sites in such a way that it is correlated to their similarities in terms of physico-chemical features, or better yet, affinities for a given ligand, would be an invaluable tool for drug discovery. This tool could be used to compare newly discovered structures against databases of known binding sites and predict whether or not the new structure can bind a given ligand.

@&#CONCLUSIONS@&#

The present work convincingly demonstrates that for the evaluation of ligand-binding site similarity, one should concentrate on residues that are actually involved in binding. The inclusion of residues outside the LBS as in comparisons relying on SSFLs may lead to incorrect measures for similarity, and, consequently, may result in erroneous conclusions with regard to binding site properties. The GA-based methods developed here can in principle be employed for the comparison of any kind non-sequential fragments, e.g. binding sites found in the interfaces of dimers, as it is irrelevant whether or not LBS residues belong to one or more amino acid chains.

The results from the present work also revealed that the 
                        
                           q
                           str
                           R
                        
                      (a ‘restricted’ version of q
                     
                        str
                      employed in TM-SITE) is strongly influenced by residues outside the LBS and their structural similarities. Consequently, it is not a suitable measure for establishing the similarity of LBSs on the basis of their geometrical and physico-chemical properties.

The CCR was employed as a criteria to evaluate whether if two sites have homologous contacts with a given ligand. However, it requires prior information on the location of the ligand in the query structure and therefore cannot be used for prediction of LBSs. The results presented in this study show that the transformations of query structures that maximize the value of S based on the BLOSUM62 matrix are also transformations that obtain the highest CCR values. We thus conclude that for establishing similarity between sets of residues each representing a LBS, maximizing S (e.g. using B-GA) represents a superior method over sequence-based procedures.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.compbiolchem.2015.12.004.

The following are the supplementary data to this article:


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

