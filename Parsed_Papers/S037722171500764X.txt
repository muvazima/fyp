@&#MAIN-TITLE@&#Enhanced models and improved solution for competitive biofuel supply chain design under land use constraints

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study effects of farmland use regulation to balance food and biofuel production.


                        
                        
                           
                           We propose two models with a land use constraint and a cap-and-trade mechanism.


                        
                        
                           
                           We propose two adaptive “relax-and-tighten” schemes to solve the DC-MPEC models.


                        
                        
                           
                           Our algorithms outperform publicly available solvers for problems in realistic sizes.


                        
                        
                           
                           Cap-and-trade level affects supply chain behavior and should be carefully selected.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Food versus fuel debate

Biofuel supply chain

Non-cooperative game

Farmland use regulations

DC-MPEC

@&#ABSTRACT@&#


               
               
                  This paper studies the effect of government regulation on farmland use to balance food and energy production in a competitive biofuel supply chain design framework. We propose a Stackelberg–Nash game model with a direct land-use constraint that captures farmland, food, and fuel market equilibrium. To provide farmers with incentives to comply with the land-use regulation, we implement the land-use constraint through a cap-and-trade mechanism which we show attains equivalent land-use patterns. We further prove the existence of optimal solutions of the two equivalent discretely constrained mathematical program with equilibrium constraints (DC-MPEC) models. Two adaptive “relax-and-tighten” schemes, integrality and Lagrangian duality based relaxation, are proposed to handle the binary variables in a mixed integer formulation of the models. The proposed methodology is tested in a case study for the State of Illinois. The computational results demonstrate the superiority of our customized algorithms to publicly available solvers for solving problems with realistic sizes. Finally, the efficiency of the cap-and-trade mechanism is demonstrated through comparisons of scenarios with and without regulation as well as a sensitivity analysis on the cap-and-trade level. The cap-and-trade policy is found to effectively reduce biomass farmland use and profits of the biofuel industry. It may have different impacts on social welfare depending on problem settings and market parameters. Cap-and-trade levels also affect system behavior and thus should be carefully selected.
               
            

@&#INTRODUCTION@&#

Increasing concerns over environmental Enhanced sustainability and energy security have led to a series of environmental and energy regulations and government subsidies for bio-energy production in recent years. As a result, the annual production of bio-ethanol in the U.S. has grown from 200 million gallons in 1983 to about 13 billion gallons by the end of 2010 (Brown, Orwig, Nemeth, & Rocha, 2007). The recent congressional mandate (US-EPA, 2007) further requires the annual bio-ethanol production to reach 36 billion gallons by 2022, of which over 80 percent must be based on cellulosic biomass feedstocks such as crop residues (e.g., corn stover) and dedicated energy crops (e.g., switchgrass and miscanthus). In observance of the mandatory requirement, the ethanol production industry is expected to grow as the technology continues to improve toward maturity. The bio-ethanol manufacturing infrastructure (particularly the cellulose-based ones) needs to be significantly expanded to provide sufficient production capacity and ensure overall efficiency and reliability of the bioenergy supply chain.

The expected growth in U.S. biofuel consumption induces further demand for bio-energy crops including first (e.g., from arable crops) and second generations of biomass (e.g., woody or fibrous biomass). The new outlet for these agricultural commodities results in competition between food and energy use of the limited farmland. In other words, biomass feedstock production would have an impact on the food market through new farmland allocation, including direct land-use change (i.e., direct conversion of land from some other use into biomass production) and indirect land-use change (i.e., a cascade of land use offset elsewhere) (USDA, 2011). Empirical observations have provided evidence of the direct impacts. Biofuel production has been criticized for reducing corn supply and raising food prices in recent years (Rajagopal, Sexton, Hochman, Roland-Holst, & Zilberman, 2009). According to Oladosu et al. (2011) and IAPC (2012), the share of corn being used for ethanol production has increased up to more than 40 percent in 2010 compared to only 10 percent in 2004/2005, and corn prices reached record high levels in 2010/2011 (e.g., more than 3.5 times of those in 2005). In light of the ever-increasing food demand and food price, the development of a biofuel supply chain (e.g., locating biorefineries and producing and transporting feedstocks) and the resulting changes in farmland use has imposed pressing challenges on food security for a growing global population. Hence, it is critical for policy makers to regulate agricultural and energy production so as to achieve a balance between food and energy supplies. Marginal lands
                        1
                     
                     
                        1
                        These lands are with little immediate usefulness due to problems with access, water control, topography, environmental restrictions, or other such factors.
                      hold the promise to accommodate large scale production of cellulosic biomass in the future. It has been estimated that about 22 million hectares of idle cropland, marginal land can yield about 377 million dry tons of biomass in the U.S. (Perlack et al., 2005). However, the potential for economically reclaiming the marginal lands and the extent to which farmers would be willing to utilize marginal lands under economic incentives remain unclear (Rajagopal, Sexton, Roland-Holst, & Zilberman, 2007).

The expansion of the biofuel industry has strong implications on multiple related engineering, social, and economic infrastructure systems (Ng, Cai, & Ouyang, 2011). For example, the establishment of the biofuel supply chain would attract farmers to divert agricultural land use from food crop production to energy crop production. As a result, future land-use patterns and business modes at local, regional and national levels may be affected. Furthermore, farmers face a wide variety of risks such as crop yield uncertainties, market prices volatility, and regulation/policy changes. Given the inflexibility and cost associated with farmland-use variations (e.g., crop rotations), farmers will need to develop a complex long-term plan for using their existing land (such as growing one or more types of crops), purchasing or selling farmland, as well as optionally enrolling part of their land in the government-led Conservation Reserve Program (CRP) (USDA-FSA, 2011). The triple challenge of land use competition among food, fuel and environmental conservation is referred as “farmland use trilemma” (University of Minnesota, 2009). On the other hand, the high cost of building new refineries and transporting biomass feedstocks mandates careful selection of biorefinery locations and sufficient provision of economic incentives encouraging farmers to supply feedstocks — the farmers’ land-use decisions and market equilibria for food, fuel, and farmland must be taken into account. As such, both farmers and biofuel manufacturers depend upon one another in making long-term plans (Keeney & Hertel, 2009). Since the cellulosic biomass market is still new, there is interest in mitigating various uncertainties in the market through long-term contracts between farmers and biofuel manufacturers (Larson, English, & He, 2008). Furthermore, government regulations/policies may directly affect the strategic planning of the farmland use and the biofuel supply chain. It is highly complex to design a sustainable biofuel supply chain system that involves the biofuel manufacturer, farmers, food and fuel consumers, and satisfies government regulations.

In this paper, we explore the possibility of imposing government regulation policies on farmland use to balance food and energy production, and investigate the impacts of such regulations on (i) a biofuel manufacturer’s supply chain design, (ii) farmers’ land use including the option of reclaiming marginal land, and (iii) the food, energy and land market equilibria. In a recent paper (Bai, Ouyang, & Pang, 2012), we introduced a binary-constrained Stackelberg–Nash game model to optimize a biofuel supply chain under competitive agricultural land use and feedstock market equilibrium. It provided a fundamental framework to model food-versus-fuel competition and evaluate market and social impacts of biofuel industry growth. However, it does not fully capture additional issues such as the farmland use trilemma, farmland trading, and possible marginal land reclamation and acquisition. It also does not address the challenge of involving government regulations or policies to mitigate the impacts of the biofuel industry on food markets and food security. In this paper, we extend the previously proposed Stackelberg–Nash game framework in Bai et al. (2012) to incorporate more land-use options including CRP enrollment and the possibility of marginal land reclamation in a land market. The enhanced model is a better representation of the problem realism, thus providing deeper economic insights. We further consider a regulation scenario through land use constraints. Since in practice it is hard to impose any land-use constraints directly on farmers, we implement these regulations by providing farmers with incentives to limit energy crop production. To this end, we propose a cap-and-trade mechanism (Chen, Liu, & Hobbs, 2011c; Zhao, Hobbs, & Pang, 2010) for farmland use which is shown to theoretically attain the same regulation goal as the explicit land-use constraints. We further prove the existence of optimal solutions to these equivalent Stackelberg–Nash models.

The proposed Stackelberg–Nash game models fall into the class of DC-MPECs, which have been studied in the literature. Yet to date there are few approaches that can efficiently solve such problems for even moderately sized instances; see e.g., the reformulation approach in Bai et al. (2012). This paper also makes a major contribution in solution methodology by developing two adaptive “relax-and-tighten” schemes to handle the binary variables in a mixed integer formulation of this class of DC-MPEC problems. The proposed algorithms (based on integrality and Lagrangian relaxation) are shown to be effective in solving the proposed competitive supply chain model for instances with realistic sizes, and significantly outperform existing applicable solvers including CPLEX and NLPEC. We apply our model and solution approach to a case study for the State of Illinois, and conduct a before-and-after analysis to illustrate the impacts of the proposed land-use regulation on supply chain design and farmland-use patterns. The proposed cap-and-trade mechanism is found to improve the total social welfare in some cases. Finally, economic insights are drawn on how policy makers could improve the social benefit and how biofuel companies could design a sustainable biofuel supply chain.

The remainder of this paper is organized as follows. Section 2 reviews related research on biofuel economic analysis and MPEC models. Section 3 first presents a base model for biofuel supply chain design with explicit farmland-use constraints, and then reformulates the model to implement the land-use constraints via a cap-and-trade mechanism. Equivalence and feasibility of these two formulations are also presented. Section 4 develops the proposed solution approach, which first transforms the original DC-MPEC problem into an equivalent single-level mixed integer quadratic program (MIQP), and then solves the MIQP by two adaptive “relax-and-tighten” algorithms. Section 5 illustrates the Illinois case study where computational results are shown for a series of scenarios with different problem sizes. Section 6 concludes the paper and discusses possible future research.

@&#LITERATURE REVIEW@&#

Biofuel’s long-term socio-economic impacts have been studied with focus on food-versus-fuel competition (Chen, Huang, Khanna, & Onal, 2011b; Johansson & Azar, 2007; Rajagopal et al., 2009; Walsh, De La Torre Ugarte, Shapouri, & Slinsky, 2003), agricultural land-use shifts from conventional food crops to energy feedstocks (Dicks et al., 2009; Khanna, Dhungana, & Clifton-Brown, 2008), and the potential of converting the reserved land (e.g., acres enrolled in CRP) (Ferris & Joshi, 2010; Mapemba, 2005). Past studies have conducted economic analyses to assess the global and national impacts of the expanding biofuel industry, mainly by means of partial equilibrium (Benjamin & Houee-Bigot, 2007; Chen et al., 2011b; Rajagopal et al., 2009), general equilibrium (Gehlhar, Somwaru, Dixon, Rimmer, & Winston, 2010; Keeney & Hertel, 2009; Tyner & Taheripour, 2008), and simulation models (Dicks et al., 2009; Gallagher, Shapouri, Price, Schamel, & Brubaker, 2003; Walsh et al., 2003). For example, McNew and Griffith (2005) build a spatial econometric model to estimate spatial distributions of crop prices and farmers’ benefits after building refineries in local areas. Most of these studies evaluate macro-economic performances or make future projections based on existing data. Generally, the behavioral mechanism behind the competition between the new biofuel industry and existing food markets has not been carefully studied in these literature. Such mechanism is particularly important in the case when we consider the interdependent interest and decisions of individual farmers, biofuel manufacturers and local food markets (Tyner & Taheripour, 2008).

Another branch of existing research addresses biofuel supply chain optimization under various circumstances (Bai, Hwang, Kang, & Ouyang, 2011; Huang, Chen, & Fan, 2010; Kang, Onal, Ouyang, Scheffran, & Tursun, 2010; Tursun, Kang, Onal, Ouyang, & Scheffran, 2008). These studies either assume exogenously given farmland use and market prices, or make suboptimal sequential decisions on farmland allocation, refinery location, and ethanol production/distribution (Berkes, Colding, & Folke, 2003; Berkes & Seixas, 2005). Besides, most of these studies assume a centralized decision-making process, in which the decisions of different stakeholders are made in cooperation to minimize the total cost of the entire supply chain (Kang et al., 2010). In reality, individual farmers and biofuel manufacturers usually have different, if not conflicting, objectives of maximizing their own profits. Unfortunately, the existing biofuel supply chain design literature has largely ignored the noncooperative behavior of the farmers and biofuel companies, nor the market equilibrium, or any additional complicating factors such as government regulations that intervene with energy and food production. Only recently, Bai et al. (2012) makes an initial exploration of modeling a decentralized biofuel system in which a biofuel manufacturer and multiple farmers have different optimization objectives. Luo and Miller (2013) further adopted a similar game theoretic approach to model the penetration of cellulosic ethanol into the overall ethanol market. The needed incentives for farmers and ethanol producers to participate in cellulosic biofuel production to meet the mandate in 2022 were estimated. In addition, Wang, Ouyang, Yang, and Bai (2013) and Christensen and Siddiqui (2015) modeled the multiple supply chain parties and markets including obligated blenders and Renewable Identification Number (RIN) by mixed complementarity problem (MCP). While Wang et al. (2013) focused on design of supply chain and impacts of the mandate under different competitive market scenarios, Christensen and Siddiqui (2015) mainly considered biomass import and biodiesel markets. Nevertheless, none of these models have explicitly addressed farmers’ land use trilemma (among food, energy, and reservation) with the option of marginal lands, nor have they considered possible solutions to the food-versus-fuel debate, e.g., through farmland use regulations to balance food and energy production.

In this paper, we develop a cap-and-trade regulatory mechanism for implementing the land-use constraint. The cap-and-trade mechanism has been initially proposed to control green-house gas emissions from decentralized electricity generation plants via the energy market (Chen et al., 2011c; Zhao et al., 2010). It is a market-based approach that provides economic incentives to pollutant producers for achieving reductions in the emissions. Each firm holds a certain amount of initial allowances for emission generation, but such allowances are tradable in an allowance market, so that firms that generate more emissions have to buy allowances from those that have surpluses. Generally, the total amount of allowances cannot exceed a system-wide cap which limits the total emissions of all plants (Tietenberg, 2006). Applying this concept to the farmland use regulation, an authority (such as the government) sets an upper limit for the total energy crop production (i.e., in terms of the corresponding land use) in the entire system so as to protect food production. It also allocates some initial free allowances to each farmer. An allowance market will be formed among the farmers to endogenously determine the price at which extra allowances will be traded.

On the methodology side, the most relevant problem may probably be the competitive facility location problem which is first discussed in Hotelling (1929) regarding two firms competing for resources in a linear market (with consumers distributed uniformly along the line). Hotelling’s ground-breaking work was improved in the 1930s and 1940s by a number of studies under modified economic assumptions (Lerner & Singer, 1937; Smithies, 1941). Later, game-theoretical models were applied by Tobin and Friesz (1986) to examine the case of a profit-maximizing firm that enters a market to compete against several other plants. These models were generalized by Friesz, Tobin, and Miller (1989) to a Stackelberg game that allows the entering firm to determine not only production levels but also the sites of its plants. Due to the mathematical complexity of these models, the development of effective solution algorithms is generally limited to heuristics. For example, Miller, Friesz, and Tobin (1992) developed several heuristic methods that are based on the approach of variational inequalities.

Later, Luo, Pang, and Ralph (1996) rigorously analyzed a general class of MPECs, which has been widely used to solve and analyze problems related to optimal design of taxation, tolls, as well as related hierarchical decision making problems. Most analytical achievements for solving MPECs have been for the continuous problems (e.g., linear or quadratic program with complementarity constraints (LP/QPCC)), including the development of a group of commercial solvers (Bai, Mitchell, & Pang, 2013; Hu, Mitchell, Pang, Bennett, & Kunapuli, 2008; Hu, Mitchell, Pang, & Yu, 2012; Mitchell, Pang, & Yu, 2010). Recently, Steffensen and Ulbrich (2010) proposed a relaxation scheme for solving MPECs combining a regularization scheme and relaxing only the degenerate complementarity conditions; Siddiqui and Gabriel (2013) transformed the MPEC using Schur’s decomposition and special ordered set (SOS) Type 1 variables, and further developed a penalty-based heuristic algorithm to obtain local solutions to large-scale MPECs.

For our research, the DC-MPEC with discrete design variables is of particular relevance (Gabriel, Shim, Conejo, De La Torre, & Garcia-Bertrand, 2010; Garcia-Bertrand, Conejo, & Gabriel, 2006). The DC-MPECs have not been extensively studied in the literature, and to date there are few approaches that can effectively solve large-scale instances of such problems. Among the limited efforts, Gabriel and Leuthold (2010) uses disjunctive constraints and linearization to reformulate a DC-MPEC for a network-constrained energy market into a mixed integer linear program (MILP). Besides, Bai et al. (2012) reformulates the DC-MPEC model into to a solvable mixed integer quadratic program (MIQP) after a series of transformations based on the Karush–Kuhn–Tucker (KKT) conditions. This solution approach is able to find an optimal solution to only small size instances, partly due to the large number of integer variables that are associated with the complementarity constraints. Therefore, it is important to develop new effective solution approaches that can be used to tackle the large scale DC-MPEC problem instances. As a step toward this direction, this paper develops two customized solution algorithms that can effectively solve instances with realistic sizes of the proposed DC-MPEC model utilizing recent advances on MPECs and the state-of-art techniques for integer programs. We also prove the equivalence between the cap-and-trade mechanism and the direct land constraints under the Stackelberg–Nash game framework, and the existence of optimal solutions to these two DC-MPEC formulations.

In this section, we propose two competitive biofuel supply chain design models, in which a biofuel company establishes a new biofuel supply chain in anticipation of farmers’ land-use decisions (e.g., land acquisition, food or energy feedstock production) under market equilibrium. We also introduce agricultural regulations that protect the food supply chain from losing excessive amount of farmland to the energy industry. To this end, we first propose a base model with direct land-use constraints, and then an equivalent model which indirectly implements the land-use constraints through a cap-and-trade mechanism.

Suppose the biofuel company can select refinery locations out of a set J of candidate locations, and we denote this decision by the binary variable xj
                      ∈ {0, 1}, ∀j ∈ J, where 
                        
                           
                              x
                              j
                           
                           =
                           1
                        
                      if location j is selected; 
                        
                           
                              x
                              j
                           
                           =
                           0
                        
                      otherwise. We consider a static problem with an implicit assumption that a refinery location once selected will have a refinery built in the first year and operating regularly in all years during its service life. Building a refinery at location j ∈ J of capacity cj
                      incurs a one-time fixed capital cost hj
                     .
                        2
                     
                     
                        2
                        The fixed facility costs are amortized into annual values so as to be consistent with the yearly land allocation, yield, and other cost coefficients.
                     
                     ,
                     
                        3
                     
                     
                        3
                        Fixed refinery capacity is assumed for simplicity. Additional discrete capacity values can be endogenously incorporated by introducing additional binary variables in a multi-type facility location framework.
                      Another decision variable for the biofuel company is the contract price offer pj
                     , j ∈ J to farmers for each unit of biomass feedstock supply at refinery j, and it should be bounded from below by the minimum biomass production cost 
                        p
                      . To stay focused, we do not consider in detail the downstream biofuel market, but simply assume that all produced biofuel is sold in an exogenous energy market (e.g., blending facility) at an endogenously determined market price (for which the biofuel company is a price taker). There is a set I of farmers who sell part of their yields to a set M of existing food markets (e.g., local grain elevators, ports of export) or reserve their land through CRP. Suppose each farmer i ∈ I initially owns gi
                      units of farmland, and it can acquire additional land at cost S(s
                     ℓ), which is a (supply) function of the total reclaimed marginal land s
                     ℓ. Specifically, S(·) is assumed to have the following property:

                        
                           
                              
                                 S
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 0
                                 ,
                                 S
                                 
                                    (
                                    
                                       s
                                       ℓ
                                    
                                    )
                                 
                                 ≥
                                 0
                                 ,
                                 
                                    
                                       d
                                       S
                                       (
                                       
                                          s
                                          ℓ
                                       
                                       )
                                    
                                    
                                       d
                                       
                                          s
                                          ℓ
                                       
                                    
                                 
                                 >
                                 0
                                 ,
                                 ∀
                                 
                                    s
                                    ℓ
                                 
                                 >
                                 0
                                 ,
                                 and
                                 
                                 
                                    S
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                                 
                                 exists
                                 .
                              
                           
                        
                     With the emergence of biorefineries, each farmer needs to determine the acquisition and allocation of its farmland among three choices: (i) use fim
                      units of land to grow food crops for food markets m ∈ M; (ii) use fij
                      units of land to grow energy crops for refinery j ∈ J; and (iii) enroll ri
                      units of land into the CRP program. As such, the total amount of land that farmer i actually uses is 
                        
                           
                              ∑
                              
                                 k
                                 ∈
                                 M
                                 ∪
                                 J
                              
                           
                           
                              f
                              
                                 i
                                 k
                              
                           
                           +
                           
                              r
                              i
                           
                           ,
                        
                      and if this quantity exceeds gi
                     , farmer i would have to purchase (or lease) additional marginal land. The transactions of land endogenously determine the land price p
                     ℓ ≥ 0.

We further assume the prices of food crops, biofuel and (marginal) land are determined respectively by market equilibrium in perfectly competitive markets. We use pm
                     (·), pr
                     (·) and pe
                     (·) to denote the inverse demand functions in food market m ∈ M, the CRP land enrollment market, and the biofuel market, respectively. Finally, we assume that farmer i bears the unit transportation cost dim
                      and dij
                      (per quantity-distance) to each market m ∈ M and refinery at j ∈ J, so the transportation costs are proportional to the physical distances between farms and food markets, and candidate refinery locations. Fig. 1
                      shows the trilemma and interactions among different stakeholders, and Table 1
                      summarizes the notations of input parameters and decision variables.

If the government would like to limit the farmland use for energy purposes, one straightforward way is to impose direct land-use constraints as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                       
                                          f
                                          
                                             i
                                             j
                                          
                                       
                                       ≤
                                       α
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   M
                                                   ∪
                                                   J
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                r
                                                i
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                           
                        where constraint (1) stipulates that the total land use for growing energy crops should not exceed a percentage α of the total land use 
                           
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       M
                                       ∪
                                       J
                                    
                                 
                                 
                                    f
                                    
                                       i
                                       k
                                    
                                 
                                 +
                                 
                                    r
                                    i
                                 
                                 )
                              
                           
                        . This percentage is an input parameter to the model, and is set by policy makers.

As such, given refinery locations x≜{xj
                        }
                           j ∈ J
                        , the biomass procurement prices at these refineries pJ
                        ≜{pj
                        }
                           j ∈ J
                        , the food crop prices at existing food markets pm
                        (·), and price for the CRP land pr
                        (·), the optimization problem for a generic farmer i ∈ I to determine its land-use decision vector 
                           
                              
                                 
                                    f
                                    ^
                                 
                                 i
                              
                              ≜
                              
                                 
                                    (
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    k
                                    ∈
                                    M
                                    ∪
                                    J
                                 
                              
                           
                         and 
                           
                              
                                 r
                                 ^
                              
                              i
                           
                         is proposed as follows
                           4
                        
                        
                           4
                           The hat in 
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       i
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          f
                                          ^
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    ,
                                 
                               and 
                                 
                                    
                                       r
                                       ^
                                    
                                    i
                                 
                               is used to distinguish the decision variables of the farmer i from those of other farmers in the set I that are anticipated by the farmer i.
                        :

                           
                              (2a)
                              
                                 
                                    
                                       
                                          
                                             
                                                maximize
                                                
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      i
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                         ^
                                                      
                                                      i
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   [
                                                   
                                                      p
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            f
                                                            ^
                                                         
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            
                                                               ∈
                                                               I
                                                               ∖
                                                               
                                                                  {
                                                                  i
                                                                  }
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   p
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                         ^
                                                      
                                                      i
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         
                                                            ∈
                                                            I
                                                            ∖
                                                            
                                                               {
                                                               i
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      r
                                                      ^
                                                   
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2b)
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      
                                                         ∈
                                                         I
                                                         ∖
                                                         
                                                            {
                                                            i
                                                            }
                                                         
                                                      
                                                   
                                                
                                                
                                                   f
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      j
                                                   
                                                
                                                ≤
                                                
                                                   c
                                                   j
                                                
                                                
                                                   x
                                                   j
                                                
                                                ,
                                                
                                                ∀
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2c)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      M
                                                      ∪
                                                      J
                                                   
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      r
                                                      ^
                                                   
                                                   i
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      
                                                         ∈
                                                         I
                                                         ∖
                                                         
                                                            {
                                                            i
                                                            }
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         r
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            M
                                                            ∪
                                                            J
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            k
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   s
                                                   ℓ
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2d)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            f
                                                            ^
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            
                                                               ∈
                                                               I
                                                               ∖
                                                               
                                                                  {
                                                                  i
                                                                  }
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            j
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             ≤
                                             α
                                             
                                                {
                                                
                                                   
                                                      
                                                         r
                                                         ^
                                                      
                                                      i
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         
                                                            ∈
                                                            I
                                                            ∖
                                                            
                                                               {
                                                               i
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         k
                                                         ∈
                                                         M
                                                         ∪
                                                         J
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               
                                                                  ∈
                                                                  I
                                                                  ∖
                                                                  
                                                                     {
                                                                     i
                                                                     }
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function (2a) maximizes the profit for farmer i ∈ I including revenue from growing food crops, biomass, and CRP, respectively. Constraint (2b) ensures that feedstocks can only be shipped and sold to candidate location j only if there is a refinery, and the total inbound flow should not exceed the capacity cj
                        . Constraint (2c) limits the total farmland farmers actually allocates by the total existing land plus the total reclaimed marginal land. Constraint (2d) is re-written from (1) in order to differentiate farmer i’s decision variable 
                           
                              
                                 f
                                 ^
                              
                              
                                 i
                                 j
                              
                           
                         with those of other farmers (which are exogenous to farmer i’s problem).

Besides, the market-clearing condition is 
                           
                              
                                 s
                                 ℓ
                              
                              =
                              
                                 S
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    p
                                    ℓ
                                 
                                 )
                              
                           
                         where

                           
                              (3)
                              
                                 
                                    
                                       
                                          p
                                          ℓ
                                       
                                       ∈
                                       
                                          argmax
                                          
                                             
                                                p
                                                ℓ
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            p
                                                            ℓ
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                        
                                                                           i
                                                                           ∈
                                                                           I
                                                                        
                                                                     
                                                                     
                                                                        [
                                                                        
                                                                           
                                                                              r
                                                                              i
                                                                           
                                                                           −
                                                                           
                                                                              g
                                                                              i
                                                                           
                                                                           +
                                                                           
                                                                              ∑
                                                                              
                                                                                 k
                                                                                 ∈
                                                                                 M
                                                                                 ∪
                                                                                 J
                                                                              
                                                                           
                                                                           
                                                                              f
                                                                              
                                                                                 i
                                                                                 k
                                                                              
                                                                           
                                                                        
                                                                        ]
                                                                     
                                                                  
                                                               
                                                               ︸
                                                            
                                                            
                                                               total
                                                               
                                                               marginal
                                                               
                                                               land
                                                               
                                                               use
                                                            
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      total
                                                      
                                                      marginal
                                                      
                                                      land
                                                      
                                                      revenue
                                                   
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∫
                                                               0
                                                               
                                                                  p
                                                                  ℓ
                                                               
                                                            
                                                            
                                                               S
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               λ
                                                               )
                                                            
                                                            d
                                                            λ
                                                         
                                                      
                                                      ︸
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  total
                                                                  
                                                                  marginal
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  land
                                                                  
                                                                  cost
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                }
                                             
                                             ︸
                                          
                                          
                                             social
                                             
                                             benefit
                                             
                                             of
                                             
                                             marginal
                                             
                                             land
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     

Note that all the constraints in the farmers’ problems:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                c
                                                j
                                             
                                             
                                                x
                                                j
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ∈
                                             J
                                             ,
                                             
                                             
                                                (
                                                
                                                   λ
                                                   j
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   r
                                                   i
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      k
                                                      ∈
                                                      M
                                                      ∪
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                
                                                   s
                                                   ℓ
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                ,
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             and
                                             
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        are shared by (i.e., common to) all the farmers’ problems. Thus, the game that concatenates all these optimization problems is an instance of a Generalized Nash equilibrium (GNE), for which there is an extensive literature; see (Facchinei & Kanzow, 2007; Facchinei & Pang, 2009) for recent surveys of this type of competitive games. In the Karush–Kuhn–Tucker (KKT) conditions stated below for problem (2), we postulate that the above constraints have the same multipliers, which we denote by λj, p
                        ℓ and pa
                        , respectively. Demonstrating that the concatenation of these conditions has a solution would provide a proof that the farmers’ game problem has a Nash equilibrium solution that is essentially based on the existence results for a variational inequality (VI) from (Facchinei and Pang, 2003, Proposition 2.2.3) .

                           Proposition 1
                           
                              The farmers’ problem 
                              (2) 
                              has a solution.
                           

See Appendix A.□

The following theorem shows that the VI solution is also a Nash equilibrium solution, which can be proved by applying Theorem (Pang & Fukushima, 2005, Theorem 2).

                           Theorem 1
                           
                              Suppose that the functions (pm
                              )
                                 m ∈ M
                              , pr, and S are continuous and satisfy the following properties:
                              
                                 
                                    
                                       (a)
                                    
                                    
                                       for every scalar a ≥ 0, the function
                                       
                                          
                                             τ
                                             ↦
                                             τ
                                             
                                                p
                                                m
                                             
                                             
                                                (
                                                τ
                                                +
                                                a
                                                )
                                             
                                          
                                        
                                       is concave and
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      p
                                                      m
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   τ
                                                
                                             
                                             ≤
                                             0
                                          
                                       
                                       ;
                                    


                                       for every scalar a ≥ 0, the function
                                       
                                          
                                             τ
                                             ↦
                                             τ
                                             
                                                p
                                                r
                                             
                                             
                                                (
                                                τ
                                                +
                                                a
                                                )
                                             
                                          
                                        
                                       is concave and
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      p
                                                      r
                                                   
                                                   
                                                      (
                                                      τ
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   τ
                                                
                                             
                                             ≤
                                             0
                                          
                                       
                                       ;
                                    


                                       
                                          
                                             
                                                lim sup
                                                
                                                   
                                                      τ
                                                      r
                                                   
                                                   →
                                                   ∞
                                                
                                             
                                             
                                                τ
                                                r
                                             
                                             
                                                p
                                                r
                                             
                                             
                                                (
                                                
                                                   τ
                                                   r
                                                
                                                )
                                             
                                             +
                                             
                                                lim sup
                                                
                                                   
                                                      
                                                         {
                                                         
                                                            τ
                                                            m
                                                         
                                                         }
                                                      
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   →
                                                   ∞
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                τ
                                                m
                                             
                                             
                                                p
                                                m
                                             
                                             
                                                (
                                                
                                                   τ
                                                   m
                                                
                                                )
                                             
                                             
                                             ≤
                                             
                                             0
                                          
                                       
                                       ;
                                    


                                       either
                                       
                                          
                                             
                                                lim sup
                                                
                                                   
                                                      τ
                                                      r
                                                   
                                                   →
                                                   ∞
                                                
                                             
                                             
                                                τ
                                                r
                                             
                                             
                                                p
                                                r
                                             
                                             
                                                (
                                                
                                                   τ
                                                   r
                                                
                                                )
                                             
                                             +
                                             
                                                lim sup
                                                
                                                   
                                                      
                                                         {
                                                         
                                                            τ
                                                            m
                                                         
                                                         }
                                                      
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   →
                                                   ∞
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                τ
                                                m
                                             
                                             
                                                p
                                                m
                                             
                                             
                                                (
                                                
                                                   τ
                                                   m
                                                
                                                )
                                             
                                             
                                             <
                                             
                                             0
                                          
                                        
                                       or
                                       
                                          
                                             max
                                             {
                                             
                                                max
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                [
                                                
                                                   sup
                                                   
                                                      
                                                         τ
                                                         m
                                                      
                                                      >
                                                      0
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      
                                                         p
                                                         m
                                                      
                                                      
                                                         (
                                                         
                                                            τ
                                                            m
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         τ
                                                         m
                                                      
                                                   
                                                
                                                ]
                                             
                                             ,
                                             
                                             
                                                sup
                                                
                                                   
                                                      τ
                                                      r
                                                   
                                                   >
                                                   0
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      p
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         τ
                                                         r
                                                      
                                                      )
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      τ
                                                      r
                                                   
                                                
                                             
                                             }
                                             
                                             <
                                             
                                             0
                                             ,
                                          
                                       
                                    


                                       S(s) is a strictly increasing function for s ≥ 0 and
                                       
                                          
                                             S
                                             (
                                             0
                                             )
                                             =
                                             0
                                          
                                       
                                       ;
                                    

The conditions (a)–(d) are satisfied if pr
                               and all pm
                               are strictly decreasing linear functions of the form 
                                 
                                    τ
                                    ↦
                                    α
                                    −
                                    β
                                    τ
                                 
                               for some positive constants α and β.

In anticipation of the Nash equilibrium resulting from the farmers’ collective decisions (2), the biofuel company tries to enter the market and makes decisions on refinery locations xj
                        , ∀j ∈ J and feedstock procurement prices pj
                        , ∀j ∈ J. In this problem, it is reasonable to assume that the biofuel company makes its decision first to which farmers react by making their land use decisions, and the biofuel company knows ex ante that the farmers observes and reacts to its action. So our model is essentially a Stackelberg–Nash game in the form of the following DC-MPEC where the biofuel company is the leader and multiple farmers are the followers:

                           
                              (4a)
                              
                                 
                                    
                                       
                                          
                                             
                                                maximize
                                                
                                                   
                                                      p
                                                      J
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   p
                                                   e
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   h
                                                   j
                                                
                                                
                                                   x
                                                   j
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   p
                                                   j
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4b)
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             
                                             
                                                x
                                                j
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4c)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             
                                                p
                                                ̲
                                             
                                             
                                                x
                                                j
                                             
                                             ≤
                                             
                                                p
                                                j
                                             
                                             ≤
                                             
                                                p
                                                ¯
                                             
                                             
                                                x
                                                j
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             
                                                f
                                                i
                                             
                                             ,
                                             
                                                r
                                                i
                                             
                                             
                                             solves
                                             
                                             (2)
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             I
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The objective function (4a) maximizes the biofuel company’s profit from producing and selling biofuel at unit price pe
                        (∑
                           j ∈ J
                        ∑
                           i ∈ I
                        
                        fij
                        ), minus the capital cost for building refineries ∑
                           j ∈ J
                        
                        hjxj
                         and the biomass feedstock procurement cost ∑
                           j ∈ J
                        
                        pj
                        ∑
                           i ∈ I
                        
                        fij
                        . Constraints (4b) define binary variables. We add constraints (4c) to specify the value range of pj
                         at j ∈ J, and parameter 
                           
                              p
                              ¯
                           
                         is an upper bound for pJ
                         under the linear demand functions which will be derived in subsequent sections.

The base model (4) introduced in the last section directly imposes land-use constraints to farmers. In reality, the government may want to impose these hard constraints externally rather than leaving them for the farmers to implement because it may be difficult to enforce them. To accomplish this goal, we consider a more practically feasible cap-and-trade mechanism that provides incentives for farmers to limit their land use for producing energy crop. We will clarify later how this alternative model is related to the base model (4), in fact the two models are equivalent under appropriate specifications of some model parameters, with both models yielding the same land allocations for the farmers.

In the proposed cap-and-trade system, the government sets a cap (i.e., an upper limit) E on the total land use for energy crop production, and it also allocates some initial free production allowances to each farmer. We follow the capacity-based allocation rule proposed in Chen, Li, and Ouyang (2011a) to determine the number of a farmer’s land-use allowances, which is proportional to the farmer’s total land capacity 
                           
                              
                                 ∑
                                 
                                    k
                                    ∈
                                    M
                                    ∪
                                    J
                                 
                              
                              
                                 f
                                 
                                    i
                                    k
                                 
                              
                              +
                              
                                 r
                                 i
                              
                              ,
                           
                         i.e., the initially owned land plus the traded (i.e., bought or sold land). The parameter α is now interpreted as the free allowance granted per unit acre of land capacity (i.e., percentage of land yield). Therefore the initial allowances for farm i are 
                           
                              α
                              [
                              
                                 r
                                 i
                              
                              +
                              
                                 ∑
                                 
                                    k
                                    ∈
                                    M
                                    ∪
                                    J
                                 
                              
                              
                                 f
                                 
                                    i
                                    k
                                 
                              
                              ]
                           
                        . Farmers need to trade for extra allowances if they want to grow more energy crops than the initial allocation, and the trading price is a variable denoted by 
                           
                              
                                 p
                                 ˜
                              
                              a
                           
                        . Furthermore, farmland is traded at a price p
                        ℓ. In deciding the land use for energy or food crop, each farmer includes as constraints only the refinery capacities but adjust their profit to include revenue (or loss) due to farm land trades and the externally provided (dis)incentive for energy crop production, i.e., the last term in (5).
                           5
                        
                        
                           5
                           If the last two terms are positive, a farmer gains revenue from selling land and allowance, while if they are negative, these are costs that the farmer pays for land and allowance.
                         This results in the optimization problem for farmer i:

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                maximize
                                                
                                                   
                                                      
                                                         f
                                                         ^
                                                      
                                                      i
                                                   
                                                   ,
                                                   
                                                      
                                                         r
                                                         ^
                                                      
                                                      i
                                                   
                                                   ≥
                                                   0
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                
                                                   [
                                                   
                                                      p
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               f
                                                               ^
                                                            
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               
                                                                  ∈
                                                                  I
                                                                  ∖
                                                                  
                                                                     {
                                                                     i
                                                                     }
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      f
                                                      ^
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      r
                                                      ^
                                                   
                                                   i
                                                
                                                
                                                   p
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            r
                                                            ^
                                                         
                                                         i
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            
                                                               ∈
                                                               I
                                                               ∖
                                                               
                                                                  {
                                                                  i
                                                                  }
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         r
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               g
                                                               i
                                                            
                                                            −
                                                            
                                                               
                                                                  r
                                                                  ^
                                                               
                                                               i
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  M
                                                                  ∪
                                                                  J
                                                               
                                                            
                                                            
                                                               
                                                                  f
                                                                  ^
                                                               
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         p
                                                         ℓ
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   profit
                                                   
                                                   or
                                                   
                                                   loss
                                                   
                                                   in
                                                   
                                                   farmland
                                                   
                                                   trade
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                
                                                   
                                                      
                                                         {
                                                         
                                                            α
                                                            
                                                               [
                                                               
                                                                  
                                                                     
                                                                        r
                                                                        ^
                                                                     
                                                                     i
                                                                  
                                                                  +
                                                                  
                                                                     ∑
                                                                     
                                                                        k
                                                                        ∈
                                                                        M
                                                                        ∪
                                                                        J
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        f
                                                                        ^
                                                                     
                                                                     
                                                                        i
                                                                        k
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  ∈
                                                                  J
                                                               
                                                            
                                                            
                                                               
                                                                  f
                                                                  ^
                                                               
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                         
                                                         }
                                                      
                                                      
                                                         
                                                            p
                                                            ˜
                                                         
                                                         a
                                                      
                                                   
                                                   ︸
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               incentive
                                                               
                                                               payment
                                                               
                                                               of
                                                               
                                                               energy
                                                               
                                                               crop
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               production
                                                               
                                                               within
                                                               
                                                               the
                                                               
                                                               allowances
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                       
                                          
                                             
                                             (
                                             2
                                             b
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where the two prices p
                        ℓ and 
                           
                              
                                 p
                                 ˜
                              
                              a
                           
                         satisfy the following market-clearing conditions expressed in complementarity form:

                           
                              (6)
                              
                                 
                                    
                                       0
                                       ≤
                                       
                                          
                                             p
                                             ˜
                                          
                                          a
                                       
                                       ⊥
                                       E
                                       −
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                       
                                          f
                                          
                                             i
                                             j
                                          
                                       
                                       ≥
                                       0
                                       ,
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       0
                                       ≤
                                       
                                          p
                                          ℓ
                                       
                                       ⊥
                                       
                                          S
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             p
                                             ℓ
                                          
                                          )
                                       
                                       +
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          g
                                          i
                                       
                                       −
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          (
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   M
                                                   ∪
                                                   J
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   k
                                                
                                             
                                             +
                                             
                                                r
                                                i
                                             
                                          
                                          )
                                       
                                       ≥
                                       0
                                       .
                                    
                                 
                              
                           
                        
                     

In summary, we present our extended Stackelberg–Nash model under the land-use cap-and-trade mechanism as follows:

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                maximize
                                                
                                                   
                                                      p
                                                      J
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                       
                                          
                                             (
                                             4
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             (
                                             4
                                             b
                                             )
                                             ,
                                             (
                                             4
                                             c
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                f
                                                i
                                             
                                             ,
                                             
                                                r
                                                i
                                             
                                             
                                             solves
                                             
                                             (5),
                                             
                                             (6)
                                             
                                             and
                                             
                                             (7)
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             I
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It is not difficult to verify the following two connections between the base game (2) and the cap-trade game (5)–(7):

                           Proposition 2
                           
                              The base model 
                              (4) 
                              and the cap-and-trade model 
                              (8) 
                              are equivalent in the following sense:
                              
                                 
                                    
                                       (a)
                                    
                                    
                                       Any Nash equilibrium solution of the base model 
                                       (4) 
                                       also solves the cap-and-trade model 
                                       (8)
                                       ;
                                    


                                       If
                                       
                                          
                                             (9)
                                             
                                                
                                                   E
                                                   ≤
                                                   α
                                                   
                                                      [
                                                      
                                                         
                                                            S
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               p
                                                               ℓ
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            g
                                                            i
                                                         
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                       holds, then any Nash equilibrium solution of the cap-and-trade model 
                                       (8) 
                                       with land price p
                                       ℓ > 0 and allowance price
                                       
                                          
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             ,
                                          
                                        
                                       and is also a Nash equilibrium solution of the base game with
                                       
                                          
                                             
                                                p
                                                ˜
                                             
                                             a
                                          
                                        
                                       being the multiplier of the constraint 
                                       (2d)
                                       .
                                    

See Appendix B.□

Model (8) above lays the foundation for us to develop solution methods. We will concentrate on developing efficient solution approaches and study how the land-use regulation could affect the economic behavior of the biofuel company, farmers, and food/land markets.

To facilitate the development of solution approaches, we assume linear demand in food markets, i.e., function 
                        
                           
                              p
                              m
                           
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 f
                                 
                                    i
                                    m
                                 
                              
                              )
                           
                           =
                           
                              a
                              
                                 1
                                 m
                              
                           
                           −
                           
                              a
                              
                                 2
                                 m
                              
                           
                           
                              ∑
                              
                                 i
                                 ∈
                                 I
                              
                           
                           
                              f
                              
                                 i
                                 m
                              
                           
                           ,
                           
                              a
                              
                                 1
                                 m
                              
                           
                           >
                           0
                           ,
                           
                              a
                              
                                 2
                                 m
                              
                           
                           >
                           0
                           ,
                           ∀
                           m
                           ∈
                           M
                           ,
                        
                      and linear price relationship for the CRP land, i.e., 
                        
                           
                              p
                              r
                           
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 r
                                 i
                              
                              )
                           
                           =
                           
                              b
                              1
                           
                           −
                           
                              b
                              2
                           
                           
                              ∑
                              
                                 i
                                 ∈
                                 I
                              
                           
                           
                              r
                              i
                           
                           ,
                           
                              b
                              1
                           
                           >
                           0
                           ,
                           
                              b
                              2
                           
                           >
                           0
                        
                     . We first adopt a disjunctive reformulation method to transform model (8) into an equivalent single level MIQP based on the KKT conditions of the farmers’ problems.

Shared by all the farmers, the coupled constraints in (2b) for all i ∈ I are satisfied at any solution of the farmers’ Nash Equilibrium, so it follows that the farmers have common multipliers for the coupled constraints, which we denote by λj
                         for j ∈ J. Plug the demand functions into the KKT optimality condition (21) of farmer i’s optimization problem with market-clearing conditions, and we deduce, for all i ∈ I:

                           
                              (10a)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                f
                                                
                                                   i
                                                   m
                                                
                                             
                                          
                                       
                                       
                                          
                                             ⊥
                                             
                                                d
                                                
                                                   i
                                                   m
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   1
                                                   m
                                                
                                             
                                             +
                                             
                                                a
                                                
                                                   2
                                                   m
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         m
                                                      
                                                   
                                                
                                                ]
                                             
                                             −
                                             α
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             +
                                             
                                                p
                                                ℓ
                                             
                                             ≥
                                             0
                                             ,
                                             m
                                             ∈
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (10b)
                              
                                 
                                    
                                       
                                          
                                             0
                                             ≤
                                             
                                                r
                                                i
                                             
                                          
                                       
                                       
                                          
                                             ⊥
                                             
                                                p
                                                ℓ
                                             
                                             −
                                             α
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             −
                                             
                                                b
                                                1
                                             
                                             +
                                             
                                                b
                                                2
                                             
                                             
                                                [
                                                
                                                   r
                                                   i
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   r
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                ]
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             21
                                             b
                                             )
                                             ,
                                             (
                                             21
                                             d
                                             )
                                             ,
                                             (
                                             21
                                             f
                                             )
                                             ,
                                             (
                                             21
                                             e
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We find that the summation of bilinear terms ∑
                           j ∈ J
                        
                        pj
                        ∑
                           i ∈ I
                        
                        fij
                         in the leader’s objective function can be rewritten as a convex quadratic function of the decision variables based on KKT conditions; the reformulation approach is similar to those used in Hobbs, Metzler, and Pang (2000) and Bai et al. (2012), to which interested readers are referred for complete procedures.

                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   p
                                                   j
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                =
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                
                                                
                                                   {
                                                   
                                                      a
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      a
                                                      
                                                         1
                                                         m
                                                      
                                                   
                                                   }
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   c
                                                   j
                                                
                                                
                                                   λ
                                                   j
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   [
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   −
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      r
                                                      i
                                                      2
                                                   
                                                   −
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                p
                                                ℓ
                                             
                                             
                                                [
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        which expresses, for fixed refinery location x, the (nonconvex) sum of products ∑
                           j ∈ J
                        
                        pj
                        ∑
                           i ∈ I
                        
                        fij
                         in terms of the sum of several convex quadratic terms, if a
                        2m
                        , b
                        2 > 0 and 
                           
                              
                                 p
                                 ℓ
                              
                              
                                 S
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    p
                                    ℓ
                                 
                                 )
                              
                           
                         is convex.

In order to reformulate the complementarity constraints into disjunctive ones, the following proposition derives theoretical upper bounds for pJ
                        , 
                           
                              
                                 
                                    p
                                    ˜
                                 
                                 a
                              
                              ,
                           
                         and p
                        ℓ, which is critical for developing upper bounds for all other variables.

                           Proposition 3
                           
                              Price variables 
                              pJ
                              , p
                              ℓ, 
                                 
                                    
                                       p
                                       ˜
                                    
                                    a
                                 
                               
                              are bounded from above. Furthermore, the following upper bounds are always valid for optimal solutions to problem 
                              (8) 
                              as follows: 
                              
                                 
                                    
                                       
                                          
                                             p
                                             j
                                          
                                          ≤
                                          
                                             p
                                             e
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             j
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                ˜
                                             
                                             a
                                          
                                          ≤
                                          
                                             1
                                             
                                                1
                                                −
                                                α
                                             
                                          
                                          
                                             max
                                             
                                                j
                                                ∈
                                                J
                                                ,
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             {
                                             
                                                p
                                                j
                                             
                                             −
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                          ≤
                                          
                                             1
                                             
                                                1
                                                −
                                                α
                                             
                                          
                                          
                                             max
                                             
                                                j
                                                ∈
                                                J
                                                ,
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             {
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                j
                                             
                                             −
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             a
                                             ′
                                          
                                          ,
                                       
                                    
                                 
                               
                              
                                 
                                    
                                       
                                          
                                             p
                                             ℓ
                                          
                                          ≤
                                          max
                                          
                                             {
                                             S
                                             
                                                (
                                                max
                                                
                                                   {
                                                   
                                                      0
                                                      ,
                                                      
                                                         l
                                                         ¯
                                                      
                                                      −
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            g
                                                            i
                                                         
                                                      
                                                   
                                                   }
                                                
                                                )
                                             
                                             ,
                                             
                                                max
                                                
                                                   j
                                                   ∈
                                                   J
                                                   ,
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                }
                                             
                                             }
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             ℓ
                                          
                                          ,
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       l
                                       ¯
                                    
                                    =
                                    max
                                    
                                       {
                                       0
                                       ,
                                       
                                          ∑
                                          
                                             m
                                             ∈
                                             M
                                          
                                       
                                       
                                          
                                             
                                                a
                                                
                                                   1
                                                   m
                                                
                                             
                                             −
                                             
                                                d
                                                
                                                   i
                                                   m
                                                
                                             
                                          
                                          
                                             a
                                             
                                                2
                                                m
                                             
                                          
                                       
                                       }
                                    
                                    +
                                    
                                       
                                          b
                                          1
                                       
                                       
                                          b
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                          
                                             i
                                             ∈
                                             J
                                          
                                       
                                       
                                          c
                                          j
                                       
                                    
                                 
                              
                              .
                           

See Appendix C.□

From the bounds for pJ
                         and 
                           
                              
                                 
                                    p
                                    ˜
                                 
                                 a
                              
                              ,
                           
                         the desired bounds for all other complementarity constraints can be obtained readily. We bound the sum 
                           
                              
                                 f
                                 
                                    i
                                    m
                                 
                              
                              +
                              
                                 ∑
                                 
                                    
                                       i
                                       ′
                                    
                                    ∈
                                    I
                                 
                              
                              
                                 f
                                 
                                    
                                       i
                                       ′
                                    
                                    m
                                 
                              
                           
                         from the above:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ≤
                                             
                                             min
                                             
                                                {
                                                max
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                               
                                                                  1
                                                                  m
                                                               
                                                            
                                                            −
                                                            
                                                               d
                                                               
                                                                  i
                                                                  m
                                                               
                                                            
                                                            +
                                                            α
                                                            
                                                               
                                                                  p
                                                                  ¯
                                                               
                                                               a
                                                               ′
                                                            
                                                         
                                                         
                                                            a
                                                            
                                                               2
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                +
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         ℓ
                                                      
                                                      ¯
                                                   
                                                   )
                                                
                                                }
                                             
                                             ≜
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                
                                                   i
                                                   m
                                                
                                                sum
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        so that ∀i ∈ I, m ∈ M
                        
                           
                              (12a)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                ≤
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      i
                                                      m
                                                   
                                                   sum
                                                
                                                ≜
                                                
                                                   
                                                      f
                                                      ¯
                                                   
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12b)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   m
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   1
                                                   m
                                                
                                             
                                             +
                                             
                                                a
                                                
                                                   2
                                                   m
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         m
                                                      
                                                   
                                                
                                                ]
                                             
                                             −
                                             α
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             +
                                             
                                                p
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                             
                                                d
                                                
                                                   i
                                                   m
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   1
                                                   m
                                                
                                             
                                             +
                                             
                                                a
                                                
                                                   2
                                                   m
                                                
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                
                                                   i
                                                   m
                                                
                                                sum
                                             
                                             +
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                ℓ
                                             
                                             ≜
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                
                                                   i
                                                   m
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Similarly, we have

                           
                              
                                 
                                    
                                       r
                                       i
                                    
                                    +
                                    
                                       ∑
                                       
                                          
                                             i
                                             ′
                                          
                                          ∈
                                          I
                                       
                                    
                                    
                                       r
                                       
                                          i
                                          ′
                                       
                                    
                                    ≤
                                    
                                       
                                          α
                                          
                                             
                                                p
                                                ¯
                                             
                                             a
                                             ′
                                          
                                          +
                                          
                                             b
                                             1
                                          
                                       
                                       
                                          b
                                          2
                                       
                                    
                                    ≜
                                    
                                       
                                          r
                                          ¯
                                       
                                       
                                          s
                                          u
                                          m
                                       
                                    
                                    ,
                                 
                              
                           
                        so that ∀i ∈ I
                        
                           
                              (13a)
                              
                                 
                                    
                                       
                                          
                                             r
                                             i
                                          
                                       
                                       
                                          
                                             
                                                ≤
                                                
                                                   1
                                                   2
                                                
                                                
                                                   
                                                      r
                                                      ¯
                                                   
                                                   
                                                      s
                                                      u
                                                      m
                                                   
                                                
                                                ≜
                                                
                                                   
                                                      r
                                                      ¯
                                                   
                                                   i
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13b)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   ℓ
                                                
                                                −
                                                α
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                −
                                                
                                                   b
                                                   1
                                                
                                                +
                                                
                                                   b
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      r
                                                      i
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                ℓ
                                             
                                             +
                                             
                                                b
                                                2
                                             
                                             
                                                
                                                   r
                                                   ¯
                                                
                                                
                                                   s
                                                   u
                                                   m
                                                
                                             
                                             ≜
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                i
                                                r
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        and ∀i ∈ I, j ∈ J
                        
                           
                              (14a)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                ≤
                                                
                                                   min
                                                   
                                                      {
                                                      
                                                         α
                                                         
                                                            1
                                                            −
                                                            α
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               f
                                                               ¯
                                                            
                                                            
                                                               i
                                                               m
                                                            
                                                            sum
                                                         
                                                         +
                                                         
                                                            
                                                               r
                                                               ¯
                                                            
                                                            
                                                               s
                                                               u
                                                               m
                                                            
                                                         
                                                         ]
                                                      
                                                      ,
                                                      
                                                         c
                                                         j
                                                      
                                                      }
                                                   
                                                   ≜
                                                   
                                                      
                                                         f
                                                         ¯
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14b)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                p
                                                j
                                             
                                             +
                                             
                                                λ
                                                j
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             +
                                             
                                                p
                                                ℓ
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                a
                                                ′
                                             
                                             +
                                             
                                                
                                                   p
                                                   ℓ
                                                
                                                ¯
                                             
                                             ≜
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Besides, we can see from (21b) that

                           
                              (15)
                              
                                 
                                    
                                       λ
                                       j
                                    
                                    ≥
                                    −
                                    
                                       d
                                       
                                          i
                                          j
                                       
                                    
                                    +
                                    
                                       p
                                       j
                                    
                                    −
                                    
                                       (
                                       1
                                       −
                                       α
                                       )
                                    
                                    
                                       
                                          p
                                          ˜
                                       
                                       a
                                    
                                    −
                                    
                                       p
                                       ℓ
                                    
                                    ,
                                 
                              
                           
                        implying that 
                           
                              
                                 p
                                 ¯
                              
                              j
                           
                         would be a valid bound for λj
                        , ∀j ∈ J; i.e., 
                           
                              
                                 λ
                                 j
                              
                              ≤
                              
                                 
                                    p
                                    ¯
                                 
                                 j
                              
                              ,
                              ∀
                              j
                              ∈
                              J
                           
                        .

As such, we use integers to implement all complementarity constraints and in doing so obtain an equivalent MIQP formulation of the MPEC model (8):

                           
                              (16a)
                              
                                 
                                    
                                       
                                          
                                             
                                                maximize
                                                
                                                   x
                                                   ,
                                                   
                                                      p
                                                      J
                                                   
                                                   ,
                                                   f
                                                   ,
                                                   r
                                                   ,
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                         ˜
                                                      
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                
                                                   p
                                                   e
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   h
                                                   j
                                                
                                                
                                                   x
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                −
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            M
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   c
                                                   j
                                                
                                                
                                                   λ
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             −
                                             
                                             
                                                p
                                                ℓ
                                             
                                             
                                                (
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                −
                                                
                                                
                                                   ∑
                                                   
                                                      m
                                                      ∈
                                                      M
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   {
                                                   
                                                      a
                                                      
                                                         2
                                                         m
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      a
                                                      
                                                         1
                                                         m
                                                      
                                                   
                                                   }
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   [
                                                   
                                                      b
                                                      1
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   −
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      r
                                                      i
                                                      2
                                                   
                                                   −
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16b)
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             
                                             
                                                x
                                                j
                                             
                                             ,
                                             
                                                y
                                                j
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             j
                                             ∈
                                             J
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16c)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             
                                                u
                                                i
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             I
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16d)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             w
                                             ,
                                             v
                                             ∈
                                             {
                                             0
                                             ,
                                             1
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16e)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             
                                                z
                                                
                                                   i
                                                   m
                                                
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             I
                                             ,
                                             j
                                             ∈
                                             J
                                             ,
                                             m
                                             ∈
                                             M
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16f)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                             ,
                                             
                                             all
                                             
                                             
                                                m
                                                ∈
                                                M
                                             
                                             ,
                                             
                                             and
                                             
                                             all
                                             
                                             
                                                j
                                                ∈
                                                J
                                             
                                             :
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             
                                                p
                                                ̲
                                             
                                             
                                                x
                                                j
                                             
                                             ≤
                                             
                                                p
                                                j
                                             
                                             ≤
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                j
                                             
                                             
                                                x
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16g)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                f
                                                
                                                   i
                                                   m
                                                
                                             
                                             ≤
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                
                                                   i
                                                   m
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16h)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                d
                                                
                                                   i
                                                   m
                                                
                                             
                                             −
                                             
                                                a
                                                
                                                   1
                                                   m
                                                
                                             
                                             +
                                             
                                                a
                                                
                                                   2
                                                   m
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         m
                                                      
                                                   
                                                
                                                ]
                                             
                                             −
                                             α
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             +
                                             
                                                p
                                                ℓ
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                
                                                   i
                                                   m
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16i)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                f
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                z
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16j)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             
                                                p
                                                j
                                             
                                             +
                                             
                                                λ
                                                j
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                α
                                                )
                                             
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             +
                                             
                                                p
                                                ℓ
                                             
                                             ≤
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16k)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                r
                                                i
                                             
                                             ≤
                                             
                                                
                                                   r
                                                   ¯
                                                
                                                i
                                             
                                             
                                                u
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16l)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                p
                                                ℓ
                                             
                                             −
                                             α
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             −
                                             
                                                b
                                                1
                                             
                                             +
                                             
                                                b
                                                2
                                             
                                             
                                                [
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   r
                                                   
                                                      i
                                                      ′
                                                   
                                                
                                                +
                                                
                                                   r
                                                   i
                                                
                                                ]
                                             
                                             ≤
                                             
                                                
                                                   γ
                                                   ¯
                                                
                                                i
                                                r
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   u
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16m)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                λ
                                                j
                                             
                                             ≤
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                j
                                             
                                             
                                                y
                                                j
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16n)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                0
                                                ≤
                                                
                                                   c
                                                   j
                                                
                                                
                                                   x
                                                   j
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ≤
                                                
                                                   c
                                                   j
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      y
                                                      j
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16o)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                p
                                                ℓ
                                             
                                             ≤
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                ℓ
                                             
                                             w
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16p)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                0
                                                ≤
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            M
                                                            ∪
                                                            J
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         r
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                                (
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         ¯
                                                      
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                )
                                             
                                             
                                                (
                                                1
                                                −
                                                w
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16q)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             0
                                             ≤
                                             
                                                
                                                   p
                                                   ˜
                                                
                                                a
                                             
                                             ≤
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                a
                                                ′
                                             
                                             v
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16r)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                                
                                                0
                                                ≤
                                                α
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            M
                                                            ∪
                                                            J
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      +
                                                      
                                                         r
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             ≤
                                             
                                             α
                                             
                                                [
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                         ¯
                                                      
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                                ]
                                             
                                             
                                                (
                                                1
                                                −
                                                v
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16s)
                              
                                 
                                    
                                       
                                          
                                       
                                       
                                          
                                             
                                             and
                                             
                                             for
                                             
                                             all
                                             
                                             
                                                j
                                                ∈
                                                J
                                             
                                             ,
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                            +
                                                            
                                                               y
                                                               j
                                                            
                                                            ≥
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               j
                                                            
                                                            ≥
                                                            
                                                               z
                                                               
                                                                  i
                                                                  j
                                                               
                                                            
                                                            ,
                                                            
                                                            ∀
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where binary variables z
                        
                           M
                        ≜{zim
                        }, z
                        
                           J
                        ≜{zij
                        }, u, y, w, v, are introduced to reformulate the complementarity constraints (21b), (10a), (10b), (21d), (21e), and (21f), respectively, based on the equivalence relationship 
                           
                              x
                              ≤
                              
                                 x
                                 ¯
                              
                              ,
                           
                        
                        
                           
                              y
                              ≤
                              
                                 y
                                 ¯
                              
                              ,
                           
                        
                        
                           
                              x
                              ⊥
                              y
                              ⇔
                              x
                              ≤
                              
                                 x
                                 ¯
                              
                              z
                              ,
                              y
                              ≤
                              
                                 y
                                 ¯
                              
                              
                                 (
                                 1
                                 −
                                 z
                                 )
                              
                              ,
                              z
                              ∈
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                           
                        .

The upshot of the above derivation is a reformulation of the original bi-level Stackelberg–Nash game model (DC-MPEC) into an equivalent concave MIQP; the latter can be directly solved by existing MIQP solvers (e.g., CPLEX) for small instances. In order to handle larger-scale cases, we next develop customized decomposition algorithms to tackle such MIQPs, i.e., two adaptive “relax-and-tighten” schemes based on integrality relaxation (IR) and Lagrangian relaxation (LR) in an iterative framework.

We first present the generic algorithm framework that could be used to solve general MPEC problems, and then explain in detail the customized implementation using IR and LR approaches in the following sections.

For each iteration n, let Fn
                            denote the set of constraints of a subproblem to be solved (i.e., un-relaxed constraints), and Rn
                            denote the set of relaxed constraints (i.e., that are not enforced in the subproblem). So 
                              
                                 
                                    F
                                    n
                                 
                                 ∪
                                 
                                    R
                                    n
                                 
                                 ,
                                 ∀
                                 n
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                              
                            defines the feasible region V of the original MIQP (16). For this particular problem, the majority of complementaries is in (10a) and (21b) especially when the scales is large, which makes the equivalent MIQP (16) quite challenging to solve for even moderately sized instances. As such, the algorithm starts with relaxing all of the constraints related to complementaries (10a) and (21b) (i.e., 
                              
                                 
                                    R
                                    1
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       16
                                       e
                                       )
                                    
                                    ,
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    j
                                    ∈
                                    J
                                    ,
                                    m
                                    ∈
                                    M
                                    }
                                 
                              
                            for IR and 
                              
                                 
                                    R
                                    1
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       16
                                       g
                                       )
                                    
                                    −
                                    
                                       (
                                       16
                                       j
                                       )
                                    
                                    ,
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    j
                                    ∈
                                    J
                                    ,
                                    m
                                    ∈
                                    M
                                    }
                                 
                              
                            for LR, respectively), and iteratively “tightens” the solution space by adding back a subset of the initially relaxed constraints in Rn
                           , to 
                              
                                 F
                                 
                                    n
                                    +
                                    1
                                 
                              
                            in the subsequent iteration. Note that 
                              
                                 
                                    F
                                    n
                                 
                                 ⊂
                                 
                                    F
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    R
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 ⊂
                                 
                                    R
                                    n
                                 
                                 ,
                              
                            ∀n, so each relaxed problems (if solved to optimality) provides an upper bound to original optimum, and each feasible solution of the original problem is a lower bound. 
                              UB
                           (
                              LB
                           ) denotes the best upper bound (lower bound) up to the current iteration.

                              
                                 
                                    Step 1.
                                 
                                 Let 
                                       
                                          n
                                          =
                                          1
                                       
                                    . Initialize sets F
                                    1, R
                                    1, bounds 
                                       
                                          UB
                                          ,
                                       
                                    
                                    
                                       LB
                                    .

At iteration n, solve a relaxed problem
                                       6
                                    
                                    
                                       6
                                       The relaxed problem refers to different problems in the integrality relaxation and LR methods, and also different constraint sets for different iterations. We will specify the equation number for the relaxed problem when we introduce each method in the following section.
                                    
with all constraints in the set Fn
                                    . Update 
                                       UB
                                     if the current solution provides the tightest upper bound.

Compute feasible solutions (lower bounds) based on the solution (x, pJ
                                    ) to the relaxed problem. Update 
                                       LB
                                     if the current solution provides the best objective value.

Compute the optimality gap by 
                                       
                                          (
                                          UB
                                          −
                                          LB
                                          )
                                          /
                                          UB
                                       
                                    . If it is below a user defined tolerance, terminate.

Inspect the solution of the relaxed problem in step 2 by comparing the violations of the current relaxed constraints in Rn
                                    . Choose a certain number (e.g., 10 in our test cases) of constraints s ⊂ Rn
                                     with the highest violations and add them back to the constraint set of the next relaxed problem, i.e., 
                                       
                                          
                                             F
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             F
                                             n
                                          
                                          ∪
                                          s
                                       
                                     and 
                                       
                                          
                                             R
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             R
                                             n
                                          
                                          
                                             ∖
                                             s
                                          
                                       
                                    . Go to step 2.

As explained above, the majority of binary variables in MIQP (16) are zim
                           , zij
                           , ∀i ∈ I, j ∈ J, m ∈ M which makes the MIQP challenging to solve for large scale instances. So the integrality relaxation technique that we adopt is straightforward, i.e., we relax the binary constraints (16e) to allow zim
                           , zij
                           , ∀i ∈ I, j ∈ J, m ∈ M to be continuous over [0, 1]. The relaxed problem provides an upper bound for (16). In our “relax-and-tighten” scheme, we relax all constraints in (16e) initially, and gradually add them back for some i ∈ I, j ∈ J, m ∈ M iteratively. In this case, 
                              
                                 F
                                 1
                                 =
                                 {
                                 
                                    (
                                    16
                                    b
                                    )
                                 
                                 −
                                 
                                    (
                                    16
                                    d
                                    )
                                 
                                 ,
                                 
                                    (
                                    16
                                    f
                                    )
                                 
                                 −
                                 
                                    (
                                    16
                                    s
                                    )
                                 
                                 ,
                                 
                                 and
                                 
                                 
                                 
                                    z
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 
                                    z
                                    
                                       i
                                       m
                                    
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 j
                                 ∈
                                 J
                                 ,
                                 m
                                 ∈
                                 M
                                 }
                                 ,
                              
                            and 
                              
                                 
                                    R
                                    1
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       16
                                       e
                                       )
                                    
                                    ,
                                    ∀
                                    i
                                    ∈
                                    I
                                    ,
                                    j
                                    ∈
                                    J
                                    ,
                                    m
                                    ∈
                                    M
                                    }
                                 
                              
                           . So 
                              
                                 
                                    F
                                    1
                                 
                                 ∪
                                 
                                    R
                                    1
                                 
                                 =
                                 V
                              
                           .

An optimal solution to the relaxed problem may probably violate the integrality constraints, but it could be used to construct feasible solutions to (16), which provides a lower bound to the true optimal objective value. A key step in our relaxation algorithm is Step 3 to obtain good feasible solutions to the original problem. We employ the following procedure by fixing the values of variables x, pJ
                            to be the optimal value of the relaxed problem (x
                           *, pJ
                           
                           *). Then feasible values of all other variables can be obtained by solving the following mixed complementarity problem (MCP):

                              
                                 (17a)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⊥
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   p
                                                   j
                                                   *
                                                
                                                +
                                                
                                                   λ
                                                   j
                                                
                                                +
                                                
                                                   (
                                                   1
                                                   −
                                                   α
                                                   )
                                                
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                +
                                                
                                                   p
                                                   ℓ
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                j
                                                ∈
                                                J
                                                ,
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (17b)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   λ
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                      *
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                (
                                                10
                                                a
                                                )
                                                ,
                                                (
                                                10
                                                b
                                                )
                                                ,
                                                (
                                                21
                                                f
                                                )
                                                ,
                                                (
                                                10
                                                e
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Usually, there is a gap between 
                              UB
                            and 
                              LB
                           . To reduce such gap, the relaxed constraints are gradually added back to the problem in Step 5. The most violated constraints have higher priorities to be added back to 
                              
                                 F
                                 
                                    n
                                    +
                                    1
                                 
                              
                            in the subsequent iteration. The rationale is that those constraints are likely to be the more effective cuts that help narrow down the search space. For example, in iteration n, we keep track of an |s| number of the relaxed constraints in Rn
                            with highest relative violations, and add them in 
                              
                                 F
                                 
                                    n
                                    +
                                    1
                                 
                              
                            in iteration 
                              
                                 n
                                 +
                                 1
                              
                           .

If all relaxed subproblems can be solved to exactly optimality, it can be seen then the integrality relaxation based “relax-and-tighten” algorithm is equivalent to solving the original MIQP after a finite number of iterations. However, as more integrality constraints are added back, solving the relaxed problem becomes increasingly difficult, and thus the convergence takes longer. The key to this algorithm is the construction of the best feasible solutions from the solutions to the relaxed problem, in the hope that with minimum computational effort optimal or near-optimal solutions can be found (i.e., the gap between the lower and the upper bounds is small enough). So a good implementation should deal with the trade-off between the computation time in solving each subproblem and the total number of needed iterations. Therefore, Step 5 is key to the performance of the algorithm. In fact, it would be interesting to have a systematic way of determining how many and which constraints (i.e., set s) should be added back to the relaxed problem. Based on our extensive numerical experiments, we found that when the number of constraints to be added back in each iteration is around 
                              
                                 0.2
                                 
                                 
                                    percent
                                    
                                    to
                                 
                                 
                                 0.8
                                 
                                 percent
                                 *
                                 
                                    (
                                    
                                       |
                                       I
                                       |
                                    
                                    
                                       |
                                       J
                                       |
                                    
                                    +
                                    
                                       |
                                       I
                                       |
                                    
                                    
                                       |
                                       M
                                       |
                                    
                                    )
                                 
                                 ,
                              
                            the algorithms generally converge faster, and within this range, the computation time is not very sensitive to |s|. For broader implementation of this approach, theoretical basis and further numerical experiments should be explored in future research.

An alternative relaxation method is Lagrangian dual based, i.e., the LR method. Similarly to the case of integrality relaxation, the large number of complementarity constraints is the primary cause of the computational difficulty, and the main challenge is due to constraints (16g)–(16j). Therefore, we choose to relax (16g)–(16j), and add them to the objective function as a penalty term with Lagrangian dual variables 
                              
                                 
                                    
                                       π
                                       1
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       π
                                       
                                          i
                                          j
                                       
                                       1
                                    
                                    }
                                 
                                 ≥
                                 0
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       π
                                       2
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       π
                                       
                                          i
                                          j
                                       
                                       2
                                    
                                    }
                                 
                                 ≥
                                 0
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       π
                                       3
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       π
                                       
                                          i
                                          m
                                       
                                       3
                                    
                                    }
                                 
                                 ≥
                                 0
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       π
                                       4
                                    
                                 
                                 =
                                 
                                    {
                                    
                                       π
                                       
                                          i
                                          m
                                       
                                       4
                                    
                                    }
                                 
                                 ≥
                                 0
                              
                           
                           
                              7
                           
                           
                              7
                              Our computational experiments also show that it is the most effective to relax constraints (16g)–(16j) than other constraints.
                           . In this section, we will first introduce the conventional LR algorithm, i.e., without iteratively “tightening” the solution space, and then discuss the modification needed for our “relax-and-tighten” algorithm.

Let Vr
                            denote the solution space of the relaxed problem defined below (e.g., Vr
                            is defined by the set of constraints (16b)–(16d), (16f), and (16k)–(16s) after all of (16g)–(16j) are relaxed) and q(
                              π
                           ) represent the optimal objective value of the relaxed problem as a function of 
                              π
                           ; specifically, q(
                              π
                           ) is equal to

                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                maximum
                                                
                                                   x
                                                   ,
                                                   
                                                      p
                                                      J
                                                   
                                                   ,
                                                   f
                                                   ,
                                                   r
                                                   ,
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   ,
                                                   
                                                      
                                                         p
                                                         ˜
                                                      
                                                      a
                                                   
                                                   ∈
                                                   
                                                      V
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      p
                                                      e
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      h
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      λ
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         a
                                                         
                                                            2
                                                            m
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               f
                                                               
                                                                  i
                                                                  m
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  m
                                                               
                                                            
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         a
                                                         
                                                            1
                                                            m
                                                         
                                                      
                                                      }
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         1
                                                      
                                                      
                                                         r
                                                         i
                                                      
                                                      −
                                                      
                                                         b
                                                         2
                                                      
                                                      
                                                         r
                                                         i
                                                         2
                                                      
                                                      −
                                                      
                                                         b
                                                         2
                                                      
                                                      
                                                         r
                                                         i
                                                      
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         r
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   
                                                      [
                                                      
                                                         S
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            ℓ
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         g
                                                         i
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                   
                                                   
                                                      π
                                                      
                                                         i
                                                         j
                                                      
                                                      1
                                                   
                                                   
                                                      [
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                   
                                                   
                                                      π
                                                      
                                                         i
                                                         j
                                                      
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         γ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                
                                                
                                                   π
                                                   
                                                      i
                                                      j
                                                   
                                                   3
                                                
                                                
                                                   [
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         f
                                                         ¯
                                                      
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      π
                                                      
                                                         i
                                                         j
                                                      
                                                      4
                                                   
                                                   
                                                      [
                                                      
                                                         γ
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The above relaxed problem can be decomposed into two subproblems:

(Sub-problem 1)

                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   maximize
                                                   z
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         1
                                                      
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         2
                                                      
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         3
                                                      
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         4
                                                      
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      z
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                subject
                                                
                                                to
                                             
                                          
                                          
                                          
                                             
                                                
                                                (
                                                16
                                                e
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           (Sub-problem 2)

                              
                                 (20)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   maximize
                                                   
                                                      x
                                                      ,
                                                      
                                                         p
                                                         J
                                                      
                                                      ,
                                                      f
                                                      ,
                                                      r
                                                      ,
                                                      
                                                         p
                                                         a
                                                      
                                                      ,
                                                      
                                                         p
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   
                                                      p
                                                      e
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      h
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∈
                                                               J
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      λ
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   
                                                      [
                                                      
                                                         S
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            ℓ
                                                         
                                                         )
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         g
                                                         i
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      {
                                                      
                                                         a
                                                         
                                                            2
                                                            m
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               f
                                                               
                                                                  i
                                                                  m
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  m
                                                               
                                                            
                                                         
                                                         ]
                                                      
                                                      −
                                                      
                                                         a
                                                         
                                                            1
                                                            m
                                                         
                                                      
                                                      }
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         b
                                                         1
                                                      
                                                      
                                                         r
                                                         i
                                                      
                                                      −
                                                      
                                                         b
                                                         2
                                                      
                                                      
                                                         r
                                                         i
                                                         2
                                                      
                                                      −
                                                      
                                                         b
                                                         2
                                                      
                                                      
                                                         r
                                                         i
                                                      
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         r
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         1
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      +
                                                      
                                                         π
                                                         
                                                            i
                                                            j
                                                         
                                                         2
                                                      
                                                      
                                                         γ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            m
                                                            ∈
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         π
                                                         
                                                            i
                                                            m
                                                         
                                                         3
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         π
                                                         
                                                            i
                                                            m
                                                         
                                                         4
                                                      
                                                      
                                                         γ
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                subject
                                                
                                                to
                                             
                                          
                                          
                                          
                                             
                                                
                                                (
                                                16
                                                b
                                                )
                                                
                                                −
                                                (
                                                16
                                                d
                                                )
                                                ,
                                                (
                                                16
                                                f
                                                )
                                                ,
                                                (
                                                16
                                                k
                                                )
                                                
                                                −
                                                (
                                                16
                                                s
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For a given 
                              π
                           , subproblem 1 (19) can be solved by simple inspection, while subproblem 2 (20) is now much simpler than the original problem (16), reducing the number of binary variables from 
                              
                                 |
                                 I
                                 |
                                 ×
                                 (
                                 |
                                 J
                                 |
                                 +
                                 |
                                 M
                                 |
                                 )
                                 +
                                 2
                                 |
                                 J
                                 |
                                 +
                                 |
                                 I
                                 |
                              
                            to 
                              
                                 2
                                 |
                                 J
                                 |
                                 +
                                 |
                                 I
                                 |
                              
                           . As such, the relaxed problem (18) can be solved relatively easily.

To find the optimal values of the Lagrangian multipliers which lead to a primal optimum, we update them iteratively. The Lagrangian dual of problem (16) is

                              
                                 
                                    
                                       
                                          
                                             q
                                             *
                                          
                                          =
                                          
                                             min
                                             
                                                
                                                   π
                                                
                                                ≥
                                                0
                                             
                                          
                                          
                                          q
                                          
                                             (
                                             
                                                π
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           For any 
                              π
                           , q(
                              π
                           ) is an upper bound to the original optimum value of (16). The conventional sub-gradient method can be applied to update 
                              π
                            iteratively (Fisher, 1981). For example, at iteration n, 
                              
                                 
                                    π
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 1
                              
                            and 
                              
                                 
                                    π
                                 
                                 
                                    n
                                    +
                                    1
                                 
                                 2
                              
                            can be updated by:

                              
                                 
                                    
                                       
                                          
                                             
                                                π
                                                
                                                   i
                                                   j
                                                   ,
                                                   n
                                                   +
                                                   1
                                                
                                                1
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   
                                                      π
                                                      
                                                         i
                                                         j
                                                         ,
                                                         n
                                                      
                                                      1
                                                   
                                                   +
                                                   
                                                      t
                                                      n
                                                   
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                
                                                ,
                                                
                                                ∀
                                                i
                                                j
                                                ∈
                                                I
                                                
                                                   J
                                                   n
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                π
                                                
                                                   i
                                                   j
                                                   ,
                                                   n
                                                   +
                                                   1
                                                
                                                2
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   
                                                      π
                                                      
                                                         i
                                                         j
                                                         ,
                                                         n
                                                      
                                                      2
                                                   
                                                   +
                                                   
                                                      t
                                                      n
                                                   
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   }
                                                
                                                ,
                                                
                                                ∀
                                                i
                                                j
                                                ∈
                                                I
                                                
                                                   J
                                                   n
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where tn
                            denotes the step size at the nth
                            iteration. There are multiple ways to update the step size (Bazaraa & Sherali, 1981; Li & Ouyang, 2011). However, one popular way is to set 
                              
                                 t
                                 
                                    n
                                    +
                                    1
                                 
                              
                            to be

                              
                                 
                                    
                                       
                                          
                                             ξ
                                             n
                                          
                                          
                                             [
                                             UB
                                             −
                                             LB
                                             ]
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         z
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         ]
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                ∑
                                                
                                                   m
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      (
                                                      
                                                         f
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            f
                                                            ¯
                                                         
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      
                                                         z
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      (
                                                      
                                                         γ
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            γ
                                                            ¯
                                                         
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      
                                                         [
                                                         1
                                                         −
                                                         
                                                            z
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         ]
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           where ξn
                            is a scalar control parameter at the nth iterations. Practical experience of the LR algorithm has suggested to use 
                              
                                 
                                    ξ
                                    0
                                 
                                 =
                                 2
                              
                            as an initial value and gradually decrease it by a small amount if q(
                              π
                           
                           
                              n
                           ) does not improve after a certain number of iterations. The algorithm terminates when prescribed stopping criteria are satisfied (e.g., the maximum number of iterations is reached or the duality gap is smaller than a tolerance).

The theoretical results in Held, Wolfe, and Crowder (1974) and Goffin (1977) (for non-differentiable optimization) indicates that the subgradient method for solving the Lagrangian dual is guaranteed to converge to the optimal solution as long as the step size satisfies 
                              
                                 
                                    
                                       {
                                       
                                          t
                                          n
                                       
                                       }
                                    
                                    
                                       n
                                       =
                                       0
                                    
                                    ∞
                                 
                                 →
                                 0
                              
                            and 
                              
                                 
                                    ∑
                                    
                                       n
                                       =
                                       0
                                    
                                    ∞
                                 
                                 
                                    t
                                    n
                                 
                                 →
                                 ∞
                              
                            
                           (Fisher, 2004). However, the optimal primal may not be guaranteed unless the duality gap is zero. While trying the conventional LR algorithm (i.e., without the “tightening” step), we found that if we relax all complementarity constraints, large-scale instances (e.g., (50, 50, 50)) cannot be solved to an acceptable tolerance due to the slow convergence and the large duality gap. In view of the significant number of complementarity constraints in our case study, it is difficult to determine which constraints to relax for best convergence. Therefore, to improve computation speed, we are inspired to develop an adaptive “relax-and-tighten” algorithm to endogenously determine which constraints to relax and which to tighten. The rational is to first relax all complementarity constraints and then iteratively tighten the solution space to reduce the duality gaps, which is shown to be capable of improving the empirical performance.

The LR based “relax-and-tighten” scheme is quite similar to the one with integrality relaxation in the previous section. We first relax (16g)-(16j) for all i ∈ I, j ∈ J, m ∈ M, and gradually add them back iteratively by giving priority to a certain number of most violated constraints. Note that the relaxed problem (18) only applies to the first iteration when constraints (16g)–(16j) for all i ∈ I, j ∈ J, m ∈ M are relaxed. After the selected constraints for certain ij and im are added back in later iterations, the penalty terms for the corresponding ij and im should be removed from the objective accordingly. The way of obtaining a feasible solution is to solve the MCP problem (17) similarly to the integrality relaxation algorithm. Another difference in the algorithm framework is the additional step to update the Lagrangian multipliers 
                              π
                            after Step 4 using the above procedure.

To test the computational performance of our adaptive “relax-and-tighten” algorithms and compare with publicly available solvers, we apply our methodology to two problems: the one proposed in our previous paper (Bai et al., 2012) (denoted as P1), and the extended model (8) in this paper (denoted as P2). P1 is a similar Stackelberg leader–follower game model, but it does not consider CRP land, marginal land market, or farmland-use constraints. For comparison, we use the same problem setting and data sets: (1) the study area is the State of Illinois where a single biofuel company considers a subset of county centers and intersections of major interstate highways as the candidate locations for building refineries (Bai et al., 2011; Kang et al., 2010); (2) corn is the feedstock type provided by farmers (i.e., farmers), and the top-corn production counties (based on 2008 production data) are selected to represent individual farms (Kang et al., 2010; Khanna et al., 2008); and (3) a set of local grain markets are chosen based on proximity to the farms.
                        8
                     
                     
                        8
                        Other data resources and parameter values are stated in detail in Bai et al. (2012).
                     
                  

For the purpose of comparison, we implemented several problem instances with different scales (i.e., |I|, |J|, |M|) from (10, 10, 10) to (50, 50, 50) and different levels of biorefinery plant capacity from 25 to 100 million gallons per year (MGY). The iterative algorithm procedure is coded in GAMS. The commercial solver CPLEX is used to solve the relaxed MIQP subproblems, and the solver PATH is used to solve the MCP problems (17). All cases are solved on a desktop computer with 3.40 GHz CPU and 7.89 GB memory. In this case study, the following values are assumed for the cap-and-trade parameters: 
                           
                              α
                              =
                              30
                              percent
                              ,
                           
                         CRP land price 
                           
                              
                                 p
                                 r
                              
                              
                                 (
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    r
                                    i
                                 
                                 )
                              
                              =
                              4.0
                              −
                              2.0
                              *
                              
                                 10
                                 
                                    −
                                    8
                                 
                              
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    I
                                 
                              
                              
                                 r
                                 i
                              
                           
                         (dollars/unit land
                           9
                        
                        
                           9
                           To unify all variables and parameters, the land unit we used is equivalent to that needed for producing one bushel of corn.
                        ), ethanol price 
                           
                              
                                 p
                                 e
                              
                              =
                              8.5
                              −
                              2.0
                              *
                              
                                 10
                                 
                                    −
                                    9
                                 
                              
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 f
                                 
                                    i
                                    j
                                 
                              
                           
                         (dollars/unit land), and the supply curve for marginal land 
                           
                              S
                              
                                 (
                                 
                                    s
                                    ℓ
                                 
                                 )
                              
                              =
                              
                                 10
                                 
                                    −
                                    8
                                 
                              
                              
                                 s
                                 ℓ
                              
                           
                         (dollars).

Computational results for P1 are listed in Table 2
                        . Under the same parameter values, the CPLEX solver results are replicates of those in Bai et al. (2012). From these results, we can see that in general our proposed adaptive “relax-and-tighten” algorithms significantly outperform the solvers (e.g., NPLEC that directly solves the original DC-MPEC and CPLEX that solves the single-level MIQP (16)). Our proposed algorithms not only greatly reduce the computation time for solving the small instances, such as (20, 15, 10) and (20, 20, 20), but also solve larger ones to near-optimum while CPLEX fails to even obtain feasible solutions. As the problem scale increases, the adaptive “relax-and-tighten” algorithms are more computationally beneficial. Furthermore, by comparing the two relaxation subroutines, we can see that the LR method generally results in a smaller optimality gap for larger instances, such as the (50, 50, 50) cases. The rationality is that the integrality relaxation algorithm only gradually narrows down the feasible region by simply adding back integrality constraints; whereas the LR approaches dual optimality by sub-gradient methods, in which the computational efforts from previous iterations can be utilized. Fig. 2
                         graphically presents the computation time and optimality gap of each solution approach with respect to the size of P1. The data points on the curves are respectively the average computation time (Fig. 2a) and optimality gap (Fig. 2b) among the three capacity levels for each problem size. In both figures, the curves of MIQP by CPLEX are incomplete due to its failure to solve problem instances with more than 2000 variables. Also, note that the optimality gap of the NLPEC solver is higher for smaller problems, as it only finds stationary solutions and thus has no guarantee on the quality of solutions.

Similar patterns in the computational results are shown for P2 in Table 3
                        . Results from the NLPEC solver are not included in this table, due to apparent low quality of solutions: zero objective values are returned for all numerical cases. It’s worth mentioning that for the (30, 30, 30)-50MGY case in P2, our relaxation algorithms can actually find an 
                           UB
                         with a 5 percent gap in about 1000 seconds, but it takes over 7000 seconds more time to further reduce the gap to 1 percent. Besides, for the (50, 50, 50)-100MGY case, although the integrality relaxation method results in a large gap (23 percent), it actually provides a better 
                           UB
                        . With the good 
                           LB
                         provided by LR, the combined gap (between the best upper and lower bounds of the two methods) is greatly reduced compared to each method alone.

Meanwhile, we can also see that as the problem size increases, more computational effort is needed and the duality gap also increases. Based on our computational experience, the integrality-relaxed and the Lagrangian-relaxed problems are much easier to solve than the original MIQP. However, we also observe from the experiments that solving these relaxed problems (such as the subproblem 2 (20)) still requires the majority of the computational effort.

Our case study also provides economic insights on the optimal design of biofuel supply chain, farmland allocation patterns and the effect of land-use regulation scheme. Table 4
                         is a comparison of the optimal solutions between P1 and P2, i.e., with and without the land-use policy on the (10, 10, 10) and (30, 30, 30) cases
                           10
                        
                        
                           10
                           For accuracy of the comparison and economic insights, results for (50,50,50) cases are not reported due to the non-negligible optimality gaps at some capacity levels.
                        .

Since the assumed capital cost for building refinery is proportional to the fixed production capacity, the solutions to all cases incur almost identical construction cost and the same total capacity. As expected, with the land-use regulation mechanism, the total land use in all cases for producing biomass is reduced accordingly. The percentage of land use for energy production is exactly equal to the regulation cap, i.e., the total initial allowances 
                           
                              α
                              =
                              30
                              
                              percent
                              ,
                           
                         and we have a non-zero price pa
                         for the land-use allowances in P2. It means that growing energy biomass and producing ethanol are in general profitable for farmers and the biofuel manufacturer, so that the farmers are willing to pay for the allowances, and the biofuel manufacturer is willing to pay for biomass at a price high enough to ensure energy land use at the cap.

We note that the (10, 10, 10) and (30, 30, 30) cases are also quite different in their results. For instance, in the (10, 10, 10) case, there is more marginal land used
                           11
                        
                        
                           11
                           In Table 4, the marginal land percentage is the ratio of total marginal used land to the total existing land (which is the fixed for all cases).
                         in P2 (compared to P1) with higher land price p
                        ℓ; while an opposite trend is observed in the (30, 30, 30) case. The reason is that in our data we chose the top 10 and top 30 farms in a descending order of corn yield respectively, and thus a smaller percentage of land is profitable in the (30, 30, 30) case. Another interesting fact in the results is the growing trend of total allowances trading as the refinery capacity increases. Intuitively, as the capacity increases and the number of refineries decreases, the profitability of farmland becomes more polarized (i.e., land near the refinery becomes profitable while that far away from refineries become unprofitable). So there are more incentives for farmers to trade their land-use allowances.

Furthermore, we find that, under certain settings, the government regulation helps improve the overall social benefit of the food, fuel and land markets. For example, in the (10, 10, 10)-25MGY and -50MGY cases, P2 leads to higher social welfare than P1, mainly because the increase of consumer surplus in the food market outweighs the decrease of that in the fuel market. However, it is not true for other cases, such as all (30,30,30) cases. It is important to note that the “social welfare” calculated here is largely subject to food and ethanol market price and consumer surplus (and the related downstream gas market), so the real impact of cap-and-trade policy on social welfare should be carefully evaluated based on more accurate and validated data. Nevertheless, these results imply the challenges in setting a policy that protect one market without sacrifice others. Therefore, in order to enhance the social welfare of the entire system, regulations on both food and biofuel industries need to be carefully designed and evaluated. To shed more lights on how the regulation level affects different supply chain stakeholders, we further a sensitivity analysis on the cap-and trade parameter.

The sensitivity analysis is run on the (30,30,30)-100MGY case as the benchmark. Results are shown in Table 5
                         regarding the farmland use, supply chain costs/benefits and social welfare. As the cap-and-trade level α drops below 40 percent, the following are observed: (1) the cap-and-trade level mainly affects the farmland use pattern, but not the optimal number and location of refineries (only except for the case 
                           
                              α
                              =
                              10
                              
                              percent
                              ,
                           
                         where the number of refineries reduces to one) – not surprisingly, more food yet less energy crops are produced and less marginal land are used under a more stringent land use policy; (2) land use allowances become scarce and more valuable, while the demand for marginal land declines; (3) the total allowance trading declines leading to a higher total transportation cost – with more food and less biomass production, farmers have to ship and sell the additional food products to more distant food markets; and (4) the biofuel industry is significantly impacted and their profit shrinks – the reduction in total ethanol revenue outweighs the increase in total food revenue, which results in a net decrease in social welfare. On the other hand, when α goes above 40 percent, the cap is no longer binding, and all the solutions are almost identical to P1 (the one without land use regulation). Allowance trading is the only quantity that is increasing with α due to a larger portion of initial allowance, but under zero allowance price, the cap-and-trade level no longer affects supply chain costs and revenues.

@&#CONCLUSIONS@&#

We proposed a land-use regulation mechanism and integrated it into a biofuel supply chain design problem that addresses the interactions among biofuel industry expansion, farmers’ land use, and food, fuel, marginal land markets. We presented a Stackelberg–Nash game model with direct land-use constraints, and then an equivalent model with a cap-and-trade mechanism that indirectly implements the land-use constraints. We further developed two solution algorithms, i.e., integrality and Lagrangian dual based adaptive “relax-and-tighten” algorithms, and showed their superior performances to the existing methods in solving various sized problem instances. In addition, the numerical case study for the State of Illinois has shown that the cap-and-trade regulation mechanism effectively reduces farmland use for energy crops and thus protects the food supply chain. In some cases, it could result in less profit for the biofuel manufacturer, but higher social welfare for the entire system (including food, fuel and land use markets). The sensitive analysis on different cap-and-trade levels shows its significant impact on land use pattern and supply chain behavior. Therefore, such regulation/policy shall be effective in practice, and it should be carefully designed and implemented to not only stabilize food market but also at the same time ensure social benefit of the entire system.

In this paper, we assumed a constant value of land-use cap 
                        
                           E
                           ¯
                        
                      and a very simple rule of initial allowance allocation, future work should address more details of the cap-and-trade system, such as how policy makers could determine the optimal land-use cap 
                        
                           
                              E
                              ¯
                           
                           ,
                        
                      and what would be a good allowance allocation policy. It is also of interest to explore possible contract scenarios between farmers and biofuel manufacturers under government regulations, and their effects on risk reduction and sustainable biofuel production. Besides, this research can be also extended to a dynamic model of biofuel supply chain design and farmland-use planning problem in a rolling horizon. Considering the static models in this paper are already very complex to solve, how to solve a dynamic model is another challenging direction for future research. On the solution algorithm side, it will be interesting to extend our proposed “relax-and-tighten” scheme to other MPEC problems and compare it with other solution approaches (e.g., the regularization of complementarity constraints Steffensen & Ulbrich, 2010) that have been proposed in the literature.

@&#ACKNOWLEDGMENTS@&#

The authors would like to thank the three EJOR reviewers for providing helpful comments. This research was supported in part by the U.S. National Science Foundation through Grants EFRI-RESIN-0835982, CMMI-0748067 and CMMI-0969600.


                     Proposition 1. The farmers’ problem 
                     (2) 
                     has a solution.
                     
                        Proof
                        We proceed with this proof by stating the KKT conditions for each farmer’s optimization problem:

                              
                                 (21a)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   
                                                      d
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   −
                                                   
                                                      p
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            p
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  m
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   p
                                                   ℓ
                                                
                                                −
                                                α
                                                
                                                   p
                                                   a
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                ∀
                                                m
                                                ∈
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21b)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⊥
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   p
                                                   j
                                                
                                                +
                                                
                                                   λ
                                                   j
                                                
                                                +
                                                
                                                   p
                                                   ℓ
                                                
                                                +
                                                
                                                   (
                                                   1
                                                   −
                                                   α
                                                   )
                                                
                                                
                                                   p
                                                   a
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                ∀
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21c)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   r
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   −
                                                   
                                                      p
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            p
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               r
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   −
                                                   α
                                                   
                                                      p
                                                      a
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21d)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   λ
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         j
                                                      
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21e)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   p
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   
                                                      S
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         ℓ
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            g
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         −
                                                         
                                                            r
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         −
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                               ∪
                                                               J
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21f)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   p
                                                   a
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   α
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                               ∪
                                                               J
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         j
                                                      
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where we have identified the same variable p
                           ℓ as the common multiplier for the constraint (2c) in farmer i’s optimization problem; see Schiro, Pang, and Shanbhag (2013) for a detailed discussion on common multipliers for the shared constraints. If we write out the optimality condition for (3) and substituting 
                              
                                 
                                    s
                                    ℓ
                                 
                                 =
                                 
                                    S
                                    
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       p
                                       ℓ
                                    
                                    )
                                 
                                 ,
                              
                            the resulting complementarity condition (21e) exactly enforces the stipulation that p
                           ℓ is the dual variable of (2c).

Since 
                              
                                 S
                                 
                                    −
                                    1
                                 
                              
                            is an increasing function, it follows from the condition (21e) that

                              
                                 (22)
                                 
                                    
                                       
                                          p
                                          ℓ
                                       
                                       =
                                       max
                                       
                                          {
                                          0
                                          ,
                                          S
                                          
                                             (
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         i
                                                         ′
                                                      
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         r
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      −
                                                      
                                                         g
                                                         
                                                            i
                                                            ′
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            k
                                                            ∈
                                                            M
                                                            ∪
                                                            J
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            k
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                             )
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           By substituting the above expression into (21), this system becomes:

                              
                                 (23)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   −
                                                   
                                                      p
                                                      m
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               m
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            p
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  m
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               −
                                                               
                                                                  g
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     k
                                                                     ∈
                                                                     M
                                                                     ∪
                                                                     J
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     k
                                                                  
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                −
                                                
                                                α
                                                
                                                   p
                                                   a
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                ∀
                                                m
                                                ∈
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                          
                                             
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   p
                                                   j
                                                
                                                +
                                                
                                                   λ
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               −
                                                               
                                                                  g
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     k
                                                                     ∈
                                                                     M
                                                                     ∪
                                                                     J
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     k
                                                                  
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   α
                                                   )
                                                
                                                
                                                   p
                                                   a
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                ∀
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   r
                                                   i
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                          
                                             
                                                
                                                   −
                                                   
                                                      p
                                                      r
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      
                                                         ∂
                                                         
                                                            p
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               r
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               −
                                                               
                                                                  g
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     k
                                                                     ∈
                                                                     M
                                                                     ∪
                                                                     J
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     k
                                                                  
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                
                                                −
                                                α
                                                
                                                   p
                                                   a
                                                
                                                ≥
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   λ
                                                   j
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         j
                                                      
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   J
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   p
                                                   a
                                                
                                             
                                          
                                          
                                             ⊥
                                          
                                          
                                             
                                                
                                                   α
                                                   
                                                      [
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            r
                                                            
                                                               i
                                                               ′
                                                            
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                               ∪
                                                               J
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               k
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         j
                                                      
                                                   
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The conditions (23) constitute the KKT conditions of a VI defined by the mapping:

                              
                                 
                                    
                                       
                                          
                                             
                                                F
                                                (
                                                
                                                   f
                                                   M
                                                
                                                ,
                                                
                                                   f
                                                   J
                                                
                                                ,
                                                r
                                                )
                                                ≜
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  α
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           d
                                                                           
                                                                              i
                                                                              m
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           p
                                                                           m
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 ∑
                                                                                 
                                                                                    
                                                                                       i
                                                                                       ′
                                                                                    
                                                                                    ∈
                                                                                    I
                                                                                 
                                                                              
                                                                              
                                                                                 f
                                                                                 
                                                                                    
                                                                                       i
                                                                                       ′
                                                                                    
                                                                                    m
                                                                                 
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        −
                                                                        
                                                                           f
                                                                           
                                                                              i
                                                                              m
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ∂
                                                                              
                                                                                 p
                                                                                 m
                                                                              
                                                                              
                                                                                 (
                                                                                 
                                                                                    ∑
                                                                                    
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                       ∈
                                                                                       I
                                                                                    
                                                                                 
                                                                                 
                                                                                    f
                                                                                    
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                       m
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                           
                                                                           
                                                                              ∂
                                                                              
                                                                                 f
                                                                                 
                                                                                    i
                                                                                    m
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        max
                                                                        
                                                                           {
                                                                           0
                                                                           ,
                                                                           S
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    ∑
                                                                                    
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                       ∈
                                                                                       I
                                                                                    
                                                                                 
                                                                                 
                                                                                    [
                                                                                    
                                                                                       
                                                                                          r
                                                                                          
                                                                                             i
                                                                                             ′
                                                                                          
                                                                                       
                                                                                       −
                                                                                       
                                                                                          g
                                                                                          
                                                                                             i
                                                                                             ′
                                                                                          
                                                                                       
                                                                                       +
                                                                                       
                                                                                          ∑
                                                                                          
                                                                                             k
                                                                                             ∈
                                                                                             M
                                                                                             ∪
                                                                                             J
                                                                                          
                                                                                       
                                                                                       
                                                                                          f
                                                                                          
                                                                                             
                                                                                                i
                                                                                                ′
                                                                                             
                                                                                             k
                                                                                          
                                                                                       
                                                                                    
                                                                                    ]
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     (
                                                                     i
                                                                     ,
                                                                     m
                                                                     )
                                                                     ∈
                                                                     I
                                                                     ×
                                                                     M
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               6.2
                                                               i
                                                               n
                                                            
                                                            
                                                               0.01
                                                               i
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  
                                                                     1
                                                                     −
                                                                     α
                                                                  
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           j
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        p
                                                                        j
                                                                     
                                                                     +
                                                                     max
                                                                     
                                                                        {
                                                                        0
                                                                        ,
                                                                        S
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 ∑
                                                                                 
                                                                                    
                                                                                       i
                                                                                       ′
                                                                                    
                                                                                    ∈
                                                                                    I
                                                                                 
                                                                              
                                                                              
                                                                                 [
                                                                                 
                                                                                    
                                                                                       r
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                    
                                                                                    −
                                                                                    
                                                                                       g
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                    
                                                                                    +
                                                                                    
                                                                                       ∑
                                                                                       
                                                                                          k
                                                                                          ∈
                                                                                          M
                                                                                          ∪
                                                                                          J
                                                                                       
                                                                                    
                                                                                    
                                                                                       f
                                                                                       
                                                                                          
                                                                                             i
                                                                                             ′
                                                                                          
                                                                                          k
                                                                                       
                                                                                    
                                                                                 
                                                                                 ]
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        }
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     (
                                                                     i
                                                                     ,
                                                                     j
                                                                     )
                                                                     ∈
                                                                     I
                                                                     ×
                                                                     J
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               6.2
                                                               i
                                                               n
                                                            
                                                            
                                                               0.01
                                                               i
                                                               n
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                                  α
                                                               
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        −
                                                                        
                                                                           p
                                                                           r
                                                                        
                                                                        
                                                                           (
                                                                           
                                                                              
                                                                                 ∑
                                                                                 
                                                                                    
                                                                                       i
                                                                                       ′
                                                                                    
                                                                                    ∈
                                                                                    I
                                                                                 
                                                                              
                                                                              
                                                                                 r
                                                                                 
                                                                                    i
                                                                                    ′
                                                                                 
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        −
                                                                        
                                                                           r
                                                                           i
                                                                        
                                                                        
                                                                           
                                                                              ∂
                                                                              
                                                                                 p
                                                                                 r
                                                                              
                                                                              
                                                                                 (
                                                                                 
                                                                                    ∑
                                                                                    
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                       ∈
                                                                                       I
                                                                                    
                                                                                 
                                                                                 
                                                                                    r
                                                                                    
                                                                                       i
                                                                                       ′
                                                                                    
                                                                                 
                                                                                 )
                                                                              
                                                                           
                                                                           
                                                                              ∂
                                                                              
                                                                                 r
                                                                                 i
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        max
                                                                        
                                                                           {
                                                                           0
                                                                           ,
                                                                           S
                                                                           
                                                                              (
                                                                              
                                                                                 
                                                                                    ∑
                                                                                    
                                                                                       
                                                                                          i
                                                                                          ′
                                                                                       
                                                                                       ∈
                                                                                       I
                                                                                    
                                                                                 
                                                                                 
                                                                                    [
                                                                                    
                                                                                       
                                                                                          r
                                                                                          
                                                                                             i
                                                                                             ′
                                                                                          
                                                                                       
                                                                                       −
                                                                                       
                                                                                          g
                                                                                          
                                                                                             i
                                                                                             ′
                                                                                          
                                                                                       
                                                                                       +
                                                                                       
                                                                                          ∑
                                                                                          
                                                                                             k
                                                                                             ∈
                                                                                             M
                                                                                             ∪
                                                                                             J
                                                                                          
                                                                                       
                                                                                       
                                                                                          f
                                                                                          
                                                                                             
                                                                                                i
                                                                                                ′
                                                                                             
                                                                                             k
                                                                                          
                                                                                       
                                                                                    
                                                                                    ]
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                           }
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  
                                                                     i
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           on the set

                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                (
                                                x
                                                )
                                             
                                          
                                          
                                             ≜
                                          
                                          
                                             
                                                {
                                                
                                                   z
                                                   ≜
                                                   
                                                      (
                                                      
                                                         f
                                                         M
                                                      
                                                      ,
                                                      
                                                         f
                                                         J
                                                      
                                                      ,
                                                      r
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   ∣
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   ≤
                                                   
                                                      c
                                                      j
                                                   
                                                   
                                                      x
                                                      j
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      ≤
                                                      α
                                                      
                                                         [
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               r
                                                               i
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  M
                                                                  ∪
                                                                  J
                                                               
                                                            
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  i
                                                                  k
                                                               
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that the variables {fij
                           }(i, j) ∈ I × J
                            are bounded by the capacity constraints with the exogenous facility decisions {xj
                           }
                              j ∈ J
                           ; nevertheless, there are no explicit bounds on the other variables {fim
                           }(i, m) ∈ I × M
                            and {ri
                           }
                              i ∈ I
                           . In this VI formulation, the multipliers λj
                           , and pa
                            in (21) become implied variables, so is the land price p
                           ℓ that is obtained from (22); see Facchinei and Pang (2003) for the detailed technique of mapping from KKT conditions to VI.

To show that the above VI, and thus the farmers’ Nash game, has a solution, we apply Proposition 2.2.3 in Facchinei and Pang (2003) by taking 
                              
                                 
                                    z
                                    ref
                                 
                                 =
                                 0
                              
                            and considering the inner product

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   z
                                                   T
                                                
                                                F
                                                
                                                   (
                                                   z
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   =
                                                   
                                                   
                                                      1
                                                      α
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            d
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         −
                                                         
                                                            p
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     m
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         
                                                            
                                                               ∂
                                                               
                                                                  p
                                                                  m
                                                               
                                                               
                                                                  (
                                                                  
                                                                     ∑
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        ∈
                                                                        I
                                                                     
                                                                  
                                                                  
                                                                     f
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        m
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  f
                                                                  
                                                                     i
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      max
                                                      
                                                         {
                                                         0
                                                         ,
                                                         S
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  [
                                                                  
                                                                     
                                                                        r
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        g
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        ∑
                                                                        
                                                                           k
                                                                           ∈
                                                                           M
                                                                           ∪
                                                                           J
                                                                        
                                                                     
                                                                     
                                                                        f
                                                                        
                                                                           
                                                                              i
                                                                              ′
                                                                           
                                                                           k
                                                                        
                                                                     
                                                                  
                                                                  ]
                                                               
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      1
                                                      
                                                         1
                                                         −
                                                         α
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      p
                                                      j
                                                   
                                                   +
                                                   max
                                                   
                                                      {
                                                      0
                                                      ,
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     r
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     g
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     ∑
                                                                     
                                                                        k
                                                                        ∈
                                                                        M
                                                                        ∪
                                                                        J
                                                                     
                                                                  
                                                                  
                                                                     f
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        k
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      1
                                                      α
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         −
                                                         
                                                            p
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            r
                                                            i
                                                         
                                                         
                                                            
                                                               ∂
                                                               
                                                                  p
                                                                  r
                                                               
                                                               
                                                                  (
                                                                  
                                                                     ∑
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        ∈
                                                                        I
                                                                     
                                                                  
                                                                  
                                                                     r
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  r
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                   max
                                                   
                                                      {
                                                      0
                                                      ,
                                                      S
                                                      
                                                         (
                                                         
                                                            
                                                               ∑
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               [
                                                               
                                                                  
                                                                     r
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     g
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     ∑
                                                                     
                                                                        k
                                                                        ∈
                                                                        M
                                                                        ∪
                                                                        J
                                                                     
                                                                  
                                                                  
                                                                     f
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        k
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                         )
                                                      
                                                      }
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ≥
                                                   
                                                   −
                                                   
                                                      1
                                                      α
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     i
                                                                     m
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            p
                                                            m
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     m
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                            2
                                                         
                                                         
                                                            
                                                               ∂
                                                               
                                                                  p
                                                                  m
                                                               
                                                               
                                                                  (
                                                                  
                                                                     ∑
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        ∈
                                                                        I
                                                                     
                                                                  
                                                                  
                                                                     f
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        m
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  f
                                                                  
                                                                     i
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      1
                                                      
                                                         1
                                                         −
                                                         α
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         d
                                                         
                                                            i
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         p
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                min
                                                
                                                   {
                                                   
                                                      
                                                         1
                                                         α
                                                      
                                                      ,
                                                      
                                                         1
                                                         
                                                            1
                                                            −
                                                            α
                                                         
                                                      
                                                   
                                                   }
                                                
                                                
                                                   (
                                                   
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               r
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            −
                                                            
                                                               g
                                                               
                                                                  i
                                                                  ′
                                                               
                                                            
                                                            +
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  ∈
                                                                  M
                                                                  ∪
                                                                  J
                                                               
                                                            
                                                            
                                                               f
                                                               
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                                  k
                                                               
                                                            
                                                         
                                                         ]
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                max
                                                
                                                   {
                                                   0
                                                   ,
                                                   S
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  i
                                                                  ′
                                                               
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            [
                                                            
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               −
                                                               
                                                                  g
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                               +
                                                               
                                                                  ∑
                                                                  
                                                                     k
                                                                     ∈
                                                                     M
                                                                     ∪
                                                                     J
                                                                  
                                                               
                                                               
                                                                  f
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     k
                                                                  
                                                               
                                                            
                                                            ]
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                   −
                                                   
                                                   
                                                      1
                                                      α
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  r
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            p
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                     ∈
                                                                     I
                                                                  
                                                               
                                                               
                                                                  r
                                                                  
                                                                     i
                                                                     ′
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            r
                                                            i
                                                            2
                                                         
                                                         
                                                            
                                                               ∂
                                                               
                                                                  p
                                                                  r
                                                               
                                                               
                                                                  (
                                                                  
                                                                     ∑
                                                                     
                                                                        
                                                                           i
                                                                           ′
                                                                        
                                                                        ∈
                                                                        I
                                                                     
                                                                  
                                                                  
                                                                     r
                                                                     
                                                                        i
                                                                        ′
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  r
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           From the above expression, the following result can be proved by verifying the boundedness of the set L
                           <≜{z ∈ Z(x)∣z
                           
                              T
                           
                           F(z) < 0}. In turn, this can be accomplished by a contrapositive argument. Once this boundedness is proved, (Facchinei & Pang, 2003, Proposition 2.2.3)
is applicable to complete the proof of the result.□


                     Proposition 2. Price variables 
                     pJ
                     , p
                     ℓ, 
                        
                           
                              p
                              ˜
                           
                           a
                        
                      
                     are bounded from above. The base model 
                     (4) 
                     and the cap-and-trade model 
                     (8) 
                     are equivalent in the following sense:
                     
                        
                           (a)
                           
                              Any Nash equilibrium solution of the base model 
                              (4) 
                              also solves the cap-and-trade model 
                              (8);


                              Any Nash equilibrium solution of the cap-and-trade model 
                              (8) 
                              with with land price p
                              ℓ > 0 and allowance price
                              
                                 
                                    
                                       
                                          p
                                          ˜
                                       
                                       a
                                    
                                    ,
                                 
                               
                              and if
                              
                                 
                                    
                                       
                                          E
                                          ≤
                                          α
                                          
                                             [
                                             
                                                
                                                   S
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ℓ
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   g
                                                   i
                                                
                                             
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                              is also a Nash equilibrium solution of the base game with
                              
                                 
                                    
                                       p
                                       ˜
                                    
                                    a
                                 
                               
                              being the multiplier of the constraint 
                              (2d).

(a) if 
                              
                                 
                                    z
                                    *
                                 
                                 ≜
                                 
                                    (
                                    
                                       f
                                       M
                                       *
                                    
                                    ,
                                    
                                       f
                                       J
                                       *
                                    
                                    ,
                                    
                                       r
                                       *
                                    
                                    )
                                 
                              
                            is a Nash equilibrium solution of the base model (4) where the farmers’ optimization problems contain the land and energy production constraints (2b)–(2d), and if 
                              
                                 (
                                 
                                    λ
                                    j
                                    *
                                 
                                 ,
                                 
                                    p
                                    
                                       ℓ
                                    
                                    *
                                 
                                 ,
                                 
                                    p
                                    a
                                    *
                                 
                                 )
                              
                            are the corresponding multipliers of these constraints as determined from the KKT conditions (21), then the tuple z
                           * is a solution of the cap-and-trade game with 
                              
                                 E
                                 ≜
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                                 
                                    f
                                    
                                       i
                                       j
                                    
                                    *
                                 
                              
                            and 
                              
                                 
                                    
                                       p
                                       ˜
                                    
                                    a
                                 
                                 =
                                 
                                    p
                                    a
                                    *
                                 
                              
                           ;

(b) Conversely, if 
                              
                                 
                                    z
                                    *
                                 
                                 ≜
                                 
                                    (
                                    
                                       f
                                       M
                                       *
                                    
                                    ,
                                    
                                       f
                                       J
                                       *
                                    
                                    ,
                                    
                                       r
                                       *
                                    
                                    )
                                 
                              
                            is a Nash equilibrium solution of the cap-and-trade game with land price p
                           ℓ > 0 and allowance price 
                              
                                 
                                    
                                       p
                                       ˜
                                    
                                    a
                                 
                                 ,
                              
                            and if 
                              
                                 E
                                 ≤
                                 α
                                 
                                    [
                                    
                                       S
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          p
                                          ℓ
                                       
                                       )
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          I
                                       
                                    
                                    
                                       g
                                       i
                                    
                                    ]
                                 
                                 ,
                              
                            then z
                           * is a Nash equilibrium solution of the base game with 
                              
                                 
                                    p
                                    ˜
                                 
                                 a
                              
                            being the multiplier of the constraint (2d) which must be satisfied by the solution z
                           *. [Incidentally, the condition (9) must hold as equality if in addition 
                              
                                 
                                    
                                       p
                                       ˜
                                    
                                    a
                                 
                                 >
                                 0
                              
                           . Thus any Nash equilibrium solution of the cap-and-trade game with positive land and allowance prices must be a solution of the base game.]□


                     Proposition 3. Price variables 
                     pJ
                     , p
                     ℓ, 
                        
                           
                              p
                              ˜
                           
                           a
                        
                      
                     are bounded from above. Furthermore, the following upper bounds are always valid for optimal solutions to problem 
                     (8)
                     :
                     
                        
                           
                              
                                 
                                    
                                       
                                          p
                                          j
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             p
                                             e
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             j
                                          
                                          ,
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          .
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                             ˜
                                          
                                          a
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             1
                                             
                                                1
                                                −
                                                α
                                             
                                          
                                          
                                             max
                                             
                                                j
                                                ∈
                                                J
                                                ,
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             {
                                             
                                                p
                                                j
                                             
                                             −
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                          ≤
                                          
                                             1
                                             
                                                1
                                                −
                                                α
                                             
                                          
                                          
                                             max
                                             
                                                j
                                                ∈
                                                J
                                                ,
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             {
                                             
                                                
                                                   p
                                                   ¯
                                                
                                                j
                                             
                                             −
                                             
                                                d
                                                
                                                   i
                                                   j
                                                
                                             
                                             }
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             a
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          p
                                          ℓ
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          max
                                          
                                             {
                                             S
                                             
                                                (
                                                max
                                                
                                                   {
                                                   
                                                      0
                                                      ,
                                                      
                                                         l
                                                         ¯
                                                      
                                                      −
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               ∈
                                                               I
                                                            
                                                         
                                                         
                                                            g
                                                            i
                                                         
                                                      
                                                   
                                                   }
                                                
                                                )
                                             
                                             ,
                                             
                                                max
                                                
                                                   j
                                                   ∈
                                                   J
                                                   ,
                                                   i
                                                   ∈
                                                   I
                                                
                                             
                                             
                                                {
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   j
                                                
                                                −
                                                
                                                   d
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                }
                                             
                                             }
                                          
                                          ≜
                                          
                                             
                                                p
                                                ¯
                                             
                                             ℓ
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     where
                     
                        
                           
                              l
                              ¯
                           
                           =
                           max
                           
                              {
                              0
                              ,
                              
                                 ∑
                                 
                                    m
                                    ∈
                                    M
                                 
                              
                              
                                 
                                    
                                       a
                                       
                                          1
                                          m
                                       
                                    
                                    −
                                    
                                       d
                                       
                                          i
                                          m
                                       
                                    
                                 
                                 
                                    a
                                    
                                       2
                                       m
                                    
                                 
                              
                              }
                           
                           +
                           
                              
                                 b
                                 1
                              
                              
                                 b
                                 2
                              
                           
                           +
                           
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    J
                                 
                              
                              
                                 c
                                 j
                              
                           
                        
                     .

                        Proof
                        First, we prove pj
                            is bounded from above. To see this, we will show that there exists a feasible solution to problem (8) with 
                              
                                 x
                                 
                                 =
                                 
                                 0
                                 ,
                                 
                                    p
                                    J
                                 
                                 =
                                 0
                                 ,
                              
                            and 
                              
                                 
                                    f
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 0
                                 ,
                                 ∀
                                 i
                                 ∈
                                 I
                                 ,
                                 j
                                 ∈
                                 J
                              
                           . That is equivalent to prove there exists a feasible solution to the following KKT conditions:

                              
                                 (24a)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   f
                                                   
                                                      i
                                                      m
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ⊥
                                                
                                                   d
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                −
                                                
                                                   a
                                                   
                                                      1
                                                      m
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      2
                                                      m
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                      
                                                         f
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            m
                                                         
                                                      
                                                      
                                                   
                                                   ]
                                                
                                                −
                                                α
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                +
                                                
                                                   p
                                                   ℓ
                                                
                                                ≥
                                                0
                                                ,
                                                
                                                m
                                                ∈
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24b)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   r
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                ⊥
                                                
                                                   p
                                                   ℓ
                                                
                                                −
                                                α
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                −
                                                
                                                   b
                                                   1
                                                
                                                +
                                                
                                                   b
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      r
                                                      i
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      
                                                         i
                                                         ′
                                                      
                                                   
                                                   ]
                                                
                                                ≥
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24c)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   α
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                            *
                                                         
                                                         +
                                                         
                                                            r
                                                            
                                                               i
                                                            
                                                            *
                                                         
                                                      
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (24d)
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ≤
                                                
                                                   p
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ⊥
                                                   
                                                      S
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         ℓ
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         g
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

It is not difficult to see that the above system of KKT conditions is feasible following a similar procedure for proving Proposition 1 in Section 3.1 by applying Proposition 2.2.3 in Facchinei and Pang (2003). Specifically, we can show this by first finding the mapping F(f
                           
                              M
                           , r) that defines the VI of the KKT condition (24) on the set Z(x) ≜ {z≜(f
                           
                              M
                           , r) ≥ 0}, and then verifying the boundedness of the set L
                           <≜{z ∈ Z(x)∣z
                           
                              T
                           
                           F(z) < 0}. Since problem (8) is a maximization problem, the biofuel manufacturer’s profit value is bounded from below, i.e.,

                              
                                 
                                    
                                       
                                          
                                             p
                                             e
                                          
                                          
                                             (
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             h
                                             j
                                          
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             p
                                             j
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                       
                                    
                                 
                              
                           We can also show by contradiction that an optimal solution must have

                              
                                 
                                    
                                       
                                          
                                             p
                                             e
                                          
                                          
                                             (
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      J
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   f
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          −
                                          
                                             h
                                             j
                                          
                                          
                                             x
                                             j
                                          
                                          −
                                          
                                             p
                                             j
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          j
                                          ∈
                                          J
                                          .
                                       
                                    
                                 
                              
                           
                        

Given (4c) and pe
                           (·) is non-increasing with respect to ∑
                              j ∈ J
                           ∑
                              i ∈ I
                           
                           fij
                           , we have

                              
                                 (25)
                                 
                                    
                                       
                                          p
                                          j
                                       
                                       ≤
                                       
                                          p
                                          e
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       ≜
                                       
                                          
                                             p
                                             ¯
                                          
                                          j
                                       
                                       ,
                                       
                                       ∀
                                       j
                                       ∈
                                       J
                                       .
                                    
                                 
                              
                           
                        

Now we look at 
                              
                                 
                                    p
                                    ˜
                                 
                                 a
                              
                            and p
                           ℓ. There are two possible cases for the optimal value of 
                              
                                 
                                    p
                                    ˜
                                 
                                 a
                              
                           :

                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                p
                                                ˜
                                             
                                             a
                                          
                                          =
                                          0
                                       
                                    .

We need to bound the sum ∑
                                       i ∈ I
                                    
                                    fim
                                    , ∀m ∈ M from the above.

If ∃ i ∈ I such that fim
                                     > 0, then from (21a)
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      i
                                                      m
                                                   
                                                
                                                −
                                                
                                                   a
                                                   
                                                      1
                                                      m
                                                   
                                                
                                                +
                                                
                                                   a
                                                   
                                                      2
                                                      m
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         f
                                                         
                                                            i
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         ∑
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         f
                                                         
                                                            
                                                               i
                                                               ′
                                                            
                                                            m
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                −
                                                α
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                +
                                                
                                                   p
                                                   ℓ
                                                
                                                =
                                                0
                                                ,
                                             
                                          
                                       
                                    which yields,

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         m
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         
                                                            a
                                                            
                                                               1
                                                               m
                                                            
                                                         
                                                         −
                                                         
                                                            d
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                         +
                                                         α
                                                         
                                                            
                                                               p
                                                               ˜
                                                            
                                                            a
                                                         
                                                      
                                                      
                                                         a
                                                         
                                                            2
                                                            m
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            a
                                                            
                                                               1
                                                               m
                                                            
                                                         
                                                         −
                                                         
                                                            d
                                                            
                                                               i
                                                               m
                                                            
                                                         
                                                      
                                                      
                                                         a
                                                         
                                                            2
                                                            m
                                                         
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    If 
                                       
                                          
                                             f
                                             
                                                i
                                                m
                                             
                                          
                                          =
                                          0
                                          ,
                                          ∀
                                          i
                                          ∈
                                          I
                                          ,
                                       
                                     then

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         
                                                            i
                                                            ′
                                                         
                                                         m
                                                      
                                                   
                                                   =
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    Hence,

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         m
                                                         ∈
                                                         M
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      f
                                                      
                                                         i
                                                         m
                                                      
                                                   
                                                   ≤
                                                   max
                                                   
                                                      {
                                                      
                                                         0
                                                         ,
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                                  
                                                                     1
                                                                     m
                                                                  
                                                               
                                                               −
                                                               
                                                                  d
                                                                  
                                                                     i
                                                                     m
                                                                  
                                                               
                                                            
                                                            
                                                               a
                                                               
                                                                  2
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    Follow a similar procedure, we can obtain

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      r
                                                      i
                                                   
                                                   ≤
                                                   
                                                      
                                                         b
                                                         1
                                                      
                                                      
                                                         b
                                                         2
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    Therefore, we have

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                               ∪
                                                               J
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         +
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ≤
                                                   max
                                                   
                                                      {
                                                      
                                                         0
                                                         ,
                                                         
                                                            ∑
                                                            
                                                               m
                                                               ∈
                                                               M
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  a
                                                                  
                                                                     1
                                                                     m
                                                                  
                                                               
                                                               −
                                                               
                                                                  d
                                                                  
                                                                     i
                                                                     m
                                                                  
                                                               
                                                            
                                                            
                                                               a
                                                               
                                                                  2
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   +
                                                   
                                                      
                                                         b
                                                         1
                                                      
                                                      
                                                         b
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            J
                                                         
                                                      
                                                      
                                                         c
                                                         j
                                                      
                                                   
                                                   ≜
                                                   
                                                      l
                                                      ¯
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    Therefore, if p
                                    ℓ > 0, from (21e) we have

                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ∈
                                                         I
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               ∈
                                                               M
                                                               ∪
                                                               J
                                                            
                                                         
                                                         
                                                            f
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         +
                                                         
                                                            r
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      S
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         ℓ
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            ∈
                                                            I
                                                         
                                                      
                                                      
                                                         g
                                                         i
                                                      
                                                   
                                                   ≤
                                                   
                                                      l
                                                      ¯
                                                   
                                                
                                             
                                          
                                       
                                    Furthermore, 
                                       
                                          
                                             S
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                ℓ
                                             
                                             )
                                          
                                       
                                     is non-decreasing, so

                                       
                                          (26)
                                          
                                             
                                                
                                                   p
                                                   ℓ
                                                
                                                ≤
                                                S
                                                
                                                   (
                                                   max
                                                   
                                                      {
                                                      
                                                         0
                                                         ,
                                                         
                                                            l
                                                            ¯
                                                         
                                                         −
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  ∈
                                                                  I
                                                               
                                                            
                                                            
                                                               g
                                                               i
                                                            
                                                         
                                                      
                                                      }
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 


                                    
                                       
                                          
                                             
                                                p
                                                ˜
                                             
                                             a
                                          
                                          >
                                          0
                                          .
                                       
                                    
                                 

In this case, if 
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          α
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   m
                                                
                                                *
                                             
                                             +
                                             
                                                r
                                                
                                                   i
                                                
                                                *
                                             
                                             )
                                          
                                          >
                                          0
                                          ,
                                       
                                     then ∃ i ∈ I, j ∈ J such that fij
                                     > 0 and from (21b), we have

                                       
                                          (27)
                                          
                                             
                                                
                                                   p
                                                   ℓ
                                                
                                                ≤
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      J
                                                      ,
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   {
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                ≤
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      J
                                                      ,
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   {
                                                   
                                                      
                                                         p
                                                         ¯
                                                      
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                    and

                                       
                                          (28)
                                          
                                             
                                                
                                                   
                                                      p
                                                      ˜
                                                   
                                                   a
                                                
                                                ≤
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      J
                                                      ,
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   {
                                                   
                                                      p
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                ≤
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      α
                                                   
                                                
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      J
                                                      ,
                                                      i
                                                      ∈
                                                      I
                                                   
                                                
                                                
                                                   {
                                                   
                                                      
                                                         p
                                                         ¯
                                                      
                                                      j
                                                   
                                                   −
                                                   
                                                      d
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                ≜
                                                
                                                   
                                                      p
                                                      ¯
                                                   
                                                   a
                                                   ′
                                                
                                             
                                          
                                       
                                    
                                 

While if 
                                       
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             f
                                             
                                                i
                                                j
                                             
                                          
                                          =
                                          α
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   M
                                                
                                             
                                             
                                                f
                                                
                                                   i
                                                   m
                                                
                                                *
                                             
                                             +
                                             
                                                r
                                                
                                                   i
                                                
                                                *
                                             
                                             )
                                          
                                          =
                                          0
                                          ,
                                       
                                     then 
                                       
                                          
                                             p
                                             ℓ
                                          
                                          =
                                          0
                                          ,
                                       
                                     and it is not feasible to (21c).

@&#REFERENCES@&#

