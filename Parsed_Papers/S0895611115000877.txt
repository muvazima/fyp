@&#MAIN-TITLE@&#Statistical shape model reconstruction with sparse anomalous deformations: Application to intervertebral disc herniation

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A sparse reconstruction algorithm from statistical shape models is proposed.


                        
                        
                           
                           The technique allows quantifying morphological anomalies.


                        
                        
                           
                           Evaluation on intervertebral disc herniation data showed improvements in diagnosis.


                        
                        
                           
                           The sparse reconstruction can deliver novel quantitative descriptors of pathologies.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Statistical shape model

Sparse optimization

Computer-aided diagnosis

Segmentation

Intervertebral disc

Herniation

Magnetic resonance imaging

@&#ABSTRACT@&#


               
               
                  Many medical image processing techniques rely on accurate shape modeling of anatomical features. The presence of shape abnormalities challenges traditional processing algorithms based on strong morphological priors. In this work, a sparse shape reconstruction from a statistical shape model is presented. It combines the advantages of traditional statistical shape models (defining a ‘normal’ shape space) and previously presented sparse shape composition (providing localized descriptors of anomalies). The algorithm was incorporated into our image segmentation and classification software. Evaluation was performed on simulated and clinical MRI data from 22 sciatica patients with intervertebral disc herniation, containing 35 herniated and 97 normal discs. Moderate to high correlation (R
                     =0.73) was achieved between simulated and detected herniations. The sparse reconstruction provided novel quantitative features describing the herniation morphology and MRI signal appearance in three dimensions (3D). The proposed descriptors of local disc morphology resulted to the 3D segmentation accuracy of 1.07±1.00mm (mean absolute vertex-to-vertex mesh distance over the posterior disc region), and improved the intervertebral disc classification from 0.888 to 0.931 (area under receiver operating curve). The results show that the sparse shape reconstruction may improve computer-aided diagnosis of pathological conditions presenting local morphological alterations, as seen in intervertebral disc herniation.
               
            

@&#INTRODUCTION@&#

Prior shape modeling of human organs plays a distinctive role in many medical image processing algorithms, including image registration, segmentation, surgical planning or computer-aided diagnosis (CAD) [1,2]. Statistical shape models (SSM) of Cootes et al. [3] have become one of the most widely used algorithms for defining anatomical shape spaces and shape similarities [1]. The standard formulation of the SSM using principle component analysis (PCA) captures general anatomical variation by defining a space of plausible shapes (within certain standard deviations from the mean shape). If normal (i.e. healthy) shapes were used in the training, this shape space can be attributed to represent ‘normal’ instances. On the other hand, the SSMs cannot model local shape deformations that are not statistically significant in the training dataset. Many pathological conditions, such as intervertebral disc (IVD) herniation, locally affect the anatomical morphology and challenge automated processing techniques (e.g. segmentation, CAD) that rely on strong prior shape assumptions.

Modeling relevant local information has been attempted with hierarchical shape modeling [4], sparse PCA [5] or medial shape representations [6]. However, these techniques still require the presence of similar shape instances in the training set. Focused shape models of Chandra et al. [7] enable to increase shape modeling sensitivity by targeting specific anatomical sub-regions. This strategy should hypothetically help to improve the modeling of ‘common’ anomalous (e.g. herniated) areas but is unlikely to capture larger pathological deformations (e.g. migrations of disc material) in absence of specific training data.

Sparse optimization techniques have become a popular choice in computer visions and medical image processing applications dealing with modeling of local anomalies. A sparse optimization was used to robustly recognize facial expressions from large training datasets in the presence of occlusions and corrupted data [8]. Sparse representation shape models of Li et al. [9] define the shape space as a convex hull of sparse linear representations of training data which considerably improves accuracy of face localization in images. Sparse shape composition of Zhang et al. [10] represents a test shape instance as a sparse linear combination of training data and defines regions of specific local deformations. It has been successfully applied in several challenging medical image segmentation problems, such as lung localization and liver segmentation [10,11] or cardiac motion analysis [12], where modeling of previously unseen local shape deformations is required. Further improvements in medical image segmentation were achieved by combining sparse reconstructions of shape subregions [13,14] and by sparse modeling of the signal intensity appearance in the form of active appearance models [14]. The sparse shape composition and its alternatives have been shown to improve deformable model segmentation of anatomical features with pathologies that substantially alter the shape morphology. However, because the sparse shape composition uses prior information in the form of a linear combination of a subset of training shapes, it is not clear how to anatomically interpret the detected sparse anomalous differences. Unlike the SSMs, the definition of a ‘normal’ shape space and a shape distance metric is not available with the sparse shape composition. While it does not hinder the application to image segmentation, these notions are important for quantification of the pathology and for designing a CAD system.

The aim of this work is to combine the advantages of sparse optimization and SSMs in order to deliver quantitative descriptors suitable for shape comparisons and classifications. The presented method of sparse reconstruction will be applied to the clinical case of IVD herniation. The hypothesis of this research is that the proposed sparse shape reconstruction can deliver sensible CAD of IVD herniation with the potential to provide novel quantitative descriptors of the lesions. The method will preserve the benefits of strong prior knowledge in the form of SSM while being able to automatically identify, quantify and classify areas of local shape abnormalities that cannot be modeled a priori (as is the case with the IVD herniation). As a result, quantitative descriptors of the morphological characteristics of the herniation that can serve as a basis for efficient radiological diagnosis will be readily available.

The clinical application presented in this study, the IVD herniation, figure among the most common causes of low back pain. The term herniation encompasses a range of acute or chronic IVD pathologies (e.g. IVD bulge, protrusion, extrusion or sequestered disc) [15] and the references often differ in the reporting nomenclature and classification of the radiological findings [16]. Accurate and precise descriptions of normal and pathologic conditions of lumbar discs are therefore highly desirable. CAD systems capable to efficiently deliver quantitative information and consistent classification can have a significant impact on clinical diagnostic and therapeutic decision making.

Previous CAD approaches for IVD herniation utilized a variety of algorithmical strategies. Herniation detection has been performed using features derived from the appearance of the IVD in magnetic resonance imaging (MRI) (e.g. raw intensity [17], mean intensities of IVD subregions [18], textural features [18,17]) and morphological features describing the IVD shape in a two-dimensional (2D) cross-section (major and minor axis [19,18], statistical models of global shape variations [20], geodesic distance to a healthy shape space [21]). The presented output of the classification is usually a binary decision about the normality of the IVD. To the best of our knowledge, computer-based reporting of quantitative characteristics of the herniation or sub-classification of the herniation to one of the clinically used nomenclatures has not been previously presented. Moreover, previous methods of computerized assessment of IVD herniation from MRI have been based on analyses of one (typically the mid-sagittal) 2D slice. However, IVD herniation is a three-dimensional (3D) pathology that affects the IVD in diverse locations in various forms and shapes. An evidence of improving CAD by 3D analysis of IVD volumes has been previously presented for the case of the degenerative disc disease [22] but not applied for CAD of IVD herniation.

Classification of IVD herniation has been based on features extracted from pre-segmented IVDs. MRI segmentation of IVDs relies on signal intensity appearance cues and strong shape priors that in combination increase the segmentation performance. Several studies generated and employed prior probabilistic atlases of the spine shape in the segmentation [23,24], or created parametric models of the IVD anatomical structure [25,26]. The SSMs have also been a popular approach to modeling the prior shape constraints in the lumbar spine. They have been employed in the MRI segmentation of IVDs [27,28,20], vertebrae [29,28] and other musculoskeletal structures [7,30,31] but their use in CAD of IVD herniation remain largely unexplored.

@&#METHODS@&#

The sparse reconstruction algorithm is presented in Section 2.1. The reconstruction was first evaluated using simulated data (Section 2.2). Validation on real data is presented in Section 2.3 where the sparse reconstruction was incorporated into an image segmentation algorithm (Section 2.3.2) and into a herniation classification pipeline (Section 2.3.3).

The proposed method supposed that a dataset of training shapes is available in the form of a SSM. For the purpose of this study, explicit shape representations by 3D mesh coordinates were used. Point-wise corresponding representations of the training shapes were obtained using the method of optimization of description length according to Davies et al. [32,33] using generalized Procrustes alignment [34]. The training dataset consisted of K
                        =69 3D meshes 
                           
                              
                                 
                                    x
                                 
                              
                              k
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 3
                                 N
                              
                           
                         (the 3D coordinates are concatenated into one vector) with N
                        =4098 vertices 
                           
                              v
                              i
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              3
                           
                        , i
                        =1, …, N and M
                        =8192 facets 
                           
                              f
                              j
                           
                           ∈
                           
                              
                                 
                                    ℤ
                                 
                              
                              3
                           
                        , j
                        =1, …, M.

The SSM method [3] finds modes of shape variation in the training data (matrix 
                           
                              
                                 P
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 3
                                 N
                                 ×
                                 K
                              
                           
                        ), and allows generating instances similar to training shapes as 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                              
                              ¯
                           
                           +
                           
                              
                                 P
                              
                           
                           
                              
                                 b
                              
                           
                        , where 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                              
                              ¯
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 3
                                 N
                              
                           
                         is the mean training shape, and 
                           
                              
                                 b
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              K
                           
                         are weights of the modes of variation, also called shape parameters. Reconstruction of an existing shape y is usually done by optimizing the shape parameters to minimize the reconstruction error e:
                           
                              (1)
                              
                                 
                                    min
                                    
                                       
                                          
                                             b
                                          
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       e
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 ,
                                 
                                 
                                 
                                 
                                    
                                       e
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             y
                                             ′
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                    
                                 
                                 ,
                              
                           
                        where y′ is the input shape y after spatial alignment to the mean shape 
                           
                              
                                 
                                    
                                       x
                                    
                                 
                              
                              ¯
                           
                         (e.g. using generalized Procrustes alignment [34]). This formulation with ℓ2 norm represents a quadratic optimization problem with smooth and convex cost function that can be efficiently solved for global minima. However, this reconstruction does not allow capturing local shape deformations that are not statistically significant in the training dataset.

Reconstruction with specific local deformations can be achieved by including the error vector e in the reconstruction optimization, as suggested by Zhang et al. [10]. This vector will represent local shape deformation from what would be a ‘normal’ shape. As such, it should only allow a subset of vertices to deviate from the shape inferred by the SSM, i.e. be sparse. In addition, this deviation should be spatially consistent, i.e. somewhat ‘smooth’. For this purpose, the reconstruction error vector was modeled as e
                        =
                        Sd, where 
                           
                              
                                 d
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 3
                                 N
                              
                           
                         is a sparse vector of displacement of mesh vertices, and 
                           
                              
                                 S
                              
                           
                           ∈
                           
                              
                                 
                                    ℝ
                                 
                              
                              
                                 3
                                 N
                                 ×
                                 3
                                 N
                              
                           
                         is a smoothing matrix. The reconstruction is reformulated as:
                           
                              (2)
                              
                                 
                                    min
                                    
                                       
                                          
                                             b
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       
                                          
                                             y
                                             ′
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                                 −
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 ,
                                 
                                 
                                    subject
                                       
                                    to
                                 
                                 
                                 ∥
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    0
                                 
                                 ≤
                                 k
                                 ,
                              
                           
                        where k is a sparsity constant.

Previous work in sparsity theories and sparse optimization has shown that for a sparse enough solution, the following reformulation (convex relaxation) is an accurate analogy to Eq. (2) that also leads to the sparsest of all solutions, while avoiding the non-convex ℓ0 norm [35,36]:
                           
                              (3)
                              
                                 
                                    min
                                    
                                       
                                          
                                             b
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       
                                          
                                             y
                                             ′
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                                 −
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 λ
                                 ∥
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    1
                                 
                                 .
                              
                           
                        
                     

Without any additional constraint on the shape parameters b, large variations can be inferred to the reconstructed shape, which can result in anatomically non-plausible shape instances. During traditional SSM reconstruction (Eq. (1)), the shape parameters b are usually restricted to lie within 2 or 3 standard deviations of each mode of variation.

The final reconstruction that is proposed in this work has therefore the following formulation:
                           
                              (4)
                              
                                 
                                    min
                                    
                                       
                                          
                                             b
                                          
                                       
                                       ,
                                       
                                          
                                             d
                                          
                                       
                                    
                                 
                                 ∥
                                 
                                    
                                       
                                          
                                             y
                                             ′
                                          
                                       
                                    
                                 
                                 −
                                 
                                    
                                       
                                          
                                             x
                                          
                                       
                                    
                                    ¯
                                 
                                 −
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       b
                                    
                                 
                                 −
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 
                                    λ
                                    1
                                 
                                 ∥
                                 
                                    
                                       b
                                    
                                 
                                 
                                    ∥
                                    2
                                    2
                                 
                                 +
                                 
                                    λ
                                    2
                                 
                                 ∥
                                 
                                    
                                       d
                                    
                                 
                                 
                                    ∥
                                    1
                                 
                                 .
                              
                           
                        
                     

Adding the ℓ2 norm condition for b in Eq. (4) will enable to control the tradeoff between SSM inference and specific local deformations d. Increasing the parameter λ
                        1 will limit the amount of shape variations explained by the SSM and hence allows more deformation information to be captured in the sparse component d. On the other hand decreasing the parameter λ
                        1 will enlarge the space of allowed variation inferred by the SSM and hence limits the amount of sparse local deformation in d. This formulation allows a balance between the global variation component b (by changing λ
                        1) and the local sparse deformation component d (by changing λ
                        2) to be determined for different applications. The influence of the parameters in our experiments is illustrated in Section 2.4.

Although the cost function in Eq. (4) is not smooth or quadratic, it is continuous and convex which allows the use of efficient optimization algorithm for finding the optimal solution. There is a variety of modern sparse optimization techniques solving computationally expensive problems in signal and image processing [37–41]. Two optimisation techniques were evaluated and compared in this study. The chosen algorithms were: the Fast Iterative Shrinkage Thresholding Algorithm (FISTA) [42] (similarly to Zhang et al. [10]), and the Homotopy-based optimization [43] thanks to their computational efficiency. The comparison is presented in Section 2.4.

The technique chosen for this study was, similarly to Zhang et al. [10], the Fast Iterative Shrinkage Thresholding Algorithm (FISTA) [42] due to its computational efficiency.

Experimental quantitative descriptors of IVD herniation were proposed and tested on simulated IVD herniation data (Section 2.2). Artificial deformation was applied to a randomly chosen healthy IVD (Fig. 1
                        a) from the SSM training shapes in the following fashion. A mesh vertex in the posterior disc area was selected as the center point and a smooth deformation was applied to a region surrounding the center point (Fig. 1b). The amount of local deformation was chosen randomly from pre-defined ranges (region diameter between 10 and 40mm, maximal displacement between 3 and 5 mm).

Regions of abnormal deformation were subsequently detected (Fig. 1c) using the proposed reconstruction algorithm and the following quantitative measures were computed: (a) average displacement per mesh vertex from a ‘normal’ shape (defined by the SSM) and (b) the central point of the detected region (mesh point minimizing the distance from all points in the region).

This experiment was repeated 200 times. For each repetition, the distance between the center of the detected region and the center of the simulated region was computed. The simulated and detected average displacements were compared and the Pearson's correlation coefficient was determined.

Evaluation on real MRI data was performed as a binary classification problem, aiming to detect herniated IVDs. The input MRI images were first segmented using a combination of established techniques with the sparse reconstruction, and then classified based on features describing the morphology and MRI signal intensity.

Sagittal T2-weighted turbo spin echo scans were acquired from 22 patients presenting to the University Hospital of Heidelberg, Germany, for MRI investigation of symptomatic conditions of the lumbar spine. T2-weighted sagittal images (11–21 slices) were acquired with in-plane resolution 0.71mm×0.71mm (image matrix 448×448), slice thickness 3mm and slice spacing 3.3mm. MRI scans from of all patients imaged six lumbar IVDs (T12/L1–L5/S1) and the combined database of 132 IVDs was used in the segmentation and classification experiments.

The radiological assessment was performed by DS (under supervision of MW) and the findings included: a bulging disc (N
                           =13), focal protrusion or extrusion (N
                           =20), and broad-based protrusion or extrusion (N
                           =15). At least one herniated IVD was identified in every patient.

Manual segmentations of a subset of lumbar discs (N
                           =49, including all discs with a herniation) were obtained by an experienced radiographer (Dr. Mark W Strudwick, University of Queensland).

The MRI images were pre-processed using a bias field correction algorithm [44], smoothed by anisotropic diffusion (20 iterations with a time step 0.01 and conductance 1.0) and reformatted using B-Spline image interpolation to an isotropic resolution of 0.71mm. Previously presented volumetric segmentation algorithm was applied to extract 3D shapes of IVDs and vertebral bodies [28]. The algorithm was manually initialized by identifying centers of visualized vertebral bodies in the mid-sagittal cross-section (one click per vertebra). All subsequent processing presented in this study was fully automated. This manual step could potentially be replaced with one of several recently proposed automated labeling techniques [45–47], hence providing a fully automated pipeline. Nevertheless, choosing and validating an appropriate automated localization method was beyond the scope of the current study.

The segmentation algorithm [28] was based on active shape models (ASMs) had been previously validated on cases with degenerative disc disease [22]. For the purpose of this study, a SSM of healthy lumbar IVDs was constructed using 62 manual segmentations from the previous study [28] (seven degenerative IVDs were removed from the previously used SSM consisting of 69 shapes [28]). This allows to better define a space of ‘normal’ shapes that can be used to obtain quantitative descriptors. Therefore the test data (herniated IVDs) often lie outside of the ‘normal’ shape space. Constraining the deformations using a global IVD shape morphology would limit the accuracy on abnormal IVDs with local deformations. To minimize this, a focused shape models of the posterior IVD region were used to improve the segmentation performance [7]. The region of focus was defined to encompass the area where the clinically most relevant herniation lesions occur (Fig. 2
                           ). These segmentation results were then locally relaxed to the local gradient extrema, after which the sparse shape reconstruction (Section 2.1) was applied.

The segmentation algorithm was evaluated at four stages: initial segmentation [28], focused shape model segmentation, gradient relaxation, and after sparse reconstruction. The dice similarity coefficient (DSC) [48] on the entire IVD volume, and the mean absolute vertex-to-vertex mesh Distance (MAVD) on the posterior IVD region (Fig. 2 with threshold of 0.5) were used as evaluation metrics. The segmentation accuracy between focused shape model segmentation and sparse reconstruction results was evaluated for statistical significant using paired Student's t-test.

There are currently no established quantitative descriptors of IVD herniation used in clinical practice. The pertinence of quantitative features derived from the sparse reconstruction was evaluated using qualitative classification of real MRI data after IVD segmentation (Section 2.3.2). The input dataset of 132 IVDs was split based on radiological reports into two classes. The first class contained healthy IVDs and IVDs with minor bulges (N
                           =97). The second class contained IVD with identified protrusions, extrusions or other type of pathological herniations (N
                           =35).

The classification features were comprised in the following groups:
                              
                                 1.
                                 Global geometrical features (N
                                    =3)

The geometrical features included volume (number of voxels), surface area (number of edge voxels, assuming a 6-connected neighborhood), and the number of edge regions (assuming a 6-connected neighborhood).

SSM shape parameters (N
                                    =6)

Shape parameters corresponding to the first 6 modes of variation were used as global shape descriptors in the classification.

Focused shape model parameters (N
                                    =6)

Similarly to SSM, shape parameters corresponding to the first 6 modes of the focused shape model were used to describe variation in the posterior disc region.

Descriptive statistics of the posterior IVD region (N
                                    =6)

In each sagittal slice, a line linearly connecting corners of adjacent vertebral bodies was defined (see [49] for more details). The IVD material posteriorly overpassing this line was quantified by its volume (absolute and relative to the whole IVD) and the distribution among sagittal slices (mean, variance, skewness and kurtosis) (Fig. 3
                                    a).

Difference between ASM segmentation and final segmentation (N
                                    =4)

The per-vertex differences in the segmentation of the posterior IVD region between the initial (ASM) and final (after sparse reconstruction) stage of the algorithm were computed. The differences were quantified by the distribution over the posterior IVD region (mean, variance, skewness and kurtosis) (Fig. 3b).

Deformations detected by sparse reconstruction (N
                                    =7)

Displacements detected during the sparse reconstruction (vector d in Eq. (4), Fig. 3c) were quantified by the per-vertex distribution (mean, variance, skewness, kurtosis). Moreover, an empirical threshold of 0.5mm was used and three additional quantities were computed over the vertices with displacement values above the threshold (number of vertices, mean and variance of the displacements).

Raw MRI signal intensity (N
                                    =6)

Features were derived from the descriptive statistics of MRI signal intensities within the segmented IVD (mean, median, standard deviation, minimum, maximum, 25th percentile)

MRI signal intensity gradient (N
                                    =10)

Gradient based features were computed as descriptive statistics of gradient norms using both ℓ1 and ℓ2 norms (sum, mean, standard deviation, minimum, maximum).

Gray-Level Co-occurrence Matrix (GLCM) (N
                                    =8)

The GLCM textural features consisted of the mean and standard deviation of contrast, correlation, energy and homogeneity [50].

Linear discriminant analysis (LDA) was used as classification algorithm. Repeated (300 times) stratified (keeping the same ratio of positive and negative samples in each class) two-fold cross-validation was performed, using 60% of samples for training and 40% for cross-validation. Feature selection by backward elimination was employed, using Area Under receiver operating Curve (AUC) as the primary metric for evaluation of the classification performance.

Initially, the classification was evaluated separately on each group of features. Next, the feature groups were combined into sets of global morphological, local morphological and MRI signal features. Further, the features were combined all together. To specifically assess the importance of the local morphological features available via the sparse reconstruction, the features related to the reconstruction (groups 4–6) were removed from the combined set of all features in the next experiment. Lastly, the classification was performed using all features except for the sparse displacement features (group 6). These features can constitute basis for novel quantitative descriptors and this experiment aimed to confirm their importance in gaining maximal classification performance.

@&#IMPLEMENTATION DETAILS@&#

The smoothing matrix S in Eq. (4) was computed from the mesh connectivity matrix. Smoothing of vertex scalar values was based on Gaussian-weighted (with variance σ
                        2) averaging of the scalar values over a local mesh neighbourhood N
                        
                           i
                         with radius r. The matrix S is therefore determined by the mesh of the statistical shape model and the two smoothing parameters r and σ. Several values of parameters r (r
                        ∈{1, 2, 3, 4}) and σ (σ
                        ∈{1mm, 2mm, 5mm, 10mm}) were evaluated in phantom experiments. The effect of different smoothing matrices on the final reconstruction was minimal. This can be explained by the fact that the smoothed vector Sd with this implementation is also sparse and therefore substituting the displacement vector for d′=
                        Sd will reach the same results. The matrix was therefore set to identity for all experiments in this study. Other designs of the smoothing matrix S that would not result in sparse vector Sd would fit to the proposed framework and can be considered in other studies.

Two optimization techniques (FISTA and Homotopy) were evaluated on simulated data. The correlation coefficient between the simulated displacements and the displacements detected by each method was used as a measure of quality of reconstruction (Fig. 4
                        ). The FISTA algorithm was found to deliver better results and was used in all experiments on real data in this study.

A range of parameters λ
                        1 and λ
                        2 (Eq. (4)) were evaluated in simulated experiments: λ
                        1, λ
                        2
                        ∈{0.0001, 0.001, 0.01}. The correlation coefficient between the simulated displacements and the displacements detected by the FISTA algorithm with different parameters was used as a measure of quality of reconstruction (Fig. 4c). The final values were empirically set according to Fig. 4c to λ
                        1
                        =
                        λ
                        2
                        =0.001 and kept constant for all experiments on real data in this study.

The reconstruction was spatially restrained to focus on the posterior IVD region (Fig. 2) using the methods of weighted PCA and focused shape models [7].

Parameters of the segmentation algorithm were kept the same as in the previous study [28]. The focused shape model segmentation was run for 50 iterations. Subsequently, one relaxation iteration to the local gradient extrema was applied before the sparse reconstruction. The FISTA optimization during sparse reconstruction was run for k
                        =50 iterations (global rate of convergence is O(1/k
                        2)). The average reconstruction time in the simulated experiments was 15s (a single thread on an Intel 2.83GHz Dual Core PC with 8GB RAM).

@&#RESULTS AND DISCUSSION@&#

Histogram of distances between simulated and detected center points of the herniation are presented in Fig. 5
                        . Correlation between the simulated and detected mean displacements per vertex of the herniated region was R
                        =0.73 (Fig. 4b).

The majority of center points of the detected herniated regions were within 15mm of the original center points (Fig. 5). For comparison, the average transversal diameter of the cartilage end-plates have been reported between 36.3 and 44.6mm in lumbar IVDs [51]. This indicates that in most cases, it is possible to approximately identify whether the herniation occurred in the left, central or right posterior IVD region. Similar identification of lateral regions of herniation occurrence is currently performed in radiological practice.

The current results on simulated herniation data suggest that the sparse reconstruction have the potential to deliver novel and sensible quantitative measures. Further work is however needed to identify most relevant morphological descriptors of the herniation, and to clinically validate proposed surrogate measures, such as the average per-vertex displacement (Fig. 4). Strengthening validation of the quantitative descriptors will require precise annotations of the herniated disc material and proper definitions of the required measurements. The quantitative features proposed here serve as a proof of concept of the sparse reconstruction and motivation for future work into this area.

Quantitative evaluation of the segmentation algorithm using 49 manually segmented IVDs is presented in Fig. 6
                           . The mean DSC over the entire IVD volume was 0.815±0.048, 0.844±0.048, 0.866±0.044 and 0.862±0.044, after ASM segmentation, focused shape model segmentation, gradient relaxation and after sparse reconstruction respectively. The mean MAVD evaluated at the posterior IVD region was 1.22±0.27mm, 1.23±0.28mm, 1.08±0.33mm and 1.07±0.30mm at each stage respectively.

Local gradient relaxation improves accuracy of the segmentation of herniated IVDs. This is true both for the entire IVD volume (as measured by DSC) as well as for the posterior IVD region where the herniations occur (as measured by MAVD). No considerable improvement of the segmentation accuracy was expected after the sparse reconstruction since the reconstruction is not driven by the MRI signal intensity. However, the reconstruction acts as a regularization filter removing noisy displacements due to unreliable appearance cues. Furthermore, it detects regions of anomalous deformations and enables quantification of the abnormality. The improvements between focused shape model segmentation and sparse shape reconstruction were nevertheless statistically significant for both quantitative metrics (p
                           <0.001 for DSC, and p
                           <0.001 for MAVD). This results further illustrates the importance of the sparse modelling of the local deformations that cannot be captured by statistical shape models, even when focused on the posterior region.

The presented quantitative measures indicate good segmentation performance on herniated IVDs in comparison with the literature. Previous segmentation approaches for herniated IVDs have been presented for 2D slices only, achieving varying ranges of mean DSC values (0.84 [52], 0.9235±0.0160 [53]). Similar DSC values have been obtained for segmentation of 2D MRI data acquired from patients with degenerative disc disease (0.89 [23]) or scoliosis (0.85 [54]). Although comparison between 2D and 3D techniques that were validated on diverse datasets is complicated, the presented segmentation results are comparable to those presented in recent literature. Furthermore, recently presented validation studies showed a good reproducibility and validity of automated measurements obtained with the same segmentation techniques [22,49]. Most importantly, the automated measures were equivalent to manual measures in detecting acute morphological IVD changes in response to exercise [49]. Finally, obtaining accurate location, size and scoring in a CAD (the goal of the present study) does not necessarily require ‘perfect’ morphological segmentations. If the system is able to detect where the herniation occurs and describe the type of present pathology (bulge, protrusion or extrusion, focal or broad-based), it would help the radiological assessment even without full segmentation of the pathology.

The classification results are summarized in Table 1
                           . It can be seen that features derived from MRI signal intensity (groups 7–9) achieve the best detection sensitivity. The highest sensitivity of 0.924 was achieved when using raw intensity features (group 7). Descriptive statistics of the posterior IVD region (group 4) performed the best in terms of AUC (0.861), accuracy (0.803) and specificity (0.834). Combination of feature groups into sets of global (groups 1–3) and local (groups 4–6) morphological descriptors (provided by the sparse reconstruction), and MRI signal features (groups 7–9) lead to improvements of most classification metrics. The best AUC (0.904), accuracy (0.850) and specificity (0.884) were obtained with morphological features (local or combined), while the highest sensitivity was achieved with MRI signal features (0.864). Finally, combination of all features together lead to further increase in AUC (0.931), accuracy (0.865). The specificity (0.881) was comparable to that of local morphological features (0.884). The sensitivity value (0.813) however did not reach the value of 0.924 that was achieved with raw intensity features only.

The high sensitivity of the raw intensity features can be related to degenerative changes (reflected as alteration of IVD appearance in T2-weighted MRI scans) that are associated with the herniation. On the other hand, many degenerative discs do not present a herniation, which explains why the MRI signal features present a higher number of false positives. The results confirm the importance of proposed local morphological features from the sparse reconstruction. They are able to decrease the number of false positive samples and improve the AUC, specificity and accuracy. The importance of the local morphological features (groups 4–6), including the sparse displacements (group 6) is confirmed by the results presented in Table 2
                           . The AUC drops from 0.931 to 0.888 after removing local morphological features, and to 0.916 when the sparse anomalous displacements (group 6) are removed, and the same trend is observed for the remaining metrics. These results suggest that the local morphological features contain important information about the herniation and motivate future clinical validation of quantitative descriptors based on the sparse reconstruction.

Comparison with other classification studies needs to be exercised with caution. The validation datasets considerably differ in size, imaging parameters and validation strategies. The main goal of this study is to present innovative features that are easily interpretable and can consequently lead to introduction of novel quantitative descriptors to clinical practice [55]. Previous works focusing on maximizing classification performances have achieved sensitivity and specificity of 0.864 and 0.966 [19], 0.94 and 0.91 [56], 0.925 and 0.959 [18] on similar datasets. However, the analyses were performed on one (mid-sagittal) 2D slice, which did not allow assessment of lateral herniations, and generally did not provide means to quantify the extent of the herniation.

The proposed sparse technique is capable to identify regions of anomalous deformations and, more importantly, to quantify the difference of a shape instance from what would be considered a ‘normal’ shape according to a training database. Quantification of shape abnormality is a crucial task in designing CAD systems and can have a large impact in detection of many pathologies. The potential impact was indicated on the example of IVD herniation by proposing novel quantitative features with positive effect on automated herniation classification.

This sparse reconstruction method develops on the sparse shape composition of Zhang et al. [10] by incorporating the following two modifications. First, the data fitting employs a SSM, rather than a linear combination of training shapes. The linear shape combination has many advantages but the SSM represents a compact representation of the training data and as such, has the ability to define a ‘normal’ shape. It is not clear how this definition can be formulated with the sparse shape composition. Second, the SSM formulation (Eq. (4)) allows certain control on how much of the deformations should be captured by the sparse displacements and how much should be explained by the SSM (parameters λ
                        1 and λ
                        2 in Eq. (4)), or equivocally, how much ‘normality’ should be imposed. This results in better flexibility and customizability to various CAD tasks.

The results showed the positive impact that the novel quantitative feature had on the classification performance. On the other hand, the analyses showed in some cases a contradictory trend for the sensitivity when combining different feature groups. Future work will be required to optimize the classification design in order to obtain the highest sensitivity and specificity at the same time. This can be achieved by combination of multiple advanced classification techniques, such as Bayesian classifiers, support vector machines or random forests.

Although the present study motivates the use of sparse reconstruction in automated IVD assessment, future work will be required to design and validate more clinically relevant measures. This will be explored together with further sub-classification into different types of herniation (broad-based or focal, protrusion, extrusion or sequestered disc) in future work. Overcoming the requirement for manual initialization will be investigated in the future as it will fully automated the pipeline.

@&#CONCLUSION@&#

Anatomical features with local pathological deformations challenge existing shape modeling techniques based on strong shape priors. This study introduced a sparse reconstruction method that is capable to overcome this limitation. It employs prior morphological knowledge in the form of statistical shape models and detects local anomalous deformations with sparse optimization. It can infer shape instances globally similar to training data, while allowing to quantify specific local deformations, supposedly present due to pathology. Effectiveness of this method was evaluated using phantom and real MRI data presenting IVD herniations. Results on simulated data encourage the search for novel quantitative descriptors of IVD herniation with the proposed technique. Experiments on patient MRI data show the advantages of using the proposed quantitative descriptors in CAD systems. Future work will focus on identifying quantitative features allowing differentiating and annotating different types of IVD herniation.

The authors have no conflict of interest to disclose.

@&#ACKNOWLEDGMENTS@&#

This research was supported under Australian Research Council's Linkage Projects funding scheme LP100200422.

The authors would like to thank Dr. Mark W Strudwick from the University of Queensland for performing manual segmentation.

@&#REFERENCES@&#

