@&#MAIN-TITLE@&#Incremental learning from chunk data for IDR/QR

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new implementation of the batch IDR/QR method.


                        
                        
                           
                           Our new implementation is theoretically equivalent to the original one but is more efficient.


                        
                        
                           
                           Based on our new implementation of batch IDR/QR, we propose the chunk IDR method.


                        
                        
                           
                           Chunk IDR is capable of processing multiple data instances at a time.


                        
                        
                           
                           Chunk IDR can accurately update the discriminant vectors when new data items are added dynamically.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Feature extraction

Dimensionality reduction

Linear discriminant analysis

Small sample size problem

Incremental learning

@&#ABSTRACT@&#


               
               
                  IDR/QR, which is an incremental dimension reduction algorithm based on linear discriminant analysis (LDA) and QR decomposition, has been successfully employed for feature extraction and incremental learning. IDR/QR can update the discriminant vectors with light computation when new training samples are inserted into the training data set. However, IDR/QR has two limitations: 1) IDR/QR can only process new samples one instance after another even if a chunk of training samples is available at a time; and 2) the approximate trick is used in IDR/QR. Then there exists a gap in performance between incremental and batch IDR/QR solutions. To address the problems of IDR/QR, in this paper, we propose a new chunk IDR method which is capable of processing multiple data instances at a time and can accurately update the discriminant vectors when new data items are added dynamically. Experiments on some real databases demonstrate the effectiveness of the proposed algorithm over the original one.
               
            

@&#INTRODUCTION@&#

Linear discriminant analysis (LDA) [1] is a well-known supervised feature extraction algorithm for pattern recognition. LDA aims to find a set of projection vectors to maximize the between-class scatter matrix and minimize the within-class scatter matrix at the same time. In many applications, however, LDA often suffers from the so-called small sample size (SSS) problem or undersampled problems [2], where the number of samples is smaller than the dimensionality of the feature space. To address this problem, many efficient LDA-based methods, e.g. principal component analysis (PCA)+LDA [3], null space based LDA (NLDA) [4–6], LDA/GSVD [7], complete CLDA (CLDA) [8], and dual-space LDA (DSLDA) [9], have been proposed to deal with the high-dimensional data and learn the optimal discriminant vectors.

PCA+LDA, also called Fisherfaces, may be the most popular method to address the SSS problem. To make the within-class scatter nonsingular, it first uses PCA to reduce the dimensionality of samples to n
                     −
                     c, where n is the number of the training samples and c is the number of the classes, before the application of LDA. Since the smallest c
                     −1 projection components are thrown away in the PCA step, some useful discriminatory information will be lost. The NLDA method supposes that the most discriminant information is contained in the null space of within-class scatter. In order to obtain the discriminant information in the null space of within-class scatter, NLDA firstly transforms the data into the null space of within-class scatter and then maximizes the between-class scatter. A drawback of NLDA is that it solves the discriminant vectors only in the null space of the within-class scatter. Then the discriminant information in the range space of the within-class scatter will be lost.

LDA/GSVD, which is a LDA method based on generalized singular value decomposition, uses the Moore–Penrose generalized inverse of the total-scatter to replace the inverse of the within-class scatter defined in the LDA objective function. However, as pointed in [10], LDA/GSVD obtains the same projection subspace as NLDA when the rank of the total-class scatter is equal to the sum of the ranks of within-class and between-class scatter. Therefore, LDA/GSVD will suffer the same drawback of NLDA. The basic ideas of CLDA and DSLDA, respectively proposed by Yang et al. and Wang et al., are the same. They can obtain their discriminant vectors in the null space of within-class scatter and its complementary space, respectively.

There exists a common aspect of above algorithms, that is, they use singular value decomposition (SVD) or GSVD to compute the discriminant vectors. Compared with QR decomposition, however, SVD/GSVD is computationally expensive [11]. In [12], Ye et al. proposed a new LDA-based algorithm, called LDA/QR, which uses QR decomposition rather than SVD or GSVD to reduce the dimensionality of the training samples. LDA/QR can address the SSS problem, while achieving efficiency and scalability simultaneously.

The aforementioned LDA-based algorithms are all batch algorithms. That is, we must obtain all the training samples in advance. Then, these algorithms have to discard the discriminant vectors acquired in the past and repeat the training processing from the beginning when some new data items are inserted dynamically. To use these algorithms in on-line scenarios, it is crucial to update the projection matrix with light computation instead of full retraining when new data items are added dynamically. Incremental learning
                        1
                     
                     
                        1
                        Incremental learning methods are designed to address real-world situations when the samples are frequently presented. There are two kinds of manner, i.e., sequential manner, where only one new sample is presented at a time, and chunk manner, where a subset of samples (at least two samples) is presented at a time.
                      (or online learning) can provide a way to address the above problem.

Recently, incremental learning has received a great attention in many practical applications, and some incremental LDA-based algorithms have been proposed. To learn the discriminant vectors of LDA incrementally, Pang et al. [13] proposed an incremental LDA (ILDA) method to update within-class scatter and between-class scatter. Then Pang's method can be used for classification of data streams. However, Pang's method is computationally expensive since no incremental method is introduced for the subsequent generalized eigenanalysis of the scatter matrices. By using fast SVD updating technique [14], Zhao et al. [15] proposed a new incremental LDA method, namely GSVD-ILDA, to incrementally update the discriminant vectors of LDA/GSVD when new data items are added. However, an approximate trick is used in GSVD-ILDA and there exists a performance gap between GSVD-ILDA and LDA/GSVD solutions. By borrowing the idea of incremental principal component analysis (IPCA) [16], Kim et al. [17,18] proposed another incremental LDA to update the discriminant vectors when new samples are inserted into the training data set. Similar to GSVD-ILDA, Kim's method is also an approximate technique. In [19], Uray et al. proposed an incremental LDA algorithm, called ILDAaPCA, which is a combination of two linear subspace algorithms, i.e., an incremental PCA and LDA. ILDAaPCA first performs IPCA and then updates the projection matrix of LDA on the updated subspace obtained by IPCA. Finally, ILDAaPCA projects the projection matrix of LDA onto another subspace of desired size while preserving the full discriminative information. Thus, ILDAaPCA can combine reconstructive and discriminative information of the training sample.

In [10], Zheng et al. proposed a modified dual-space LDA (MDSLDA) and its corresponding incremental extension. MDSLDA first projects all the training data onto the subspace spanned by the class means before the application of DSLDA. They also proposed an incremental MDSLDA which can accurately update the discriminant vectors of MDSLDA. Based on CLDA, Lu et al. [20,21] proposed two different implementations of incremental CLDA. Based on maximum margin criterion (MMC) [22,23], Yan et al. proposed an incremental implementation of MMC (IMMC) [24,25] which borrows the idea of the candid covariance-free incremental PCA (CCIPCA) [26].

To overcome the SSS problem and develop incremental LDA algorithm, in [27,28], Ye et al. proposed another incremental dimension reduction method via QR decomposition (IDR/QR). IDR/QR use QR decomposition of the class means matrix rather than SVD to reduce the dimension of the training samples. The projection vectors are contained in the range space of the class means matrix. By using efficient QR-updating techniques, IDR/QR can update the discriminant vectors with very low computation. Note that IDR/QR can also be performed in batch mode and the batch IDR/QR is the same as LDA/QR except that LDA/QR computes its discriminant vectors in the range space of between-class scatter where the global centroid is subtracted. Although some experiments on real database demonstrate the effectiveness of IDR/QR, it still has two limitations: 1) IDR/QR can only process new samples one instance after another even if a chunk of training samples is available at a time; 2) the approximate trick is used in IDR/QR. Then there exists a gap in performance between incremental and batch IDR/QR solutions.

To solve the limitations of IDR/QR, in this paper, we propose a new chunk IDR which is capable of processing multiple data instances at a time and can accurately update the discriminant vectors when new data items are added dynamically. Firstly, we propose a new implementation of batch IDR/QR, which is equivalent to the original implementation of batch IDR/QR theoretically but whose computational cost is lower than the original ones. Then, based on our proposed new implementation of batch IDR/QR, we propose a new chunk IDR. Experiments on some real-world databases demonstrate the effectiveness of the proposed algorithm over the original one. Note that in [29], Pen has already proposed a chunk IDR/QR. However, Pen's method is also an approximate trick and the computational complexity of Pen's method is more expensive than Ye's incremental IDR/QR for single data processing.

The rest of this paper is organized as follows. In Section 2, we review briefly the LDA method and the IDR/QR method. In Section 3, we propose the new implementation of batch IDR/QR. The new chunk IDR is presented in Section 4. Section 5 is devoted to the experiments. Finally, we conclude the paper in Section 6.

@&#RELATED WORKS@&#

Let X
                        ={x
                        
                           i
                        
                        
                           j
                        , j
                        =1, 2,…,n
                        
                           i
                        ; i
                        =1, 2,…,c} be a d-dimensional sample set with n data points, where c is the number of the classes, n
                        
                           i
                         is the number of the samples of the ith class, x
                        
                           i
                        
                        
                           j
                         is the jth sample of the ith class and ∑
                           i
                           =1
                        
                           c
                        
                        n
                        
                           i
                        
                        =
                        n. In LDA, three matrices, called within-class, between-class and total scatter matrices, are defined as follows:
                           
                              (1)
                              
                                 
                                    S
                                    w
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      i
                                                      j
                                                   
                                                   −
                                                   
                                                      m
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         i
                                                         j
                                                      
                                                      −
                                                      
                                                         m
                                                         i
                                                      
                                                   
                                                
                                                T
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    H
                                    w
                                 
                                 
                                    H
                                    w
                                    T
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    S
                                    b
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          n
                                          i
                                       
                                       
                                          
                                             
                                                m
                                                i
                                             
                                             −
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                             i
                                          
                                          −
                                          m
                                       
                                    
                                    T
                                 
                                 =
                                 
                                    H
                                    b
                                 
                                 
                                    H
                                    b
                                    T
                                 
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    S
                                    t
                                 
                                 =
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       c
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                      i
                                                      j
                                                   
                                                   −
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                         i
                                                         j
                                                      
                                                      −
                                                      m
                                                   
                                                
                                                T
                                             
                                             =
                                             
                                                H
                                                t
                                             
                                             
                                                H
                                                t
                                                T
                                             
                                             =
                                             
                                                S
                                                b
                                             
                                             +
                                             
                                                S
                                                w
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the centroid m
                        
                           i
                         of the ith class is defined as 
                           
                              m
                              i
                           
                           =
                           
                              1
                              
                                 n
                                 i
                              
                           
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                    i
                                 
                              
                              
                                 
                                    x
                                    i
                                    j
                                 
                              
                           
                        , the global centroid m is defined as 
                           m
                           =
                           
                              1
                              n
                           
                           
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 c
                              
                              
                                 
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                          i
                                       
                                    
                                    
                                       
                                          x
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                         and H
                        
                           b
                        , H
                        
                           w
                         and H
                        
                           t
                         are defined, respectively, as
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             H
                                             w
                                          
                                          =
                                          
                                             
                                                
                                                   x
                                                   1
                                                   1
                                                
                                                −
                                                
                                                   m
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   1
                                                   
                                                      n
                                                      1
                                                   
                                                
                                                −
                                                
                                                   m
                                                   1
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   c
                                                   1
                                                
                                                −
                                                
                                                   m
                                                   c
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   c
                                                   
                                                      n
                                                      c
                                                   
                                                
                                                −
                                                
                                                   m
                                                   c
                                                
                                             
                                          
                                          ∈
                                          
                                             R
                                             
                                                d
                                                ×
                                                n
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                             b
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      n
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         m
                                                         1
                                                      
                                                      −
                                                      m
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      n
                                                      c
                                                   
                                                
                                                
                                                   
                                                      
                                                         m
                                                         c
                                                      
                                                      −
                                                      m
                                                   
                                                
                                             
                                          
                                          ∈
                                          
                                             R
                                             
                                                d
                                                ×
                                                c
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                             t
                                          
                                          =
                                          
                                             
                                                
                                                   x
                                                   1
                                                   1
                                                
                                                −
                                                m
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   1
                                                   
                                                      n
                                                      1
                                                   
                                                
                                                −
                                                m
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   c
                                                   1
                                                
                                                −
                                                m
                                                ,
                                                …
                                                ,
                                                
                                                   x
                                                   c
                                                   
                                                      n
                                                      c
                                                   
                                                
                                                −
                                                m
                                             
                                          
                                          ∈
                                          
                                             R
                                             
                                                d
                                                ×
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The classical LDA algorithm aims to find an optimal projection matrix G that maximizes the so-called Fisher's criterion
                           
                              (5)
                              
                                 G
                                 =
                                 arg
                                 
                                    max
                                    G
                                 
                                 trace
                                 
                                    
                                       
                                          
                                             
                                                
                                                   G
                                                   T
                                                
                                                
                                                   S
                                                   w
                                                
                                                G
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                G
                                                T
                                             
                                             
                                                S
                                                b
                                             
                                             G
                                          
                                       
                                    
                                 
                              
                           
                        where trace(⋅) denotes the trace operator. The solution to the optimization problem in (5) can be obtained by solving the following generalized eigenvalue problem:
                           
                              (6)
                              
                                 
                                    S
                                    b
                                 
                                 g
                                 =
                                 λ
                                 
                                    S
                                    w
                                 
                                 g
                                 ,
                                 
                                 λ
                                 ≠
                                 0
                              
                           
                        where g is the eigenvector corresponding to the eigenvalue λ. The eigenvectors corresponding to the c
                        −1 largest eigenvalues form the columns of G.

When the SSS problem occurs, the within-class scatter is singular and LDA will fail. To address the SSS problem, Ye et al. [27,28] proposed the IDR/QR method to obtain the optimal discriminant vectors. The procedure of batch IDR/QR is listed in Algorithm 1.
                           Algorithm 1
                           batch IDR/QR.


                           Input: data matrix X.

Output: transformation matrix G.
                                 
                                    
                                       
                                       
                                          
                                             Step 1: Compute the centroid matrix, i.e. the class mean matrix, M
                                                =[m
                                                1, m
                                                2, ⋯, m
                                                
                                                   c
                                                ].
                                          
                                          
                                             Step 2: Compute the economic QR decomposition of M as M
                                                =
                                                QR, where Q
                                                ∈R
                                                   d
                                                   ×
                                                   c
                                                , R
                                                ∈R
                                                   c
                                                   ×
                                                   c
                                                .
                                          
                                          
                                             Step 3: Z
                                                ←
                                                Q
                                                
                                                   T
                                                
                                                H
                                                
                                                   w
                                                .
                                          
                                          
                                             Step 4: Y
                                                ←
                                                Q
                                                
                                                   T
                                                
                                                H
                                                
                                                   b
                                                .Step 5: W
                                                ←
                                                ZZ
                                                
                                                   T
                                                ./* Reduced within-class scatter matrix*/
                                          
                                          
                                             Step 6: B
                                                ←
                                                YY
                                                
                                                   T
                                                ./* Reduced between-class scatter matrix*/
                                          
                                          
                                             Step 7: Compute the c eigenvectors ϕ
                                                
                                                   i
                                                 of (W
                                                +
                                                μI
                                                
                                                   c
                                                )−1
                                                B with decreasing eigenvalues, where μ is a nonnegative constant and I
                                                
                                                   c
                                                
                                                ∈R
                                                   c
                                                   ×
                                                   c
                                                 is an identity matrix.
                                          
                                          
                                             Step 8: G
                                                =
                                                QΦ, where Φ
                                                =[ϕ
                                                1, ϕ
                                                2,…,ϕ
                                                
                                                   c
                                                ].
                                          
                                       
                                    
                                 
                              
                           

When a new sample is added, Ye et al. proposed two different incremental IDR/QR algorithms, which are according as the new sample belongs to an existing class or a new class, to update the optimal discriminant vectors of the batch IDR/QR algorithm. In general, the incremental IDR/QR algorithms utilize three steps to accomplish the incremental learning task:
                           
                              Step 1.
                              Updating the centroid matrix M and its QR-decomposition.

Updating reduced within-class scatter matrix W.

Updating reduced between-class scatter matrix B.

The detailed procedures of incremental IDR/QR can be found in [27,28].

In this section, we present the new implementation of IDR/QR which is equivalent to the original implementation of batch IDR/QR but is more efficient than the original one. Our implementation is motivated by the following theorem.
                        Theorem 1
                        Let Z
                           
                              M
                           
                           =
                           M
                           
                              T
                           
                           H
                           
                              w
                           , Y
                           
                              M
                           
                           =
                           M
                           
                              T
                           
                           H
                           
                              b
                           , W
                           
                              M
                           
                           =
                           Z
                           
                              M
                           
                           Z
                           
                              M
                           
                           
                              T
                           , B
                           
                              M
                           
                           =
                           Y
                           
                              M
                           
                           Y
                           
                              M
                           
                           
                              T
                            and D
                           
                              M
                           
                           =
                           M
                           
                              T
                           
                           M. Suppose that φ
                           1, φ
                           2, ⋯, φ
                           
                              c
                            are the eigenvectors corresponding to the c largest eigenvalues of eigensystem
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                W
                                                M
                                             
                                             +
                                             μ
                                             
                                                D
                                                M
                                             
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       B
                                       M
                                    
                                    
                                       φ
                                       i
                                    
                                    =
                                    
                                       λ
                                       i
                                    
                                    
                                       φ
                                       i
                                    
                                    ,
                                    
                                    1
                                    ≤
                                    i
                                    ≤
                                    c
                                 
                              
                           
                        

Then G
                           =
                           MΓ, where Γ
                           =[φ
                           1, φ
                           2, ⋯, φ
                           
                              c
                           ].

From Eq. (7), we have
                              
                                 (8)
                                 
                                    
                                       M
                                       T
                                    
                                    
                                       H
                                       b
                                    
                                    
                                       H
                                       b
                                       T
                                    
                                    M
                                    
                                       φ
                                       i
                                    
                                    =
                                    
                                       λ
                                       i
                                    
                                    
                                       
                                          
                                             M
                                             T
                                          
                                          
                                             H
                                             w
                                          
                                          
                                             H
                                             w
                                             T
                                          
                                          M
                                          +
                                          μ
                                          
                                             M
                                             T
                                          
                                          M
                                       
                                    
                                    
                                       φ
                                       i
                                    
                                 
                              
                           
                        

Since M
                           =
                           QR, we have
                              
                                 (9)
                                 
                                    
                                       R
                                       T
                                    
                                    
                                       Q
                                       T
                                    
                                    
                                       H
                                       b
                                    
                                    
                                       H
                                       b
                                       T
                                    
                                    Q
                                    R
                                    
                                       φ
                                       i
                                    
                                    =
                                    
                                       λ
                                       i
                                    
                                    
                                       
                                          
                                             R
                                             T
                                          
                                          
                                             Q
                                             T
                                          
                                          
                                             H
                                             w
                                          
                                          
                                             H
                                             w
                                             T
                                          
                                          Q
                                          R
                                          +
                                          μ
                                          
                                             R
                                             T
                                          
                                          R
                                       
                                    
                                    
                                       φ
                                       i
                                    
                                 
                              
                           
                        

Then we can obtain
                              
                                 (10)
                                 
                                    
                                       Q
                                       T
                                    
                                    
                                       H
                                       b
                                    
                                    
                                       H
                                       b
                                       T
                                    
                                    Q
                                    R
                                    
                                       φ
                                       i
                                    
                                    =
                                    
                                       λ
                                       i
                                    
                                    
                                       
                                          
                                             Q
                                             T
                                          
                                          
                                             H
                                             w
                                          
                                          
                                             H
                                             w
                                             T
                                          
                                          Q
                                          +
                                          μ
                                          
                                             I
                                             c
                                          
                                       
                                    
                                    R
                                    
                                       φ
                                       i
                                    
                                 
                              
                           
                        

and
                              
                                 (11)
                                 
                                    B
                                    R
                                    
                                       φ
                                       i
                                    
                                    =
                                    
                                       λ
                                       i
                                    
                                    
                                       
                                          W
                                          +
                                          μ
                                          
                                             I
                                             c
                                          
                                       
                                    
                                    R
                                    
                                       φ
                                       i
                                    
                                 
                              
                           
                        

From Eq. (11) we can know that Rφ
                     
                        i
                      is also an eigenvector of (W
                     +
                     μI
                     
                        c
                     )−1
                     B. Then we have Φ
                     =
                     RΓ and G
                     =
                     QΦ
                     =
                     QRΓ
                     =
                     MΓ.

From Theorem 1 we can know that we can use M rather than Q to reduce the dimensionality of the samples and the computation of the economic QR decomposition of M, which may be time-consuming when the number of the classes c is large, can be omitted. However, we should compute the matrix D
                     
                        M
                     
                     =
                     M
                     
                        T
                     
                     M which need not be computed in the original batch IDR/QR algorithm. Fortunately, the matrix M
                     
                        T
                     
                     M can be computed from Y
                     
                        M
                     
                     =
                     M
                     
                        T
                     
                     H
                     
                        b
                     . From Eq. (4) we know that
                        
                           (12)
                           
                              M
                              =
                              
                                 H
                                 b
                              
                              E
                              +
                              m
                              ⋅
                              
                                 e
                                 T
                              
                           
                        
                     where 
                        E
                        =
                        diag
                        
                           
                              
                                 
                                    n
                                    1
                                 
                              
                              
                                 n
                                 1
                              
                           
                           
                              
                                 
                                    n
                                    2
                                 
                              
                              
                                 n
                                 2
                              
                           
                           ⋯
                           
                              
                                 
                                    n
                                    c
                                 
                              
                              
                                 n
                                 c
                              
                           
                        
                        ∈
                        
                           R
                           
                              c
                              ×
                              c
                           
                        
                      is a diagonal matrix and e
                     =[1, 1, ⋯, 1]
                        T
                     
                     ∈R
                        c
                      is a column vector of all ones. Then
                        
                           (13)
                           
                              
                                 D
                                 M
                              
                              =
                              
                                 M
                                 T
                              
                              M
                              =
                              
                                 M
                                 T
                              
                              
                                 
                                    
                                       H
                                       b
                                    
                                    E
                                    +
                                    m
                                    ⋅
                                    
                                       e
                                       T
                                    
                                 
                              
                              =
                              
                                 Y
                                 M
                              
                              E
                              +
                              
                                 
                                    
                                       M
                                       T
                                    
                                    m
                                 
                              
                              
                                 e
                                 T
                              
                           
                        
                     
                  

Now, our new implementation of IDR/QR, called IDR/new for short, is formally summarized as follows:
                        Algorithm 2
                        batch IDR/new.


                        Input: data matrix X.

Output: transformation matrix G.
                              
                                 
                                    
                                    
                                       
                                          Step 1: Compute the centroid matrix, i.e. the class mean matrix, M
                                             =[m
                                             1, m
                                             2, ⋯, m
                                             
                                                c
                                             ].
                                       
                                       
                                          Step 2: Z
                                             
                                                M
                                             
                                             =
                                             M
                                             
                                                T
                                             
                                             H
                                             
                                                w
                                             .
                                       
                                       
                                          Step 3: Y
                                             
                                                M
                                             
                                             =
                                             M
                                             
                                                T
                                             
                                             H
                                             
                                                b
                                             .
                                       
                                       
                                          Step 4: W
                                             
                                                M
                                             
                                             =
                                             Z
                                             
                                                M
                                             
                                             Z
                                             
                                                M
                                             
                                             
                                                T
                                             ./* Reduced within-class scatter matrix*/
                                       
                                       
                                          Step 5: B
                                             
                                                M
                                             
                                             =
                                             Y
                                             
                                                M
                                             
                                             Y
                                             
                                                M
                                             
                                             
                                                T
                                             ./* Reduced between-class scatter matrix*/
                                       
                                       
                                          Step 6: Compute D
                                             
                                                M
                                              using Eq. (13).
                                       
                                       
                                          Step 7: Compute the c eigenvectors φ
                                             
                                                i
                                              of (W
                                             
                                                M
                                             
                                             +
                                             μD
                                             
                                                M
                                             )−1
                                             B
                                             
                                                M
                                              with decreasing eigenvalues.
                                       
                                       
                                          Step 8: G
                                             =
                                             MΓ, where Γ
                                             =[φ
                                             1, φ
                                             2, ⋯, φ
                                             
                                                c
                                             ].
                                       
                                    
                                 
                              
                           
                        

The computational complexities of Algorithms 1 and 2 are listed in Table 1
                        . Note that the computational complexity of economic QR decomposition for an m
                        ×
                        n matrix is 4mn
                        2
                        −4n
                        3/3 [11]. Generally, we have d
                        ≫
                        c. Then from Table 1 we can know that the new implementation of IDR/QR is more efficient than the original one especially the number of the classes c is large.

In this section, we present the new chunk IDR based on the proposed new implementation of IDR/QR. Note that chunk IDR can take care of newly added samples from existing and new classes simultaneously. For simplicity of deriving our chunk IDR, the following convention is used: for any variable X, its updated version after inserting new samples is denoted by 
                        
                           X
                           ˜
                        
                     .

Let 
                           
                              X
                              ^
                           
                           =
                           
                              
                                 
                                    x
                                    ^
                                 
                                 1
                              
                              
                                 
                                    x
                                    ^
                                 
                                 2
                              
                              ⋯
                              
                                 
                                    x
                                    ^
                                 
                                 q
                              
                           
                         be the newly added samples, where 
                           
                              
                                 x
                                 ^
                              
                              i
                           
                         (i
                        =1, 2, ⋯, q) belongs to existing classes or new classes, q is the number of the added samples, and ĉ is the number of the classes of the added samples. Then the centroid M
                        ∈R
                           d
                           ×
                           c
                         is updated to 
                           
                              M
                              ˜
                           
                           ∈
                           
                              R
                              
                                 d
                                 ×
                                 
                                    c
                                    ˜
                                 
                              
                           
                        , where 
                           
                              c
                              ˜
                           
                         is the number of classes of samples 
                           
                              X
                              ˜
                           
                           =
                           
                              
                                 X
                                 ,
                                 
                                 
                                    X
                                    ^
                                 
                              
                           
                        .

Obviously 
                           
                              X
                              ^
                           
                         can be expressed as
                           
                              (14)
                              
                                 
                                    X
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          
                                             X
                                             ^
                                          
                                          1
                                       
                                       ,
                                       
                                       
                                          
                                             X
                                             ^
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 X
                                 ^
                              
                              1
                           
                         contains the new added samples which belong to existing class and 
                           
                              
                                 X
                                 ^
                              
                              2
                           
                         contains the new added samples which belongs to new classes. Let 
                           
                              M
                              ^
                           
                         is the centroid matrix of 
                           
                              X
                              ^
                           
                        . Similarly, 
                           
                              M
                              ^
                           
                         can be expressed as
                           
                              (15)
                              
                                 
                                    M
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                             ^
                                          
                                          1
                                       
                                       ,
                                       
                                       
                                          
                                             M
                                             ^
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 M
                                 ^
                              
                              1
                           
                         is the centroid matrix of 
                           
                              
                                 X
                                 ^
                              
                              1
                           
                         and 
                           
                              
                                 M
                                 ^
                              
                              2
                           
                         is the centroid matrix of 
                           
                              
                                 X
                                 ^
                              
                              2
                           
                        .

Let S
                        ={k|k
                        =1, ⋯, c} be the set that contains the indices of the common class in X and 
                           
                              X
                              ^
                           
                        . Suppose S(i), 1≤
                        i
                        ≤|S|, where |·| denotes the cardinal number of set S, and denotes the ith elements in set S. Then 
                           
                              
                                 m
                                 ˜
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                        , which is the centroid of the S(i)th class of 
                           
                              X
                              ˜
                           
                        , can be expressed as
                           
                              (16)
                              
                                 
                                    
                                       m
                                       ˜
                                    
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    m
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 +
                                 
                                    f
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        where 
                           
                              f
                              
                                 S
                                 
                                    i
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       n
                                       ^
                                    
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                             ^
                                          
                                          
                                             S
                                             
                                                i
                                             
                                          
                                       
                                       −
                                       
                                          m
                                          
                                             S
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    n
                                    ˜
                                 
                                 
                                    S
                                    
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              
                                 n
                                 ˜
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                           =
                           
                              n
                              
                                 S
                                 
                                    i
                                 
                              
                           
                           +
                           
                              
                                 n
                                 ^
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                        ; here 
                           
                              
                                 n
                                 ^
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 m
                                 ^
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                         are, respectively, the number of the samples and the centroid of the S(i)th class of 
                           
                              X
                              ^
                           
                        . Then 
                           
                              M
                              ˜
                           
                         can be expressed as
                           
                              (17)
                              
                                 
                                    M
                                    ˜
                                 
                                 =
                                 
                                    
                                       M
                                       +
                                       F
                                       
                                          G
                                          T
                                       
                                       ,
                                       
                                       
                                          
                                             M
                                             ^
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where F
                        =[m
                        
                           S(1), m
                        
                           S(2), ⋯, m
                        
                           S(|S|)]∈R
                           d
                           ×|S|, G is a c
                        ×|S| matrix and its S(i)th column is (0, ⋯, 1, ⋯, 0)
                           T
                        
                        ∈R
                           c
                           ×1 where 1 appears at the S(i)th position.

First, we consider how to obtain 
                           
                              
                                 H
                                 ˜
                              
                              w
                           
                        , which is the updated version of H
                        
                           w
                        . Let Ĥ
                        
                           w
                         be a matrix computed from 
                           
                              X
                              ^
                           
                        . Then Ĥ
                        
                           w
                         can be expressed as
                           
                              (18)
                              
                                 
                                    
                                       H
                                       ^
                                    
                                    w
                                 
                                 =
                                 
                                    
                                       
                                          
                                             H
                                             ^
                                          
                                          
                                             w
                                             1
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             H
                                             ^
                                          
                                          
                                             w
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where Ĥ
                        
                           w1 and Ĥ
                        
                           w2 are, respectively, the matrices computed from 
                           
                              
                                 X
                                 ^
                              
                              1
                           
                         and 
                           
                              
                                 X
                                 ^
                              
                              2
                           
                        . Let H
                        
                           S(i) and Ĥ
                        
                           S(i) be the matrices computed from the samples of the S(i)th class in X and 
                           
                              X
                              ^
                           
                        , respectively. Then 
                           
                              
                                 H
                                 ˜
                              
                              
                                 S
                                 
                                    i
                                 
                              
                           
                        , which is the updated version of H
                        
                           S(i), can be expressed as
                           
                              (19)
                              
                                 
                                    
                                       H
                                       ˜
                                    
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          H
                                          
                                             S
                                             
                                                i
                                             
                                          
                                       
                                       −
                                       
                                          f
                                          
                                             S
                                             
                                                i
                                             
                                          
                                       
                                       ⋅
                                       
                                          e
                                          
                                             S
                                             
                                                i
                                             
                                          
                                          T
                                       
                                       ,
                                       
                                       
                                          
                                             H
                                             ^
                                          
                                          
                                             S
                                             
                                                i
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   m
                                                   ^
                                                
                                                
                                                   S
                                                   
                                                      i
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   m
                                                   ˜
                                                
                                                
                                                   S
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             e
                                             ^
                                          
                                          
                                             S
                                             
                                                i
                                             
                                          
                                          T
                                       
                                    
                                 
                              
                           
                        where 
                           
                              e
                              
                                 S
                                 
                                    i
                                 
                              
                           
                           =
                           
                              
                                 1
                                 1
                                 ⋯
                                 1
                              
                              T
                           
                           ∈
                           
                              R
                              
                                 
                                    n
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 ×
                                 1
                              
                           
                         and 
                           
                              e
                              
                                 
                                    S
                                    ^
                                 
                                 
                                    i
                                 
                              
                           
                           =
                           
                              
                                 1
                                 1
                                 ⋯
                                 1
                              
                              T
                           
                           ∈
                           
                              R
                              
                                 
                                    
                                       n
                                       ^
                                    
                                    
                                       S
                                       
                                          i
                                       
                                    
                                 
                                 ×
                                 1
                              
                           
                         are the column vectors of all ones. Hence, 
                           
                              
                                 H
                                 ˜
                              
                              w
                           
                         can be written as
                           
                              (20)
                              
                                 
                                    
                                       H
                                       ˜
                                    
                                    w
                                 
                                 =
                                 
                                    
                                       
                                          H
                                          w
                                       
                                       −
                                       F
                                       
                                          K
                                          T
                                       
                                       ,
                                       
                                       
                                          
                                             H
                                             ˜
                                          
                                          
                                             w
                                             2
                                          
                                       
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 H
                                 ˜
                              
                              
                                 w
                                 2
                              
                           
                           =
                           
                              
                                 
                                    
                                       H
                                       ^
                                    
                                    
                                       S
                                       
                                          1
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             m
                                             ^
                                          
                                          
                                             S
                                             
                                                1
                                             
                                          
                                       
                                       −
                                       
                                          
                                             m
                                             ˜
                                          
                                          
                                             S
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ⋅
                                 
                                    
                                       e
                                       ^
                                    
                                    
                                       S
                                       
                                          1
                                       
                                    
                                    T
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    H
                                    
                                       S
                                       
                                          
                                             S
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             m
                                             ^
                                          
                                          
                                             S
                                             
                                                
                                                   S
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             m
                                             ˜
                                          
                                          
                                             S
                                             
                                                
                                                   S
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⋅
                                 
                                    
                                       e
                                       ^
                                    
                                    
                                       S
                                       
                                          
                                             S
                                          
                                       
                                    
                                    T
                                 
                                 ,
                                 
                                 
                                    
                                       H
                                       ^
                                    
                                    
                                       w
                                       2
                                    
                                 
                              
                           
                           ∈
                           
                              R
                              
                                 d
                                 ×
                                 q
                              
                           
                        , K is an n
                        ×|S| matrix and its S(i)th column is (0, ⋯, e
                        
                           Ŝ(i), ⋯, 0)
                           T
                        
                        ∈R
                           n
                           ×1.

Second, we consider how to obtain 
                           
                              
                                 Z
                                 ˜
                              
                              M
                           
                        , which is the updated version of Z
                        
                           M
                        . Since Z
                        
                           M
                        
                        =
                        M
                        
                           T
                        
                        H
                        
                           w
                        , we have
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                Z
                                                ˜
                                             
                                             M
                                          
                                          =
                                          
                                             
                                                M
                                                ˜
                                             
                                             T
                                          
                                          
                                             
                                                H
                                                ˜
                                             
                                             w
                                          
                                          =
                                          
                                             
                                                
                                                   M
                                                   +
                                                   F
                                                   
                                                      G
                                                      T
                                                   
                                                   ,
                                                   
                                                      
                                                         M
                                                         ^
                                                      
                                                      2
                                                   
                                                
                                             
                                             T
                                          
                                          
                                             
                                                
                                                   H
                                                   w
                                                
                                                −
                                                F
                                                
                                                   K
                                                   T
                                                
                                                ,
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   
                                                      w
                                                      2
                                                   
                                                
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               +
                                                               F
                                                               
                                                                  G
                                                                  T
                                                               
                                                            
                                                         
                                                         T
                                                      
                                                      
                                                         
                                                            
                                                               H
                                                               w
                                                            
                                                            −
                                                            F
                                                            
                                                               K
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               +
                                                               F
                                                               
                                                                  G
                                                                  T
                                                               
                                                            
                                                         
                                                         T
                                                      
                                                      
                                                         
                                                            H
                                                            ˜
                                                         
                                                         
                                                            w
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            M
                                                            ^
                                                         
                                                         2
                                                         T
                                                      
                                                      
                                                         
                                                            
                                                               H
                                                               w
                                                            
                                                            −
                                                            F
                                                            
                                                               K
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            M
                                                            ^
                                                         
                                                         2
                                                         T
                                                      
                                                      
                                                         
                                                            H
                                                            ˜
                                                         
                                                         
                                                            w
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         Z
                                                         M
                                                      
                                                      +
                                                      G
                                                      
                                                         A
                                                         1
                                                      
                                                      −
                                                      
                                                         A
                                                         2
                                                      
                                                      
                                                         K
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         A
                                                         3
                                                         T
                                                      
                                                      
                                                         
                                                            H
                                                            ˜
                                                         
                                                         
                                                            w
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            M
                                                            ^
                                                         
                                                         2
                                                         T
                                                      
                                                      
                                                         A
                                                         4
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            M
                                                            ^
                                                         
                                                         2
                                                         T
                                                      
                                                      
                                                         
                                                            H
                                                            ˜
                                                         
                                                         
                                                            w
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where A
                        1
                        =
                        F
                        
                           T
                        
                        H
                        
                           w
                        , A
                        2
                        =
                        M
                        
                           T
                        
                        F
                        +
                        G(F
                        
                           T
                        
                        F), A
                        3
                        =
                        M
                        +
                        FG
                        
                           T
                        , and A
                        4
                        =
                        H
                        
                           w
                        
                        −
                        F
                        ⋅
                        K
                        
                           T
                        .

Finally, we consider how to get 
                           
                              
                                 W
                                 ˜
                              
                              M
                           
                        , which is the updated version of W
                        
                           M
                        . Since W
                        
                           M
                        
                        =
                        Z
                        
                           M
                        
                        Z
                        
                           M
                        
                        
                           T
                        , we have
                           
                              (22)
                              
                                 
                                    
                                       W
                                       ˜
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       Z
                                       ˜
                                    
                                    M
                                 
                                 
                                    
                                       Z
                                       ˜
                                    
                                    M
                                    T
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                   ˜
                                                
                                                11
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                   ˜
                                                
                                                12
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   W
                                                   ˜
                                                
                                                21
                                             
                                          
                                          
                                             
                                                
                                                   W
                                                   ˜
                                                
                                                22
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          W
                                          ˜
                                       
                                       11
                                    
                                    =
                                    
                                       W
                                       M
                                    
                                    +
                                    
                                       
                                          
                                             Z
                                             M
                                          
                                          
                                             A
                                             1
                                             T
                                          
                                       
                                    
                                    
                                       G
                                       T
                                    
                                    −
                                    
                                       
                                          
                                             Z
                                             M
                                          
                                          K
                                       
                                    
                                    
                                       A
                                       2
                                       T
                                    
                                    +
                                    G
                                    
                                       
                                          
                                             
                                                Z
                                                M
                                             
                                             
                                                A
                                                1
                                                T
                                             
                                          
                                       
                                       T
                                    
                                    +
                                    G
                                    
                                       
                                          
                                             A
                                             1
                                          
                                          
                                             A
                                             1
                                             T
                                          
                                       
                                    
                                    
                                       G
                                       T
                                    
                                    −
                                    G
                                    
                                       
                                          
                                             A
                                             1
                                          
                                          K
                                       
                                    
                                    
                                       A
                                       2
                                       T
                                    
                                    +
                                    
                                       A
                                       2
                                    
                                    
                                       
                                          
                                             
                                                Z
                                                M
                                             
                                             K
                                          
                                       
                                       T
                                    
                                    −
                                    
                                       A
                                       2
                                    
                                    
                                       
                                          
                                             
                                                A
                                                1
                                             
                                             K
                                          
                                       
                                       T
                                    
                                    
                                       G
                                       T
                                    
                                 
                              
                              
                                 
                                    +
                                    
                                       A
                                       2
                                    
                                    
                                       
                                          
                                             K
                                             T
                                          
                                          K
                                       
                                    
                                    
                                       A
                                       2
                                       T
                                    
                                    +
                                    
                                       
                                          
                                             A
                                             3
                                             T
                                          
                                          
                                             
                                                H
                                                ˜
                                             
                                             
                                                w
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                                3
                                                T
                                             
                                             
                                                
                                                   H
                                                   ˜
                                                
                                                
                                                   w
                                                   2
                                                
                                             
                                          
                                       
                                       T
                                    
                                    ,
                                 
                              
                           
                         
                        
                           
                              
                                 W
                                 ˜
                              
                              12
                           
                           =
                           
                              Z
                              M
                           
                           
                              
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       2
                                       T
                                    
                                    
                                       A
                                       4
                                    
                                 
                              
                              T
                           
                           +
                           G
                           
                              
                                 
                                    A
                                    1
                                 
                                 
                                    
                                       
                                          
                                             
                                                M
                                                ^
                                             
                                             2
                                             T
                                          
                                          
                                             A
                                             4
                                          
                                       
                                    
                                    T
                                 
                              
                           
                           −
                           
                              A
                              2
                           
                           
                              
                                 
                                    K
                                    T
                                 
                                 
                                    
                                       
                                          
                                             
                                                M
                                                ^
                                             
                                             2
                                             T
                                          
                                          
                                             A
                                             4
                                          
                                       
                                    
                                    T
                                 
                              
                           
                           +
                           
                              
                                 
                                    A
                                    3
                                    T
                                 
                                 
                                    
                                       H
                                       ˜
                                    
                                    
                                       w
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       2
                                       T
                                    
                                    
                                       A
                                       4
                                    
                                 
                              
                              T
                           
                           ,
                         
                        
                           
                              
                                 W
                                 ˜
                              
                              21
                           
                           =
                           
                              
                                 W
                                 ˜
                              
                              12
                              T
                           
                         and 
                           
                              
                                 W
                                 ˜
                              
                              22
                           
                           =
                           
                              
                                 
                                    
                                       M
                                       ^
                                    
                                    2
                                    T
                                 
                                 
                                    A
                                    4
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       2
                                       T
                                    
                                    
                                       A
                                       4
                                    
                                 
                              
                              T
                           
                           +
                           
                              
                                 
                                    
                                       M
                                       ^
                                    
                                    2
                                    T
                                 
                                 
                                    
                                       H
                                       ˜
                                    
                                    
                                       w
                                       2
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       2
                                       T
                                    
                                    
                                       
                                          H
                                          ˜
                                       
                                       
                                          w
                                          2
                                       
                                    
                                 
                              
                              T
                           
                        .

First, we consider how to update 
                           
                              
                                 D
                                 ˜
                              
                              M
                           
                        , which is the updated version of D
                        
                           M
                        . Since D
                        
                           M
                        
                        =
                        M
                        
                           T
                        
                        M, we have
                           
                              (23)
                              
                                 
                                    
                                       D
                                       ˜
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       M
                                       ˜
                                    
                                    T
                                 
                                 
                                    M
                                    ˜
                                 
                              
                           
                        
                     

From Eq. (17) we can know
                           
                              (24)
                              
                                 
                                    
                                       D
                                       ˜
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                D
                                                M
                                             
                                             +
                                             
                                                
                                                   
                                                      M
                                                      T
                                                   
                                                   F
                                                
                                             
                                             
                                                G
                                                T
                                             
                                             +
                                             G
                                             
                                                
                                                   
                                                      F
                                                      T
                                                   
                                                   M
                                                
                                             
                                             +
                                             G
                                             
                                                
                                                   
                                                      F
                                                      T
                                                   
                                                   F
                                                
                                             
                                             
                                                G
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                      +
                                                      F
                                                      
                                                         G
                                                         T
                                                      
                                                   
                                                
                                                T
                                             
                                             
                                                
                                                   M
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                2
                                                T
                                             
                                             
                                                
                                                   M
                                                   +
                                                   F
                                                   
                                                      G
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                2
                                                T
                                             
                                             
                                                
                                                   M
                                                   ^
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Second, we consider how to get Ỹ
                        
                           M
                        , which is the updated version of Y
                        
                           M
                        . Here, we compute Ỹ
                        
                           M
                         from 
                           
                              
                                 D
                                 ˜
                              
                              M
                           
                        . From Eq. (12) we have
                           
                              (25)
                              
                                 
                                    H
                                    b
                                 
                                 =
                                 
                                    
                                       M
                                       −
                                       m
                                       ⋅
                                       
                                          e
                                          T
                                       
                                    
                                 
                                 diag
                                 
                                    
                                       
                                          n
                                          1
                                       
                                    
                                    
                                       
                                          n
                                          2
                                       
                                    
                                    ⋯
                                    
                                       
                                          n
                                          c
                                       
                                    
                                 
                              
                           
                        
                     

Then we can obtain
                           
                              (26)
                              
                                 
                                    
                                       Y
                                       ˜
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       M
                                       ˜
                                    
                                    T
                                 
                                 
                                    
                                       H
                                       ˜
                                    
                                    b
                                 
                                 =
                                 
                                    
                                       M
                                       ˜
                                    
                                    T
                                 
                                 
                                    
                                       
                                          M
                                          ˜
                                       
                                       −
                                       
                                          m
                                          ˜
                                       
                                       ⋅
                                       
                                          
                                             e
                                             ˜
                                          
                                          T
                                       
                                    
                                 
                                 diag
                                 
                                    
                                       
                                          n
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          n
                                          
                                             c
                                             ˜
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             D
                                             ˜
                                          
                                          M
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   M
                                                   ˜
                                                
                                                T
                                             
                                             
                                                m
                                                ˜
                                             
                                          
                                       
                                       ⋅
                                       
                                          
                                             e
                                             ˜
                                          
                                          T
                                       
                                    
                                 
                                 diag
                                 
                                    
                                       
                                          n
                                          1
                                       
                                    
                                    ⋯
                                    
                                       
                                          n
                                          
                                             c
                                             ˜
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              e
                              ˜
                           
                           =
                           
                              
                                 1
                                 1
                                 ⋯
                                 1
                              
                              T
                           
                           ∈
                           
                              R
                              
                                 c
                                 ˜
                              
                           
                         is the updated version of e and 
                           
                              m
                              ˜
                           
                           =
                           
                              
                                 nm
                                 +
                                 q
                                 
                                    m
                                    ^
                                 
                              
                              
                                 n
                                 +
                                 q
                              
                           
                         is the updated version of m; here 
                           
                              m
                              ^
                           
                         is the global centroid of the newly added samples.

Finally, the updated version of B
                        
                           M
                        , i.e. 
                           
                              
                                 B
                                 ˜
                              
                              M
                           
                        , can be computed as
                           
                              (27)
                              
                                 
                                    
                                       B
                                       ˜
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       Y
                                       ˜
                                    
                                    M
                                 
                                 
                                    
                                       Y
                                       ˜
                                    
                                    M
                                    T
                                 
                              
                           
                        
                     

Now, our new chunk IDR is formally summarized as follows:
                           Algorithm 3
                           chunk IDR.


                           Input: The matrices H
                              
                                 w
                              , M, Z
                              
                                 M
                              , D
                              
                                 M
                              , and W
                              
                                 M
                              , the size n
                              
                                 i
                               of the ith class samples, the global centroid m, the total number of samples n, and the newly added samples 
                                 
                                    X
                                    ^
                                 
                                 =
                                 
                                    
                                       
                                          x
                                          ^
                                       
                                       1
                                    
                                    
                                       
                                          x
                                          ^
                                       
                                       2
                                    
                                    ⋯
                                    
                                       
                                          x
                                          ^
                                       
                                       q
                                    
                                 
                              .

Output: the updated matrices 
                                 
                                    
                                       H
                                       ˜
                                    
                                    w
                                 
                              , 
                                 
                                    M
                                    ˜
                                 
                              , 
                                 
                                    
                                       Z
                                       ˜
                                    
                                    M
                                 
                              , 
                                 
                                    
                                       D
                                       ˜
                                    
                                    M
                                 
                              , and 
                                 
                                    
                                       W
                                       ˜
                                    
                                    M
                                 
                              , the size ñ
                              
                                 i
                               of the ith class samples, the global centroid 
                                 
                                    m
                                    ˜
                                 
                              , and the total number of samples ñ.
                                 
                                    
                                       
                                       
                                          
                                             Step 1: Set ñ
                                                =
                                                n
                                                +
                                                q, 
                                                   
                                                      m
                                                      ^
                                                   
                                                   =
                                                   
                                                      1
                                                      n
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         q
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                               ^
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                , 
                                                   
                                                      m
                                                      ˜
                                                   
                                                   =
                                                   
                                                      
                                                         nm
                                                         +
                                                         q
                                                         
                                                            m
                                                            ^
                                                         
                                                      
                                                      
                                                         n
                                                         ^
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         n
                                                         ˜
                                                      
                                                      i
                                                   
                                                   =
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                           i
                                                                        
                                                                        +
                                                                        
                                                                           
                                                                              n
                                                                              ^
                                                                           
                                                                           i
                                                                        
                                                                        ,
                                                                     
                                                                     
                                                                        
                                                                        i
                                                                        ∈
                                                                        S
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                           i
                                                                        
                                                                        ,
                                                                     
                                                                     
                                                                        i
                                                                        ∉
                                                                        S
                                                                        
                                                                        and
                                                                        
                                                                        i
                                                                        ≤
                                                                        c
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              n
                                                                              ^
                                                                           
                                                                           i
                                                                        
                                                                        ,
                                                                     
                                                                     
                                                                        
                                                                        c
                                                                        <
                                                                        i
                                                                        ≤
                                                                        
                                                                           c
                                                                           ˜
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             Step 2: Compute 
                                                   
                                                      M
                                                      ˜
                                                   
                                                 using Eq. (16) and (17).
                                          
                                          
                                             Step 3: Compute 
                                                   
                                                      
                                                         H
                                                         ˜
                                                      
                                                      w
                                                   
                                                 using Eq. (18), (19) and (20).
                                          
                                          
                                             Step 4: Compute 
                                                   
                                                      
                                                         Z
                                                         ˜
                                                      
                                                      M
                                                   
                                                 using Eq. (21).
                                          
                                          
                                             Step 5: Compute 
                                                   
                                                      
                                                         W
                                                         ˜
                                                      
                                                      M
                                                   
                                                 using Eq. (22)./* Reduced within-class scatter matrix*/
                                          
                                          
                                             Step 6: Compute 
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                      M
                                                   
                                                 using Eq. (24).
                                          
                                          
                                             Step 7: Compute Ỹ
                                                
                                                   M
                                                 using Eq. (26).
                                          
                                          
                                             Step 8: Compute 
                                                   
                                                      
                                                         B
                                                         ˜
                                                      
                                                      M
                                                   
                                                 using Eq. (27)./* Reduced between-class scatter matrix*/
                                          
                                       
                                    
                                 
                              
                           

The computational complexities of Algorithm 3 are listed in Table 2
                        . Note that in Table 1 
                        N denotes the number of the samples in X which belongs to the classes in the set S.

From Table 2 we can know that the total computational complexity of the chunk IDR algorithm is 
                           O
                           
                              
                                 
                                    c
                                    ˜
                                 
                                 3
                              
                           
                           +
                           O
                           
                              
                                 d
                                 n
                                 
                                    c
                                    ^
                                 
                              
                           
                        . For incremental IDR/QR, we should repeat the incremental IDR/QR algorithm q times when q new samples are added and its computational complexity is 
                           O
                           
                              
                                 d
                                 
                                    c
                                    ˜
                                 
                                 q
                              
                           
                           +
                           O
                           
                              
                                 q
                                 
                                    
                                       c
                                       ˜
                                    
                                    3
                                 
                              
                           
                           +
                           O
                           
                              
                                 q
                                 d
                                 
                                    
                                       c
                                       ˜
                                    
                                    2
                                 
                              
                           
                        . Then the computational cost of the chunk IDR algorithm is lower than that of the incremental IDR/QR algorithm especially when q is large.

@&#EXPERIMENTS AND RESULTS@&#

In this section, we evaluate our proposed batch IDR/new (Algorithm 2) and chunk IDR (Algorithm 3) on the AR and extended version 1 MPEG databases in terms of computational efficiency and recognition accuracy. Since the comparison of classification performances among IDR/QR and other techniques, e.g. PCA, Fisherface and LDA/GSVD, has been done in literatures [12,27,28], we only compare our proposed methods with Ye's batch and incremental IDR/QR. We use the nearest neighbor classifier with cosine distance for the classification task in the experiments. We choose μ
                     =0.5 in our experiments as [27,28]. The experiments are implemented on a Mobile DualCore Intel Pentium (1666MHz) processor Hasee Computer with 898M RAM and the programming environment is MATLAB 7.0.

The AR face database contains over 4000 gray face images of 126 people (70 men and 56 women), including frontal views of with different facial expressions, lighting conditions and occlusions. The face images of 120 individuals (26 images per person) were taken in two sessions. The images of these 120 persons (65 men and 55 women) are used in our experiments. Then there are 3120 (120×26=3120) images in our experiments. All images were manually cropped and resized to 50×40. Some example images of one person are shown in Fig. 1
                        .

In this subsection, we will give an experiment to demonstrate the efficiency of chunk IDR in the sample-by-sample incremental mode.

Firstly, we randomly select four images of each person as the training data set, and use the remaining images as the testing data set. Secondly, we divide the training data set into two different parts: initial set, which contains 90 persons (90×4=360 images), and added set, which contains the other 30 people (30×4=120 images). Thirdly, we use, respectively, the batch IDR/QR and IDR/new to compute the project matrices on the initial set. Fourthly, we randomly select one sample from the added set for incremental learning. With the newly added sample, we use the incremental IDR/QR and chunk IDR to calculate the CPU times of updating procedures. Since the incremental IDR/QR and chunk IDR only involve the updating of the QR decomposition (or D
                           
                              M
                           ), W (or W
                           
                              M
                           ), and B (or B
                           
                              M
                           ), the batch IDR/QR and IDR/new, which are used for comparison, only calculate the CPU time of computing Step 1–6 in Algorithms 1 and 2. Fifthly, we repeat Step 4 until all the samples of the added set are used for the inserted samples. Finally, we compute the discriminant vectors of different algorithms. The computational times of the different algorithms are shown in Fig. 2
                           . We also give the recognition performances of the different algorithms in Fig. 3
                            when all the samples of the added set are inserted into the initial set.

In this subsection, we will give an experiment to demonstrate the efficiency of chunk IDR in the chunk mode. The experiment procedure is the same as Section 5.1.1 except the fourth step. In this experiment, we randomly select 4 samples at a time from the added set for incremental learning. When four samples are inserted into the initial set at a time, the incremental IDR/QR should be repeated four times with the insertion of the four samples. The computational times of the different algorithms are shown in Fig. 4
                           . Note that, here, we do not report the recognition performances of the different algorithms when all the samples of the added set are inserted into the initial set since the recognition performances of chunk data processing are the same as those of single data processing.

The extended version 1 MPEG dataset [18] (http://www.iis.ee.ic.ac.uk/∼tkkim/code.htm) is a combination of several public face databases. It contains 3175 images from 635 persons (five images per person) showing illumination and view variations. All the images in the database were normalized to 46×56pixels using manually labeled eye positions. Some example images of two persons are shown in Fig. 5
                        .

In this subsection, we will give an experiment to demonstrate the efficiency of chunk IDR in the sample-by-sample incremental mode. The experiment procedure is the same as Section 5.1.1 except the second step. In this experiment, the initial set contains 595 persons (595×4=2380 images), and added set contains the other 40 people (40×4=160 images). The computational times of the different algorithms are shown in Fig. 6
                           . We also give the recognition performances of the different algorithms in Fig. 7
                            when all the samples of the added set are inserted into the initial set.

In this subsection, we will give an experiment to demonstrate the efficiency of chunk IDR in the chunk mode. In this experiment, the chunk size is 8, i.e. 8 samples selected at a time from the added set are inserted into the initial set for incremental learning. The computational times of the different algorithms are shown in Fig. 8
                           .

In this subsection, we will compare the chunk IDR with Kim's algorithm [17,18] which is also a chunk incremental learning algorithm. The source code of Kim's algorithm is downloaded from his homepage (http://www.iis.ee.ic.ac.uk/~tkkim/code.htm). For fair comparison, the execution times of the chunk IDR algorithm contain the times of updating of D
                        
                           M
                        , W
                        
                           M
                        , and B
                        
                           M
                         and calculating Steps 7–8 in Algorithm 2. The experiments are conducted on AR database and the experiment procedure is the same as Section 5.1.1 except the fourth step.

In the first experiment, we randomly select 4 samples at a time from the added set for incremental learning. Then the chunk size is 4. The recognition performances of the chunk IDR algorithm and Kim's algorithm with chunk size=4 are shown in Fig. 9
                         when all the samples of the added set are inserted into the initial set. The computational times of the chunk IDR algorithm and Kim's algorithm with chunk size=4 are shown in Fig. 10
                        .

In the second and third experiments, we randomly select 8 and 12 samples, respectively, at a time from the added set for incremental learning. Then the chunk sizes are 8, and 12 respectively. The computational times of the chunk IDR algorithm and Kim's algorithm with chunk size=8 and 12 are also shown in Fig. 10.

@&#DISCUSSIONS@&#

From Fig. 2–4 and Fig. 6–10, we can obtain the following conclusions:
                           
                              (1)
                              The recognition rates of IDR/new and IDR/QR are equal, and then the equivalences of these two methods are experimentally verified. However, we can find that IDR/new is more efficient than IDR/QR, especially when the number of classes is large.

When one sample is added at a time, the computational complexity of the chunk IDR method is slightly more efficient than that of the incremental IDR/QR method. However, the recognition rates of the chunk IDR method are much higher that those of the incremental IDR/QR method. The reason is that the chunk IDR method can accurately update the discriminant vectors of batch IDR/new, while the incremental IDR/QR method is an approximate technique.

When a chunk sample (more than one sample) is added at a time, our proposed chunk IDR method is much more efficient than the incremental IDR/QR method. The reason is that the chunk IDR method can process the multiple added samples at one time, whereas the incremental IDR/QR can only process the multiple added samples one after another. Then our proposed chunk IDR is more suitable than the incremental IDR/QR method in the chunk environment.

The computational costs of the chunk IDR algorithm are much lower than Kim's algorithm with different chunk sizes. Besides, the recognition rate of the chunk IDR algorithm is higher than Kim's algorithm.

@&#CONCLUSIONS@&#

In this paper, we first propose a novel implementation of the batch IDR/QR method, called IDR/new, where the QR decomposition in the batch IDR/QR method can be omitted. IDR/new can obtain the same discriminant vectors as batch IDR/QR, but is more efficient. Based on the IDR/new method, we then propose a new chunk IDR which is capable of processing multiple data instances at a time.

We also conduct some experiments on some publicly available face databases to evaluate the performances of our proposed IDR/new and chunk IDR methods. The experiment results show that the proposed methods give better performance than those of the batch IDR/QR and incremental IDR/QR. As for future research, we plan to investigate the incremental version of the kernel IDR/QR [30].

@&#ACKNOWLEDGMENTS@&#

This research is supported by Anhui Provincial Natural Science Foundation (No. 1308085MF95), the Pre-research Foundation of NSFC of Anhui Polytechnic University (zryy1305), the Key Laboratory of Intelligent Perception and Systems for High-Dimensional Information (Nanjing University of Science and Technology), Ministry of Education (Grant No. 30920130122005), China Postdoctoral Science Foundation (2013M531251), NSFC of China (Nos. 61231002, 61073137, 61203243), the Natural Science Foundation of the Anhui Higher Education Institutions of China (No. KJ2013B031) and Jiangxi Provincial Natural Science Foundation of China (20122BAB211025).

@&#REFERENCES@&#

