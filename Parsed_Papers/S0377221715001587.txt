@&#MAIN-TITLE@&#A single vehicle routing problem with pickups and deliveries, continuous random demands and predefined customer order

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study a specific vehicle routing problem with deliveries and pickups.


                        
                        
                           
                           The customers are served according to a particular sequence.


                        
                        
                           
                           The demands of each customer are continuous random variables.


                        
                        
                           
                           The optimal routing strategy can be found by a dynamic programming algorithm.


                        
                        
                           
                           The optimal strategy has a specific threshold structure.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Logistics

Dynamic programming

Routing with pickup and deliveries

Continuous demands

@&#ABSTRACT@&#


               
               
                  This paper extends the results of a particular capacitated vehicle routing problem with pickups and deliveries (see Pandelis et al., 2013b) to the case in which the demands for a material that is delivered to N customers and the demands for a material that is collected from the customers are continuous random variables instead of discrete ones. The customers are served according to a particular order. The optimal policy that serves all customers has a specific threshold-type structure and it is computed by a suitable efficient dynamic programming algorithm that operates over all policies having this structure. The structural result is illustrated by a numerical example.
               
            

@&#INTRODUCTION@&#

In the capacitated vehicle routing problem with stochastic demands the objective is to find the optimal routing of a single vehicle with finite capacity or of a fleet of vehicles with finite capacity that originate from one or several depots and deliver products to N geographically scattered customers, whose demands for the products are random variables. Many exact and heuristic algorithms have been developed for various versions of this problem (see Chepuri & Momem-de-Mello, 2005; Goodson, Ohlmann, & Thomas, 2012; Haugland, Ho, & Laporte, 2007; Kyriakidis & Dimitrakos, 2008; Lei, Laporte, & Guo, 2011; Marinakis, Iordanidou, & Marinaki, 2013; Mendoza, Castanier, Gueret, Medaglia, & Velasco, 2010; Novoa & Storer, 2009; Rei, Gendreau, & Soriano, 2010; Secomandi & Margot, 2009; Tan, Cheong, & Goh, 2007). A dynamic programming approach has been proposed in various capacitated single vehicle routing problems with stochastic discrete demands in which the customers are serviced according to a predefined sequence (see Minis & Tatarakis, 2011; Pandelis, Karamatsoukis, & Kyriakidis, 2013a, 2013b; Pandelis, Kyriakidis, & Dimitrakos, 2012; Tatarakis & Minis, 2009; Yang, Mathur, & Ballou, 2000).

In this paper we modify a specific stochastic capacitated vehicle routing problem with pickups and deliveries studied by Pandelis et al. (2013b) by assuming that the demands of the customers are continuous random variables instead of discrete ones. We give below the description of the modified problem for the case in which only one material is delivered to the customers. The results can easily be extended if the vehicle delivers K > 1 materials, although the required computations are excessive.

We assume that a vehicle of capacity Q > 0 starts its route from a depot loaded with a quantity of material 1 that is smaller or equal to Q and visits N customers according to a predefined order 1 → 2 → ⋅⋅⋅ → N. The vehicle delivers some quantity of material 1 to each customer and collects some quantity of material 2 according to his/her demands. The vehicle is allowed during its route to return to the depot to empty the collected quantity of material 2 and to restock with material 1. When the vehicle returns to the depot for restocking it is not always preferable to load it to its full capacity with material 1, as there needs to be some space available in order to accommodate the collected quantities of material 2 from next customers. Let ξj
                      and 
                        
                           
                              ψ
                              j
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           ,
                        
                      be the demand of customer j for material 1 and the quantity of material 2 that is collected from customer j, respectively. We suppose that ξj
                      and 
                        
                           
                              ψ
                              j
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           ,
                        
                      are continuous random variables such that max 1 ≤ j ≤ N
                     
                     ξj
                      ≤ Q and max 1 ≤ j ≤ N
                     
                     ψj
                      ≤ Q. Let ϕj
                     (x, y) be the joint probability density function of ξj
                      and ψj
                     . For each customer the actual demand for material 1 and the actual quantity of material 2 that must be picked up are revealed only when the vehicle arrives at the customer's site. When the vehicle visits customer 
                        
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           N
                           }
                        
                      for the first time it satisfies as much demand for material 1 as possible and collects the largest possible quantity of material 2. If part of the demand for material 1 is not satisfied and/or there is not enough space for the whole quantity of material 2 that must be collected, the vehicle goes to the depot, empties material 2, restocks with material 1, and returns to customer j. The vehicle returns to the depot after the completion of the service of all customers. Let c
                     
                        j0 and 
                        
                           
                              c
                              
                                 0
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           ,
                        
                      be the travel cost from customer j to the depot and the travel cost from the depot to customer j, respectively. Let also 
                        
                           
                              c
                              
                                 j
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           −
                           1
                           ,
                        
                      be the travel cost from customer j to customer 
                        
                           j
                           +
                           1
                           .
                        
                      It is reasonable to assume that these costs satisfy the symmetric property and the triangle inequality, i.e. 
                        
                           
                              c
                              
                                 j
                                 0
                              
                           
                           =
                           
                              c
                              
                                 0
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           ,
                        
                      and 
                        
                           
                              c
                              
                                 j
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           ≤
                           
                              c
                              
                                 j
                                 0
                              
                           
                           +
                           
                              c
                              
                                 0
                                 ,
                                 j
                                 +
                                 1
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           N
                           −
                           1
                           .
                        
                      Our objective is to find a vehicle routing strategy that minimizes the total expected cost for the service of all customers. A realistic example that fits to this problem could be the optimal routing of a vehicle that visits a sequence of buildings that are under construction, and delivers lime, which is material 1, and collects garbage, which is material 2. Another practical application of the problem could be the so-called ex-van sales, in which the driver of the vehicle acts as a salesman. Suppose that his customers are fruit stores that are supplied with a particular kind of fruit, for example cherries, according to a particular order. It is reasonable to assume that the demands of each fruit store for fresh fruits and the quantities of expired fruits are not known in advance but they are revealed as soon as the vehicle arrives at a fruit store. If the demand of a fruit store for fresh fruits exceeds the quantity that is loaded in the vehicle or if the quantity of expired fruits exceeds the empty space in the vehicle, the driver has to go to the depot to unload the expired fruits and to replenish with fresh ones.

Note that the determination of the optimal routing strategy is achieved by an appropriate dynamic programming approach as in the case of discrete demands that was studied in Pandelis et al. (2013b). However in the present problem the state space after the visit of the vehicle to each customer is a continuous set. We propose a suitable discretization of the state space in order to make the dynamic programming method applicable.

In next section we give a structural property of the optimal routing strategy and we show how it can be computed by implementing a special-purpose dynamic programming algorithm. In Section 3 we give a numerical example and the conclusions of the paper are presented in the last section.

Following the same approach as in Pandelis et al. (2013b), we choose as decision epochs of the problem, the epochs at which the vehicle visits for the first time each customer and has satisfied as much of the customer's demand for material 1 as possible and has picked up as much of material 2 as possible. Note that it is possible at these decision epochs to have some demand for material 1 that has not been satisfied if the quantity of material 1 carried by the vehicle is not sufficient. It is also possible at these decision epochs to have some quantity of material 2 that has not been collected by the vehicle due to lack of empty space. Let 
                        
                           z
                           ∈
                           [
                           −
                           Q
                           ,
                           Q
                           ]
                        
                      be the load of material 1 carried by the vehicle after the first visit at a customer's site, and let 
                        
                           r
                           ∈
                           [
                           −
                           Q
                           ,
                           Q
                           ]
                        
                      be the empty space in the vehicle. Negative values for z and r denote the unsatisfied demand for material 1 and lack of empty space for material 2. When z ≥ 0 and r ≥ 0 (demand for material 1 and collection of material 2 fully satisfied) the vehicle has two choices: (i) it proceeds directly to the next customer and (ii) it goes to the depot, empties the collected quantity of material 2, restocks with load θ ∈ [0, Q] of material 1, and then visits the next customer. When z < 0 and/or r < 0, the vehicle goes to the depot, empties material 2, and restocks (if z < 0) the owed quantity 
                        
                           −
                           z
                        
                      of material 1. Then it has the following choices: (i) it loads an additional quantity θ ≥ 0 of material 1 so that at least 
                        
                           −
                           r
                        
                      (if r < 0) empty space remains after delivering the owed quantity 
                        
                           −
                           z
                           ,
                        
                      that is 
                        
                           θ
                           ≤
                           Q
                           +
                           min
                           (
                           z
                           ,
                           r
                           )
                           ,
                        
                      returns to the customer, satisfies the remaining demand and/or picks up the remaining quantity of material 2, and then proceeds to the next customer and (ii) returns to the customer, satisfies the remaining demand for material 1 and/or collects the remaining quantity of material 2, makes a second trip to the depot where it empties the collected quantity of material 2, restocks with load θ ∈ [0, Q] of material 1 and proceeds to the next customer. It can be seen that, when z < 0 and/or r < 0, the vehicle makes either one or two trips to the depot before proceeding to the next customer.

Let 
                           
                              
                                 f
                                 j
                              
                              
                                 (
                                 z
                                 ,
                                 r
                                 )
                              
                              ,
                              z
                              ,
                              r
                              ∈
                              
                                 [
                                 −
                                 Q
                                 ,
                                 Q
                                 ]
                              
                              ,
                           
                         be the minimum expected total cost from customer j to the end of the route, if the load of material 1 carried by the vehicle after visiting customer j for the first time is equal to z and the empty space is equal to r. For 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              −
                              1
                              }
                              ,
                           
                         this quantity satisfies the following dynamic programming equations (see e.g. Chapter 6 in Ross, 1992):

                           
                              (1)
                              
                                 
                                    
                                       f
                                       j
                                    
                                    
                                       (
                                       z
                                       ,
                                       r
                                       )
                                    
                                    =
                                    min
                                    
                                       {
                                       
                                          H
                                          j
                                       
                                       
                                          (
                                          z
                                          ,
                                          r
                                          )
                                       
                                       ,
                                       
                                          A
                                          j
                                       
                                       }
                                    
                                    ,
                                    
                                    0
                                    ≤
                                    z
                                    ,
                                    r
                                    ≤
                                    Q
                                    ,
                                 
                              
                           
                        and

                           
                              (2)
                              
                                 
                                    
                                       f
                                       j
                                    
                                    
                                       (
                                       z
                                       ,
                                       r
                                       )
                                    
                                    =
                                    2
                                    
                                       c
                                       
                                          j
                                          0
                                       
                                    
                                    +
                                    min
                                    
                                       {
                                       
                                          
                                             H
                                             ˜
                                          
                                          j
                                       
                                       
                                          (
                                          z
                                          ,
                                          r
                                          )
                                       
                                       ,
                                       
                                          A
                                          j
                                       
                                       }
                                    
                                    ,
                                    
                                    if
                                    
                                    z
                                    <
                                    0
                                    
                                    
                                       and
                                       /
                                       or
                                    
                                    
                                    r
                                    <
                                    0
                                    ,
                                 
                              
                           
                        where,

                           
                              (3)
                              
                                 
                                    
                                       H
                                       j
                                    
                                    
                                       (
                                       z
                                       ,
                                       r
                                       )
                                    
                                    
                                    =
                                    
                                    
                                       c
                                       
                                          j
                                          ,
                                          j
                                          +
                                          1
                                       
                                    
                                    
                                    +
                                    
                                    
                                    
                                       ∫
                                       0
                                       Q
                                    
                                    
                                    
                                    
                                       
                                          ∫
                                          0
                                          Q
                                       
                                       
                                          
                                             f
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                          
                                       
                                    
                                    
                                       z
                                       
                                       −
                                       
                                       x
                                       ,
                                       r
                                       
                                       +
                                       
                                       min
                                       
                                          (
                                          z
                                          ,
                                          x
                                          )
                                       
                                       
                                       −
                                       
                                       y
                                       )
                                    
                                    
                                       ϕ
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                    d
                                    x
                                    
                                    d
                                    y
                                    ,
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   ˜
                                                
                                                j
                                             
                                             
                                                (
                                                z
                                                ,
                                                r
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   j
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                min
                                                
                                                   θ
                                                   ∈
                                                   [
                                                   0
                                                   ,
                                                   Q
                                                   +
                                                   min
                                                   (
                                                   z
                                                   ,
                                                   r
                                                   )
                                                   ]
                                                
                                             
                                             
                                                ∫
                                                0
                                                Q
                                             
                                             
                                             
                                             
                                                ∫
                                                0
                                                Q
                                             
                                             
                                                f
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                θ
                                                −
                                                x
                                                ,
                                                Q
                                                +
                                                min
                                                
                                                   (
                                                   0
                                                   ,
                                                   r
                                                   )
                                                
                                                −
                                                θ
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                +
                                                
                                                min
                                                
                                                   (
                                                   θ
                                                   ,
                                                   x
                                                   )
                                                
                                                −
                                                y
                                                )
                                             
                                             
                                                ϕ
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                             d
                                             x
                                             
                                             d
                                             y
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             A
                                             j
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                c
                                                
                                                   j
                                                   0
                                                
                                             
                                             +
                                             
                                                c
                                                
                                                   j
                                                   +
                                                   1
                                                   ,
                                                   0
                                                
                                             
                                             +
                                             
                                                min
                                                
                                                   θ
                                                   ∈
                                                   [
                                                   0
                                                   ,
                                                   Q
                                                   ]
                                                
                                             
                                             
                                                ∫
                                                0
                                                Q
                                             
                                             
                                             
                                             
                                                ∫
                                                0
                                                Q
                                             
                                             
                                                f
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                θ
                                                −
                                                x
                                                ,
                                                Q
                                                −
                                                θ
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                +
                                                
                                                min
                                                
                                                   (
                                                   θ
                                                   ,
                                                   x
                                                   )
                                                
                                                −
                                                y
                                                )
                                             
                                             
                                                ϕ
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                             d
                                             x
                                             
                                             d
                                             y
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The boundary conditions are

                           
                              (6)
                              
                                 
                                    
                                       f
                                       N
                                    
                                    
                                       (
                                       z
                                       ,
                                       r
                                       )
                                    
                                    =
                                    
                                       c
                                       
                                          N
                                          0
                                       
                                    
                                    
                                    if
                                    
                                    0
                                    ≤
                                    z
                                    ,
                                    r
                                    ≤
                                    Q
                                    ,
                                 
                              
                           
                        and

                           
                              (7)
                              
                                 
                                    
                                       f
                                       N
                                    
                                    
                                       (
                                       z
                                       ,
                                       r
                                       )
                                    
                                    =
                                    3
                                    
                                       c
                                       
                                          N
                                          0
                                       
                                    
                                    
                                    if
                                    
                                    z
                                    <
                                    0
                                    
                                    
                                       and
                                       /
                                       of
                                    
                                    
                                    r
                                    <
                                    0
                                    .
                                 
                              
                           
                        The first term in the curly brackets in (1) and (2) corresponds to choice (i) and the second term corresponds to choice (ii). The minimum total expected cost is

                           
                              
                                 
                                    
                                       f
                                       0
                                    
                                    
                                    =
                                    
                                    
                                       c
                                       10
                                    
                                    
                                    +
                                    
                                    
                                    
                                       min
                                       
                                          θ
                                          ∈
                                          [
                                          0
                                          ,
                                          Q
                                          ]
                                       
                                    
                                    
                                       ∫
                                       0
                                       Q
                                    
                                    
                                    
                                    
                                       
                                          ∫
                                          0
                                          Q
                                       
                                       
                                       
                                          
                                             f
                                             1
                                          
                                          
                                             (
                                             θ
                                             
                                             −
                                             
                                             x
                                             ,
                                             Q
                                             
                                             −
                                             
                                             θ
                                             
                                             +
                                             
                                             
                                             min
                                             
                                                (
                                                θ
                                                ,
                                                x
                                                )
                                             
                                             
                                             −
                                             
                                             y
                                             )
                                          
                                          
                                             ϕ
                                             1
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          
                                          d
                                          x
                                          
                                          d
                                          y
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

It can be shown by induction on j in a similar way as in Pandelis et al. (2013b) that Hj
                        (z, r) and 
                           
                              
                                 
                                    H
                                    ˜
                                 
                                 j
                              
                              
                                 (
                                 z
                                 ,
                                 r
                                 )
                              
                           
                         are non-increasing in each of their arguments. This result enables us to prove the following proposition that describes the structure of the optimal vehicle routing strategy after its first visit to customer 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              −
                              1
                              }
                              .
                           
                         Part (i) of the proposition is a consequence of Hj
                        (z, r) being non-increasing in its arguments and Parts (ii)–(iv) follow from 
                           
                              
                                 
                                    H
                                    ˜
                                 
                                 j
                              
                              
                                 (
                                 z
                                 ,
                                 r
                                 )
                              
                           
                         being non-increasing in its arguments.

                           Proposition 1
                           
                              After the first visit to customer
                              
                                 
                                    j
                                    ∈
                                    {
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    −
                                    1
                                    }
                                 
                               
                              there are four cases:
                              
                                 
                                    (i)
                                    
                                       For each z ∈ [0, Q] there exists a critical number
                                       
                                          
                                             
                                                s
                                                
                                                   1
                                                   j
                                                
                                             
                                             
                                                (
                                                z
                                                )
                                             
                                             ∈
                                             
                                                [
                                                0
                                                ,
                                                Q
                                                −
                                                z
                                                ]
                                             
                                          
                                        
                                       such that it is optimal for the vehicle to proceed to customer
                                       
                                          
                                             j
                                             +
                                             1
                                          
                                        
                                       if and only if
                                       
                                          
                                             r
                                             ∈
                                             [
                                             
                                                s
                                                
                                                   1
                                                   j
                                                
                                             
                                             
                                                (
                                                z
                                                )
                                             
                                             ,
                                             Q
                                             −
                                             z
                                             ]
                                             .
                                          
                                        
                                       Moreover, s
                                       1j
                                       (z) is non-increasing in z.
                                    


                                       There exists a critical number
                                       
                                          
                                             
                                                r
                                                j
                                             
                                             ∈
                                             
                                                [
                                                −
                                                Q
                                                ,
                                                0
                                                ]
                                             
                                          
                                        
                                       such that if z ∈ [0, Q] and r < rj it is optimal for the vehicle to make two trips to the depot, while if z ∈ [0, Q] and rj
                                        ≤ r < 0 it is optimal to make one trip to the depot.
                                    


                                       There exists a critical number
                                       
                                          
                                             
                                                q
                                                j
                                             
                                             ∈
                                             
                                                [
                                                −
                                                Q
                                                ,
                                                0
                                                ]
                                             
                                          
                                        
                                       such that if r ∈ [0, Q] and z < qj it is optimal for the vehicle to make two trips to the depot, while if r ∈ [0, Q] and qj
                                        ≤ z < 0 it is optimal to make one trip to the depot.
                                    


                                       For each
                                       
                                          
                                             r
                                             ∈
                                             [
                                             −
                                             Q
                                             ,
                                             0
                                             )
                                          
                                        
                                       there exists a critical number
                                       
                                          
                                             
                                                s
                                                
                                                   2
                                                   j
                                                
                                             
                                             
                                                (
                                                r
                                                )
                                             
                                             ∈
                                             
                                                [
                                                −
                                                Q
                                                ,
                                                0
                                                )
                                             
                                          
                                        
                                       such that it is optimal for the vehicle to make two trips to the depot if and only if
                                       
                                          
                                             z
                                             ∈
                                             [
                                             −
                                             Q
                                             ,
                                             
                                                s
                                                
                                                   2
                                                   j
                                                
                                             
                                             
                                                (
                                                r
                                                )
                                             
                                             ]
                                             .
                                          
                                        Moreover, s
                                       2j
                                       (r) is non-increasing in r.
                                    

The state space after the first visit of the vehicle to customer 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              }
                           
                         is the set 
                           
                              S
                              =
                              {
                              (
                              z
                              ,
                              r
                              )
                              :
                              −
                              Q
                              ≤
                              z
                              ,
                              r
                              ≤
                              Q
                              ,
                              z
                              +
                              r
                              ≤
                              Q
                              }
                              .
                           
                         A discretization of the state space is necessary for the implementation of the dynamic programming algorithm. Let ρ be a relatively small number (e.g. 
                           
                              ρ
                              =
                              0.05
                           
                         or 
                           
                              ρ
                              =
                              0.01
                              )
                              .
                           
                         We discretize S by restricting our attention only to its points (kρ, lρ), 
                           
                              k
                              ,
                              l
                              =
                              −
                              Q
                              /
                              ρ
                              ,
                              −
                              Q
                              /
                              ρ
                              +
                              1
                              ,
                              …
                              ,
                              Q
                              /
                              ρ
                              −
                              1
                              ,
                              Q
                              /
                              ρ
                              .
                           
                         The minimum expected cost fN
                        (kρ, lρ), 
                           
                              −
                              Q
                              /
                              ρ
                              ≤
                              k
                              ,
                              l
                              ≤
                              Q
                              /
                              ρ
                              ,
                           
                         is found by using (6) and (7) with 
                           
                              z
                              =
                              k
                              ρ
                           
                         and 
                           
                              r
                              =
                              l
                              ρ
                              .
                           
                         The minimum expected cost 
                           
                              
                                 f
                                 j
                              
                              
                                 (
                                 k
                                 ρ
                                 ,
                                 l
                                 ρ
                                 )
                              
                              ,
                              −
                              Q
                              /
                              ρ
                              ≤
                              k
                              ,
                              l
                              ≤
                              Q
                              /
                              ρ
                              ,
                           
                         and the corresponding optimal decision are found, recursively, for 
                           
                              j
                              =
                              N
                              −
                              1
                              ,
                              N
                              −
                              2
                              ,
                              …
                              ,
                              1
                           
                         by using the dynamic programming Eqs. (1) and (2) with 
                           
                              z
                              =
                              k
                              ρ
                           
                         and 
                           
                              r
                              =
                              l
                              ρ
                              .
                           
                         The double integrals in (3)–(5) are computed approximately. The parameter θ in (4) and (5) takes values in the set 
                           
                              {
                              u
                              ρ
                              :
                              u
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              Q
                              /
                              ρ
                              +
                              min
                              (
                              k
                              ,
                              l
                              )
                              }
                           
                         and in the set 
                           
                              {
                              0
                              ,
                              ρ
                              ,
                              …
                              ,
                              Q
                              −
                              ρ
                              ,
                              Q
                              }
                              ,
                           
                         respectively. For example, if k < 0 and/or l < 0 the quantity 
                           
                              
                                 
                                    H
                                    ˜
                                 
                                 j
                              
                              
                                 (
                                 k
                                 ρ
                                 ,
                                 l
                                 ρ
                                 )
                              
                           
                         is computed as follows:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   H
                                                   ˜
                                                
                                                j
                                             
                                             
                                                (
                                                k
                                                ρ
                                                ,
                                                l
                                                ρ
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             =
                                             
                                                c
                                                
                                                   j
                                                   ,
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             +
                                             
                                                min
                                                
                                                   θ
                                                   ∈
                                                   {
                                                   0
                                                   ,
                                                   ρ
                                                   ,
                                                   …
                                                   ,
                                                   Q
                                                   +
                                                   min
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                   }
                                                
                                             
                                             
                                                ∑
                                                
                                                   x
                                                   =
                                                   0
                                                
                                                
                                                   Q
                                                   /
                                                   ρ
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      y
                                                      =
                                                      0
                                                   
                                                   
                                                      Q
                                                      /
                                                      ρ
                                                      −
                                                      1
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                      
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      θ
                                                      −
                                                      x
                                                      ρ
                                                      ,
                                                      Q
                                                      +
                                                      min
                                                      
                                                         (
                                                         0
                                                         ,
                                                         l
                                                         ρ
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                −
                                                
                                                θ
                                                +
                                                min
                                                
                                                   (
                                                   θ
                                                   ,
                                                   x
                                                   ρ
                                                   )
                                                
                                                −
                                                y
                                                ρ
                                                )
                                             
                                             
                                                ϕ
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             
                                                (
                                                x
                                                ρ
                                                ,
                                                y
                                                ρ
                                                )
                                             
                                             
                                                ρ
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In view of  Proposition 1, the optimal policy, i.e. the critical numbers s
                        1j
                        (kρ) ≥ 0, 0 ≤ k ≤ Q/ρ, 
                           
                              
                                 s
                                 
                                    2
                                    j
                                 
                              
                              
                                 (
                                 l
                                 ρ
                                 )
                              
                              <
                              0
                              ,
                              −
                              Q
                              /
                              ρ
                              ≤
                              l
                              ≤
                              −
                              1
                              ,
                              
                                 r
                                 j
                              
                              ≤
                              0
                           
                         and qj
                         ≤ 0 for each customer 
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              −
                              1
                              }
                           
                         can be found by the following dynamic programming algorithm:


                        Algorithm for the determination of the critical numbers 
                        rj, qj, s
                        1j
                        (kρ), 0 ≤ k ≤ Q/ρ, 
                           
                              
                                 s
                                 
                                    2
                                    j
                                 
                              
                              
                                 (
                                 l
                                 ρ
                                 )
                              
                              ,
                              −
                              Q
                              /
                              ρ
                              ≤
                              l
                              ≤
                              −
                              1
                           
                        
                        , for customer
                        
                           
                              j
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              N
                              }
                           
                        
                     


                        
                           
                              
                                 
                                 
                                    
                                       
                                          Step 0. Set 
                                             
                                                
                                                   f
                                                   N
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                
                                                   c
                                                   
                                                      N
                                                      0
                                                   
                                                
                                                ,
                                             
                                           for 
                                             
                                                k
                                                ,
                                                l
                                                =
                                                0
                                                ,
                                                …
                                                ,
                                                Q
                                                /
                                                ρ
                                             
                                           such that 
                                             
                                                k
                                                +
                                                l
                                                ≤
                                                Q
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                         Set 
                                             
                                                
                                                   f
                                                   N
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                3
                                                
                                                   c
                                                   
                                                      N
                                                      0
                                                   
                                                
                                                ,
                                             
                                           for 
                                             
                                                k
                                                ,
                                                l
                                                =
                                                −
                                                Q
                                                /
                                                ρ
                                                ,
                                                …
                                                ,
                                                Q
                                                /
                                                ρ
                                             
                                           such that 
                                             
                                                k
                                                <
                                                0
                                             
                                           and/or 
                                             
                                                l
                                                <
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    
                                         Set 
                                             
                                                j
                                                =
                                                N
                                                −
                                                1
                                                .
                                             
                                          
                                       
                                    
                                    
                                       
                                          Step 1. Set 
                                             
                                                
                                                   r
                                                   j
                                                
                                                =
                                                r
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                       
                                          Step 2. (Determination of critical number 
                                             
                                                
                                                   r
                                                   j
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   0
                                                   ,
                                                   r
                                                   )
                                                
                                                >
                                                
                                                   A
                                                   j
                                                
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   r
                                                   j
                                                
                                                =
                                                r
                                                +
                                                ρ
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   0
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                ,
                                                0
                                                ≤
                                                k
                                                ≤
                                                Q
                                                /
                                                ρ
                                                ,
                                                
                                                   r
                                                   j
                                                
                                                /
                                                ρ
                                                ≤
                                                l
                                                <
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   A
                                                   j
                                                
                                                ,
                                                0
                                                ≤
                                                k
                                                ≤
                                                Q
                                                /
                                                ρ
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                l
                                                <
                                                
                                                   r
                                                   j
                                                
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        4. Go to Step 3.
                                    
                                    
                                         Otherwise, set 
                                             
                                                r
                                                =
                                                r
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                r
                                                =
                                                −
                                                Q
                                                −
                                                ρ
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   r
                                                   j
                                                
                                                =
                                                −
                                                Q
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   0
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                ,
                                                0
                                                ≤
                                                k
                                                ≤
                                                Q
                                                /
                                                ρ
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                l
                                                <
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Go to Step 3.
                                    
                                    
                                         Otherwise, go to Step 2.
                                    
                                    
                                       
                                          Step 3. Set 
                                             
                                                z
                                                =
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                       
                                          Step 4. (Determination of critical number 
                                             
                                                
                                                   q
                                                   j
                                                
                                                
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   0
                                                   )
                                                
                                                >
                                                
                                                   A
                                                   j
                                                
                                                ,
                                             
                                           then do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   q
                                                   j
                                                
                                                =
                                                z
                                                +
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   0
                                                   )
                                                
                                                ,
                                                
                                                   q
                                                   j
                                                
                                                /
                                                ρ
                                                ≤
                                                k
                                                <
                                                0
                                                ,
                                                0
                                                ≤
                                                l
                                                ≤
                                                Q
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   A
                                                   j
                                                
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                k
                                                <
                                                
                                                   q
                                                   j
                                                
                                                /
                                                ρ
                                                ,
                                                0
                                                ≤
                                                l
                                                ≤
                                                Q
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        4. Go to Step 5.
                                    
                                    
                                         Otherwise, set 
                                             
                                                z
                                                =
                                                z
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                z
                                                =
                                                −
                                                Q
                                                −
                                                ρ
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   q
                                                   j
                                                
                                                =
                                                −
                                                Q
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   0
                                                   )
                                                
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                k
                                                <
                                                0
                                                ,
                                                0
                                                ≤
                                                l
                                                ≤
                                                Q
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Go to Step 5.
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                 
                                    
                                         Otherwise, go to Step 4.
                                    
                                    
                                        
                                          Step 5. Set 
                                             
                                                z
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    
                                        
                                          Step 6. Set 
                                             
                                                r
                                                =
                                                Q
                                                −
                                                z
                                                .
                                             
                                          
                                       
                                    
                                    
                                        
                                          Step 7. (Determination of critical number 
                                             
                                                
                                                   s
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   
                                                      (
                                                      k
                                                      ρ
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                
                                                   H
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   r
                                                   )
                                                
                                                >
                                                
                                                   A
                                                   j
                                                
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   s
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                =
                                                r
                                                +
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                
                                                   A
                                                   j
                                                
                                                ,
                                                0
                                                ≤
                                                l
                                                ≤
                                                
                                                   s
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                /
                                                ρ
                                                −
                                                1
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                
                                                   H
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                ,
                                                
                                                   s
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                /
                                                ρ
                                                ≤
                                                l
                                                ≤
                                                
                                                   (
                                                   Q
                                                   −
                                                   z
                                                   )
                                                
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        4. Set 
                                             
                                                z
                                                =
                                                z
                                                +
                                                ρ
                                                .
                                             
                                           If 
                                             
                                                z
                                                ≤
                                                Q
                                             
                                           go to Step 6. Otherwise, go to Step 8.
                                    
                                    
                                         Otherwise, set 
                                             
                                                r
                                                =
                                                r
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                r
                                                =
                                                −
                                                ρ
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   s
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   z
                                                   )
                                                
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                =
                                                
                                                   H
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   l
                                                   ρ
                                                   )
                                                
                                                ,
                                                0
                                                ≤
                                                l
                                                ≤
                                                
                                                   (
                                                   Q
                                                   −
                                                   z
                                                   )
                                                
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                z
                                                =
                                                z
                                                +
                                                ρ
                                                .
                                             
                                           If 
                                             
                                                z
                                                ≤
                                                Q
                                                ,
                                             
                                           go to Step 6. Otherwise, go to Step 8.
                                    
                                    
                                        Otherwise, go to Step 7.
                                    
                                    
                                       
                                          Step 8. Set 
                                             
                                                r
                                                =
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                       
                                          Step 9. Set 
                                             
                                                z
                                                =
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                       
                                          Step 10. (Determination of critical number 
                                             
                                                
                                                   s
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                   
                                                      (
                                                      l
                                                      ρ
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   z
                                                   ,
                                                   r
                                                   )
                                                
                                                >
                                                
                                                   A
                                                   j
                                                
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   s
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   )
                                                
                                                =
                                                z
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   r
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   A
                                                   j
                                                
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                k
                                                ≤
                                                
                                                   s
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   )
                                                
                                                /
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   r
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   r
                                                   )
                                                
                                                ,
                                                
                                                   s
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   )
                                                
                                                /
                                                ρ
                                                +
                                                1
                                                ≤
                                                k
                                                ≤
                                                −
                                                1
                                                .
                                             
                                          
                                       
                                    
                                    
                                        4. Set 
                                             
                                                r
                                                =
                                                r
                                                −
                                                ρ
                                                .
                                             
                                           If 
                                             
                                                r
                                                ≥
                                                −
                                                Q
                                                ,
                                             
                                           go to Step 9. Otherwise, go to Step 11.
                                    
                                    
                                         Otherwise, set 
                                             
                                                z
                                                =
                                                z
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                         If 
                                             
                                                z
                                                =
                                                −
                                                Q
                                                −
                                                ρ
                                                ,
                                             
                                           do the following:
                                    
                                    
                                        1. Set 
                                             
                                                
                                                   s
                                                   
                                                      2
                                                      j
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   )
                                                
                                                =
                                                −
                                                Q
                                                −
                                                ρ
                                                .
                                             
                                          
                                       
                                    
                                    
                                        2. Set 
                                             
                                                
                                                   f
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   r
                                                   )
                                                
                                                =
                                                2
                                                
                                                   c
                                                   
                                                      j
                                                      0
                                                   
                                                
                                                +
                                                
                                                   
                                                      H
                                                      ˜
                                                   
                                                   j
                                                
                                                
                                                   (
                                                   k
                                                   ρ
                                                   ,
                                                   r
                                                   )
                                                
                                                ,
                                                −
                                                Q
                                                /
                                                ρ
                                                ≤
                                                k
                                                ≤
                                                −
                                                1
                                                .
                                             
                                          
                                       
                                    
                                    
                                        3. Set 
                                             
                                                r
                                                =
                                                r
                                                −
                                                ρ
                                                .
                                             
                                           If 
                                             
                                                r
                                                ≥
                                                −
                                                Q
                                                ,
                                             
                                           go to Step 9. Otherwise, go to Step 11.
                                    
                                    
                                         Otherwise, go to Step 10.
                                    
                                    
                                       
                                          Step 11. Set 
                                             
                                                j
                                                =
                                                j
                                                −
                                                1
                                                .
                                             
                                           If 
                                             
                                                j
                                                ≥
                                                1
                                             
                                           go to Step 1. Otherwise, stop.
                                    
                                 
                              
                           
                        
                     

As illustration we present the following example.


                     Example. Suppose that 
                        
                           N
                           =
                           8
                           ,
                        
                     
                     
                        
                           Q
                           =
                           6
                           .
                        
                      The travel costs between customers j and 
                        
                           j
                           +
                           1
                           ,
                           
                        
                     
                     
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           7
                           ,
                        
                      are given by: 
                        
                           
                              c
                              12
                           
                           =
                           30
                           ,
                        
                     
                     
                        
                           
                              c
                              23
                           
                           =
                           26
                           ,
                        
                     
                     
                        
                           
                              c
                              34
                           
                           =
                           18
                           ,
                        
                     
                     
                        
                           
                              c
                              45
                           
                           =
                           25
                           ,
                        
                     
                     
                        
                           
                              c
                              56
                           
                           =
                           20
                           ,
                        
                     
                     
                        
                           
                              c
                              67
                           
                           =
                           18
                        
                      and 
                        
                           
                              c
                              78
                           
                           =
                           26
                           .
                        
                      The travel costs between customers j, 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           8
                           ,
                        
                      and the depot are given by: 
                        
                           
                              c
                              10
                           
                           =
                           25
                           ,
                        
                     
                     
                        
                           
                              c
                              20
                           
                           =
                           22
                           ,
                        
                     
                     
                        
                           
                              c
                              30
                           
                           =
                           25
                           ,
                        
                     
                     
                        
                           
                              c
                              40
                           
                           =
                           20
                           ,
                        
                     
                     
                        
                           
                              c
                              50
                           
                           =
                           17
                           ,
                        
                     
                     
                        
                           
                              c
                              60
                           
                           =
                           21
                           ,
                        
                     
                     
                        
                           
                              c
                              70
                           
                           =
                           24
                        
                      and 
                        
                           
                              c
                              80
                           
                           =
                           28
                           .
                        
                      Note that these costs satisfy the triangle inequality. We assume that, for each customer 
                        
                           j
                           ∈
                           {
                           1
                           ,
                           …
                           ,
                           8
                           }
                        
                      the demand ξj
                      for material 1 and the quantity ψj
                      of material 2 that is collected are independent continuous random variables which follow the Gamma distribution right-truncated in the interval [0, Q]. Their probability density functions are given by:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             h
                                             j
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   F
                                                   1
                                                
                                                
                                                   (
                                                   Q
                                                   )
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                   1
                                                   
                                                      α
                                                      1
                                                   
                                                
                                                
                                                   x
                                                   
                                                      
                                                         α
                                                         1
                                                      
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                Γ
                                                (
                                                
                                                   α
                                                   1
                                                
                                                )
                                             
                                          
                                          
                                             e
                                             
                                                −
                                                
                                                   λ
                                                   1
                                                
                                                x
                                             
                                          
                                          
                                          and
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             w
                                             j
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   F
                                                   2
                                                
                                                
                                                   (
                                                   Q
                                                   )
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   λ
                                                   2
                                                   
                                                      α
                                                      2
                                                   
                                                
                                                
                                                   x
                                                   
                                                      
                                                         α
                                                         2
                                                      
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                Γ
                                                (
                                                
                                                   α
                                                   2
                                                
                                                )
                                             
                                          
                                          
                                             e
                                             
                                                −
                                                
                                                   λ
                                                   2
                                                
                                                x
                                             
                                          
                                          ,
                                          
                                          x
                                          ∈
                                          
                                             [
                                             0
                                             ,
                                             Q
                                             ]
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     respectively, where, αi, λi
                      > 0, i ∈ {1, 2}, 
                        
                           Γ
                           
                              (
                              α
                              )
                           
                           =
                           
                              ∫
                              0
                              ∞
                           
                           
                              e
                              
                                 −
                                 u
                              
                           
                           
                              u
                              
                                 α
                                 −
                                 1
                              
                           
                           
                           d
                           u
                           ,
                           α
                           >
                           0
                        
                      and 
                        
                           
                              F
                              i
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              
                                 [
                                 Γ
                                 
                                    (
                                    
                                       α
                                       i
                                    
                                    )
                                 
                                 ]
                              
                              
                                 −
                                 1
                              
                           
                           
                              ∫
                              0
                              
                                 
                                    λ
                                    i
                                 
                                 x
                              
                           
                           
                              
                                 e
                                 
                                    −
                                    u
                                 
                              
                              
                                 u
                                 
                                    
                                       α
                                       i
                                    
                                    −
                                    1
                                 
                              
                              
                              d
                              u
                           
                           ,
                           
                        
                      
                     x ≥ 0. The Gamma distribution seems to be a reasonable choice for the demand for material 1 and for the quantity of material 2 that is collected since, as mentioned in p. 442 in the book of Tijms (2003), in inventory applications the Gamma distribution is often used to model demand distributions. Due to independence of ξj
                      and ψj
                     , 
                        
                           
                              φ
                              j
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           
                              h
                              j
                           
                           
                              (
                              x
                              )
                           
                           
                              w
                              j
                           
                           
                              (
                              y
                              )
                           
                           .
                        
                      We set 
                        
                           
                              α
                              1
                           
                           =
                           5
                           ,
                        
                     
                     
                        
                           
                              λ
                              1
                           
                           =
                           4
                        
                      and 
                        
                           
                              α
                              2
                           
                           =
                           3
                           ,
                        
                     
                     
                        
                           
                              λ
                              2
                           
                           =
                           2
                           .
                        
                      We choose 
                        
                           ρ
                           =
                           0.05
                        
                      so that the discretized state space after the first visit of the vehicle to each customer is the set 
                        
                           {
                           (
                           k
                           ×
                           0.05
                           ,
                           l
                           ×
                           0.05
                           )
                           :
                           k
                           ,
                           l
                           =
                           −
                           120
                           ,
                           …
                           ,
                           120
                           
                           and
                           
                           k
                           +
                           l
                           ≤
                           120
                           }
                           .
                        
                      We implemented the initial dynamic programming algorithm based on (1)–(7) and the special-purpose dynamic programming algorithm by running the corresponding Matlab program on a personal computer equipped with an Intel Core 2 Duo, 2.5 GHz processor and 4 GB of RAM. In Fig. 1
                      below, we present the optimal decisions after the first visit to customer 5. The structure of the optimal policy, as expected, is of threshold-type described in Proposition 1. The action of proceeding directly to the next customer is coloured by dark blue, the action of returning to the depot once is coloured by red and the action of making two trips to the depot is coloured by light green. The value of the minimum total expected cost f
                     0 is found to be approximately equal to 298.04. The computation time of the special-purpose dynamic programming algorithm is 9112 seconds. It is considerably smaller than the computation time of the initial dynamic programming algorithm which is 12554 seconds.

Both algorithms enable us to determine the optimal quantity of material 1 that is loaded in the vehicle when it returns to the depot for replenishment. For example, if after the first visit of the vehicle to customer 5 the state is 
                        
                           (
                           z
                           ,
                           r
                           )
                           =
                        
                     
                     
                        
                           (
                           −
                           2.75
                           ,
                           
                           2
                           )
                           ,
                        
                      then the optimal decision for the vehicle is to go to the depot to empty the quantity of material 2 that it carries and to load the owed quantity of material 1 which is equal to 2.75. Then, it loads an additional quantity of material 1 which is equal to 2.9, returns to customer 5, satisfies the remaining demand of material 1 and then proceeds to customer 6. If after the first visit of the vehicle to customer 5 the state is 
                        
                           (
                           z
                           ,
                           r
                           )
                           =
                        
                     
                     
                        
                           (
                           −
                           5
                           ,
                           
                           −
                           2.5
                           )
                           ,
                        
                      the optimal decision is to go to the depot to empty the quantity of material 2 that it carries and to load the owed quantity of material 1 which is equal to 5. Then, it returns to customer 5 to deliver the owed quantity of material 1 and pick up the remaining quantity of material 2 which is equal to 2.5, makes a second trip to the depot, empties the remaining quantity of material 2, loads a new quantity of material 1 equal to 3.2 and then proceeds to customer 6.

@&#CONCLUSIONS@&#

In this paper we considered a simple capacitated vehicle routing problem with pickups and deliveries. It was assumed that (i) the vehicle visits each customer according to a predefined sequence, (ii) each customer demands a quantity of material 1 that is a random variable and (iii) each customer gives to the vehicle a quantity of material 2 that is also a continuous random variable. It was assumed that these random variables are continuous with known distributions and their actual values become known only when the vehicle arrives at each customer's site. Assumption (i) together with a suitable choice of decision epochs enabled us to develop a dynamic programming algorithm for the determination of the routing strategy with the minimum total expected cost. We also gave a structural property of the optimal routing strategy according to which the state space is divided to three subsets. If at a decision epoch the state belongs to the first subset then the vehicle proceeds to the next customer, if it belongs to the second subset then it makes one trip to the depot before proceeding to the next customer and if it belongs to the third subset then it makes two trips to the depot before proceeding to the next customer. This characterization of the optimal policy enabled us to design an efficient special-purpose dynamic programming algorithm for its computation by restricting our attention only to those policies having the above structural property. The state space, that corresponds to each customer, is continuous and it was discretized before applying the dynamic programming algorithms to specific numerical examples.

@&#ACKNOWLEDGEMENTS@&#

We would like to thank two anonymous referees whose helpful comments improved the presentation of the paper.

@&#REFERENCES@&#

