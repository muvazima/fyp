@&#MAIN-TITLE@&#Perfect periodic scheduling for binary tree routing in wireless networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An approach to scheduling data through a Wireless Mesh Network to the Internet.


                        
                        
                           
                           An efficiency improvement of up to 50% relative to common cycle solutions.


                        
                        
                           
                           An optimisation method for co-coordinating data transmission through a routing tree.


                        
                        
                           
                           A polynomial time algorithm for a special case of an NP-hard combinatoric problem.


                        
                        
                           
                           Perfect periodic solutions which accommodate multiple periodicities.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Scheduling

OR in telecommunications

Mobile and Ad hoc NETworks (MANETs)

Combinatorial optimization

Chinese Remainder Theorem

@&#ABSTRACT@&#


               
               
                  In this paper we tackle the problem of co-ordinating transmission of data across a Wireless Mesh Network. The single task nature of mesh nodes imposes simultaneous activation of adjacent nodes during transmission. This makes the co-ordinated scheduling of local mesh node traffic with forwarded traffic across the access network to the Internet via the Gateway notoriously difficult. Moreover, with packet data the nature of the co-ordinated transmission schedule has a big impact upon both the data throughput and energy consumption. Perfect Periodic Scheduling, in which each demand is itself serviced periodically, provides a robust solution. In this paper we explore the properties of Perfect Periodic Schedules with modulo arithmetic using the Chinese Remainder Theorem. We provide a polynomial time, optimisation algorithm, when the access network routing tree has a chain or binary tree structure. Results demonstrate that energy savings and high throughput can be achieved simultaneously. The methodology is generalisable.
               
            

@&#INTRODUCTION@&#

The emerging technology of Wireless Mesh Networks (WMN) (Akyildiz, Wang, & Wang, 2005) provides a promising paradigm for the flexible and low-cost provision of global Internet communication. Mesh routers facilitate multi-hop wireless transmission to relay data over extended distances without need for the cost, delay and disruption of installing cabled access points. Packet scheduling facilitates improved throughput, fairness between clients, reduced delays and energy conservation (Quintas & Friderikos, 2012). However, specialized scheduling methodology is required to exploit these features.

Mesh routers are typically mounted on the sides of buildings and operate in two ways: firstly they service the clients who connect directly to a mesh router to gain broadband access; secondly they act as a relay to other mesh routers in forwarding content to a particular mesh router that acts as the gateway to wired infrastructure. Within each local star network the mesh router can communicate with at most one client at a time. The packet nature of transmission imposes a discrete, unit time, nature on transmission schedules. Moreover, schedules which are periodic for each client are highly desirable because they provide clients with predefined transmission times between which they can conserve resources and avoid contention. The regularity of transmission reduces jitter and thus improves Quality of Service. In addition, the issue of fairness between clients can be enforced by imposing Perfect Periodic Schedule (PPS), in which clients each have periodic sub-schedules of appropriate relative periodicity. Across a mesh network mesh routers may therefore impose local scheduling on their own clients but then need to interweave global scheduling on forwarding traffic to another mesh router. Since mesh routers are unable to multi-task, the problem of coordinating transmission across the entire routing network in the WMN is considerable. Improvement in throughput is captured by the Minimum Frame Length Schedule Problem (MFLSP) which seeks to find a schedule of minimum total duration which may then be repeated. In this paper we therefore focus on MFLSP using centrally co-ordinated periodicities to schedule packets across the network.

Several studies have been undertaken on problems of local access. Local traffic is serviced by a mesh router, and forms a local star network, each in a periodic fashion within a perfect periodic (sub)schedule. Bar-Noy, Bhatia, Naor, and Schieber (2002a) prove that the problem of finding a feasible perfect periodic schedule is an 
                        NP
                     -hard problem in general. Kim and Glass (2014) derive a simple test for the existence of a feasible schedule for problems with two or three distinct periodicities in total. They also provide a method of constructing a feasible schedule, if one exists, using modulo arithmetic. In practice, clients’ level of requested demand may vary considerably. Due to the difficulty of finding a feasible perfect periodic schedule to satisfy the particular combination of requested periodicities, heuristics are used to allocated close values, according to specific criteria. Bar-Noy, Dreizin, and Patt-Shamir (2004) consider two objective measures of maximum and weighted average ratios between the allocated and requested periodicities. They present a few efficient heuristic algorithms to develop a perfect periodic schedule using a methodology, called tree scheduling, since it is based on hierarchical round-robin where the hierarchy is a form of tree. Bar-Noy, Nisgav, and Patt-Shamir (2002b) develop tree based approximation algorithms for perfect periodic schedule with the objective of minimizing weighted average ratios between the allocated periodicity and requested periodicity. Brakerski, Dreizin, and Patt-Shamir (2003) study the question of dispatching in a perfect periodic schedule, namely how to find the next item to schedule, given the past schedule. There are few other papers which consider PPS for telecommunications, namely (Brakerski et al., 2003; Brakerski, Nisgav, & Patt-Shamir, 2006; Chen & Huang, 2008; Patil & Garg, 2006), but none applied to WMNs.

Some studies have been undertaken on problems of data transmission across a mesh network to carry the data from individual mesh nodes to the Internet Gateway. Different interference models have been proposed in the wireless scheduling literature. Notably, the graph interference model (Commander & Pardalos, 2009; Ephremides & Truong, 1990; Gupta, Lin, & Srikant, 2007; Raman, 2006; Sarkar & Ray, 2008; Sharma, Mazumdar, & Shroff, 2006; Wang & Ansari, 1997), where nodes interfere with other nodes in a predefined neighbourhood within the network a conflict graph. If the interference is restricted to the 1-hop neighborhood, then the scheduling problem reduces to the Chromatic Number Problem. More recently the physical interference model has been proposed (Bjorklund, Varbrand, & Yuan, 2004; Brar, Blough, & Santi, 2006; Das, Marks, Arabshahi, & Gray, 2005; ElBatt & Ephremides, 2004; Goussevskaia, Oswald, & Wattenhofer, 2007; Hua & Lau, 2008; Li & Ephremides, 2007; Moscibroda, Wattenhofer, & Zollinger, 2006; Papadaki & Friderikos, 2008; Quintas & Friderikos, 2012) where signal power attenuation is taken explicitly into account via the Signal to Interference plus Noise Ratio (SINR) constraint that represents the actual physical interference in the wireless network. In the WMN context, interference related to broadcast noise is less of a feature. The main characteristic of the technology is blocking of transmission on adjacent links due to the single-task nature of mesh nodes. The problem thus resembles 1-hop edge colouring. However, the strongest feature in our context is the periodic nature of transmission through a link.

One article (Allen, Cooper, Glass, Kim, & Whitaker, 2012) explores the means of coordinating local mesh schedules which are periodic, but not necessarily so restrictive as to be perfectly periodic. The authors consider the scenario of pre-set local periodic schedules at the mesh nodes, and develop an heuristic to integrate them into a global schedule through the access network. An access link between two adjacent nodes can only be active when there is a simultaneous gap in local transmission at each of the two nodes. Thus, the first natural mechanism for co-ordinating local schedules is to control their relative start times. However, this is rarely sufficient even with sparse local schedules. Allen et al. (2012) develop an optimization scheduling algorithm which in addition equitably reduces the service time to local clients. Their algorithm works well for 25-node routing networks. However, by the nature of the problem, a large reduction in throughput was required to achieve a feasible schedule. Their computational work thus highlights the necessity of co-ordinating the periodicities of the local schedules if service levels are to be maintained. When transmission is co-ordinated in practice this necessity is satisfied with the standard mode of a Common Cycle.

We tackle the problem of scheduling both local and global data transmissions in a mesh network in perfectly periodic fashion. In a perfect periodic schedule, each transmission is undertaken at a regular, though not necessarily common, time interval.

We develop a methodology for the problem focusing upon uniform client demand, uniform link capacities and binary and chain routing trees. This is in line with the common practice of imposing routing through tree subnetworks of binary, or near binary, form. Moreover, both the results and the methodology are generalisable. Results are compared with the simpler periodic form used in practice of a Common Cycle, termed round robin, to gauge their advantage. The problem is formulated and the solution space defined in terms of congruent arithmetic in the next section. The case of a chain routing tree is then analysed in Section 3 and reduced to just two potentially optimal forms. The following three sections are dedicated to finding minimum time frame schedules for a binary routing tree. We first analyse properties of feasible, and then optimal, schedules for half of a binary tree, namely one which has (up to) two branches on all but the node adjacent to the Gateway. Using these results, in Section 5 we reduce the number of candidates for an optimal schedule of a full binary tree. The forms of an optimal binary tree are then further reduced and enumerated in Section 6, along with closed form expressions for the corresponding time frames. The outcome is an optimisation algorithm, which depends only upon prime factorisation of an integer of reasonable size, namely the total number of peripheral clients in the network. A polynomial time approximation scheme (PTAS), which is computable in practice, is also provided. The impact of transmission from different parts of the network, and the effectiveness gain over the Common Cycle schedule, are also analysed. The behaviour of algorithm OptPPS in practice is evaluated in Section 7, where experimental results reveal that efficiency gains of over 35% is normal, and 100% is reached for some relatively small networks.

@&#BACKGROUND@&#

The routing of messages through a Wireless Mesh Network is done in practice within a predetermined routing tree subnetwork whose root is the single gateway to the Internet. The packet nature of data transmission results in transmissions of homogeneous size. Data all originate at local clients and in the absence of further information we assume identical demand from each client in the network.

In practice, transmission into and out of the gateway are generally performed separately. We focus upon flow into the gateway, as outflow transmission can be treated in an identical manner. In this context a mesh node may have several incoming links within the routing tree, but only a single outgoing link. It is simplest to consider the case of homogeneous link capacity, which we will calibrate to be one unit of data per time unit.

Now recall that any two links adjacent to a star-node cannot be active simultaneously. Thus, at a mesh node a schedule consists of an assignment of each time slot to at most one of the adjacent links: to a local client; to one of the incoming access links; or else the single outgoing access link. The imperative of improved throughput is captured by the Minimum Frame Length Schedule Problem (MFLSP) which seeks to find a schedule of minimum total duration. In this context, we wish to find a periodic schedule, of minimum length, in which all data make a single hop along the routing tree and each link being itself scheduled periodically. The problem may be formulated as follows.

Notations

                        
                           
                              G
                           
                           index for the Gateway Mesh node

index for a non-Gateway Mesh node

number of Mesh nodes, other than the Gateway

the link in the routing tree out of Mesh node j
                           

total amount of data flow through link j, i.e. the amount of data output by node j
                           

the set of links in the access network ending at the Gateway Mesh node

the set of links in the access network ending or beginning at Mesh node j
                           

the set of links from local clients into Mesh node j
                           


                              
                                 
                                    
                                       =
                                       |
                                    
                                    
                                       Y
                                       j
                                    
                                    
                                       |
                                       ,
                                    
                                 
                               the number of local clients of Mesh node j
                           

first time slot in which link lj
                               is activated

the list of first time-slots τj
                              
                           

periodicity of data transmission for the out-flow from Mesh node j, along link lj
                              
                           

the list of periodicities qj
                              
                           


                              
                                 
                                    =
                                    S
                                    (
                                    
                                       τ
                                       ̲
                                    
                                    ,
                                    
                                       q
                                       ̲
                                    
                                    )
                                 
                               the perfect periodic schedule defined by 
                                 τ
                               and 
                                 q
                              
                           


                              
                                 
                                    =
                                    T
                                    (
                                    
                                       τ
                                       ̲
                                    
                                    ,
                                    
                                       q
                                       ̲
                                    
                                    )
                                 
                               or 
                                 
                                    T
                                    (
                                    S
                                    )
                                    ,
                                 
                               the length of a complete cycle of the perfect periodic schedule 
                                 
                                    S
                                    (
                                    
                                       τ
                                       ̲
                                    
                                    ,
                                    
                                       q
                                       ̲
                                    
                                    )
                                    .
                                 
                              
                           

We say that a solution 
                        S
                      is dominated by another solution 
                        
                           S
                           ′
                        
                      if 
                        
                           T
                           
                              (
                              
                                 S
                                 ′
                              
                              )
                           
                           ≤
                           T
                           
                              (
                              S
                              )
                           
                        
                     . Observe that the input data consists of the network links, the lj
                     ’s, and the local data captured by the yj
                      values. Since there is conservation of data-flow at each Mesh node, the total amount of in-flow has to be the same as the total amount of out-flow at each Mesh node. Thus, the demand for data flow along links in the network, wj
                     , is fully determined by the amount of local data entering the network at Mesh nodes, yj
                      for 
                        
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           n
                           ,
                        
                      in the routing tree. Numbering star-nodes to respect the direction of flow along the routing tree, the wj
                      values may thus be determined recursively by the formula

                        
                           
                              
                                 
                                    w
                                    j
                                 
                                 =
                                 
                                    y
                                    j
                                 
                                 +
                                 
                                    ∑
                                    
                                       
                                          l
                                          
                                             j
                                             ′
                                          
                                       
                                       ∈
                                       
                                          L
                                          j
                                       
                                       ,
                                       
                                       
                                          j
                                          ′
                                       
                                       ≠
                                       j
                                    
                                 
                                 
                                    w
                                    
                                       j
                                       ′
                                    
                                 
                                 .
                              
                           
                        
                     
                     Problem:
For a given routing tree with a single Gateway node, and n additional nodes with yj
                      clients at node j, for 
                        
                           j
                           =
                           1
                           ,
                           …
                           ,
                           n
                           ,
                        
                      find time-slots τj
                      and periodicities qj
                      satisfying the following constraints:

                        
                           (1)
                           
                              
                                 
                                    τ
                                    
                                       j
                                       ′
                                    
                                 
                                 +
                                 
                                    (
                                    k
                                    −
                                    1
                                    )
                                 
                                 
                                    q
                                    
                                       j
                                       ′
                                    
                                 
                                 
                                 for
                                 
                                 k
                                 ∈
                                 N
                                 
                                 and
                                 
                                 
                                    j
                                    ′
                                 
                                 ∈
                                 
                                    L
                                    j
                                 
                                 
                                 
                                 are
                                 
                                 pairwise
                                 
                                 distinct
                                 
                                 for
                                 
                                 all
                                 
                                 j
                                 ,
                              
                           
                        
                     and

                        
                           (2)
                           
                              
                                 
                                    ∑
                                    
                                       
                                          j
                                          ′
                                       
                                       ∈
                                       
                                          L
                                          j
                                       
                                    
                                 
                                 
                                    1
                                    
                                       q
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 <
                                 1
                                 
                                 for
                                 
                                 all
                                 
                                 j
                                 ,
                              
                           
                        
                     and

                        
                           (3)
                           
                              
                                 
                                    ∑
                                    
                                       
                                          j
                                          ′
                                       
                                       ∈
                                       
                                          L
                                          G
                                       
                                    
                                 
                                 
                                    1
                                    
                                       q
                                       
                                          j
                                          ′
                                       
                                    
                                 
                                 ≤
                                 1
                                 ,
                              
                           
                        
                     for which the overall periodicity T( 
                        q
                      ) of the corresponding schedule satisfies

                        
                           (4)
                           
                              
                                 T
                                 
                                 is
                                 
                                 a
                                 
                                 multiple
                                 
                                 of
                                 
                                 l
                                 c
                                 m
                                 (
                                 
                                    q
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    q
                                    n
                                 
                                 )
                                 ,
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 T
                                 ≥
                                 
                                    w
                                    j
                                 
                                 
                                    q
                                    j
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 j
                                 ,
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 T
                                 
                                    (
                                    1
                                    −
                                    
                                       ∑
                                       
                                          
                                             j
                                             ′
                                          
                                          ∈
                                          
                                             L
                                             j
                                          
                                       
                                    
                                    
                                       1
                                       
                                          q
                                          
                                             j
                                             ′
                                          
                                       
                                    
                                    )
                                 
                                 ≥
                                 
                                    y
                                    j
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 j
                                 ,
                              
                           
                        
                     and

                        
                           (7)
                           
                              
                                 
                                    τ
                                    j
                                 
                                 ,
                                 
                                    q
                                    j
                                 
                                 ∈
                                 N
                                 ,
                                 
                                 for
                                 
                                 all
                                 
                                 j
                                 .
                              
                           
                        
                     The objective is to minimize the schedule cycle length 
                        
                           T
                           =
                           T
                           (
                           
                              τ
                              ̲
                           
                           ,
                           
                              q
                              ̲
                           
                           )
                        
                     .

Constraint (1) prohibits simultaneous transmission on access links adjacent to the same node. Constraints (2) and (6) respectively ensure that at each mesh node there is some gap, and that the number of gaps in the complete schedule is sufficient to accommodate all of the local traffic. The capacity restriction at the Gateway node is captured in constraint (3). Constraint (5) ensures that all of the data wj
                      at each node j is transmitted within the schedule cycle. While constraint (4) ensures that the periodicity of each sub-schedule is accommodated within the whole schedule.

The following useful result follows directly from the Chinese Remainder Theorem (CRT) (Jones & Jones, 1998, Theorem 3.12).

                        Lemma 1
                        
                           A solution τj and qj for
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                              
                            
                           satisfies Condition (
                           
                              1
                           
                           ) if and only if
                           
                              
                                 (8)
                                 
                                    
                                       
                                          τ
                                          
                                             j
                                             ′
                                          
                                       
                                       ¬
                                       ≡
                                       
                                          τ
                                          
                                             j
                                             
                                                ′
                                                ′
                                             
                                          
                                       
                                       
                                       mod
                                       
                                       g
                                       c
                                       d
                                       
                                          (
                                          
                                             q
                                             
                                                j
                                                ′
                                             
                                          
                                          ,
                                          
                                             q
                                             
                                                j
                                                
                                                   ′
                                                   ′
                                                
                                             
                                          
                                          )
                                       
                                       
                                       for
                                       
                                       
                                          j
                                          ′
                                       
                                       ≠
                                       
                                          j
                                          
                                             ′
                                             ′
                                          
                                       
                                       
                                       and
                                       
                                       
                                          j
                                          ′
                                       
                                       ,
                                       
                                          j
                                          
                                             ′
                                             ′
                                          
                                       
                                       ∈
                                       
                                          L
                                          j
                                       
                                       
                                       for
                                       
                                       all
                                       
                                       j
                                       .
                                    
                                 
                              
                           
                        


                           A set of periodicities qj for
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                              
                            
                           cannot accommodate a feasible schedule τj for
                           
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                              
                            
                           (satisfying Condition (
                           
                              1
                           
                           )) if there is a pair whose periodicities, qj and
                           
                              
                                 q
                                 
                                    j
                                    ′
                                 
                              
                            
                           are pairwise coprime, i.e.
                           
                              
                                 g
                                 c
                                 d
                                 (
                                 
                                    q
                                    j
                                 
                                 ,
                                 
                                    q
                                    
                                       j
                                       ′
                                    
                                 
                                 )
                                 =
                                 1
                              
                           
                           .
                        

For two positive integers, a and b, let R(a, b) denote the remainder function of a and b, that is, 
                        
                           R
                           
                              (
                              a
                              ,
                              b
                              )
                           
                           =
                           a
                           −
                           b
                           
                              ⌊
                              a
                              /
                              b
                              ⌋
                           
                           ,
                        
                      and a∣b denotes that a divides b.

In this section, we study a chain network where each node has at most one adjacent node from which it receives data. Observe that since local clients each require only one data unit to be transfered in each cycle, they can be fitted into an available time slot without violating the perfect periodic nature of the schedule. It is therefore convenient to have a simple diagrammatic representation of the multiple local clients of a node. We use a triangle node for this purpose, and index the nodes by depth from the gateway, as shown in Fig. 1
                     .

                        Lemma 2
                        
                           A chain Network has an optimal PPS with
                           
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 2
                              
                            
                           or 3.
                        

Suppose that the Lemma does not hold. Then there exist an optimal solution with 
                              
                                 
                                    q
                                    1
                                    ′
                                 
                                 ≥
                                 4
                              
                            and periodicity T′, say, for which T′ ≥ 4w
                           1 by Condition (5). We now construct a new solution by letting 
                              
                                 
                                    q
                                    j
                                 
                                 =
                                 3
                              
                            for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                                 ,
                              
                            and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                       −
                                       1
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌈
                                    n
                                    /
                                    2
                                    ⌉
                                 
                              
                            and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                    
                                 
                                 =
                                 1
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌊
                                    n
                                    /
                                    2
                                    ⌋
                                 
                              
                           .

Conditions (1) and (2) are trivially satisfied for 
                              
                                 j
                                 =
                                 n
                              
                            since 
                              
                                 
                                    L
                                    n
                                 
                                 =
                                 
                                    {
                                    
                                       l
                                       n
                                    
                                    }
                                 
                              
                            has only one element. For 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                                 −
                                 1
                                 ,
                              
                           
                           
                              
                                 
                                    L
                                    j
                                 
                                 =
                                 
                                    {
                                    
                                       l
                                       j
                                    
                                    ,
                                    
                                       l
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                            and 
                              
                                 g
                                 c
                                 d
                                 (
                                 
                                    q
                                    j
                                 
                                 ,
                                 
                                    q
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 3
                                 .
                              
                            Thus, for 
                              
                                 j
                                 ≤
                                 n
                                 −
                                 1
                                 ,
                              
                            Condition (1) is satisfied by Lemma 1 since 
                              
                                 
                                    τ
                                    j
                                 
                                 ¬
                                 ≡
                                 
                                    τ
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                 mod
                                 
                                 3
                                 ,
                              
                            and Condition (2) is satisfied since

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                L
                                                j
                                             
                                          
                                       
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                ′
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             q
                                             j
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          3
                                       
                                       +
                                       
                                          1
                                          3
                                       
                                       
                                       <
                                       
                                       1
                                       .
                                    
                                 
                              
                           Condition (3) is trivially satisfied since G has only one element. Moreover, 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                              
                            satisfies Condition (4) since 
                              
                                 
                                    q
                                    j
                                 
                                 =
                                 3
                              
                            for all j, and Condition (5) since 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                                 =
                                 
                                    w
                                    1
                                 
                                 
                                    q
                                    j
                                 
                                 ≥
                                 
                                    w
                                    j
                                 
                                 
                                    q
                                    j
                                 
                              
                            for all j. Moreover, Condition (6) is satisfied since

                              
                                 
                                    
                                       T
                                       
                                          (
                                          
                                          1
                                          
                                          −
                                          
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                ∈
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          )
                                       
                                       >
                                       3
                                       
                                          y
                                          j
                                       
                                       
                                          (
                                          1
                                          
                                          −
                                          
                                          
                                             1
                                             
                                                q
                                                j
                                             
                                          
                                          
                                          −
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       3
                                       
                                          y
                                          j
                                       
                                       
                                          (
                                          1
                                          
                                          −
                                          
                                          
                                             1
                                             3
                                          
                                          −
                                          
                                             1
                                             3
                                          
                                          )
                                       
                                       =
                                       
                                          y
                                          j
                                       
                                       ,
                                    
                                 
                              
                           and 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                                 ≥
                                 3
                                 
                                    w
                                    j
                                 
                                 >
                                 3
                                 
                                    y
                                    j
                                 
                              
                            for all j. Therefore, the new solution is feasible and has 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                                 <
                                 
                                    T
                                    ′
                                 
                                 ,
                              
                            providing the required contradiction.□


                           For a chain network with two or more nodes and y
                           1 ≤ w
                           2, an optimal PPS is provided by 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   ̲
                                                
                                                =
                                                
                                                   (
                                                   
                                                      q
                                                      1
                                                   
                                                   ,
                                                   
                                                      q
                                                      2
                                                   
                                                   ,
                                                   ⋯
                                                   ,
                                                   
                                                      q
                                                      n
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            2
                                                            ,
                                                            4
                                                            ,
                                                            4
                                                            ,
                                                            ⋯
                                                            ,
                                                            4
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            
                                                               y
                                                               1
                                                            
                                                            ≥
                                                            
                                                               w
                                                               2
                                                            
                                                            /
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            3
                                                            ,
                                                            3
                                                            ,
                                                            3
                                                            ,
                                                            ⋯
                                                            ,
                                                            3
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            
                                                               y
                                                               1
                                                            
                                                            <
                                                            
                                                               w
                                                               2
                                                            
                                                            /
                                                            3
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   τ
                                                   ̲
                                                
                                                =
                                                
                                                   (
                                                   
                                                      τ
                                                      1
                                                   
                                                   ,
                                                   
                                                      τ
                                                      2
                                                   
                                                   ,
                                                   ⋯
                                                   ,
                                                   
                                                      τ
                                                      n
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                0
                                                ,
                                                1
                                                ,
                                                0
                                                ,
                                                1
                                                ,
                                                ⋯
                                                ,
                                                0
                                                ,
                                                1
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            4
                                                            
                                                               w
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            3
                                                            
                                                               w
                                                               1
                                                            
                                                            ≥
                                                            4
                                                            
                                                               w
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            3
                                                            
                                                               w
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                            3
                                                            
                                                               w
                                                               1
                                                            
                                                            <
                                                            4
                                                            
                                                               w
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

By Lemma 2, there are two cases to consider: 
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 2
                              
                            and 
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 3
                              
                           . Suppose that 
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 2
                              
                           . Due to the local transmission to the node 1, we have that q
                           2 ≥ 3. Since q
                           1 and q
                           2 cannot be coprime, q
                           2 ≥ 4 and hence T ≥ 4w
                           2 by Condition (5). A feasible solution with 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                              
                            can be obtained by setting 
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 2
                              
                            and 
                              
                                 
                                    q
                                    j
                                 
                                 =
                                 4
                              
                            for 
                              
                                 j
                                 =
                                 2
                                 ,
                                 ⋯
                                 ,
                                 n
                                 ,
                              
                            and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                       −
                                       1
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌈
                                    n
                                    /
                                    2
                                    ⌉
                                 
                              
                            and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                    
                                 
                                 =
                                 1
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌊
                                    n
                                    /
                                    2
                                    ⌋
                                 
                              
                           . Then, τj
                            and 
                              
                                 τ
                                 
                                    j
                                    +
                                    1
                                 
                              
                            for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                                 −
                                 1
                              
                            satisfy Condition (1) by Lemma 1 since 
                              
                                 
                                    L
                                    j
                                 
                                 =
                                 
                                    {
                                    
                                       l
                                       j
                                    
                                    ,
                                    
                                       l
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                            and 
                              
                                 
                                    τ
                                    j
                                 
                                 ¬
                                 ≡
                                 
                                    τ
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                 mod
                                 
                                 g
                                 c
                                 d
                                 
                                    (
                                    
                                       q
                                       j
                                    
                                    ,
                                    
                                       q
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              
                           . Condition (2) is satisfied because

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                L
                                                j
                                             
                                          
                                       
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                ′
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             q
                                             j
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                       ≤
                                       
                                          1
                                          2
                                       
                                       +
                                       
                                          1
                                          4
                                       
                                       
                                       <
                                       
                                       1
                                       
                                       for
                                       
                                       all
                                       
                                       j
                                       .
                                    
                                 
                              
                           Condition (3) is trivially satisfied since G has only one element. Condition (4) is satisfied because 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                              
                            and 
                              
                                 l
                                 c
                                 m
                                 (
                                 
                                    q
                                    1
                                 
                                 ,
                                 ⋯
                                 ,
                                 
                                    q
                                    n
                                 
                                 )
                                 =
                                 4
                              
                           . Since 
                              
                                 2
                                 
                                    w
                                    2
                                 
                                 ≥
                                 
                                    w
                                    2
                                 
                                 +
                                 
                                    y
                                    1
                                 
                                 =
                                 
                                    w
                                    1
                                 
                                 ,
                              
                            we have that 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                                 ≥
                                 2
                                 
                                    w
                                    1
                                 
                                 ≥
                                 
                                    w
                                    1
                                 
                                 
                                    q
                                    1
                                 
                              
                            and 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                                 ≥
                                 4
                                 
                                    w
                                    j
                                 
                                 =
                                 
                                    w
                                    j
                                 
                                 
                                    q
                                    j
                                 
                              
                            for 
                              
                                 j
                                 =
                                 2
                                 ,
                                 ⋯
                                 ,
                                 n
                                 ,
                              
                            satisfying Condition (5). Moreover, Condition (6) is satisfied since 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                                 ≥
                                 4
                                 
                                    y
                                    j
                                 
                              
                            and

                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            j
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            L
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         q
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                4
                                                
                                                   y
                                                   j
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      1
                                                      
                                                         q
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      
                                                         q
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                4
                                                
                                                   y
                                                   j
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      1
                                                      2
                                                   
                                                   −
                                                   
                                                      1
                                                      4
                                                   
                                                   )
                                                
                                                =
                                                
                                                   y
                                                   j
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                j
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Therefore, the solution is feasible and has 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    2
                                 
                              
                           .

We now suppose that 
                              
                                 
                                    q
                                    1
                                 
                                 =
                                 3
                              
                           . Then, T ≥ 3w
                           1 by Condition (5). A feasible solution with 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                              
                            can be obtained by letting 
                              
                                 
                                    q
                                    j
                                 
                                 =
                                 3
                              
                            for all j, and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                       −
                                       1
                                    
                                 
                                 =
                                 0
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌈
                                    n
                                    /
                                    2
                                    ⌉
                                 
                              
                            and 
                              
                                 
                                    τ
                                    
                                       2
                                       h
                                    
                                 
                                 =
                                 1
                              
                            for 
                              
                                 h
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌊
                                    n
                                    /
                                    2
                                    ⌋
                                 
                              
                           . τj
                            and 
                              
                                 τ
                                 
                                    j
                                    +
                                    1
                                 
                              
                            for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 n
                                 −
                                 1
                              
                            satisfy Condition (1) by Lemma 1 since 
                              
                                 
                                    L
                                    j
                                 
                                 =
                                 
                                    {
                                    
                                       l
                                       j
                                    
                                    ,
                                    
                                       l
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    }
                                 
                              
                            and 
                              
                                 
                                    τ
                                    j
                                 
                                 ¬
                                 ≡
                                 
                                    τ
                                    
                                       j
                                       +
                                       1
                                    
                                 
                                 
                                 mod
                                 
                                 g
                                 c
                                 d
                                 
                                    (
                                    
                                       q
                                       j
                                    
                                    ,
                                    
                                       q
                                       
                                          j
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              
                           . Condition (2) is satisfied because

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                j
                                                ′
                                             
                                             ∈
                                             
                                                L
                                                j
                                             
                                          
                                       
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                ′
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          
                                             q
                                             j
                                          
                                       
                                       +
                                       
                                          1
                                          
                                             q
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                       
                                       =
                                       
                                          1
                                          3
                                       
                                       +
                                       
                                          1
                                          3
                                       
                                       
                                       <
                                       
                                       1
                                       
                                       for
                                       
                                       all
                                       
                                       j
                                       .
                                    
                                 
                              
                           Condition (3) is trivially satisfied since G has only one element. Observe that 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                              
                            satisfies Conditions (4)–(6) as follows: Condition (4) is satisfied since 
                              
                                 
                                    q
                                    j
                                 
                                 =
                                 3
                              
                            for all j and Condition (5) is satisfied since 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                                 =
                                 
                                    w
                                    1
                                 
                                 
                                    q
                                    j
                                 
                                 ≥
                                 
                                    w
                                    j
                                 
                                 
                                    q
                                    j
                                 
                              
                            for all j. Moreover, Condition (6) is satisfied since 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                                 ≥
                                 3
                                 
                                    w
                                    j
                                 
                                 >
                                 3
                                 
                                    y
                                    j
                                 
                              
                            and

                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      ∑
                                                      
                                                         
                                                            j
                                                            ′
                                                         
                                                         ∈
                                                         
                                                            L
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         q
                                                         
                                                            j
                                                            ′
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                             
                                          
                                          
                                             >
                                          
                                          
                                             
                                                
                                                3
                                                
                                                   y
                                                   j
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      1
                                                      
                                                         q
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      1
                                                      
                                                         q
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   )
                                                
                                                =
                                                3
                                                
                                                   y
                                                   j
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      1
                                                      3
                                                   
                                                   −
                                                   
                                                      1
                                                      3
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   y
                                                   j
                                                
                                                
                                                for
                                                
                                                all
                                                j
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Therefore, the new solution is feasible and has 
                              
                                 T
                                 =
                                 3
                                 
                                    w
                                    1
                                 
                              
                           . Consequently, if y
                           1 ≤ w
                           2, then there exits an optimal solution having 
                              
                                 T
                                 =
                                 min
                                 {
                                 3
                                 
                                    w
                                    1
                                 
                                 ,
                                 
                                 4
                                 
                                    w
                                    2
                                 
                                 }
                              
                           .□

Observe that nodes at depth 3 onward have no explicit effect on the T. However, reducing the chain to depth 1 reduces T to 2w
                     1.

                        Example 1
                        Consider a chain network of depth 3 with input data 
                              
                                 
                                    y
                                    1
                                 
                                 =
                                 3
                                 ,
                              
                           
                           
                              
                                 
                                    y
                                    2
                                 
                                 =
                                 2
                              
                            and 
                              
                                 
                                    y
                                    3
                                 
                                 =
                                 1
                              
                            as shown Fig. 2
                           (a) . By Theorem 1, an optimal PPS is provided by 
                              
                                 
                                    q
                                    ̲
                                 
                                 =
                                 
                                    (
                                    
                                       q
                                       1
                                    
                                    ,
                                    
                                       q
                                       2
                                    
                                    ,
                                    
                                       q
                                       3
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    2
                                    ,
                                    4
                                    ,
                                    4
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    τ
                                    ̲
                                 
                                 =
                                 
                                    (
                                    
                                       τ
                                       1
                                    
                                    ,
                                    
                                       τ
                                       2
                                    
                                    ,
                                    
                                       τ
                                       3
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    0
                                    ,
                                    1
                                    ,
                                    0
                                    )
                                 
                              
                            and 
                              
                                 T
                                 =
                                 min
                                 {
                                 3
                                 
                                    w
                                    1
                                 
                                 ,
                                 4
                                 
                                    w
                                    2
                                 
                                 }
                                 =
                                 12
                              
                           . The corresponding full set of time slots in which links are activated within each full cycle is indicated in Fig. 2(b) . Each local client’s link is activated once in every full cycle of length 12.

Now consider how a standard routing protocol using a Common Cycle of periodicity qC
                      would schedule data transfer. It requires qC
                      ≥ 3, to satisfy Condition (2) since node 2 has three links. Since TC
                      ≥ qCw
                     1, 
                        
                           
                              q
                              C
                           
                           =
                           3
                        
                      provides the optimal Common Cycle schedule. Thus, for Example 1, 
                        
                           
                              T
                              C
                           
                           =
                           3
                           *
                           6
                           =
                           18
                        
                      compared with 
                        
                           
                              T
                              *
                           
                           =
                           12
                        
                      and 
                        
                           
                              T
                              C
                           
                           /
                           
                              T
                              *
                           
                           =
                           3
                           /
                           2
                        
                     . More generally, when 3w
                     1 ≥ 4w
                     2, from Theorem 1,

                        
                           
                              
                                 
                                    
                                       T
                                       C
                                    
                                    
                                       T
                                       *
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       
                                          w
                                          1
                                       
                                    
                                    
                                       4
                                       
                                          w
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    
                                       3
                                       (
                                       2
                                       
                                          w
                                          2
                                       
                                       −
                                       
                                          (
                                          
                                             w
                                             2
                                          
                                          −
                                          
                                             y
                                             1
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       4
                                       
                                          w
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    3
                                    2
                                 
                                 −
                                 
                                    3
                                    4
                                 
                                 
                                    (
                                    
                                       w
                                       2
                                    
                                    −
                                    
                                       y
                                       1
                                    
                                    )
                                 
                                 ≤
                                 
                                    3
                                    2
                                 
                                 ,
                              
                           
                        
                     giving the following result.

                        Theorem 2
                        
                           For a chain network, perfect periodic schedule accommodates up to 50% more capacity than the standard Common Cycle approach.
                        

When a routing tree has multiple Mesh nodes adjacent to the Gateway, the PPS problem is NP-hard (Kim & Glass, 2014). We study the special case of a routing tree in which each mesh node has at most two incoming access links, namely a binary tree network. For ease of analysis, we first study the case with only one Mesh node adjacent to the Gateway, defined as half binary tree network (Fig. 3
                     ). We then extend this result to the case where there are two Mesh nodes adjacent to the Gateway (Fig. 6) in the next section.

We use the following convention for a half binary tree which we refer to as a canonical indexing. Nodes are indexed with respect to the distance (in the number of edges) from the gateway, and an edge has the same index as its start node. Links going into a specific node are indexed in non-increasing transmission requirement, eg. w
                     2 ≥ w
                     3. In addition, we may refer to the two incoming links at node j as j
                     1 and j
                     2 where 
                        
                           
                              w
                              
                                 j
                                 1
                              
                           
                           ≥
                           
                              w
                              
                                 j
                                 2
                              
                           
                        
                      by convention. We assume throughout that the input data flow rates is not too large at any single node. More precisely, 
                        
                           
                              y
                              j
                           
                           ≤
                           
                              w
                              
                                 j
                                 2
                              
                           
                        
                      for all j.

Our approach is to identify a limited number of possible dominant solutions for half of a binary (sub)tree before proceeding to consider optimal solutions for whole binary tree. It is sufficient to consider three classes of feasible schedules, one for each values of q
                     1, namely 
                        
                           S
                           2
                        
                      for 
                        
                           
                              q
                              1
                           
                           =
                           2
                           ,
                        
                     
                     
                        
                           S
                           3
                        
                      for 
                        
                           
                              q
                              1
                           
                           =
                           3
                        
                      and 
                        
                           S
                           a
                        
                      for 
                        
                           
                              q
                              1
                           
                           =
                           a
                        
                      and a ≥ 4.


                        
                           Lemma 3
                           
                              For any two integers a and b, the schedule
                              
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                               
                              where a ≥ 2 and ab ≥ 3, defined by 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                      1
                                                   
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      1
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                      2
                                                   
                                                   =
                                                   2
                                                   a
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      2
                                                   
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                      3
                                                   
                                                   =
                                                   2
                                                   a
                                                   b
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      3
                                                   
                                                   =
                                                   3
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                      
                                                         j
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      q
                                                      j
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      
                                                         j
                                                         1
                                                      
                                                   
                                                   =
                                                   R
                                                   
                                                      (
                                                      
                                                         τ
                                                         j
                                                      
                                                      +
                                                      1
                                                      ,
                                                      2
                                                      a
                                                      )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   j
                                                   =
                                                   2
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                      
                                                         j
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      q
                                                      j
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      τ
                                                      
                                                         j
                                                         2
                                                      
                                                   
                                                   =
                                                   R
                                                   
                                                      (
                                                      
                                                         τ
                                                         j
                                                      
                                                      +
                                                      3
                                                      ,
                                                      2
                                                      a
                                                      )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   j
                                                   =
                                                   2
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              is feasible with T ≥ max {2aw
                              2, 2abw
                              3} and 2ab∣T.
                           

Observe that 
                                 
                                    
                                       τ
                                       1
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       2
                                    
                                    
                                    mod
                                    
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          1
                                       
                                       ,
                                       
                                          q
                                          2
                                       
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       τ
                                       2
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       3
                                    
                                    
                                    mod
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          2
                                       
                                       ,
                                       
                                          q
                                          3
                                       
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       τ
                                       3
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       1
                                    
                                    
                                    mod
                                    
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          3
                                       
                                       ,
                                       
                                          q
                                          1
                                       
                                       )
                                    
                                 
                              . Moreover, 
                                 
                                    
                                       τ
                                       
                                          j
                                          ′
                                       
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       
                                          j
                                          
                                             ′
                                             ′
                                          
                                       
                                    
                                    
                                    mod
                                    
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          
                                             j
                                             ′
                                          
                                       
                                       ,
                                       
                                          q
                                          
                                             j
                                             
                                                ′
                                                ′
                                             
                                          
                                       
                                       )
                                    
                                    
                                    for
                                    
                                    
                                       j
                                       ′
                                    
                                    ≠
                                    
                                       j
                                       
                                          ′
                                          ′
                                       
                                    
                                    
                                    and
                                    
                                    
                                       j
                                       ′
                                    
                                    ,
                                    
                                       j
                                       
                                          ′
                                          ′
                                       
                                    
                                    ∈
                                    
                                       L
                                       j
                                    
                                 
                               for 
                                 
                                    j
                                    =
                                    2
                                    ,
                                    ⋯
                                    ,
                                    n
                                 
                               by construction. Therefore, τj
                              , 
                                 
                                    τ
                                    
                                       j
                                       1
                                    
                                 
                               and 
                                 
                                    τ
                                    
                                       j
                                       2
                                    
                                 
                               satisfy Condition (1) by Lemma 1 for all j. Moreover, for all j
                              
                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                ∈
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                q
                                                j
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   1
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   2
                                                
                                             
                                          
                                          ≤
                                          
                                             1
                                             2
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                a
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                2
                                                a
                                                b
                                             
                                          
                                          
                                          ≤
                                          
                                          
                                             1
                                             2
                                          
                                          +
                                          
                                             1
                                             4
                                          
                                          +
                                          
                                             1
                                             6
                                          
                                          <
                                          1
                                          ,
                                       
                                    
                                 
                              ensuring that Condition (2) is satisfied. Condition (3) is trivially satisfied since G has only one element. Thus, 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       a
                                       ,
                                       b
                                       )
                                    
                                 
                               is feasible. Conditions (4) and (5) mean that 2ab∣T and 
                                 
                                    T
                                    ≥
                                    max
                                    
                                       {
                                       2
                                       
                                          w
                                          1
                                       
                                       ,
                                       2
                                       a
                                       
                                          w
                                          2
                                       
                                       ,
                                       2
                                       a
                                       b
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                    =
                                    max
                                    
                                       {
                                       2
                                       a
                                       
                                          w
                                          2
                                       
                                       ,
                                       2
                                       a
                                       b
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                 
                               by Appendix A. Then, Condition (6) is satisfied since

                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         ∑
                                                         
                                                            
                                                               j
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               L
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         
                                                            q
                                                            
                                                               j
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   2
                                                   a
                                                   b
                                                   
                                                      w
                                                      3
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         1
                                                         2
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            2
                                                            a
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            2
                                                            a
                                                            b
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      (
                                                      a
                                                      −
                                                      1
                                                      )
                                                      b
                                                      −
                                                      1
                                                      )
                                                   
                                                   
                                                      w
                                                      3
                                                   
                                                   ≥
                                                   
                                                      y
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and

                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         ∑
                                                         
                                                            
                                                               j
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               L
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         
                                                            q
                                                            
                                                               j
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   2
                                                   a
                                                   
                                                      w
                                                      2
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         1
                                                         
                                                            2
                                                            a
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            2
                                                            a
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            2
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      (
                                                      2
                                                      a
                                                      −
                                                      3
                                                      )
                                                   
                                                   
                                                      w
                                                      2
                                                   
                                                   ≥
                                                   
                                                      y
                                                      j
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   
                                                   j
                                                   =
                                                   2
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   .
                                                   
                                                   □
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                              For a half binary tree structure with canonical indexing, if
                              
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                 
                               
                              and
                              
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    4
                                 
                               
                              in a PPS, then q
                              3 
                              must be a multiple of 4 in any feasible solution.
                           

Suppose otherwise, then there is a feasible PPS solution with 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                    ,
                                 
                              
                              
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    4
                                 
                               and q
                              3 is of the form 
                                 
                                    4
                                    a
                                    +
                                    2
                                    ,
                                 
                               since q
                              3 is a multiple of 2 by Corollary 1. Thus, 
                                 
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          1
                                       
                                       ,
                                       
                                          q
                                          2
                                       
                                       )
                                    
                                    =
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          2
                                       
                                       ,
                                       
                                          q
                                          3
                                       
                                       )
                                    
                                    =
                                    g
                                    c
                                    d
                                    
                                       (
                                       
                                          q
                                          3
                                       
                                       ,
                                       
                                          q
                                          1
                                       
                                       )
                                    
                                    =
                                    2
                                    ,
                                 
                               and hence 
                                 
                                    
                                       τ
                                       1
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       2
                                    
                                    
                                    mod
                                    
                                    2
                                    ,
                                 
                              
                              
                                 
                                    
                                       τ
                                       2
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       3
                                    
                                    
                                    mod
                                    
                                    2
                                 
                               and 
                                 
                                    
                                       τ
                                       3
                                    
                                    ¬
                                    ≡
                                    
                                       τ
                                       1
                                    
                                    
                                    mod
                                    
                                    2
                                 
                              . This implies that the values τ
                              1, τ
                              2 and τ
                              3 are not pairwise distinct, providing the required contradiction.□


                              For a network containing a half binary subtree with
                              
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                    ,
                                 
                               
                              there exists an optimal PPS having one of following forms with the corresponding constraints on the value of T: 
                              
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                          
                                          for
                                          
                                          a
                                          ≥
                                          2
                                          ,
                                          
                                          with
                                          
                                          T
                                          ≥
                                          4
                                          a
                                          max
                                          
                                             {
                                             
                                                ⌈
                                                
                                                   
                                                      w
                                                      2
                                                   
                                                   a
                                                
                                                ⌉
                                             
                                             ,
                                             
                                                w
                                                3
                                             
                                             }
                                          
                                          
                                          and
                                          
                                          4
                                          a
                                          ∣
                                          T
                                          ,
                                       
                                    
                                 
                              
                              or 
                              
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             a
                                             ,
                                             1
                                             )
                                          
                                          
                                          for
                                          
                                          a
                                          ≥
                                          3
                                          ,
                                          
                                          with
                                          
                                          T
                                          ≥
                                          2
                                          a
                                          
                                             w
                                             2
                                          
                                          
                                          and
                                          
                                          2
                                          a
                                          ∣
                                          T
                                          .
                                       
                                    
                                 
                              
                           

Take a feasible PPS for a half binary tree with 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                 
                               and the corresponding T. Both q
                              2 and q
                              3 have to be a multiple of 2 since q
                              1, q
                              2 and q
                              3 cannot be pairwise coprime by Corollary 1. Due to transmissions of the link 3, ie. w
                              3 > 0, we have that q
                              2 ≥ 4. We consider the cases 
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    4
                                 
                               and 
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    2
                                    a
                                 
                               for a ≥ 3, separately.

Suppose that 
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    4
                                 
                              . Note that q
                              3 must be a multiple of 4, 
                                 
                                    
                                       q
                                       3
                                    
                                    =
                                    4
                                    b
                                 
                               say, by Lemma 4, and b ≥ 2 to allow time for the local transmissions of the node 1, y
                              1. Conditions (4) and (5) imply that T is a multiple of 4b and that 
                                 
                                    T
                                    ≥
                                    max
                                    
                                       {
                                       2
                                       
                                          w
                                          1
                                       
                                       ,
                                       4
                                       
                                          w
                                          2
                                       
                                       ,
                                       4
                                       b
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                    =
                                    max
                                    
                                       {
                                       4
                                       
                                          w
                                          2
                                       
                                       ,
                                       4
                                       b
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                 
                               by Appendix A. Thus, T ≥ 4bmax {⌈w
                              2/b⌉, w
                              3} and 4b∣T. Observe that both these conditions are precisely the constraints on the value of T in 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       2
                                       ,
                                       b
                                       )
                                    
                                 
                               from Lemma 3.

Now suppose that 
                                 
                                    
                                       q
                                       2
                                    
                                    =
                                    2
                                    a
                                 
                               and a ≥ 3. Since 3w
                              2 ≥ w
                              1 and a ≥ 3, Conditions (4) and (5) imply that 
                                 
                                    T
                                    ≥
                                    max
                                    
                                       {
                                       2
                                       
                                          w
                                          1
                                       
                                       ,
                                       2
                                       a
                                       
                                          w
                                          2
                                       
                                       }
                                    
                                    =
                                    2
                                    a
                                    
                                       w
                                       2
                                    
                                 
                               and 2a∣T. Observe that this condition is precisely the constraints on the value of T in 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       a
                                       ,
                                       1
                                       )
                                    
                                 
                               from Lemma 3.□

Consider a half binary tree network of depth 2 with input data 
                                 
                                    
                                       y
                                       1
                                    
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       y
                                       2
                                    
                                    =
                                    2
                                 
                               and 
                                 
                                    
                                       y
                                       3
                                    
                                    =
                                    1
                                 
                              . Then, 
                                 
                                    
                                       w
                                       1
                                    
                                    =
                                    4
                                    ,
                                 
                              
                              
                                 
                                    
                                       w
                                       2
                                    
                                    =
                                    2
                                 
                               and 
                                 
                                    
                                       w
                                       3
                                    
                                    =
                                    1
                                 
                              . By Lemma 5, an optimal PPS with 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                 
                               is provided by 
                                 
                                    
                                       q
                                       ̲
                                    
                                    =
                                    
                                       (
                                       
                                          q
                                          1
                                       
                                       ,
                                       
                                          q
                                          2
                                       
                                       ,
                                       
                                          q
                                          3
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       2
                                       ,
                                       4
                                       ,
                                       8
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       τ
                                       ̲
                                    
                                    =
                                    
                                       (
                                       
                                          τ
                                          1
                                       
                                       ,
                                       
                                          τ
                                          2
                                       
                                       ,
                                       
                                          τ
                                          3
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       0
                                       ,
                                       1
                                       ,
                                       3
                                       )
                                    
                                 
                               and 
                                 
                                    T
                                    =
                                    8
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             2
                                          
                                          /
                                          2
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                    =
                                    8
                                 
                              . The corresponding full set of time slots in which links are activated within each full cycle is indicated in Fig. 4
                              . Each local client’s link is activated once in every full cycle of length 8.


                        
                           Lemma 6
                           
                              For a network containing a half binary subtree with
                              
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    3
                                    ,
                                 
                               
                              there exists an optimal PPS having the following form with the corresponding constraints on the value of T:
                              
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                               
                              for a ≥ 2 with 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   
                                                      2
                                                      r
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   3
                                                   
                                                   
                                                   for
                                                   
                                                   r
                                                   =
                                                   0
                                                   ,
                                                   ⋯
                                                   ,
                                                   
                                                      ⌊
                                                      
                                                         log
                                                         2
                                                      
                                                      n
                                                      ⌋
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   q
                                                   j
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   3
                                                   a
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   other
                                                   
                                                   j
                                                   "s
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   1
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   
                                                      j
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   R
                                                   (
                                                   
                                                      τ
                                                      j
                                                   
                                                   +
                                                   1
                                                   ,
                                                   3
                                                   )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   
                                                      j
                                                      2
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   R
                                                   (
                                                   
                                                      τ
                                                      j
                                                   
                                                   +
                                                   2
                                                   ,
                                                   3
                                                   )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              which has 
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   3
                                                   a
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            
                                                               w
                                                               1
                                                            
                                                            a
                                                         
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         ^
                                                      
                                                      }
                                                   
                                                   
                                                   and
                                                   
                                                   3
                                                   a
                                                   ∣
                                                   T
                                                   ,
                                                   
                                                   
                                                   where
                                                   
                                                   
                                                      w
                                                      ^
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   max
                                                   
                                                      {
                                                      
                                                         w
                                                         
                                                            
                                                               2
                                                               r
                                                            
                                                            +
                                                            1
                                                         
                                                      
                                                      :
                                                      r
                                                      =
                                                      1
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         ⌊
                                                         
                                                            log
                                                            2
                                                         
                                                         n
                                                         ⌋
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

We first show that 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                               for a ≥ 2 is feasible, with 
                                 
                                    T
                                    ≥
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          ^
                                       
                                       }
                                    
                                 
                               and 3a∣T, where 
                                 
                                    
                                       w
                                       ^
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          w
                                          
                                             
                                                2
                                                r
                                             
                                             +
                                             1
                                          
                                       
                                       :
                                       r
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       
                                          ⌊
                                          
                                             log
                                             2
                                          
                                          n
                                          ⌋
                                       
                                       }
                                    
                                 
                              . Observe that τj
                              , 
                                 
                                    τ
                                    
                                       j
                                       1
                                    
                                 
                               and 
                                 
                                    τ
                                    
                                       j
                                       2
                                    
                                 
                               satisfy Condition (1) by Lemma 1 for all j. Condition (2) is satisfied since a ≥ 2 and

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                ∈
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          =
                                          
                                             1
                                             
                                                q
                                                j
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   1
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   2
                                                
                                             
                                          
                                          ≤
                                          
                                             1
                                             3
                                          
                                          +
                                          
                                             1
                                             3
                                          
                                          +
                                          
                                             1
                                             
                                                3
                                                a
                                             
                                          
                                          
                                          <
                                          
                                          1
                                          
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          j
                                          .
                                       
                                    
                                 
                              Condition (3) is trivially satisfied since G has only one element. Thus, 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                               is feasible. Observe that 
                                 
                                    
                                       w
                                       ^
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          w
                                          
                                             
                                                2
                                                r
                                             
                                             +
                                             1
                                          
                                       
                                       :
                                       0
                                       ≤
                                       r
                                       ≤
                                       
                                          ⌊
                                          
                                             log
                                             2
                                          
                                          n
                                          ⌋
                                       
                                       }
                                    
                                    =
                                    
                                       max
                                       
                                          j
                                          ∈
                                          J
                                          ∖
                                          
                                             J
                                             1
                                          
                                       
                                    
                                    
                                       {
                                       
                                          w
                                          j
                                       
                                       }
                                    
                                    ,
                                 
                               where 
                                 
                                    J
                                    =
                                    {
                                    1
                                    ,
                                    ⋯
                                    ,
                                    n
                                    }
                                 
                               and 
                                 
                                    
                                       J
                                       1
                                    
                                    =
                                    
                                       {
                                       
                                          2
                                          r
                                       
                                       :
                                       0
                                       ≤
                                       r
                                       ≤
                                       
                                          ⌊
                                          
                                             log
                                             2
                                          
                                          n
                                          ⌋
                                       
                                       }
                                    
                                    ,
                                 
                               because a star-node j for j ∈ J∖ J
                              1 transmits its data to the gateway via a star-node j for 
                                 
                                    j
                                    ∈
                                    {
                                    
                                       2
                                       r
                                    
                                    +
                                    1
                                    :
                                    0
                                    ≤
                                    r
                                    ≤
                                    
                                       ⌊
                                       
                                          log
                                          2
                                       
                                       n
                                       ⌋
                                    
                                    }
                                 
                              . Thus, Condition (5) imposes that 
                                 
                                    T
                                    ≥
                                    max
                                    
                                       {
                                       
                                          w
                                          j
                                       
                                       
                                          q
                                          j
                                       
                                       }
                                    
                                    =
                                    max
                                    
                                       {
                                       3
                                       
                                          max
                                          
                                             j
                                             ∈
                                             
                                                J
                                                1
                                             
                                          
                                       
                                       
                                          {
                                          
                                             w
                                             j
                                          
                                          }
                                       
                                       ,
                                       3
                                       a
                                       
                                          max
                                          
                                             j
                                             ∈
                                             J
                                             ∖
                                             
                                                J
                                                1
                                             
                                          
                                       
                                       
                                          {
                                          
                                             w
                                             j
                                          
                                          }
                                       
                                       }
                                    
                                    =
                                    max
                                    
                                       {
                                       3
                                       
                                          w
                                          1
                                       
                                       ,
                                       3
                                       a
                                       
                                          w
                                          ^
                                       
                                       }
                                    
                                 
                              . Condition (4) imposes that T is divisible by 3a and strengthens the bound on T to 
                                 
                                    T
                                    ≥
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          ^
                                       
                                       }
                                    
                                 
                              . Note that 
                                 
                                    T
                                    ≥
                                    
                                       q
                                       
                                          j
                                          2
                                       
                                    
                                    
                                       w
                                       
                                          j
                                          2
                                       
                                    
                                    ≥
                                    6
                                    
                                       y
                                       j
                                    
                                 
                               since 
                                 
                                    
                                       q
                                       
                                          j
                                          2
                                       
                                    
                                    =
                                    3
                                    a
                                    ≥
                                    6
                                 
                               and 
                                 
                                    
                                       w
                                       
                                          j
                                          2
                                       
                                    
                                    ≥
                                    
                                       y
                                       j
                                    
                                 
                               for all j. Thus,

                                 
                                    
                                       
                                          
                                             
                                                
                                                   T
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         ∑
                                                         
                                                            
                                                               j
                                                               ′
                                                            
                                                            ∈
                                                            
                                                               L
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         
                                                            q
                                                            
                                                               j
                                                               ′
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   6
                                                   
                                                      y
                                                      j
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         1
                                                         
                                                            q
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            q
                                                            
                                                               j
                                                               1
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            q
                                                            
                                                               j
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                ≥
                                             
                                             
                                                
                                                   6
                                                   
                                                      y
                                                      j
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         1
                                                         3
                                                      
                                                      −
                                                      
                                                         1
                                                         3
                                                      
                                                      −
                                                      
                                                         1
                                                         
                                                            3
                                                            a
                                                         
                                                      
                                                      )
                                                   
                                                   ≥
                                                   
                                                      y
                                                      j
                                                   
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   j
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Thus, Condition (6) is satisfied.

Take a feasible solution 
                                 S
                               with 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    3
                                 
                              . Let 
                                 
                                    r
                                    ˜
                                 
                               denote the smallest index among nodes for which 
                                 
                                    
                                       q
                                       
                                          2
                                          
                                             
                                                r
                                                ˜
                                             
                                             +
                                             1
                                          
                                       
                                    
                                    ≠
                                    3
                                 
                              . Let 
                                 
                                    
                                       j
                                       ˜
                                    
                                    =
                                    
                                       argmax
                                       
                                          j
                                          ∈
                                          
                                             J
                                             2
                                          
                                       
                                    
                                    
                                       {
                                       
                                          w
                                          j
                                       
                                       }
                                    
                                 
                               where 
                                 
                                    
                                       J
                                       2
                                    
                                    =
                                    
                                       {
                                       
                                          2
                                          
                                             
                                                r
                                                ˜
                                             
                                             +
                                             1
                                          
                                       
                                       }
                                    
                                    ∪
                                    
                                       {
                                       
                                          2
                                          r
                                       
                                       +
                                       1
                                       :
                                       1
                                       ≤
                                       r
                                       ≤
                                       
                                          r
                                          ˜
                                       
                                       +
                                       1
                                       }
                                    
                                    
                                       }
                                    
                                 
                               (Fig. 5
                              
                              ).

Since 
                                 
                                    
                                       q
                                       j
                                    
                                    =
                                    3
                                 
                               for 
                                 
                                    j
                                    ∈
                                    {
                                    
                                       2
                                       r
                                    
                                    :
                                    0
                                    ≤
                                    r
                                    ≤
                                    
                                       r
                                       ˜
                                    
                                    }
                                    ,
                                 
                               we have that qj
                               for j ∈ J
                              2 are each multiples of 3 by Corollary 1. Since qj
                               > 3 for j ∈ J
                              2 to accommodate local transmission at star-node 2
                                 r
                               for 
                                 
                                    r
                                    =
                                    0
                                    ,
                                    ⋯
                                    ,
                                    
                                       r
                                       ˜
                                    
                                    ,
                                 
                               we have that 
                                 
                                    q
                                    
                                       j
                                       ˜
                                    
                                 
                               is of the form 3a for some integer a and a ≥ 2. Thus, 
                                 
                                    T
                                    (
                                    S
                                    )
                                 
                               is constrained by Condition (4) to have 
                                 
                                    3
                                    a
                                    ∣
                                    T
                                    (
                                    S
                                    )
                                 
                               and by Condition (5) to have 
                                 
                                    T
                                    
                                       (
                                       S
                                       )
                                    
                                    ≥
                                    max
                                    
                                       {
                                       3
                                       
                                          w
                                          1
                                       
                                       ,
                                       3
                                       a
                                       
                                          w
                                          
                                             j
                                             ˜
                                          
                                       
                                       }
                                    
                                    =
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          
                                             j
                                             ˜
                                          
                                       
                                       }
                                    
                                 
                              . Since 
                                 
                                    
                                       w
                                       
                                          
                                             2
                                             
                                                r
                                                ˜
                                             
                                          
                                          +
                                          1
                                       
                                    
                                    ≥
                                    
                                       w
                                       
                                          
                                             2
                                             j
                                          
                                          +
                                          1
                                       
                                    
                                 
                               for 
                                 
                                    j
                                    ≥
                                    
                                       r
                                       ˜
                                    
                                    +
                                    2
                                    ,
                                 
                               from the definition of 
                                 
                                    
                                       j
                                       ˜
                                    
                                    ,
                                 
                               we have that 
                                 
                                    
                                       w
                                       
                                          j
                                          ˜
                                       
                                    
                                    ≥
                                    max
                                    
                                       {
                                       
                                          w
                                          
                                             
                                                2
                                                r
                                             
                                             +
                                             1
                                          
                                       
                                       :
                                       0
                                       ≤
                                       r
                                       ≤
                                       
                                          ⌊
                                          
                                             log
                                             2
                                          
                                          n
                                          ⌋
                                       
                                       }
                                    
                                    =
                                    
                                       w
                                       ^
                                    
                                 
                              . Therefore, 
                                 
                                    T
                                    
                                       (
                                       S
                                       )
                                    
                                    ≥
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          
                                             j
                                             ˜
                                          
                                       
                                       }
                                    
                                    ≥
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          ^
                                       
                                       }
                                    
                                    =
                                    T
                                    
                                       (
                                       
                                          S
                                          3
                                       
                                       
                                          (
                                          a
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                               which implies that there exists an optimal PPS with the form of 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                              .□

From the results of Lemmas 5 and 6 based upon periodicities 2 and 3 respectively, we obtain a complete set of optimal PPSs for a half binary tree in Theorem 3.

                           Theorem 3
                           
                              For a half binary tree, there is an optimal PPS of one of the following forms: 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      2
                                                      )
                                                   
                                                   
                                                   with
                                                   
                                                   T
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   8
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            2
                                                         
                                                         /
                                                         2
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         3
                                                      
                                                      }
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   
                                                   with
                                                   
                                                   T
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   6
                                                   
                                                      w
                                                      2
                                                   
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   
                                                   with
                                                   
                                                   T
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   6
                                                   
                                                      ⌈
                                                      
                                                         w
                                                         1
                                                      
                                                      /
                                                      2
                                                      ⌉
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and if there exists an integer a such that a∣w
                              2 
                              and 3 ≤ a < w
                              2/w
                              3,

                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                          
                                          with
                                          
                                          T
                                          =
                                          4
                                          
                                             w
                                             2
                                          
                                          ,
                                       
                                    
                                 
                              
                              and if there exists an integer a such that a∣w
                              1 
                              and
                              
                                 
                                    3
                                    ≤
                                    a
                                    <
                                    
                                       w
                                       1
                                    
                                    /
                                    
                                       w
                                       ^
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             S
                                             3
                                          
                                          
                                             (
                                             a
                                             )
                                          
                                          
                                          with
                                          
                                          T
                                          =
                                          3
                                          
                                             w
                                             1
                                          
                                       
                                    
                                 
                              
                              where
                              
                                 
                                    
                                       w
                                       ^
                                    
                                    =
                                    max
                                    
                                       {
                                       
                                          w
                                          
                                             
                                                2
                                                r
                                             
                                             +
                                             1
                                          
                                       
                                       :
                                       r
                                       =
                                       1
                                       ,
                                       ⋯
                                       ,
                                       
                                          ⌊
                                          
                                             log
                                             2
                                          
                                          n
                                          ⌋
                                       
                                       }
                                    
                                 
                              
                              .
                           

There are three cases to consider: 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                    ,
                                 
                              
                              
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    3
                                 
                               and q
                              1 ≥ 4.

When 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    2
                                    ,
                                 
                               by Lemma 5, it is sufficient to consider only schedules 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       2
                                       ,
                                       a
                                       )
                                    
                                 
                               for a ≥ 2 with 
                                 
                                    T
                                    =
                                    4
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             2
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          3
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       a
                                       ,
                                       1
                                       )
                                    
                                 
                               for a ≥ 3 with 
                                 
                                    T
                                    =
                                    2
                                    a
                                    
                                       w
                                       2
                                    
                                 
                              . By Appendix B for T/4, T is mimimized to

                                 
                                    
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               4
                                                               
                                                                  w
                                                                  2
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               if
                                                               
                                                               there
                                                               
                                                               exists
                                                               
                                                               an
                                                               
                                                               integer
                                                               
                                                               a
                                                               
                                                               such
                                                               
                                                               that
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                               
                                                                  a
                                                                  ∣
                                                                  
                                                                     w
                                                                     2
                                                                  
                                                               
                                                               
                                                               and
                                                               
                                                               
                                                                  3
                                                                  ≤
                                                                  a
                                                                  <
                                                                  
                                                                     w
                                                                     2
                                                                  
                                                                  /
                                                                  
                                                                     w
                                                                     3
                                                                  
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               8
                                                               max
                                                               
                                                                  {
                                                                  
                                                                     ⌈
                                                                     
                                                                        w
                                                                        2
                                                                     
                                                                     /
                                                                     2
                                                                     ⌉
                                                                  
                                                                  ,
                                                                  
                                                                     w
                                                                     3
                                                                  
                                                                  }
                                                               
                                                            
                                                         
                                                         
                                                            otherwise,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              by 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       2
                                       ,
                                       a
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       2
                                       ,
                                       2
                                       )
                                    
                                    ,
                                 
                               respectively. Moreover, 
                                 
                                    
                                       S
                                       2
                                    
                                    
                                       (
                                       a
                                       ,
                                       1
                                       )
                                    
                                 
                               for a ≥ 3 achieves the smallest T value by setting 
                                 
                                    a
                                    =
                                    3
                                 
                               to give 
                                 
                                    T
                                    =
                                    6
                                    
                                       w
                                       2
                                    
                                 
                              .

When 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    3
                                    ,
                                 
                               by Lemma 6, it is sufficient to consider schedules of the form 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                               for a ≥ 2 with 
                                 
                                    T
                                    =
                                    3
                                    a
                                    max
                                    
                                       {
                                       
                                          ⌈
                                          
                                             w
                                             1
                                          
                                          /
                                          a
                                          ⌉
                                       
                                       ,
                                       
                                          w
                                          ^
                                       
                                       }
                                    
                                    .
                                 
                               Note that 
                                 
                                    
                                       w
                                       1
                                    
                                    ≥
                                    2
                                    
                                       w
                                       ^
                                    
                                 
                               since 
                                 
                                    
                                       w
                                       1
                                    
                                    ≥
                                    
                                       w
                                       
                                          2
                                          
                                             r
                                             −
                                             1
                                          
                                       
                                    
                                    =
                                    
                                       w
                                       
                                          
                                             2
                                             r
                                          
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       w
                                       
                                          2
                                          r
                                       
                                    
                                    +
                                    
                                       y
                                       
                                          2
                                          
                                             r
                                             −
                                             1
                                          
                                       
                                    
                                    >
                                    
                                       w
                                       
                                          
                                             2
                                             r
                                          
                                          +
                                          1
                                       
                                    
                                    +
                                    
                                       w
                                       
                                          2
                                          r
                                       
                                    
                                    ≥
                                    2
                                    
                                       w
                                       
                                          
                                             2
                                             r
                                          
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                               because 
                                 
                                    
                                       w
                                       
                                          2
                                          r
                                       
                                    
                                    ≥
                                    
                                       w
                                       
                                          
                                             2
                                             r
                                          
                                          +
                                          1
                                       
                                    
                                 
                               for 
                                 
                                    r
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    
                                       ⌊
                                       
                                          log
                                          2
                                       
                                       n
                                       ⌋
                                    
                                 
                              . Thus, Appendix B may be applied to T/3 to give the smallest value of

                                 
                                    
                                       
                                          
                                             
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               3
                                                               
                                                                  w
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                               
                                                               if
                                                               
                                                               there
                                                               
                                                               exists
                                                               
                                                               an
                                                               
                                                               integer
                                                               
                                                               a
                                                               
                                                               such
                                                               
                                                               that
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                                  ∣
                                                                  
                                                                     w
                                                                     1
                                                                  
                                                               
                                                               
                                                               and
                                                               
                                                               
                                                                  3
                                                                  ≤
                                                                  a
                                                                  <
                                                                  
                                                                     w
                                                                     1
                                                                  
                                                                  /
                                                                  
                                                                     w
                                                                     ^
                                                                  
                                                               
                                                               ,
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               6
                                                               
                                                                  ⌈
                                                                  
                                                                     w
                                                                     1
                                                                  
                                                                  /
                                                                  2
                                                                  ⌉
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                               
                                                               otherwise,
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              from 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       a
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                               respectively.

Now consider a feasible solution with q
                              1 ≥ 4, from Condition (5), 
                                 
                                    T
                                    ≥
                                    
                                       q
                                       1
                                    
                                    
                                       w
                                       1
                                    
                                    ≥
                                    4
                                    
                                       w
                                       1
                                    
                                    ≥
                                    3
                                    
                                       (
                                       
                                          w
                                          1
                                       
                                       +
                                       1
                                       )
                                    
                                    ≥
                                    6
                                    
                                       ⌈
                                       
                                          w
                                          1
                                       
                                       /
                                       2
                                       ⌉
                                    
                                 
                               since w
                              1 ≥ 3. Thus, any solution with q
                              1 ≥ 4 is dominated by the solution 
                                 
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              .□

For completeness, observe that in the context of a larger tree, it might be necessary to consider solutions with q
                        1 ≥ 4.

                           Lemma 7
                           
                              For a network containing a half binary subtree with
                              
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    a
                                    ≥
                                    4
                                    ,
                                 
                               
                              there exists an optimal PPS,
                              
                                 
                                    
                                       S
                                       a
                                    
                                    ,
                                 
                               
                              having the following form 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                   j
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   a
                                                   
                                                   
                                                   for
                                                   
                                                   j
                                                   =
                                                   1
                                                   ,
                                                   ⋯
                                                   ,
                                                   n
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   1
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   
                                                      j
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   R
                                                   (
                                                   
                                                      τ
                                                      j
                                                   
                                                   +
                                                   1
                                                   ,
                                                   a
                                                   )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   τ
                                                   
                                                      j
                                                      2
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   R
                                                   (
                                                   
                                                      τ
                                                      j
                                                   
                                                   +
                                                   2
                                                   ,
                                                   a
                                                   )
                                                   
                                                   
                                                   
                                                   for
                                                   
                                                   all
                                                   
                                                   j
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              with periodicity T constrained by the two conditions 
                              
                                 
                                    
                                       
                                          T
                                          ≥
                                          
                                             w
                                             1
                                          
                                          a
                                          
                                          and
                                          
                                          a
                                          ∣
                                          T
                                          .
                                       
                                    
                                 
                              
                           

We first show that the solutions 
                                 
                                    S
                                    a
                                 
                               for a ≥ 4 is feasible. Observe that τj
                              , 
                                 
                                    τ
                                    
                                       j
                                       1
                                    
                                 
                               and 
                                 
                                    τ
                                    
                                       j
                                       2
                                    
                                 
                               satisfy Condition (1) by Lemma 1 for all j. Condition (2) is satisfied since

                                 
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                ∈
                                                
                                                   L
                                                   j
                                                
                                             
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          ≤
                                          
                                             1
                                             
                                                q
                                                j
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   1
                                                
                                             
                                          
                                          +
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   2
                                                
                                             
                                          
                                          ≤
                                          
                                             1
                                             4
                                          
                                          +
                                          
                                             1
                                             4
                                          
                                          +
                                          
                                             1
                                             4
                                          
                                          
                                          <
                                          
                                          1
                                          
                                          for
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          j
                                          .
                                       
                                    
                                 
                              Condition (3) is trivially satisfied since G has only one element. Observe that a∣T and T ≥ w
                              1
                              a are precisely Conditions (4) and (5). Moreover, Condition (6) is satisfied since

                                 
                                    
                                       
                                          T
                                          
                                             (
                                             1
                                             −
                                             
                                                ∑
                                                
                                                   
                                                      j
                                                      ′
                                                   
                                                   ∈
                                                   
                                                      L
                                                      j
                                                   
                                                
                                             
                                             
                                                1
                                                
                                                   q
                                                   
                                                      j
                                                      ′
                                                   
                                                
                                             
                                             )
                                          
                                          ≥
                                          4
                                          
                                             w
                                             1
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                1
                                                4
                                             
                                             −
                                             
                                                1
                                                4
                                             
                                             −
                                             
                                                1
                                                4
                                             
                                             )
                                          
                                          =
                                          
                                             w
                                             1
                                          
                                          ≥
                                          
                                             y
                                             j
                                          
                                          
                                          for
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          j
                                          .
                                       
                                    
                                 
                              
                           

Take a feasible PPS with 
                                 
                                    
                                       q
                                       1
                                    
                                    =
                                    a
                                 
                               and a ≥ 4. Then, by Conditions (4) and (5), a∣T and T ≥ w
                              1
                              a. Observe that both these conditions are precisely the constraints on the value of T in 
                                 
                                    S
                                    a
                                 
                              .□

We now extend the results for the half binary tree to the whole binary tree. Fig. 7 depicts the structure of the whole binary tree which can be decomposed into two half binary trees. We index the two half binary trees independently using canonical indexing, and assume without loss of generality that w
                     
                        A1 ≥ w
                     
                        B1. We assume throughout that the input data flow rates is not too large at any single node. More precisely, 
                        
                           
                              y
                              
                                 k
                                 j
                              
                           
                           ≤
                           
                              w
                              
                                 k
                                 
                                    j
                                    2
                                 
                              
                           
                        
                      for 
                        
                           k
                           =
                           A
                           ,
                           B
                        
                      and all non-peripheral nodes j (j
                     2 being undefined for peripheral nodes). Let nA
                      and nB
                      denote the numbers of star-nodes in the left-hand side half binary tree and the right-hand side half binary tree, respectively, where 
                        
                           n
                           =
                           
                              n
                              A
                           
                           +
                           
                              n
                              B
                           
                        
                     . We define a composite function ○ for combining two feasible schedules, one for each of the two for two half binary trees, into a single schedule for the whole binary tree. The composite periodicity vector 
                        
                           
                              q
                              ̲
                           
                           =
                           
                              
                                 q
                                 ̲
                              
                              A
                           
                           ∘
                           
                              
                                 q
                                 ̲
                              
                              B
                           
                        
                      leaves the periodicities unchanged, while 
                        
                           
                              τ
                              ̲
                           
                           =
                           
                              
                                 τ
                                 ̲
                              
                              A
                           
                           ∘
                           
                              
                                 τ
                                 ̲
                              
                              B
                           
                        
                      retain the relative start time within each subschedule but shift the timing for one tree by one time-unit to avoid overlap at the gateway. Thus, τAj
                      ← τAj
                      for 
                        
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           
                              n
                              A
                           
                        
                      and 
                        
                           
                              τ
                              
                                 B
                                 j
                              
                           
                           ←
                           R
                           
                              (
                              
                                 τ
                                 
                                    B
                                    j
                                 
                              
                              +
                              1
                              ,
                              
                                 q
                                 
                                    B
                                    j
                                 
                              
                              )
                           
                        
                      for 
                        
                           j
                           =
                           1
                           ,
                           ⋯
                           ,
                           
                              n
                              B
                           
                        
                     . Observe that feasibility of the composite tree 
                        
                           
                              S
                              A
                           
                           ∘
                           
                              S
                              B
                           
                        
                      is inherited from feasibility of 
                        
                           S
                           A
                        
                      and 
                        
                           S
                           B
                        
                      independently and Conditions (1) and (3) at the gateway. Condition (1) holds by Corollary 1 because 
                        
                           ∣
                           
                              τ
                              
                                 A
                                 1
                              
                           
                           −
                           
                              τ
                              
                                 B
                                 1
                              
                           
                           ∣
                           =
                           1
                        
                      and gcd(q
                     
                        A1, q
                     
                        B1) ≥ 2. Condition (3) holds because q
                     
                        A1 ≥ 2, q
                     
                        B1 ≥ 2 and 
                        
                           
                              y
                              G
                           
                           =
                           0
                        
                     . Moreover, there are no additional constraints on T other than those imposed by subtrees 
                        
                           S
                           A
                        
                      and 
                        
                           
                              S
                              B
                           
                           ,
                        
                      since (4)–(6) are edge conditions and the single condition associated with the new gateway node, Condition (6), is automatically satisfied since it is assumed to have no direct input, 
                        
                           
                              y
                              G
                           
                           =
                           0
                        
                     .

We find an optimal solution for the whole binary tree by coordinating limited number of feasible solutions for the half binary tree.

                        Lemma 8
                        
                           For any instance of a whole binary tree network, there exists no optimal solution with q
                           
                              A1 ≥ 4.
                        

Suppose that there exists an optimal schedule 
                              S
                            with q
                           
                              A1 ≥ 4. From Condition (5), the solution has 
                              
                                 T
                                 
                                    (
                                    S
                                    )
                                 
                                 ≥
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 ≥
                                 3
                                 
                                    (
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                 
                              
                            because w
                           
                              A1 ≥ 3. Note that 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                            has 6∣T and 
                              
                                 T
                                 ≥
                                 max
                                 
                                    {
                                    3
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    ,
                                    3
                                    
                                       w
                                       
                                          B
                                          1
                                       
                                    
                                    ,
                                    6
                                    
                                       w
                                       
                                          A
                                          3
                                       
                                    
                                    ,
                                    6
                                    
                                       w
                                       
                                          B
                                          3
                                       
                                    
                                    }
                                 
                                 =
                                 3
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                              
                            because w
                           
                              B1 ≤ w
                           
                              A1, 
                              
                                 2
                                 
                                    w
                                    
                                       A
                                       3
                                    
                                 
                                 <
                                 
                                    w
                                    
                                       A
                                       2
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       A
                                       3
                                    
                                 
                                 +
                                 
                                    y
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 ,
                              
                            and 
                              
                                 2
                                 
                                    w
                                    
                                       B
                                       3
                                    
                                 
                                 <
                                 
                                    w
                                    
                                       B
                                       2
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       B
                                       3
                                    
                                 
                                 +
                                 
                                    y
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 
                                    w
                                    
                                       B
                                       1
                                    
                                 
                              
                           . Thus, 
                              
                                 T
                                 
                                    (
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                    ∘
                                    
                                       S
                                       3
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                    )
                                 
                                 =
                                 6
                                 
                                    ⌈
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    /
                                    2
                                    ⌉
                                 
                                 ≤
                                 3
                                 
                                    (
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                 
                              
                           . Therefore, 
                              S
                            is dominated by 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 ,
                              
                            providing the required contradiction.□


                           For any instance of the whole binary tree network, there exists an optimal solution with q
                           
                              A1 ≤ 3 and q
                           
                              B1 ≤ 4.
                        

Take an optimal schedule 
                              
                                 S
                                 =
                                 
                                    S
                                    A
                                 
                                 ∘
                                 
                                    S
                                    B
                                 
                              
                           . Without loss of generality, we assume that 
                              
                                 
                                    τ
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 0
                              
                           . From Lemma 8
                           
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                                 
                                 or
                                 
                                 3
                              
                           . Now suppose that the Lemma does not hold, and thus q
                           
                              B1 ≥ 5, and hence q
                           
                              B1 ≥ 6 by Corollary 1 applied to the gateway node. Let 
                              
                                 a
                                 =
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                              
                            and 
                              
                                 b
                                 =
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                              
                           . Construct new solution 
                              
                                 
                                    S
                                    ′
                                 
                                 =
                                 
                                    S
                                    A
                                 
                                 ∘
                                 
                                    S
                                    B
                                    ′
                                 
                              
                            by setting

                              
                                 
                                    
                                       
                                          
                                             
                                                q
                                                
                                                   A
                                                   j
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   q
                                                   
                                                      A
                                                      j
                                                   
                                                
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   A
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                                
                                                   B
                                                   1
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                a
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                q
                                                
                                                   B
                                                   j
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                b
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                2
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   B
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   A
                                                   j
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   τ
                                                   
                                                      A
                                                      j
                                                   
                                                
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   A
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   B
                                                   1
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   B
                                                   2
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   B
                                                   3
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                2
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   B
                                                   
                                                      j
                                                      1
                                                   
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                R
                                                
                                                   (
                                                   
                                                      τ
                                                      
                                                         B
                                                         j
                                                      
                                                      ′
                                                   
                                                   +
                                                   1
                                                   ,
                                                   b
                                                   )
                                                
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                2
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   B
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                τ
                                                
                                                   B
                                                   
                                                      j
                                                      2
                                                   
                                                
                                                ′
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                R
                                                
                                                   (
                                                   
                                                      τ
                                                      
                                                         B
                                                         j
                                                      
                                                      ′
                                                   
                                                   +
                                                   2
                                                   ,
                                                   b
                                                   )
                                                
                                                
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                2
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   B
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Observe that 
                              
                                 
                                    τ
                                    
                                       B
                                       j
                                    
                                    ′
                                 
                                 ,
                              
                           
                           
                              
                                 τ
                                 
                                    B
                                    
                                       j
                                       1
                                    
                                 
                                 ′
                              
                            and 
                              
                                 τ
                                 
                                    B
                                    
                                       j
                                       2
                                    
                                 
                                 ′
                              
                            satisfy Condition (1) by Lemma 1 for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 
                                    n
                                    B
                                 
                              
                           . Condition (2) is satisfied because

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         j
                                                         ′
                                                      
                                                      ∈
                                                      
                                                         L
                                                         
                                                            B
                                                            j
                                                         
                                                      
                                                   
                                                
                                                
                                                   1
                                                   
                                                      q
                                                      
                                                         j
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      q
                                                      
                                                         B
                                                         j
                                                      
                                                   
                                                
                                                +
                                                
                                                   1
                                                   
                                                      q
                                                      
                                                         B
                                                         
                                                            j
                                                            1
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   1
                                                   
                                                      q
                                                      
                                                         B
                                                         
                                                            j
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   1
                                                   a
                                                
                                                +
                                                
                                                   1
                                                   b
                                                
                                                +
                                                
                                                   1
                                                   b
                                                
                                                ≤
                                                
                                                   1
                                                   2
                                                
                                                +
                                                
                                                   1
                                                   6
                                                
                                                +
                                                
                                                   1
                                                   6
                                                
                                                =
                                                
                                                   5
                                                   6
                                                
                                                <
                                                1
                                                
                                                
                                                for
                                                
                                                j
                                                =
                                                1
                                                ,
                                                ⋯
                                                ,
                                                
                                                   n
                                                   B
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Condition (3) holds because 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                    ′
                                 
                                 ≥
                                 2
                                 ,
                              
                           
                           
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                    ′
                                 
                                 ≥
                                 2
                              
                            and 
                              
                                 
                                    y
                                    G
                                 
                                 =
                                 0
                              
                           . Thus, 
                              
                                 S
                                 ′
                              
                            is feasible. It remains to show that schedule 
                              
                                 S
                                 ′
                              
                            is accommodated in 
                              
                                 T
                                 (
                                 S
                                 )
                                 ,
                              
                            or equivalently that Conditions (4)–(6) are satisfied for the given value of 
                              
                                 T
                                 (
                                 S
                                 )
                              
                           . Condition (4) is satisfied because 
                              
                                 T
                                 (
                                 S
                                 )
                              
                            is divisible by both 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 a
                              
                            and 
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 b
                              
                           . Condition (5) is satisfied because

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                max
                                                {
                                                
                                                   w
                                                   
                                                      A
                                                      j
                                                   
                                                
                                                
                                                   q
                                                   
                                                      A
                                                      j
                                                   
                                                   ′
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      j
                                                   
                                                
                                                
                                                   q
                                                   
                                                      B
                                                      j
                                                   
                                                   ′
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                max
                                                {
                                                
                                                   w
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                
                                                   q
                                                   
                                                      A
                                                      1
                                                   
                                                   ′
                                                
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         A
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         A
                                                         j
                                                      
                                                      ′
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                
                                                   q
                                                   
                                                      B
                                                      1
                                                   
                                                   ′
                                                
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         B
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         B
                                                         j
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         B
                                                         j
                                                      
                                                      ′
                                                   
                                                   }
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                max
                                                {
                                                
                                                   w
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                a
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         A
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         A
                                                         j
                                                      
                                                      ′
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                a
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         B
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   b
                                                   
                                                      w
                                                      
                                                         B
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                max
                                                {
                                                
                                                   w
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                a
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         A
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                b
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                max
                                                {
                                                
                                                   w
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                
                                                   q
                                                   
                                                      A
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   max
                                                   
                                                      j
                                                      ∈
                                                      {
                                                      2
                                                      ,
                                                      ⋯
                                                      ,
                                                      
                                                         n
                                                         A
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   
                                                      q
                                                      
                                                         A
                                                         j
                                                      
                                                   
                                                   }
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                
                                                   q
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                T
                                                (
                                                S
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that 
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                    ′
                                 
                                 ≥
                                 2
                              
                            and 
                              
                                 
                                    q
                                    
                                       B
                                       j
                                    
                                    ′
                                 
                                 ≥
                                 6
                              
                            for 
                              
                                 j
                                 =
                                 2
                                 ,
                                 ⋯
                                 ,
                                 
                                    n
                                    B
                                 
                              
                           . Moreover, since 
                              
                                 T
                                 
                                    (
                                    S
                                    )
                                 
                                 ≥
                                 
                                    q
                                    
                                       B
                                       j
                                    
                                    ′
                                 
                                 
                                    w
                                    
                                       B
                                       j
                                    
                                 
                                 =
                                 b
                                 
                                    w
                                    
                                       B
                                       j
                                    
                                 
                                 ≥
                                 b
                                 
                                    w
                                    
                                       B
                                       
                                          j
                                          2
                                       
                                    
                                 
                                 ≥
                                 6
                                 
                                    y
                                    
                                       B
                                       j
                                    
                                 
                              
                            for 
                              
                                 j
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    n
                                    B
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       T
                                       
                                          (
                                          S
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             ∑
                                             
                                                
                                                   j
                                                   ′
                                                
                                                ∈
                                                
                                                   L
                                                   
                                                      B
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             1
                                             
                                                q
                                                
                                                   j
                                                   ′
                                                
                                             
                                          
                                          )
                                       
                                       ≥
                                       6
                                       
                                          y
                                          
                                             B
                                             j
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             5
                                             6
                                          
                                          )
                                       
                                       ≥
                                       
                                          y
                                          
                                             B
                                             j
                                          
                                       
                                       ,
                                    
                                 
                              
                           and thus, Condition (6) is satisfied.□

From Lemmas 8 and 9, it is sufficient to consider only solutions with 
                        
                           
                              q
                              
                                 A
                                 1
                              
                           
                           =
                           2
                           ,
                           3
                        
                      and 
                        
                           
                              q
                              
                                 B
                                 1
                              
                           
                           =
                           2
                           ,
                           3
                           ,
                           4
                        
                     . Moreover, since q
                     
                        A1 and q
                     
                        B1 cannot be co-prime from Corollary 1, when 
                        
                           
                              q
                              
                                 A
                                 1
                              
                           
                           =
                           2
                        
                      the value of q
                     
                        B1 is 2 or 4, and when 
                        
                           
                              q
                              
                                 A
                                 1
                              
                           
                           =
                           3
                        
                      
                     q
                     
                        B1 is 3. We now consider each of these three cases in turn.

                        Lemma 10
                        
                           Any feasible PPS for a whole binary tree with
                           
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 3
                              
                            
                           is dominated by a solution
                           
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    a
                                    )
                                 
                              
                            
                           with
                           
                              
                                 T
                                 =
                                 3
                                 a
                                 max
                                 
                                    {
                                    
                                       ⌈
                                       
                                          w
                                          
                                             A
                                             1
                                          
                                       
                                       /
                                       a
                                       ⌉
                                    
                                    ,
                                    
                                       w
                                       ^
                                    
                                    }
                                 
                              
                            
                           for some integer a ≥ 2, where
                           
                              
                                 
                                    w
                                    ^
                                 
                                 =
                                 max
                                 
                                    {
                                    
                                       w
                                       
                                          k
                                          (
                                          
                                             2
                                             r
                                          
                                          +
                                          1
                                          )
                                       
                                    
                                    :
                                    r
                                    =
                                    1
                                    ,
                                    ⋯
                                    ,
                                    
                                       ⌊
                                       
                                          log
                                          2
                                       
                                       
                                          n
                                          k
                                       
                                       ⌋
                                    
                                    
                                    and
                                    
                                    k
                                    =
                                    A
                                    ,
                                    B
                                    }
                                 
                              
                           
                           .
                        

Take a feasible schedule 
                              
                                 
                                    S
                                    A
                                 
                                 ∘
                                 
                                    S
                                    B
                                 
                              
                            with 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 3
                              
                           . As observed above, 
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 3
                              
                            from Corollary 1. Thus, by Lemma 6, 
                              
                                 S
                                 A
                              
                            and 
                              
                                 S
                                 B
                              
                            are dominated by 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    
                                       a
                                       A
                                    
                                    )
                                 
                              
                            and 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    
                                       a
                                       B
                                    
                                    )
                                 
                                 ,
                              
                            respectively, where 3aA
                           ∣T, 3aB
                           ∣T, 
                              
                                 T
                                 ≥
                                 3
                                 
                                    a
                                    A
                                 
                                 max
                                 
                                    {
                                    
                                       ⌈
                                       
                                          w
                                          
                                             A
                                             1
                                          
                                       
                                       /
                                       
                                          a
                                          A
                                       
                                       ⌉
                                    
                                    ,
                                    
                                       
                                          w
                                          ^
                                       
                                       A
                                    
                                    }
                                 
                              
                            and 
                              
                                 T
                                 ≥
                                 3
                                 
                                    a
                                    B
                                 
                                 max
                                 
                                    {
                                    
                                       ⌈
                                       
                                          w
                                          
                                             B
                                             1
                                          
                                       
                                       /
                                       
                                          a
                                          B
                                       
                                       ⌉
                                    
                                    ,
                                    
                                       
                                          w
                                          ^
                                       
                                       B
                                    
                                    }
                                 
                              
                            where 
                              
                                 
                                    w
                                    ^
                                 
                                 A
                              
                            and 
                              
                                 
                                    w
                                    ^
                                 
                                 B
                              
                            are defined in Lemma 6. The rest of the proof follows by setting 
                              
                                 a
                                 =
                                 
                                    a
                                    A
                                 
                              
                            if 
                              
                                 
                                    
                                       w
                                       ^
                                    
                                    A
                                 
                                 ≥
                                 
                                    
                                       w
                                       ^
                                    
                                    B
                                 
                              
                            and 
                              
                                 a
                                 =
                                 
                                    a
                                    B
                                 
                              
                            if 
                              
                                 
                                    
                                       w
                                       ^
                                    
                                    A
                                 
                                 <
                                 
                                    
                                       w
                                       ^
                                    
                                    B
                                 
                                 ,
                              
                            since w
                           
                              A1 ≥ w
                           
                              B1 and 
                              
                                 
                                    w
                                    ^
                                 
                                 =
                                 max
                                 
                                    {
                                    
                                       
                                          w
                                          ^
                                       
                                       A
                                    
                                    ,
                                    
                                       
                                          w
                                          ^
                                       
                                       B
                                    
                                    }
                                 
                              
                            as defined above.□


                           Any feasible PPS for a whole binary tree with
                           
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 2
                              
                            
                           is dominated by one of the following solutions
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            
                           for some integer a ≥ 2 with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                a
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                              
                            
                           with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                24
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         6
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               3
                                                            
                                                         
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         4
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                              
                            
                           and a ≥ 3 with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                a
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                              
                            
                           with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                24
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         4
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         6
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               3
                                                            
                                                         
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            
                           and a ≥ 3 with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                a
                                                max
                                                {
                                                
                                                   ⌈
                                                   
                                                      
                                                         w
                                                         
                                                            A
                                                            2
                                                         
                                                      
                                                      2
                                                   
                                                   ⌉
                                                
                                                ,
                                                
                                                   ⌈
                                                   
                                                      
                                                         w
                                                         
                                                            B
                                                            2
                                                         
                                                      
                                                      a
                                                   
                                                   ⌉
                                                
                                                ,
                                                
                                                   w
                                                   
                                                      B
                                                      3
                                                   
                                                
                                                }
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                              
                            
                           with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                6
                                                max
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         2
                                                      
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

From the result for a network containing a half binary subtree in Lemma 5, it is sufficient to consider all combinations of 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            for a ≥ 2 or 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                              
                            for a ≥ 3 and 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    b
                                    )
                                 
                              
                            for b ≥ 2 or 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    b
                                    ,
                                    1
                                    )
                                 
                              
                            for b ≥ 3. We consider these cases separately.

Case 1: 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            for a ≥ 2 and 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    b
                                    )
                                 
                              
                            for b ≥ 2.

By Lemma 5, we have that 4a∣T, 4b∣T and T ≥ 4 max {amax {⌈w
                           
                              A2/a⌉, w
                           
                              A3}, bmax {⌈w
                           
                              B2/b⌉, w
                           
                              B3}}. Thus, an optimal T value is of the form

                              
                                 
                                    
                                       T
                                       ≥
                                       4
                                       
                                          a
                                          ′
                                       
                                       max
                                       
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                
                                                   a
                                                   ′
                                                
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                A
                                                3
                                             
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                
                                                   a
                                                   ′
                                                
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                B
                                                3
                                             
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           by setting 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 a
                              
                            if w
                           
                              A2 > w
                           
                              B2 and 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 b
                              
                            if w
                           
                              A2 ≤ w
                           
                              B2.

Case 2: 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            for a ≥ 2 and 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    b
                                    ,
                                    1
                                    )
                                 
                              
                            for b ≥ 3.

We first consider the subcase when 
                              
                                 a
                                 =
                                 2
                              
                            and 
                              
                                 b
                                 =
                                 3
                              
                           . In this subcase, by Lemma 5, we have that 24∣T and T ≥ max {4w
                           
                              A2, 8w
                           
                              A3, 6w
                           
                              B2}. Thus,

                              
                                 
                                    
                                       T
                                       =
                                       24
                                       max
                                       
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                6
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      3
                                                   
                                                
                                                3
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                4
                                             
                                             ⌉
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        

We now consider the subcase when 
                              
                                 a
                                 =
                                 2
                              
                            and b ≥ 4. By Lemma 5, we have that 8∣T, 2b∣T and

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                max
                                                {
                                                4
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                ,
                                                8
                                                
                                                   w
                                                   
                                                      A
                                                      3
                                                   
                                                
                                                ,
                                                2
                                                b
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                max
                                                {
                                                4
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                ,
                                                8
                                                
                                                   w
                                                   
                                                      A
                                                      3
                                                   
                                                
                                                ,
                                                4
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                ,
                                                8
                                                
                                                   w
                                                   
                                                      B
                                                      3
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                8
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                T
                                                (
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                                ∘
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           implying that in this subcase, any solution can be dominated by a solution 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                              
                           .

Finally, we consider the subcase when a ≥ 3 and b ≥ 3. Then, by Lemma 5, we have that 4a∣T, 2b∣T and T ≥ max {4w
                           
                              A2, 4aw
                           
                              A3, 2bw
                           
                              B2}. Thus, an optimal T value is of the form

                              
                                 
                                    
                                       T
                                       =
                                       4
                                       
                                          a
                                          ′
                                       
                                       max
                                       
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                
                                                   a
                                                   ′
                                                
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                A
                                                3
                                             
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                2
                                             
                                             ⌉
                                          
                                          }
                                       
                                       ,
                                    
                                 
                              
                           by setting 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 a
                              
                            if 4w
                           
                              A3 > 2w
                           
                              B3 and 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 b
                              
                            if 4w
                           
                              A3 ≤ 2w
                           
                              B3.

Case 3: 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                              
                            for a ≥ 3 and 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    b
                                    )
                                 
                              
                            for b ≥ 2

This case is similar to Case 2 but with the roles of a and b reversed. If 
                              
                                 a
                                 =
                                 3
                              
                            and 
                              
                                 b
                                 =
                                 2
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                24
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         4
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               3
                                                            
                                                         
                                                         6
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           If a ≥ 3 and b ≥ 3, then

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                
                                                   a
                                                   ′
                                                
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         
                                                            a
                                                            ′
                                                         
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 a
                              
                            if 2w
                           
                              A2 > 4w
                           
                              B3 and 
                              
                                 
                                    a
                                    ′
                                 
                                 =
                                 b
                              
                            if 2w
                           
                              A2 ≤ 4w
                           
                              B3.

Case 4: 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                              
                            for a ≥ 3 and 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    b
                                    ,
                                    1
                                    )
                                 
                              
                            for b ≥ 3.

By Lemma 5, we have that 2a∣T, 2b∣T and

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   2
                                                   a
                                                   
                                                      w
                                                      
                                                         A
                                                         2
                                                      
                                                   
                                                   ,
                                                   2
                                                   b
                                                   
                                                      w
                                                      
                                                         B
                                                         2
                                                      
                                                   
                                                   }
                                                
                                                ≥
                                                6
                                                max
                                                
                                                   {
                                                   
                                                      w
                                                      
                                                         A
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         2
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                T
                                                (
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   3
                                                   ,
                                                   1
                                                   )
                                                
                                                ∘
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   3
                                                   ,
                                                   1
                                                   )
                                                
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Thus, the solution is dominated by a solution 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                              
                           .□


                           Any feasible PPS for a whole binary tree with
                           
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                              
                            
                           and
                           
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 4
                                 ,
                              
                            
                           which is not dominated by a solution with
                           
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 2
                                 ,
                              
                            
                           is dominated by one of the following solutions
                        


                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            
                           for some integer a ≥ 3 with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                a
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            
                           with 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                12
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Note that any feasible PPS 
                              
                                 
                                    S
                                    A
                                 
                                 ∘
                                 
                                    S
                                    B
                                 
                              
                            with 
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 4
                              
                            is dominated by a solution with 
                              
                                 
                                    S
                                    B
                                 
                                 =
                                 
                                    S
                                    4
                                 
                              
                            by Lemma 7. Since 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                                 ,
                              
                            by Lemma 5 there are two cases to consider: 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            for a ≥ 2, and 
                              
                                 
                                    S
                                    A
                                 
                                 =
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                              
                            for a ≥ 3.

Case 1: 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            for a ≥ 2

By Lemmas 5 and 7, we have that 4a∣T and T ≥ max {4w
                           
                              A2, 4aw
                           
                              A3, 4w
                           
                              B1}. If 
                              
                                 a
                                 =
                                 2
                                 ,
                              
                            then

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                max
                                                {
                                                4
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                ,
                                                8
                                                
                                                   w
                                                   
                                                      A
                                                      3
                                                   
                                                
                                                ,
                                                4
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                }
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                8
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≥
                                          
                                          
                                             
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                T
                                                (
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                                ∘
                                                
                                                   S
                                                   2
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   2
                                                   )
                                                
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           implying that the solution is dominated by 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                              
                           . If a ≥ 3, then

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                4
                                                a
                                                max
                                                
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         a
                                                      
                                                      ⌉
                                                   
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Case 2: 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            for a ≥ 3

By Lemmas 5 and 7, conditions on T are 4∣T, 2a∣T and T ≥ max {2aw
                           
                              A2, 4w
                           
                              B1}. Thus, when 
                              
                                 a
                                 =
                                 3
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       T
                                       =
                                       12
                                       max
                                       
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                2
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                3
                                             
                                             ⌉
                                          
                                          }
                                       
                                       .
                                    
                                 
                              
                           Now take a ≥ 4 and compare 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            and its time frame T with the alternative schedule 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                                 .
                              
                            The alternative schedule is feasible with 
                              
                                 
                                    q
                                    
                                       A
                                       2
                                    
                                    ′
                                 
                                 =
                                 4
                                 <
                                 2
                                 a
                                 =
                                 
                                    q
                                    
                                       A
                                       2
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    q
                                    
                                       A
                                       j
                                    
                                    ′
                                 
                                 =
                                 
                                    q
                                    
                                       A
                                       j
                                    
                                 
                                 =
                                 2
                                 a
                              
                            or 4, for all other values of j, and thus 4∣T′, 2a∣T′ and 
                              
                                 
                                    q
                                    
                                       A
                                       j
                                    
                                    ′
                                 
                                 ≤
                                 
                                    q
                                    
                                       A
                                       j
                                    
                                 
                              
                            for all values of j. Hence, T′ ≤ T and 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            is dominated by 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                                 .
                              
                           
                           □

In the previous section we classified the forms which we need to consider for an optimal PPS for a binary tree in Lemmas 10 to 12. Several of these forms are parameterised by the variable a and it is therefore useful to reduce the range of potential values of a, which we now do in the following Lemma. Algorithm OptPPS and Theorem 4 then draws these results together. The efficiency of the optimisation algorithm OptPPS is considered at the end of the section, along with its effectiveness relative to the standard round robin, Common Cycle, schedule.

                        Lemma 13
                        
                           For a binary tree network, PPS of the following forms
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ,
                              
                            
                           and
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                                 ,
                              
                            
                           and
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ,
                              
                            
                           may be optimal only for values of a less than 8, 8, 8, and 5, respectively.
                        

Observe that we may restrict attention to the case 
                              
                                 T
                                 <
                                 3
                                 (
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 +
                                 1
                                 )
                              
                            since 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                            has 
                              
                                 T
                                 =
                                 6
                                 
                                    ⌈
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    /
                                    2
                                    ⌉
                                 
                                 ≤
                                 3
                                 
                                    (
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                 
                              
                           . In addition, it is sufficient to consider a solution with 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                              
                            only if w
                           
                              A2 < 9w
                           
                              A3. To see this take an instance with w
                           
                              A2 ≥ 9w
                           
                              A3 and a PPS solution with 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                              
                           . Then, q
                           
                              A2 ≥ 4 by Lemma 4, and hence, by Condition (5) and the assumption that y
                           
                              A1 ≤ w
                           
                              A3,

                              
                                 
                                    
                                       T
                                       ≥
                                       4
                                       
                                          w
                                          
                                             A
                                             2
                                          
                                       
                                       ≥
                                       3
                                       
                                          w
                                          
                                             A
                                             2
                                          
                                       
                                       +
                                       9
                                       
                                          w
                                          
                                             A
                                             3
                                          
                                       
                                       ≥
                                       3
                                       
                                          w
                                          
                                             A
                                             2
                                          
                                       
                                       +
                                       3
                                       
                                          (
                                          
                                             w
                                             
                                                A
                                                3
                                             
                                          
                                          +
                                          
                                             y
                                             
                                                A
                                                1
                                             
                                          
                                          +
                                          1
                                          )
                                       
                                       ≥
                                       3
                                       
                                          (
                                          
                                             w
                                             
                                                A
                                                1
                                             
                                          
                                          +
                                          1
                                          )
                                       
                                       ,
                                    
                                 
                              
                           providing the required contradiction.

Consider a solution with one of the following forms, 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            and 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                           . In order for one of these solutions to be optimal, it must hold that 
                              
                                 4
                                 a
                                 
                                    w
                                    
                                       A
                                       3
                                    
                                 
                                 ≤
                                 T
                                 <
                                 3
                                 
                                    (
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                 
                                 ,
                              
                            since 
                              
                                 
                                    q
                                    
                                       A
                                       3
                                    
                                 
                                 =
                                 4
                                 a
                                 .
                              
                            Thus,

                              
                                 
                                    
                                       a
                                       <
                                       
                                          
                                             3
                                             (
                                             
                                                w
                                                
                                                   A
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             4
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             3
                                             (
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   A
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             4
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                          
                                       
                                       ≤
                                       
                                          
                                             3
                                             (
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             +
                                             3
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                             )
                                          
                                          
                                             4
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                          
                                       
                                       <
                                       9
                                       ,
                                    
                                 
                              
                           since we are restricting attention to instances for which w
                           
                              A2 < 9w
                           
                              A3. Now consider a solution in the form of 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    a
                                    ,
                                    1
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                           . It has 
                              
                                 
                                    q
                                    
                                       A
                                       2
                                    
                                 
                                 =
                                 2
                                 a
                              
                            and therefore 
                              
                                 2
                                 a
                                 
                                    w
                                    
                                       A
                                       2
                                    
                                 
                                 <
                                 T
                                 ≤
                                 3
                                 
                                    (
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    +
                                    1
                                    )
                                 
                              
                           . Hence,

                              
                                 
                                    
                                       a
                                       <
                                       
                                          
                                             3
                                             (
                                             
                                                w
                                                
                                                   A
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             2
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             3
                                             (
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             +
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                             +
                                             
                                                y
                                                
                                                   A
                                                   1
                                                
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             2
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                          
                                       
                                       ≤
                                       
                                          
                                             3
                                             (
                                             4
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             2
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                          
                                       
                                       ≤
                                       6
                                       ,
                                    
                                 
                              
                           in an optimal solution.□


                     Algorithm OptPPS
                  

Find the minimum T value amongst the following forms, and output in addition a corresponding schedule:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             3
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                          ∘
                                          
                                             S
                                             3
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          6
                                          
                                             ⌈
                                             
                                                w
                                                
                                                   A
                                                   1
                                                
                                             
                                             /
                                             2
                                             ⌉
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             3
                                          
                                          
                                             (
                                             a
                                             )
                                          
                                          ∘
                                          
                                             S
                                             3
                                          
                                          
                                             (
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          3
                                          
                                             w
                                             
                                                A
                                                1
                                             
                                          
                                          
                                          for
                                          
                                          3
                                          ≤
                                          a
                                          ,
                                          a
                                          ∣
                                          
                                             w
                                             
                                                A
                                                1
                                             
                                          
                                          ,
                                          
                                          and
                                          
                                          a
                                          <
                                          
                                             w
                                             
                                                A
                                                1
                                             
                                          
                                          /
                                          
                                             w
                                             ^
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              w
                              ^
                           
                           =
                           max
                           
                              {
                              
                                 w
                                 
                                    k
                                    (
                                    
                                       2
                                       r
                                    
                                    +
                                    1
                                    )
                                 
                              
                              :
                              r
                              =
                              1
                              ,
                              ⋯
                              ,
                              
                                 ⌊
                                 
                                    log
                                    2
                                 
                                 
                                    n
                                    k
                                 
                                 ⌋
                              
                              
                              and
                              
                              k
                              =
                              A
                              ,
                              B
                              }
                           
                        
                     ;

                        
                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          8
                                          max
                                          {
                                          
                                             ⌈
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             /
                                             2
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                A
                                                3
                                             
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                w
                                                
                                                   B
                                                   2
                                                
                                             
                                             /
                                             2
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                B
                                                3
                                             
                                          
                                          }
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             3
                                             ,
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          
                                          =
                                          
                                          24
                                          max
                                          
                                             {
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                6
                                                ⌉
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      A
                                                      3
                                                   
                                                
                                                /
                                                3
                                                ⌉
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                /
                                                4
                                                ⌉
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             a
                                             ,
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          4
                                          a
                                          max
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                a
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                A
                                                3
                                             
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                /
                                                2
                                             
                                             ⌉
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                          
                                          for
                                          
                                          3
                                          ≤
                                          a
                                          ≤
                                          8
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             3
                                             ,
                                             1
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          
                                          =
                                          
                                          24
                                          max
                                          
                                             {
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                4
                                                ⌉
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                /
                                                6
                                                ⌉
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      B
                                                      3
                                                   
                                                
                                                /
                                                3
                                                ⌉
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             a
                                             ,
                                             1
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          4
                                          a
                                          max
                                          {
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                2
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             ⌈
                                             
                                                
                                                   w
                                                   
                                                      B
                                                      2
                                                   
                                                
                                                /
                                                a
                                             
                                             ⌉
                                          
                                          ,
                                          
                                             w
                                             
                                                B
                                                3
                                             
                                          
                                          }
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                          
                                          for
                                          
                                          3
                                          ≤
                                          a
                                          ≤
                                          5
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             3
                                             ,
                                             1
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             3
                                             ,
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          6
                                          max
                                          
                                             {
                                             
                                                w
                                                
                                                   A
                                                   2
                                                
                                             
                                             ,
                                             
                                                w
                                                
                                                   B
                                                   2
                                                
                                             
                                             }
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                          ∘
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                       
                                    
                                    
                                       with
                                    
                                    
                                       
                                          T
                                          =
                                          4
                                          max
                                          {
                                          
                                             w
                                             
                                                A
                                                2
                                             
                                          
                                          ,
                                          
                                             w
                                             
                                                B
                                                2
                                             
                                          
                                          }
                                          
                                          for
                                          
                                          3
                                          ≤
                                          a
                                          ≤
                                          8
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     a∣max {w
                     
                        A2, w
                     
                        B2},  and a < max {w
                     
                        A2, w
                     
                        B2}/max {w
                     
                        A3, w
                     
                        B3};

                        
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             2
                                             ,
                                             a
                                             )
                                          
                                          ∘
                                          
                                             S
                                             4
                                          
                                          with
                                          T
                                          =
                                          4
                                          a
                                          max
                                          
                                             {
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                a
                                                ⌉
                                             
                                             ,
                                             
                                                w
                                                
                                                   A
                                                   3
                                                
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                /
                                                a
                                                ⌉
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          for
                                          
                                          3
                                          ≤
                                          a
                                          ≤
                                          8
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             S
                                             2
                                          
                                          
                                             (
                                             3
                                             ,
                                             1
                                             )
                                          
                                          ∘
                                          
                                             S
                                             4
                                          
                                          with
                                          T
                                          =
                                          12
                                          max
                                          
                                             {
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      A
                                                      2
                                                   
                                                
                                                /
                                                2
                                                ⌉
                                             
                                             ,
                                             
                                                ⌈
                                                
                                                   w
                                                   
                                                      B
                                                      1
                                                   
                                                
                                                /
                                                3
                                                ⌉
                                             
                                             }
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        Theorem 4
                        
                           For a whole binary tree, Algorithm OptPPS provides an optimal perfect periodic schedule.
                        

We have established in the previous section that only solutions with 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 3
                              
                            and 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 2
                              
                            with 
                              
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 2
                              
                            or 4, described in Lemmas 10, 11 and 12 need be considered.

When 
                              
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    q
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 3
                              
                            potential optimal solutions are of the form 
                              
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    3
                                 
                                 
                                    (
                                    a
                                    )
                                 
                              
                            with periodicity 
                              
                                 T
                                 =
                                 3
                                 a
                                 max
                                 
                                    {
                                    
                                       ⌈
                                       
                                          w
                                          
                                             A
                                             1
                                          
                                       
                                       /
                                       a
                                       ⌉
                                    
                                    ,
                                    
                                       w
                                       ^
                                    
                                    }
                                 
                              
                            from Lemma 10. Now 
                              
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 ≥
                                 2
                                 
                                    w
                                    ^
                                 
                                 ,
                              
                            since w
                           
                              A1 ≥ w
                           
                              B1 and 
                              
                                 
                                    w
                                    
                                       k
                                       1
                                    
                                 
                                 ≥
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          
                                             r
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                    
                                 
                                 +
                                 
                                    y
                                    
                                       k
                                       
                                          2
                                          
                                             r
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 >
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                    
                                 
                                 ≥
                                 2
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                       +
                                       1
                                    
                                 
                              
                            because 
                              
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                    
                                 
                                 ≥
                                 
                                    w
                                    
                                       k
                                       
                                          2
                                          r
                                       
                                       +
                                       1
                                    
                                 
                              
                            from the indexing convention, for 
                              
                                 r
                                 =
                                 1
                                 ,
                                 ⋯
                                 ,
                                 
                                    ⌊
                                    
                                       log
                                       2
                                    
                                    
                                       n
                                       k
                                    
                                    ⌋
                                 
                              
                            and 
                              
                                 k
                                 =
                                 A
                                 ,
                                 B
                              
                           . Hence, 
                              
                                 
                                    ⌈
                                    
                                       w
                                       
                                          A
                                          1
                                       
                                    
                                    /
                                    2
                                    ⌉
                                 
                                 ≥
                                 
                                    w
                                    ^
                                 
                              
                            and from the result in Appendix B applied to T/3, for a ≥ 2

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            
                                                               w
                                                               
                                                                  A
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            there
                                                            
                                                            exists
                                                            
                                                            an
                                                            
                                                            integer
                                                            
                                                            a
                                                            
                                                            such
                                                            
                                                            that
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                            
                                                               a
                                                               ∣
                                                               
                                                                  w
                                                                  
                                                                     A
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                            and
                                                            
                                                            
                                                               3
                                                               ≤
                                                               a
                                                               <
                                                               
                                                                  w
                                                                  
                                                                     A
                                                                     1
                                                                  
                                                               
                                                               /
                                                               
                                                                  w
                                                                  ^
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            6
                                                            
                                                               ⌈
                                                               
                                                                  w
                                                                  
                                                                     A
                                                                     1
                                                                  
                                                               
                                                               /
                                                               2
                                                               ⌉
                                                            
                                                         
                                                      
                                                      
                                                         otherwise,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           giving rise to the first two forms.

The solution 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    a
                                    )
                                 
                              
                            for a ≥ 2 has

                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            4
                                                            max
                                                            {
                                                            
                                                               w
                                                               
                                                                  A
                                                                  2
                                                               
                                                            
                                                            ,
                                                            
                                                               w
                                                               
                                                                  B
                                                                  2
                                                               
                                                            
                                                            }
                                                            
                                                            
                                                            if
                                                            
                                                            there
                                                            
                                                            exists
                                                            
                                                            an
                                                            
                                                            integer
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            a
                                                            
                                                            such
                                                            
                                                            that
                                                            
                                                            
                                                               a
                                                               ∣
                                                               max
                                                               {
                                                               
                                                                  w
                                                                  
                                                                     A
                                                                     2
                                                                  
                                                               
                                                               ,
                                                               
                                                                  w
                                                                  
                                                                     B
                                                                     2
                                                                  
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                            
                                                            and
                                                            
                                                            
                                                               3
                                                               ≤
                                                               a
                                                               <
                                                               max
                                                               
                                                                  {
                                                                  
                                                                     w
                                                                     
                                                                        A
                                                                        2
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     w
                                                                     
                                                                        B
                                                                        2
                                                                     
                                                                  
                                                                  }
                                                               
                                                               /
                                                               max
                                                               
                                                                  {
                                                                  
                                                                     w
                                                                     
                                                                        A
                                                                        3
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     w
                                                                     
                                                                        B
                                                                        3
                                                                     
                                                                  
                                                                  }
                                                               
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            8
                                                            max
                                                            {
                                                            
                                                               ⌈
                                                               
                                                                  w
                                                                  
                                                                     A
                                                                     2
                                                                  
                                                               
                                                               /
                                                               2
                                                               ⌉
                                                            
                                                            ,
                                                            
                                                               w
                                                               
                                                                  A
                                                                  3
                                                               
                                                            
                                                            ,
                                                            
                                                               ⌈
                                                               
                                                                  w
                                                                  
                                                                     B
                                                                     2
                                                                  
                                                               
                                                               /
                                                               2
                                                               ⌉
                                                            
                                                            ,
                                                            
                                                               w
                                                               
                                                                  B
                                                                  3
                                                               
                                                            
                                                            }
                                                            
                                                            
                                                            otherwise,
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

from Lemma 11 and Appendix B. The list of solutions from Lemmas 11 combined with the upper limit on the value of a is given in Lemma 13, thus give rise to the third to the ninth solution forms. The last two forms arise from Lemma 12, with additional restrictions on the range of a imposed by Lemma 13.□

Observe that the eleven expressions considered by Algorithm OptPPS as having potentially minimum values for the time frame, T, are each closed form, and that only the second expression may need evaluating more than 8 times. It is sufficient to consider the second expression only for values of a no greater than 
                        
                           
                              w
                              
                                 A
                                 1
                              
                           
                        
                     . The second and ninth expressions involve prime factorisation of an integer no greater than w
                     
                        A1. While factorisation is NP-hard in general, it can be performed quickly for any integer up to 40 digits long (Wolfram, 2008). Since w
                     
                        A1 represents the total number of peripheral clients in the network, an optimal PPS for a full binary tree network can, in practice, be found in polynomial time.

Observe that if the value of 
                     w
                     
                        A1 were to be too large for prime factorisation by the available software, then a potential optimal solution 
                        
                           
                              S
                              3
                           
                           
                              (
                              a
                              )
                           
                           ∘
                           
                              S
                              3
                           
                           
                              (
                              a
                              )
                           
                        
                      with value 
                        
                           T
                           =
                           3
                           
                              w
                              
                                 A
                                 1
                              
                           
                        
                      might be missed. However, the solution found by the algorithm would nonetheless be a 
                        
                           (
                           1
                           +
                           1
                           /
                           
                              w
                              
                                 A
                                 1
                              
                           
                           )
                        
                      approximation, by comparison with the value 
                        
                           T
                           =
                           6
                           
                              ⌈
                              
                                 w
                                 
                                    A
                                    1
                                 
                              
                              /
                              2
                              ⌉
                           
                        
                      for 
                        
                           
                              S
                              3
                           
                           
                              (
                              2
                              )
                           
                           ∘
                           
                              S
                              3
                           
                           
                              (
                              2
                              )
                           
                           .
                        
                     
                  

Having established the efficiency of our optimal algorithm, we now turn our attention to its effectiveness. The standard approach to perfect periodic scheduling is a Common Cycle, or round robin, schedule and we therefore use this as the benchmark.

                        Lemma 14
                        
                           For a whole binary tree, an optimal solution with a common periodicity is
                           
                              
                                 
                                    S
                                    4
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            
                           with periodicity
                           
                              
                                 
                                    q
                                    C
                                 
                                 =
                                 4
                              
                            
                           and value
                           
                              
                                 
                                    T
                                    C
                                 
                                 =
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                              
                           
                           .
                        

Since mesh nodes have three access links and one local link, from Condition (2), qC
                            ≥ 4. Thus, from Condition (5), 
                              
                                 T
                                 ≥
                                 
                                    q
                                    
                                       A
                                       1
                                    
                                 
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 
                                    q
                                    C
                                 
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 ≥
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                              
                           . Now the schedule with 
                              
                                 
                                    q
                                    C
                                 
                                 =
                                 4
                              
                            is 
                              
                                 
                                    S
                                    4
                                 
                                 ∘
                                 
                                    S
                                    4
                                 
                              
                            and it has value 
                              
                                 T
                                 =
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                              
                            satisfying Conditions (4)–(6), completing the proof.□

Consider a binary tree network of depth 2 with 
                              
                                 
                                    y
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 3
                              
                           
                           
                              
                                 
                                    y
                                    
                                       A
                                       2
                                    
                                 
                                 =
                                 6
                                 ,
                              
                           
                           
                              
                                 
                                    y
                                    
                                       A
                                       3
                                    
                                 
                                 =
                                 3
                                 ,
                              
                           
                           
                              
                                 
                                    y
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 1
                              
                           
                           
                              
                                 
                                    y
                                    
                                       B
                                       2
                                    
                                 
                                 =
                                 3
                              
                            and 
                              
                                 
                                    y
                                    
                                       B
                                       3
                                    
                                 
                                 =
                                 1
                              
                           . Then, 
                              
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 12
                              
                           
                           
                              
                                 
                                    w
                                    
                                       A
                                       2
                                    
                                 
                                 =
                                 6
                                 ,
                              
                           
                           
                              
                                 
                                    w
                                    
                                       A
                                       3
                                    
                                 
                                 =
                                 3
                                 ,
                              
                           
                           
                              
                                 
                                    w
                                    
                                       B
                                       1
                                    
                                 
                                 =
                                 5
                              
                           
                           
                              
                                 
                                    w
                                    
                                       B
                                       2
                                    
                                 
                                 =
                                 3
                              
                            and 
                              
                                 
                                    w
                                    
                                       B
                                       3
                                    
                                 
                                 =
                                 1
                                 ,
                              
                            and hence 
                              
                                 
                                    T
                                    C
                                 
                                 =
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                                 =
                                 48
                              
                            by Lemma 14, while an optimal PPS 
                              
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    2
                                    ,
                                    2
                                    )
                                 
                                 ∘
                                 
                                    S
                                    2
                                 
                                 
                                    (
                                    3
                                    ,
                                    1
                                    )
                                 
                              
                            has value 
                              
                                 T
                                 =
                                 24
                                 max
                                 {
                                 
                                    ⌈
                                    
                                       w
                                       
                                          A
                                          2
                                       
                                    
                                    /
                                    6
                                    ⌉
                                 
                                 ,
                                 
                                    ⌈
                                    
                                       w
                                       
                                          A
                                          3
                                       
                                    
                                    /
                                    3
                                    ⌉
                                 
                                 ,
                                 
                                    ⌈
                                    
                                       w
                                       
                                          B
                                          2
                                       
                                    
                                    /
                                    4
                                    ⌉
                                 
                                 }
                                 =
                                 24
                              
                            from algorithm OptPSS, as shown in Appendix C. Thus, our algorithm doubles the effective capacity of the network for this instance of the problem. It can do no better since T
                           * ≥ q
                           
                              A1
                           w
                           
                              A1 ≥ 2w
                           
                              A1 and the optimal Common Cycle schedule has 
                              
                                 T
                                 =
                                 
                                    T
                                    C
                                 
                                 =
                                 4
                                 
                                    w
                                    
                                       A
                                       1
                                    
                                 
                              
                            by Lemma 14, verifying the Theorem below. An optimal schedule of the above form is presented in Fig. 8 for completeness.


                           For any binary tree the application of the optimal PPS algorithm provides up to 100% additional capacity over the optimal Common Cycle schedule, i.e., 
                           
                              
                                 
                                    
                                       
                                          
                                             T
                                             C
                                          
                                          
                                             T
                                             *
                                          
                                       
                                       ≤
                                       2
                                       .
                                    
                                 
                              
                           
                        

A set of experiments was carried out to explore the behaviour of our algorithm OptPPS. A benchmark dataset of instances was devised to take account of various characteristics: size of the network, using depth of 2, 4 and 6 links from the Gateway node; scale of demand, with maximum user demand up to 10, 50, and 100; and the distribution of demand both within and between the two sides of the binary tree as described below. Local demand is generated randomly from a uniform distribution for each node in the network (other than the Gateway) for 20 instances. The benchmark test suite is included as a supplement to the electronic version of this article. The results of applying OptPPS to the benchmart test suite are reported for each of the data sets in Table 1.

The first section of Table 1 provides the values given in the form of capacity gain compared to default alternative of a, in fact the best, Common Cycle (CS). The second section shows the total number of times a candidate solution achieves the optimal value within each set, and is generally greater than 20 due to multiple optima. The 100% capacity gain of OptPPS over CS, postulated in Theorem 5, is achieved for some of the small instances. However, the maximum value and the spread in capacity gain within a data set reduces as the size of the network increases, with the gain narrowing to within 1% of 33% consistently for networks extending 6 links from the Gateway.

The effect of the level of demand is explored by extending the range of demand from [1,10] to [1,50] and then [1,100] for each node in the network. The impact is small on both the range of optimal solutions and their values, and possibly not statistically significant. Indeed, the underlying natural variation in efficiency values between sets of experiments is highlighted by comparing the first line of results in each of the test sets, as they are randomly generated with the same parameter settings. The average gains differs by 7.

The balance of demand within each side of the binary tree is explored by doubling and then quadrupling average demand at one of the nodes one link from the Gateway on each side. The increase in demand had a similar effect to increasing the size of the network, with average gain reducing with imbalance but remaining above 33% on average.

The effect of the imbalance between the two sides of the binary tree is quite different. As demand on one side of the binary tree, side A, is scaled up, the efficiency gain reported in Table 1 increases, and optimal solutions become restricted to those with periodicity 2, and never 3, at the Gateway. The gain in capacity is always above 75% once demand is imbalanced by 4 to 1. Note that each candidate solutions considered by algorithm OptPPS is optimal for some test instance. However, the spread in the structure of optimal PPS solutions narrows with the size of the network, until periodicity 3 at the Gateway always provides an optimal solution, whereas periodicity 2 at the Gateway is usually appropriate for the smallest networks (
                        
                           n
                           =
                           6
                        
                     ).

Algorithm OptPPS runs in less than 1 second. and has proved effective on a wide range of instances, demonstrating a benefit over any common cycle solution of at least 22% in additional capacity in all cases.

@&#CONCLUSION@&#

This paper examined packet scheduling in a Wireless Mesh access Network with a single Gateway to the Internet and identical link capacities, and focus upon perfectly periodic schedules with the minimum time frame in which each peripheral client receives the same level of service. It focuses upon routing trees with a chain or a binary tree structure, producing optimal schedules for co-ordinating local traffic generation with transmission across the access network which run in polynomial time. In doing so the research complements work on perfect periodic schedules at a single mesh node by Kim and Glass (2014), and on transmit schedules across the access network to the Internet Gateway respecting pre-generated periodic local mesh schedules (Allen et al., 2012).

The algorithms which we propose for a perfect periodic schedule along a chain, and through a binary tree network, form the basis of a robust operating mechanism for WMNs. The chain algorithm runs in polynomial time and is up to 50% more effective than the optimal Common Cycle schedule. The binary tree scheduling algorithm effectively runs in polynomial time, of less than 1minute. Theoretically it is only demonstrably a PTAS relying on factorisation of an integer. However, the integer under consideration represents the number of clients in the network which is small enough to be factorised quickly with current computer algorithms. The contribution of our algorithm is to provide up to double the throughput compared to the optimal Common Cycle schedule for a binary tree. Moreover, the nature of an optimal schedule makes it easy to convey to local nodes, and each solution remains optimal within a range of tolerance which depends only upon the relative cumulative transmission loads through the links within two hops of the Gateway. Even outside the tolerance range the solution will remain feasible with only an incrementally increased time frame.

An important property revealed by this research is that for a binary routing tree in a uniform link capacity WMN, the minimum total time frame of a PPS transmitting information to the Gateway is determined solely by the flow of data required through the six nodes closest to the gateway. For a chain routing network it is the relative traffic on the two links adjacent to the Gateway which determines the form of an optimal solution for maximising the throughput. Observe that these properties may be used when assigning the routing tree within the wireless access network, or indeed for designing the access network itself. Thus, the simplicity and speed of our scheduling algorithms ensure that they can be used to design the routing network. The methodology developed in this paper provides analytic tools for tackling more general routing trees. Future extensions might include non-binary routing tree structures in WMNs, taking account of secondary interference of two or more hops, and scheduling of other types of MANETs with similar equipment.

@&#ACKNOWLEDGMENTS@&#

This research was supported by EPSRC Grant number EP/G036454/1. The authors are grateful for the anonymous refereeing process which resulted in a substantial improvement in the quality of this article.


                     If a ≥ 2 and ab ≥ 3, then
                     
                        
                           max
                           
                              {
                              2
                              
                                 w
                                 1
                              
                              ,
                              2
                              a
                              
                                 w
                                 2
                              
                              ,
                              2
                              a
                              b
                              
                                 w
                                 3
                              
                              }
                           
                           =
                           max
                           
                              {
                              2
                              a
                              
                                 w
                                 2
                              
                              ,
                              2
                              a
                              b
                              
                                 w
                                 3
                              
                              }
                           
                        
                     
                     .
                     
                        Proof
                        Consider the case when 
                              
                                 a
                                 =
                                 2
                              
                           . Note that b ≥ 2 when 
                              
                                 a
                                 =
                                 2
                              
                           . Suppose otherwise, then 
                              
                                 4
                                 
                                    w
                                    2
                                 
                                 =
                                 2
                                 a
                                 
                                    w
                                    2
                                 
                                 <
                                 2
                                 
                                    w
                                    1
                                 
                              
                            and 
                              
                                 4
                                 b
                                 
                                    w
                                    3
                                 
                                 =
                                 2
                                 a
                                 b
                                 
                                    w
                                    3
                                 
                                 <
                                 2
                                 
                                    w
                                    1
                                 
                              
                           . From 4w
                           2 < 2w
                           1, we have that 
                              
                                 
                                    w
                                    2
                                 
                                 <
                                 
                                    w
                                    1
                                 
                                 −
                                 
                                    w
                                    2
                                 
                                 =
                                 
                                    w
                                    2
                                 
                                 +
                                 
                                    w
                                    3
                                 
                                 +
                                 
                                    y
                                    1
                                 
                                 −
                                 
                                    w
                                    2
                                 
                                 =
                                 
                                    w
                                    3
                                 
                                 +
                                 
                                    y
                                    1
                                 
                              
                           . From 4bw
                           3 < 2w
                           1,

                              
                                 
                                    
                                       b
                                       <
                                       
                                          
                                             w
                                             1
                                          
                                          
                                             2
                                             
                                                w
                                                3
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                w
                                                2
                                             
                                             +
                                             
                                                w
                                                3
                                             
                                             +
                                             
                                                y
                                                1
                                             
                                          
                                          
                                             2
                                             
                                                w
                                                3
                                             
                                          
                                       
                                       <
                                       
                                          
                                             2
                                             
                                                w
                                                3
                                             
                                             +
                                             2
                                             
                                                y
                                                1
                                             
                                          
                                          
                                             2
                                             
                                                w
                                                3
                                             
                                          
                                       
                                       =
                                       1
                                       +
                                       
                                          
                                             y
                                             1
                                          
                                          
                                             w
                                             3
                                          
                                       
                                       ≤
                                       2
                                       ,
                                    
                                 
                              
                           which contradicts to that b ≥ 2. Consider the case when a ≥ 3. Then, 
                              
                                 2
                                 a
                                 
                                    w
                                    2
                                 
                                 ≥
                                 6
                                 
                                    w
                                    2
                                 
                                 =
                                 2
                                 
                                    (
                                    
                                       w
                                       2
                                    
                                    +
                                    
                                       w
                                       2
                                    
                                    +
                                    
                                       w
                                       2
                                    
                                    )
                                 
                                 ≥
                                 2
                                 
                                    (
                                    
                                       w
                                       2
                                    
                                    +
                                    
                                       w
                                       3
                                    
                                    +
                                    
                                       y
                                       1
                                    
                                    )
                                 
                                 =
                                 2
                                 
                                    w
                                    1
                                 
                              
                           .□


                     For given positive integers b and c such that b ≥ c, the set of values
                     
                        
                           T
                           
                              (
                              a
                              )
                           
                           =
                           a
                           max
                           
                              {
                              
                                 ⌈
                                 b
                                 /
                                 a
                                 ⌉
                              
                              ,
                              c
                              }
                           
                        
                      
                     for an integer a ≥ 2 has minimum value
                     
                        
                           
                              
                                 
                                    
                                       
                                          T
                                          (
                                          a
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          b
                                          
                                          
                                          if
                                          
                                          there
                                          
                                          exists
                                          
                                          a
                                          
                                          such
                                          
                                          that
                                          
                                          3
                                          ≤
                                          a
                                          <
                                          b
                                          /
                                          c
                                          
                                          and
                                          
                                          a
                                          ∣
                                          b
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          T
                                          (
                                          2
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          2
                                          max
                                          {
                                          
                                             ⌈
                                             b
                                             /
                                             2
                                             ⌉
                                          
                                          ,
                                          c
                                          }
                                          
                                          
                                          otherwise.
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        Proof
                        Consider the case when 
                              
                                 a
                                 =
                                 2
                              
                           . If b < 2c, then 
                              
                                 T
                                 =
                                 2
                                 c
                              
                           . If b ≥ 2c, then

                              
                                 
                                    
                                       T
                                       
                                          (
                                          2
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   
                                                      if
                                                      
                                                      b
                                                      
                                                      is
                                                      
                                                      an
                                                      
                                                      even
                                                      
                                                      number,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      b
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Consider the case when a ≥ 3. If b < ac, then

                              
                                 
                                    
                                       T
                                       (
                                       a
                                       )
                                       =
                                       a
                                       c
                                       ≥
                                       max
                                       {
                                       2
                                       c
                                       ,
                                       b
                                       +
                                       1
                                       }
                                       ≥
                                       T
                                       (
                                       2
                                       )
                                    
                                 
                              
                           since a ≥ 3. If b ≥ ac, then

                              
                                 
                                    
                                       T
                                       
                                          (
                                          a
                                          )
                                       
                                       =
                                       a
                                       
                                          ⌈
                                          
                                             b
                                             a
                                          
                                          ⌉
                                       
                                       ≥
                                       
                                          {
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   
                                                      if
                                                      
                                                      a
                                                      ∣
                                                      b
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      b
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   otherwise.
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Consequently,

                              
                                 
                                    
                                       
                                          min
                                          
                                             a
                                             ≥
                                             3
                                          
                                       
                                       T
                                       
                                          (
                                          a
                                          )
                                       
                                       ≥
                                       T
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              
                           if there exists no integer a such that 3 ≤ a < b/c and a∣b.□

Implementation of algorithm OptPPS on Example 3
                  

In Example 3, 
                        
                           
                              w
                              
                                 A
                                 1
                              
                           
                           =
                           12
                           ,
                        
                     
                     
                        
                           
                              w
                              
                                 A
                                 2
                              
                           
                           =
                           6
                           ,
                        
                     
                     
                        
                           
                              w
                              
                                 A
                                 3
                              
                           
                           =
                           3
                           ,
                        
                     
                     
                        
                           
                              w
                              
                                 B
                                 1
                              
                           
                           =
                           5
                           ,
                        
                     
                     
                        
                           
                              w
                              
                                 B
                                 2
                              
                           
                           =
                           3
                        
                      and 
                        
                           
                              w
                              
                                 B
                                 3
                              
                           
                           =
                           1
                        
                     . The condition on parameter values in OptPPS for candidate schedules of the form 
                        
                           
                              S
                              3
                           
                           
                              (
                              a
                              )
                           
                           ∘
                           
                              S
                              3
                           
                           
                              (
                              a
                              )
                           
                        
                      restricts consideration to 
                        
                           a
                           =
                           3
                        
                      only, because 
                        
                           3
                           ≤
                           a
                           <
                           
                              w
                              
                                 A
                                 1
                              
                           
                           /
                           
                              w
                              ^
                           
                        
                      and 
                        
                           
                              w
                              
                                 A
                                 1
                              
                           
                           =
                           12
                        
                      and 
                        
                           
                              w
                              ^
                           
                           =
                           max
                           
                              {
                              
                                 w
                                 
                                    A
                                    3
                                 
                              
                              ,
                              
                                 w
                                 
                                    B
                                    3
                                 
                              
                              }
                           
                           =
                           3
                        
                     . Moreover, no schedule of the form 
                        
                           
                              S
                              2
                           
                           
                              (
                              2
                              ,
                              a
                              )
                           
                           ∘
                           
                              S
                              2
                           
                           
                              (
                              2
                              ,
                              a
                              )
                           
                        
                      is a candidate because 3 ≤ a < max {w
                     
                        A2, w
                     
                        B2}/max {w
                     
                        A3, w
                     
                        B3} and 
                        
                           max
                           
                              {
                              
                                 w
                                 
                                    A
                                    2
                                 
                              
                              ,
                              
                                 w
                                 
                                    B
                                    2
                                 
                              
                              }
                           
                           /
                           max
                           
                              {
                              
                                 w
                                 
                                    A
                                    3
                                 
                              
                              ,
                              
                                 w
                                 
                                    B
                                    3
                                 
                              
                              }
                           
                           =
                           2
                           ,
                        
                      and hence algorithm OptPPS evaluates T values for candidate list of schedules as follows:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   6
                                                   
                                                      ⌈
                                                      
                                                         w
                                                         
                                                            A
                                                            1
                                                         
                                                      
                                                      /
                                                      2
                                                      ⌉
                                                   
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   6
                                                   
                                                      ⌈
                                                      
                                                         w
                                                         
                                                            A
                                                            1
                                                         
                                                      
                                                      /
                                                      2
                                                      ⌉
                                                   
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      3
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      3
                                                   
                                                   
                                                      (
                                                      3
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   3
                                                   
                                                      w
                                                      
                                                         A
                                                         1
                                                      
                                                   
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      2
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      2
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   8
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         w
                                                         
                                                            A
                                                            2
                                                         
                                                      
                                                      /
                                                      2
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         w
                                                         
                                                            B
                                                            2
                                                         
                                                      
                                                      /
                                                      2
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   24
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      2
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   24
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         6
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               3
                                                            
                                                         
                                                         /
                                                         3
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         4
                                                         ⌉
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   24
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      3
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   12
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      4
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      4
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   16
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         4
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   48
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      5
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      5
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   20
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         5
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   60
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      6
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      6
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   24
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         6
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   72
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      7
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      7
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   28
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         7
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   84
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      8
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      8
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   32
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         8
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         A
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   }
                                                   =
                                                   96
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      2
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   24
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         4
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         6
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               3
                                                            
                                                         
                                                         /
                                                         3
                                                         ⌉
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   =
                                                   48
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      3
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   12
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         3
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      4
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      4
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   16
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         4
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                   =
                                                   48
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      5
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      5
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   20
                                                   max
                                                   {
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      ⌈
                                                      
                                                         
                                                            w
                                                            
                                                               B
                                                               2
                                                            
                                                         
                                                         /
                                                         5
                                                      
                                                      ⌉
                                                   
                                                   ,
                                                   
                                                      w
                                                      
                                                         B
                                                         3
                                                      
                                                   
                                                   }
                                                   =
                                                   60
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   6
                                                   max
                                                   
                                                      {
                                                      
                                                         w
                                                         
                                                            A
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            B
                                                            2
                                                         
                                                      
                                                      }
                                                   
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      3
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   12
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         3
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         3
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   36
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      4
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   16
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         4
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         4
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   48
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      5
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   20
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         5
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         5
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   60
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      6
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   24
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         6
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         6
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   72
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      7
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   28
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         7
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         7
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   84
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      2
                                                      ,
                                                      8
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   32
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         8
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         w
                                                         
                                                            A
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         8
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   96
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      S
                                                      2
                                                   
                                                   
                                                      (
                                                      3
                                                      ,
                                                      1
                                                      )
                                                   
                                                   ∘
                                                   
                                                      S
                                                      4
                                                   
                                                   :
                                                
                                             
                                             
                                                
                                                   T
                                                   =
                                                   12
                                                   max
                                                   
                                                      {
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               A
                                                               2
                                                            
                                                         
                                                         /
                                                         2
                                                         ⌉
                                                      
                                                      ,
                                                      
                                                         ⌈
                                                         
                                                            w
                                                            
                                                               B
                                                               1
                                                            
                                                         
                                                         /
                                                         3
                                                         ⌉
                                                      
                                                      }
                                                   
                                                   =
                                                   36
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

OptPPS picks up the minimum of these T values, 24, and outputs both schedules which achieve the T value of 24, namely 
                        
                           
                              S
                              2
                           
                           
                              (
                              2
                              ,
                              2
                              )
                           
                           ∘
                           
                              S
                              2
                           
                           
                              (
                              2
                              ,
                              2
                              )
                           
                        
                      and 
                        
                           
                              S
                              2
                           
                           
                              (
                              2
                              ,
                              2
                              )
                           
                           ∘
                           
                              S
                              2
                           
                           
                              (
                              3
                              ,
                              1
                              )
                           
                           ,
                        
                      as optimal for Example 3.

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.ejor.2015.05.031
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

