@&#MAIN-TITLE@&#A semi-automatic method for robust and efficient identification of neighboring muscle cells

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We evolve the threshold selection method.


                        
                        
                           
                           We decompose the histogram distribution into different layers by Fourier transform.


                        
                        
                           
                           We select the optimal threshold based on the practical needs.


                        
                        
                           
                           We evolve the ultimate erosion theorem to achieve high accuracy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Segmentation

Threshold selection

Morphological erosion

Morphological dilation

Muscle cell/fiber

@&#ABSTRACT@&#


               
               
                  Segmentation and identification of muscle cells robustly and efficiently is of considerable importance in determining the muscle’s physiological conditions. It is challenging due to frequently occurring artifacts, indistinct boundary between adjacent cells, the arbitrary shape and large number of cells. Currently, the widely used segmentation and quantification tools are usually manual or semi-automatic, which is time-consuming and labor intensive. In this paper, a semi-automatic method is proposed to segment the muscle cells robustly and efficiently. The proposed approach utilizes and evolves three fundamental image processing techniques, threshold selection, morphological ultimate erosion and morphological dilation. Experimental results verified the effectiveness of the proposed method.
               
            

@&#INTRODUCTION@&#

Image segmentation [1–4] plays important roles in many computer vision applications. With the rapid development of microscopy imaging [5], many new scientific applications are brought forth in the areas of physics, chemistry and biology [6,7]. Among them, cell segmentation is the most studied and popular one. Many methods were proposed and claimed to be superior in segmenting a class of cell images, e.g. watershed method [8], region growing method [9], morphological method [10], neural network method [11], graph method [12] and machine learning and modeling method [13,14]. In this paper, we propose a method to segment the muscle cell/fiber image which usually contains a lot of cells/fibers and would cost great labor and time for manual or semi-automatic methods. Hence, image processing techniques that is capable of segmenting the neighboring cells and identifying their boundaries robustly and efficiently becomes very important. Past efforts in segmenting the muscle cell/fiber images include: (1), active contour based method [15,16,18]; (2), GVF method [17]. Experimental results indicate that our proposed method is superior to them in efficiency and accuracy.

There are two general properties of the muscle cell images, intensity and intensity gradient and they are identified mainly by their intensity gradients and local intensities. It is difficult for one to notice the global intensity variations of these images accurately because of lateral inhibition. Hence, we enhance the boundary of all the cells and use the segmented intensity gradients as constraint for the segmentation with a global threshold. To segment the enhanced gradient image robustly, we calculate the threshold based on the slope variation of the histogram distribution [19]. The threshold is selected as the point with greatest variation, which is more accurate than the state of art threshold selection methods [20–34]. After the image was segmented by the selected threshold, some neighboring cells are still connected. Thus, further processing is needed to separate them from each other. To separate them, we propose an iterative erosion method based on an area threshold that can distinguish the area of the cell and the area of the noise which is prevalent in image processing applications [35]. The area threshold is computed on line. After the cell is identified, its boundary is delineated by dilating the segmented seed toward its edge until part of it reaches the edge.

The segmentation comprises three parts. The first part is segmentation of the original image by a global threshold. The second part is producing the gradient image and segmenting it by a global threshold. The third part is combining the first part and second part for the final segmentation based on the characteristics of the muscle cell images.

For the first part of segmentation, we need to compute a threshold from the original image. An improved threshold selection method is proposed in this paper based on our previous study [15]. The histogram distribution of the original image is calculated and then transformed into the Fourier domain. The first term of the Fourier transform corresponds to the DC value of the histogram distribution. The second term of the Fourier transform corresponds to the sketchiest global information of the histogram distribution. Suppose the image contains the object and the background and their gray-scales are Gaussian distributed, the second term of Fourier transform corresponds to a sketchy overlay of two Gaussian distributions. Hence, a global variation peak exists between these two Gaussian distributions to separate them roughly. This global variation peak is detected automatically and it is then used as the benchmark threshold to segment the original image. The threshold selection method contains the following steps:


                        Step 1: Re-arrange the gray-scale values of the image in the interval [1, 255] and compute its normalized histogram distribution, P(x):
                           
                              (1)
                              
                                 
                                    P
                                    
                                       (
                                       
                                          x
                                          =
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                          
                                             
                                                N
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                N
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                    ;
                                    i
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    ..
                                    .
                                    ,
                                    255
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    j
                                    =
                                    
                                       
                                          argmax
                                          
                                             {
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             }
                                          
                                       
                                       
                                          k
                                          ∈
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                            
                                                            
                                                            255
                                                            ]
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Ni
                         denotes the frequency of the gray-scale i and Nj
                         denotes the maximum frequency which occurs at j in the interval 
                           
                              [
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          
                                             255
                                          
                                       
                                    
                                 
                              
                              ]
                           
                        .


                        Step 2: Transform P(x) by the Discrete Fourier Transform (DFT):
                           
                              (3)
                              
                                 
                                    F
                                    
                                       (
                                       k
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          x
                                          =
                                          1
                                       
                                       
                                          255
                                       
                                    
                                    P
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          i
                                          
                                             
                                                2
                                                π
                                                k
                                                x
                                             
                                             
                                                255
                                             
                                          
                                       
                                    
                                    ;
                                    k
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    ..
                                    .
                                    ,
                                    255
                                 
                              
                           
                        
                     


                        Step 3: After DFT, choose the first term and second term of the low frequency parts and eliminate the other parts by the following equation:
                           
                              (4)
                              
                                 
                                    F
                                    ′
                                 
                                 
                                    (
                                    k
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   ;
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   ;
                                                   k
                                                   =
                                                   254
                                                   ,
                                                   255
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ;
                                                   k
                                                   =
                                                   3
                                                   ,
                                                   …
                                                   ,
                                                   253
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Step 4: Transform from the frequency domain back into spatial domain to get the smoothed histogram.
                           
                              (5)
                              
                                 
                                    P
                                    ′
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    1
                                    
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       255
                                    
                                 
                                 
                                    F
                                    ′
                                 
                                 
                                    (
                                    k
                                    )
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       
                                          
                                             2
                                             π
                                             x
                                             k
                                          
                                          
                                             255
                                          
                                       
                                    
                                 
                                 ;
                                 x
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 255
                              
                           
                        
                     


                        Step 5: There are two slopes for each point on P′(x), one on the left and the other on the right. They are computed by fitting a line model with 15 adjacent points at each side. All the reasonable numbers from 3 to 81 are tested on a variety of images and it is found that the numbers from 7 to 21 are the most effective parameters for the histogram range from 1 to 255. So we choose 15 for all the experiments. The line model is formulated as:
                           
                              (6)
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    a
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    b
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          [
                                          
                                             a
                                             ,
                                             b
                                          
                                          ]
                                       
                                       T
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   B
                                                
                                                T
                                             
                                             B
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          B
                                       
                                       T
                                    
                                    Y
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    B
                                    =
                                    
                                    
                                    
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    x
                                                                                 
                                                                                 
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           ⋮
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                     
                                                                        15
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           ⋮
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    Y
                                    =
                                    
                                    
                                    
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   15
                                                
                                             
                                          
                                          ]
                                       
                                       T
                                    
                                 
                              
                           
                        
                     

Two slopes at point 
                           i
                        , a
                        1(i) and a
                        2 (i), are then obtained from Eq. (7).


                        Step 6: Compute the slope difference, s(i), at point i:
                           
                              (10)
                              
                                 
                                    s
                                    
                                       (
                                       i
                                       )
                                    
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    ;
                                    i
                                    =
                                    16
                                    ,
                                    17
                                    ,
                                    ..
                                    .
                                    ,
                                    240
                                 
                              
                           
                        
                     

Find the positions in the slope difference distribution that meet the following conditions:
                           
                              (11)
                              
                                 
                                    s
                                    
                                       (
                                       i
                                       )
                                    
                                    −
                                    s
                                    (
                                    i
                                    −
                                    1
                                    )
                                    =
                                    0
                                 
                              
                           
                        
                     

We get the valleys Vi
                        ;i=1, 2,...,Nv
                         with greatest local variations and the peaks Pi
                        ;i=1, 2,...,Np
                         with greatest local variations of the slope difference distribution. Suppose there are two histogram peaks, P
                        1 and P
                        2 corresponding to the centers of the two Gaussian distributions, we choose the position where the valley Vi
                         between P
                        1 and P
                        2 as the benchmark threshold Tb
                        . Then the original image, 
                           I
                         is binarized as follows:
                           
                              (12)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          I
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ;
                                                      I
                                                      ≥
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      I
                                                      <
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the second part of segmentation, we need to form the gradient image from the original image. The Sobel operator is used to detect the intensity gradient in the row direction and column direction respectively and get two gradient images Ix
                         and Iy
                         . Then the gradient magnitude image is computed as follows:
                           
                              (13)
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          g
                                       
                                    
                                    
                                       (
                                       
                                          k
                                          ,
                                          j
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             (
                                             
                                                k
                                                ,
                                                j
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             2
                                          
                                          
                                             (
                                             
                                                k
                                                ,
                                                j
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              (
                              
                                 k
                                 ,
                                 j
                              
                              )
                           
                         denotes the index of the pixel position.

The gradient image is then segmented with a global threshold to obtain the edge image, 
                           
                              
                                 S
                              
                              
                                 E
                              
                           
                        . We need the segmented edges to be as complete as possible for the subsequent processing. Unfortunately, none of the state of art threshold selection methods [20–34] could yield acceptable accuracy. Hence, we use the same criteria to select the threshold as [19] and it contains the following steps.

Immediately following the first two steps, Step 1 and Step 2 described above.


                        Step 7: Choose the low frequency parts and eliminate the high frequency parts by the following equation.
                           
                              (14)
                              
                                 
                                    F
                                    ′
                                 
                                 
                                    (
                                    k
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   ;
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   10
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   F
                                                   
                                                      (
                                                      k
                                                      )
                                                   
                                                   ;
                                                   k
                                                   =
                                                   246
                                                   ,
                                                   …
                                                   ,
                                                   254
                                                   ,
                                                   255
                                                   ;
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ;
                                                   k
                                                   =
                                                   11
                                                   ,
                                                   …
                                                   ,
                                                   245
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        k is chosen from 1 to 10 to keep more details of the image. As a result, the selected threshold could segment the image and keep the edge more complete. Transform from the frequency domain back into spatial domain by the following equation.
                           
                              (15)
                              
                                 
                                    P
                                    ′
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    1
                                    
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       255
                                    
                                 
                                 
                                    F
                                    ′
                                 
                                 
                                    (
                                    k
                                    )
                                 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                       
                                          
                                             2
                                             π
                                             x
                                             k
                                          
                                          
                                             255
                                          
                                       
                                    
                                 
                                 ;
                                 x
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 255
                              
                           
                        
                     


                        P′(x) is the smoothed histogram distribution.


                        Step 8: Repeat the above Step 5 and Step 6. We get the valleys Vi
                        ;i=1, 2,...,Nv
                         of the slope difference distribution with local variation peaks. There are valleys adjacent to the benchmark threshold Tb
                        , some on the left and the others on the right. The valley on the left is selected to make the segmented edge to be as complete as possible. Accordingly, the gray-scale value corresponding to the left valley is selected as the optimal threshold, 
                           
                              
                                 T
                              
                              
                                 o
                              
                           
                        .

The edge image is obtained by the following equation.
                           
                              (16)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          E
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ;
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            g
                                                         
                                                      
                                                      ≥
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      
                                                         
                                                            I
                                                         
                                                         
                                                            g
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

With the two segmentation results, SE
                         and SI
                        , we calculate the final segmentation 
                           
                              
                                 S
                              
                              
                                 f
                              
                           
                         in two cases due to the vast variety of muscle cell types. The user decides which case to choose for one specific type of muscle cell images. There are muscle cell images with many overlapping neighboring boundary while the segmented edge for each cell is not closed, which is true in most cases. For this kind of cell images (Case 1), we define the following segmentation method that utilizes the segmentation results of both the edge image and original image, SE
                         and 
                           
                              
                                 S
                              
                              
                                 I
                              
                           
                        .
                           
                              (17)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                         ;
                                                         
                                                            i
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                      =
                                                      1
                                                      )
                                                      
                                                         
                                                         
                                                            a
                                                         
                                                         
                                                            n
                                                         
                                                         
                                                            d
                                                         
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            E
                                                         
                                                      
                                                      =
                                                      0
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      
                                                         
                                                            
                                                            e
                                                         
                                                         
                                                            l
                                                         
                                                         
                                                            s
                                                         
                                                         
                                                            e
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

There are also cell images with many overlapping neighboring boundary while the segmented edge for each cell is closed, which is true occasionally. For this kind of cell images (Case 2), we define the following segmentation method that utilizes the segmentation results of the edge image, SE
                         only.
                           
                              (18)
                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                         ;
                                                         
                                                         i
                                                         f
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            E
                                                         
                                                      
                                                      =
                                                      0
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      0
                                                      ;
                                                      
                                                      
                                                         e
                                                         l
                                                         s
                                                         e
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the final segmentation, 
                           
                              
                                 S
                              
                              
                                 f
                              
                           
                        , some cells are separate from others while some cells are connected with each other. To separate the connected cells and identify the cell individually, we propose the following iterative morphological erosion method based on the online computed area threshold.


                        Step 9: Initialization of the seeds of all the cells as the final segmentation, Sf
                        .
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                       
                                       1
                                    
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          f
                                       
                                    
                                 
                              
                           
                        
                     


                        Step 10: Use the structuring element 
                           
                              B
                              =
                              
                                 {
                                 
                                    (
                                    
                                       0
                                       ,
                                       0
                                    
                                    )
                                 
                                 }
                              
                           
                         to erode the seeds, 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       b
                                    
                                 
                              
                              1
                           
                         morphologically with the following equations. The structuring element used in this study is a disk with the size of one pixel.
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                       
                                       '
                                    
                                    =
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                       
                                       i
                                    
                                    Θ
                                    B
                                    =
                                    
                                       {
                                       
                                          
                                             z
                                             |
                                          
                                          
                                             
                                                (
                                                B
                                                )
                                             
                                             
                                                z
                                             
                                          
                                          ⊆
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                             i
                                          
                                       
                                       }
                                    
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          (
                                          B
                                          )
                                       
                                       
                                          z
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          c
                                          |
                                          c
                                          =
                                          a
                                          +
                                          z
                                          ,
                                          a
                                          ∈
                                          B
                                       
                                       }
                                    
                                 
                              
                           
                        where z is the translation vector and a represents the points in the structuring element B. The translation of 
                           B
                         is kept inside 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       b
                                    
                                 
                              
                              i
                           
                         while 
                           B
                         moving inside 
                           
                              
                                 
                                    
                                       I
                                    
                                    
                                       b
                                    
                                 
                              
                              i
                           
                         to get the erosion.


                        Step 11: Compute the union of all the separated cells based on their sizes and save them as seeds (separated and identified cells).
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    ⋃
                                    
                                       C
                                       
                                          (
                                          
                                             
                                                j
                                             
                                             
                                                ˜
                                             
                                          
                                          )
                                       
                                       ;
                                       
                                          
                                             j
                                          
                                          
                                             ˜
                                          
                                       
                                       =
                                       
                                          
                                             arg
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             
                                             a
                                             r
                                             e
                                             a
                                          
                                       
                                       
                                          (
                                          
                                             C
                                             
                                                (
                                                j
                                                )
                                             
                                          
                                          )
                                       
                                       <
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                b
                                             
                                          
                                       
                                       '
                                    
                                    −
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                 
                              
                           
                        
                     


                        S
                        0 is the area threshold to distinguish the area of the cell and the area of noise blob and it is computed as the mean area of all the blobs in the eroded image, 
                           
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                           
                         after 10 times of erosion of the final segmentation, 
                           
                              
                                 
                                    I
                                 
                                 
                                    b
                                 
                                 
                                    1
                                 
                              
                           
                         with 
                           
                              B
                              =
                              
                                 {
                                 
                                    (
                                    
                                       0
                                       ,
                                       0
                                    
                                    )
                                 
                                 }
                              
                           
                        and Eqs. (20) and (21).


                        Step 12: Repeat step 10 and step 11 until the area of each segmented cell is smaller than S
                        0 . Then the seeds of all the cells are formulated as:
                           
                              (24)
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       ⋃
                                       
                                          i
                                          =
                                          1
                                       
                                       N
                                    
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                
                                                
                                                   c
                                                
                                             
                                          
                                          i
                                       
                                    
                                 
                              
                           
                        
                     

After all the cells are identified, the position, 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         of 
                           
                              k
                              
                                 t
                                 h
                              
                           
                         cell is computed as:
                           
                              (25)
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       M
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       M
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        where 
                           j
                         denotes the pixel index of the identified cell and 
                           M
                         is the total number of pixels contained in the segmented cell.

The proposed iterative morphological erosion method is based on the well-known ultimate erosion theorem. Given two sets A and B, 
                           
                              B
                              ⊆
                              A
                           
                        , the union of the connected components of A that have a nonempty intersection with B is denoted as 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    A
                                 
                              
                              
                                 (
                                 B
                                 )
                              
                           
                        .The ultimate erosion for the set 
                           X
                         of overlapping convex components is defined as:
                           
                              (27)
                              
                                 
                                    U
                                    l
                                    t
                                    
                                       (
                                       X
                                       )
                                    
                                    =
                                    
                                       ⋃
                                       
                                          n
                                          ϵ
                                          N
                                       
                                    
                                    
                                       [
                                       
                                          
                                             (
                                             
                                                X
                                                ⊖
                                                n
                                                B
                                             
                                             )
                                          
                                          \
                                          
                                             
                                                ρ
                                             
                                             
                                                X
                                                ⊖
                                                n
                                                B
                                             
                                          
                                          
                                             (
                                             
                                                X
                                                ⊖
                                                
                                                   (
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                   )
                                                
                                                B
                                             
                                             )
                                          
                                       
                                       ]
                                    
                                 
                              
                           
                        
                     

Two facts make the ultimate erosion fail in segmenting the overlapping neighboring cells. Firstly, the shapes of the muscle cells are irregular. Thus, the ultimate erosion will produce more seeds than the actual number if no area threshold is used to constrain the erosion process. Secondly, ultimate erosion could not distinguish the real cells and the noise blobs. Consequently, there will be a lot of clutter seeds detected if applying ultimate erosion directly. 
                        Fig. 1 demonstrates the poor performance of ultimate erosion in separating overlapping circles. There are actually 13 circles while ultimate erosion calculates 17 seeds in Fig. 1(b) (To present the seeds clearly, we show the dilated version of the seeds). Two seeds in the middle of the image are connected due to their small distance. Fig. 1(c) shows the detected seeds with controlled area threshold for comparison purpose.

In summary, the proposed iterative erosion method is significantly superior to the ultimate erosion theorem in solving practical problems.

To delineate the boundary of each identified cell, authors in [17] use GVF method [36]. A circle with the radius of 
                           n
                         pixels from the center of the seed is drawn. Then the circle is pushed toward the edge of the cells by gradient vector field which is defined as the vector 
                           
                              V
                              
                                 (
                                 
                                    x
                                    ,
                                    y
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    u
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    ,
                                    v
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                 
                                 )
                              
                           
                         that minimizes the energy function:
                           
                              (28)
                              
                                 
                                    E
                                    =
                                    ∫
                                    
                                    ∫
                                    μ
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                v
                                             
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                v
                                             
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          |
                                          
                                             ∇
                                             f
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       
                                          |
                                          
                                             V
                                             −
                                             ∇
                                             f
                                          
                                          |
                                       
                                       2
                                    
                                    d
                                    x
                                    d
                                    y
                                 
                              
                           
                        
                     

where f is the edge map derived by applying edge detection on the smoothed image which was obtained by convolving the original image with a Gaussian kernel. µ is the regularization parameter which adjusts the trade-off between the first and second term of the integrand.

When the initial circle is too large or too small compared to the real size of the cell, the GVF will not converge correctly. Another drawback of the GVF method is that it is easily affected by the incorrect edge information. In addition, it takes time to converge and especially time-consuming when the number of cells is huge. A significantly more efficient method to identify the cell border is proposed as follows.


                        Step 13: Start the loop to dilate the first identified cell seed by the following equation.
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                       
                                       i
                                    
                                    ⊕
                                    B
                                    =
                                    
                                       {
                                       
                                          z
                                          |
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      s
                                                   
                                                
                                                )
                                             
                                             
                                                z
                                             
                                          
                                          ∩
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             i
                                          
                                          ≠
                                          ∅
                                       
                                       }
                                    
                                 
                              
                           
                        where 
                           
                              B
                              =
                              
                                 {
                                 
                                    (
                                    
                                       0
                                       ,
                                       0
                                    
                                    )
                                 
                                 }
                              
                           
                         and 
                           
                              
                                 B
                              
                              s
                           
                         denotes the symmetric or supplement of B. 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              
                              1
                           
                         denotes the jth identified cell seed in Section 2.2.


                        Step 14: Immediately following each dilation, compute the intersection of the dilated cell with the binarized edge image SE
                         computed in Section 2.1.
                           
                              (30)
                              
                                 
                                    S
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ∩
                                    
                                       
                                          S
                                       
                                       
                                          E
                                       
                                    
                                 
                              
                           
                        
                     

If the size of the intersection S is greater than the predefined value, 10, break the loop started in Step 1. If not, repeat Step 1 and Step 2 until 
                           
                              S
                              >
                              10
                           
                        .


                        Step 15: Extract the boundary of the dilated cell seed by the following equation.
                           
                              (31)
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                       
                                       i
                                    
                                 
                              
                           
                        
                     


                        Step 16: Repeat Steps 13–15 for the next identified cell seed until all the seeds are processed.

Please note that the proposed fast method works because the seeds are obtained by erosion while it tries to dilate the seeds back to their original sizes.

@&#EXPERIMENTAL RESULTS@&#

To verify the superiority of the developed threshold selection method over the state of art threshold selection methods in segmentation accuracy, we firstly compared the developed method with the popular Otsu׳s method and fuzzy entropy method. A specific example from case 1 which occurs most frequently in muscle cell images is shown in 
                        Fig. 2 and 
                        Fig. 3 respectively. For the threshold selection process, the carmine line denotes the original histogram distribution and the green line denotes the smoothed histogram probability distribution. The blue line denotes the local peaks of the slope difference distribution that are originally greater than zero. The red line denotes the local peaks of the slope difference distribution that are originally smaller than zero and are reversed to be greater than zero with a minor sign. The blue crosses correspond to the blue peaks and denote the peaks of the histogram distribution. The red circles correspond to the red peaks and denote the valleys of the histogram distribution. The blue asterisk in Fig. 2(b) corresponds to the benchmark threshold Tb
                        . The blue asterisk in Fig. 2(e) corresponds to the optimal threshold To
                        . In Fig. 2, the identified cells are 25 with 100% accuracy rate with the developed threshold selection method. The numbers of the identified cells are respectively 20 for Otsu׳ method (80% accuracy rate) and 18 for fuzzy entropy method (72% accuracy rate) as shown in Fig. 3.

We show another example from case 2 in 
                        Fig. 4 and 
                        Fig. 5 respectively. There is a missed identification out of 128 cells for the proposed method. There are 8 missed identifications for the Otsu based method and there are 2 missed identifications for the fuzzy entropy based method. Both the developed threshold selection method based identification results and the fuzzy entropy method based identification results have an incorrect identification.

To show the superiority of the proposed threshold selection method to the state of art threshold selection methods [20–34], we tested all the available thresholding methods on two example gradient images from case 1 and case 2 respectively and the results are shown in 
                        Fig. 6 and 
                        Fig. 7. As can be seen, the proposed method could segment the edges of the gradient images more completely than state of art methods and thus the segmented cells in the opposite images are separate more completely, which facilitate the subsequent iterative erosion step. From Fig. 6 and Fig. 7, we see that cross entropy method [34], fuzzy c-means method [30] and the soft method [29] have better segmentation results than other methods. Hence, we show the final identification results by these methods in 
                        Fig. 8 and 
                        Fig. 9 to compare with the results by the proposed method. The proposed method has 100% accuracy in identifying the cells in the first image while the other three methods have accuracy less than 92%. The proposed method has 0 missing rate in identifying the cells in the second image and 0.5% wrong identification rate while the other methods have at least 3.5% missing rate and 0.5% wrong identification rate.

To show the superiority of the proposed border delineation method over GVF method [17, 36], we show their results on the two example images from case 1 and case 2 in 
                        Fig. 10. As can be seen, the GVF method is inclined to be affected by the noise blobs in the image while the proposed method is not. In addition, the proposed method is significantly more efficient than GVF method from the MATLAB simulation results.

To show the superiority of the proposed method over active contour method [15,16], we show the results of applying active contour [37] on the two examples in 
                        Fig. 11. As can be seen, the active contour stops undesirably without propagating along all the edges and that explains why only parts of the cells in the image are identified in [15]. In [16], the seeds of the cells are annotated manually before applying active contour, which requires a lot of labor. In addition, the authors of [17] focus on comparing the GVF delineation results with those by AxioVision instead of evaluating the challenging segmentation and identification problems.

In this section, we give more results of identified cells from different types of muscle cells to validate the effectiveness of the proposed method. The identification results are shown in 
                        
                        
                        
                        Figs. 12–15. As can be seen, the identification accuracy appears to be good.

The quantitative measure is defined as follows. If there is one and only one identified cell inside each “ground-truth” boundary, it is counted as true positive (TP); if there are more than one identified cell inside each “ground-truth” boundary, the extra ones are counted as false positives (FP); if there is none, it is counted as a false negative (FN). One hundred skeletal muscle cell images (with the total number of cells/fibers over 5000 compared to 679 in [15] and about 2000 in [17]) are used for the calculation of the quantitative results. The computed TP is 93.4%; the computed FP is 0.18%; the computed FN is 6.6%. To compare with the state of art threshold selection methods, we choose the cross entropy method and fuzzy c-means method for comparison because of their relatively better performance over other state of art methods in this research work. When changing the proposed threshold selection method to the cross entropy method, the computed TP is 85.6%; the computed FP is 1.2%; the computed FN is 13.2%. When changing the proposed threshold selection method to the fuzzy c-means method, the computed TP is 84.7%; the computed FP is 1.4%; the computed FN is 13.9%.

@&#DISCUSSION@&#

Three challenging problems exist in muscle cell segmentation. (1), not all cells are convex and their shapes are irregular. (2), the sizes of the cells vary greatly. (3), there are noise blobs. The first two problems inspirit us to design effective and practical iterative erosion method based on the ultimate erosion theorem. The last problem urges us to come up with the proposed threshold selection method to guarantee the pre-segmentation to be accurate and the useful information is retained as completely as possible.

The major contributions of this paper include:

1) To solve the bottleneck problem of segmentation accuracy for muscle cell images, we utilize and evolve the proposed threshold selection method in [19], which is based on the histogram distribution of the image. We decomposed the histogram distribution into different layers with different details by Fourier transform. As a result, the optimal threshold could be selected based on the practical needs. Its effectiveness in segmenting muscle cell images and muscle cell gradient images is validated in this paper, which represents a breakthrough in segmentation accuracy by threshold selection method for some specific classes of images. Experimental results showed that using the proposed threshold selection method for segmentation, the cell identification rate is increased significantly compared to those using other threshold selection methods for segmentation.

For the AxionVision software, the object is outline directly using the mouse or the threshold is selected manually based on the histograms, which requires a certain amount of experience of the user [38]. For the Metamorph software, the upper and lower limits for the threshold range needs to be selected carefully and the user needs to preview a measurement several times using different threshold ranges to be sure that the measurement will be based on an accurate segmentation [39]. Compared to them, the advantage of the proposed threshold selection method is automatic, efficient and robust.

2) A novel iterative erosion method is proposed based on the ultimate erosion theorem. It utilizes an online computed area threshold to constrain the erosion process and achieves much better identification accuracy than ultimate erosion.

For the AxionVision software, the user needs to choose to erode, dilate or watershed options manually to separate the connected cells [38]. For the Metamorph software, this issue is not addressed [39]. Compared to them, the proposed method is more efficient.

3) A novel border delineation method is proposed based on the morphological dilation, which is significantly efficient than GVF method in delineating the borders of the muscle cells.

4) Compared to the state of art methods [15–17], the proposed method appears to be superior when both efficiency and accuracy are considered. In [17], the authors pointed out that “In our test, Cyteseer failed to segment many testing images, especially those images exhibiting poor quality with weak boundaries and high background, leading us to conclude that in our hands, Cyteseer does not perform as well as our algorithm.”, which indicates that the Cyteseer software lacks robustness in many cases. On the contrary, the proposed method is capable of segmenting all the tested images with considerable accuracy.

@&#CONCLUSION@&#

In this paper, a new method is proposed to segment and identify different types of muscle cells or fibers. It utilizes the general property of muscle cell/fiber images: intensity and edge, to achieve the generalized effectiveness in so many types of muscle cell images. The proposed method was validated by the experimental results and it has the potential to benefit more cell segmentation applications in the future.

None declared.

@&#REFERENCES@&#

