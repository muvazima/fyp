@&#MAIN-TITLE@&#Solving the dynamic capacitated location-routing problem with fuzzy demands by hybrid heuristic algorithm

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A dynamic capacitated location-routing problem with fuzzy demands is proposed.


                        
                        
                           
                           A fuzzy chance-constrained programming formulation is given for the problem.


                        
                        
                           
                           To solve the problem, a hybrid heuristic algorithm with four phases is proposed.


                        
                        
                           
                           The performance of the proposed method, is examined using GAMS 24.0.2.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Routing

Location

Location-routing problem

Fuzzy demand

Credibility theory

@&#ABSTRACT@&#


               
               
                  In this paper, the dynamic capacitated location-routing problem with fuzzy demands (DCLRP-FD) is considered. In the DCLRP-FD, facility location problem and vehicle routing problem are solved on a time horizon. Decisions concerning facility locations are permitted to be made only in the first time period of the planning horizon but, the routing decisions may be changed in each time period. Furthermore, the vehicles and depots have a predefined capacity to serve the customers with altering demands during the time horizon. It is assumed that the demands of customers are fuzzy variables. To model the DCLRP-FD, a fuzzy chance-constrained programming is designed based upon the fuzzy credibility theory. To solve this problem, a hybrid heuristic algorithm (HHA) with four phases including the stochastic simulation and a local search method are proposed. To achieve the best value of two parameters of the model, the dispatcher preference index (DPI) and the assignment preference index (API), and to analyze their influences on the final solution, numerical experiments are carried out. Moreover, the efficiency of the HHA is demonstrated via comparing with the lower bound of solutions and by using a standard benchmark set of test problems. The numerical examples show that the proposed algorithm is robust and could be used in real world problems.
               
            

@&#INTRODUCTION@&#

Due to the fact that customers’ demand is showing an upward trend with competitive prices and a lesser waiting time is desired for receiving the goods, it makes logistics the main issue in supply chain management (Zare Mehrjerdi & Nadizadeh, 2013). In recent years, the efficient, reliable, and flexible decisions on location of depots and the distribution routings are of vital importance for managers (Karaoglan, Altiparmak, Kara, & Dengiz, 2012; Nadizadeh, Sahraeian, Sabzevari Zadeh, & Homayouni, 2011). Many researchers indicated that if the routes are ignored while locating the depots, the costs of distribution systems might be immoderate (Karaoglan, Altiparmak, Kara, & Dengiz, 2011; Martínez-Salazar, Molina, Ángel-Bello, Gómez, & Caballero, 2014). Salhi and Rand (1989) first showed that the solving of the location problem without route consideration may lead to a sub-optimal solution. The location-routing problem (LRP) overcomes this drawback by simultaneously considering the location and routing decisions (Guerrero, Prodhon, Velasco, & Amaya, 2013; Hashemi Doulabi & Seifi, 2013; Jarboui, Derbel, Hanafi, & Mladenović, 2013).

The LRP can be defined as a combination of two problems of facility location problem (FLP) and vehicle routing problem (VRP) Escobar, Linfati, and Toth (2013), Lopes, Plastria, Ferreira, and Beatriz Sousa (2014), Stenger, Schneider, Schwind, and Vigo (2012). Since both problems belong to the class of NP-hard problem, the LRP is also an NP-hard problem (Barreto, Ferreira, Paixao, & Sousa Santos, 2007; Belenguer, Benavent, Prins, Prodhon, & Wolfler-Calvo, 2011; Samanlioglu, 2013). In the LRP, customer demands must be satisfied, vehicle capacities should not be exceeded, and the minimization of facility fixed and operating costs, as well as of routing costs have to be realized (Rieck, Ehrenberg, & Zimmermann, 2014). Laporte (1988) was the first researcher who discussed and classified the LRP models. Min, Jayaraman, and Srivastava (1998) reviewed the LRP literature using a hierarchical classification based on the problem characteristics such as the number of depots, the capacity of depots and vehicles, and the form of the objective function. Nagy and Salhi (2007) also performed a comprehensive literature review on the LRP models, solution approaches, application areas and some future works.

Recently, Prodhon and Prins (2014) analyzed the new literature on the standard LRP and new extensions such as several distribution echelons, multiple objectives or uncertain data. They also compared the results of state-of-the-art meta-heuristics on standard sets of instances for the classical LRP, the two-echelon LRP and the truck and trailer problem.

The LRP is applicable to a wide variety of fields such as food and drink distribution, newspapers delivery, waste collection, drug distribution, bill delivery, military applications, parcel delivery, relief goods distribution in natural disaster, and various consumer goods distribution (Ceselli, Righini, & Tresoldi, 2014; Manzour-al-Ajdad, Torabi, & Salhi, 2012; Rath & Gutjahr, 2014; Ting & Chen, 2013). In capacitated location-routing problem (CLRP), the problem is constrained with the vehicles and the depots capacities. The objectives in CLRP are to determine the location of depots and a set of customers to be assigned by each depot as well as the distribution routes (Baldacci, Mingozzi, & Wolfler Calvo, 2011; Contardo, Cordeau, & Gendron, 2013; Contardo, Hemmelmayr, & Crainic, 2012). Since CLRP is an NP-hard problem, most of papers in the field of CLRP are focused on only new solution methods that are often based on heuristic or meta-heuristic approaches (Nguyen, Prins, & Prodhon, 2012; Yu, Lin, Lee, & Ting, 2010). Some reviews on solution approaches of CLRP exist in the literature that can be found in Duhamel, Lacomme, Prins, and Prodhon (2010) and Derbel, Jarboui, Hanafi, and Chabchoub (2012).

The dynamic location-routing problem is a very important area of the LRP which has not been addressed much in the literature. The static (single-period) LRP is very much prone to the criticism that the planning horizons of the location and routing do not match. In other words, the LRP integrates the strategic (location) and tactical (routing) levels. Locational decisions are usually quite stable in time, because of implementation costs and set-up times. On the other hand, routing decisions (even master tour decisions at a tactical level) are more often changed than location decisions, especially when they refer to the transportation of goods to customers with varying demands (Albareda-Sambola, Fernández, & Nickel, 2012). Therefore, by considering a planning horizon for facility location that contain shorter planning intervals for route planning, dynamic LRPs are a much better model of real-life location problems with routing aspects and provide an important means of refuting the above criticism (Nagy & Salhi, 2007).

In this paper, the dynamic capacitated location-routing problem with fuzzy demands (DCLRP-FD) is considered. In the DCLRP-FD, depots can only be opened at the beginning of the planning horizon and remain unchanged throughout the planning horizon. On the other hand, the routing of vehicles can be changed at each period due to fluctuations of demands. The vehicles and depots have a limited capacity to serve the customers that their demands change in each time period. Moreover, it is assumed that the demands of customers are fuzzy variables. A fuzzy chance-constrained programming is designed based upon the fuzzy credibility theory to model the DCLRP-FD. The high complexity of this problem makes it impossible to be solved in practice with commercial software. For this reason, a hybrid heuristic algorithm (HHA) with four phases including the stochastic simulation and a local search method are proposed to solve the problem. To the best of our knowledge, this paper is the first work in the field of LRP that consider both the planning horizon and uncertainty for the customers’ demand.

The remainder of this paper is organized as follows: In the next section, the literature review of the work is presented. In Section 3, some basic concepts of fuzzy theory are given. Section 4 defines the DCLRP-FD in more details and presents a fuzzy chance-constrained programming model using the credibility theory. Details of the hybrid heuristic algorithm to solve the DCLRP-FD are presented in Section 5. In Section 6, different numerical experiments are given to reveal the performance of the proposed algorithm. In the final section, the conclusion remarks of the paper are presented.

@&#LITERATURE REVIEW@&#

The first effort on dynamic LRP dates back to the research of Laporte and Dejax (1989). They considered multiple planning periods for the LRP, whereby in each period both the locations and the routes may be changed. They presented an ingenuous network representation of the problem. The resulting network optimization problem was solved by exact and heuristic approaches. Salhi and Nagy (1999) assumed that the depots were fixed throughout the planning horizon but the vehicle routes changed following changes in customers’ demand. It was also assumed that the customer set did not change. In their work, a number of solution approaches were investigated. Ambrosino and Scutella (2005) considered a multi-level LRP with static and dynamic planning horizons and applied commercial software to solve the integer linear programming (ILP) formulation of the problem. Prodhon (2011) considered the periodic location-routing problem. The objective of the problem was to determine the set of depots to be opened, the combination of service days to be assigned to customers and the routes originating from each depot for each period of the horizon, in order to minimize the total cost. To solve large size instances of the periodic location-routing problem, a hybrid evolutionary algorithm was proposed. The algorithm was hybridized with a heuristic based on the randomized extended Clarke and Wright algorithm to create feasible solutions. Finally, the proposed method was evaluated over three sets of instances and the results showed that it outperforms the previous methods. Albareda-Sambola et al. (2012) presented the multiperiod location-routing problem with decoupled time scales. Their problem was defined over a finite time horizon, in which location and routing decisions were made at different time scales. They also assumed that locations could be opened or modified only in some selected time periods of the planning horizon and then they remain unchanged during the time periods between them. Due to the complexity of the model, they proposed an approximation based on replacing vehicle routes by spanning trees, and its capability for providing good quality solutions was assessed in a series of computational experiments.

Dynamic problems divide the planning horizon into multiple periods. Normally within the planning horizon there is some uncertainty about some of the parameters (typically the customers’ demand). In this paper, it is assumed that the demands of customers in each time period are not known and they are considered as fuzzy variables. This means that the information about demand at each customer is often not precise enough. For example, based on experience, it can be concluded that demand of a customer is “around 50 units”, “between 20 and 60 units”, etc. A problem under uncertainty may be modeled using various approaches such as using fuzzy variables. Whether to use fuzzy or stochastic variables in a model directly depends on the semantic of the problem and also the availability of reliable data. Although many problems can be modeled using stochastic variables, there are some reasons in which it becomes almost impossible or irrational to use stochastic variables, such as: there are not enough data to be used to model the problem and, the available data is not reliable and error-prone (Fazel Zarandi, Hemmati, Davari, & Turksen, 2013). Therefore, while the use of probability theory is cumbersome and costly, fuzzy logic can be worthwhile in these cases.

Recently fuzzy logic has been used to solve many different problems. The need to use fuzzy logic in problems arises whenever there are some vague or uncertain parameters. Credibility theory has been used in many problems with fuzzy parameters so far, in parallel with some meta-heuristics (see Zare Mehrjerdi & Nadizadeh, 2013). There are some works on the CLRP with fuzzy variables in the literature of CLRP. The work of Zarandi, Hemmati, and Davari (2011) is the first attempt to model the CLRP using fuzzy variables and credibility theory along with a meta-heuristic technique as a tool for solving the problem. They presented a CLRP in which travel time between two nodes was a fuzzy variable and the problem was solved using simulated annealing (SA) approach. Their proposed method was tested using a standard test problem of CLRP and the results showed that the method was robust and could be used in real world problems. In the second work, Fazel Zarandi et al. (2013) considered the location-routing problem with time windows under uncertainty. They assumed that demands of customers and travel times were fuzzy variables. In their work, a fuzzy chance-constrained programming model was designed using credibility theory and a simulation-embedded SA algorithm was presented in order to solve the problem. To initialize solutions of SA, a heuristic method based on fuzzy c-means clustering with Mahalanobis distance and sweep method was employed. They attested the proposed solution approach with some numerical experiments. In next work, Zare Mehrjerdi and Nadizadeh (2013) considered the CLRP with fuzzy demands. They modeled the problem with a fuzzy chance-constrained programming based upon the fuzzy credibility theory. To solve this problem, a greedy clustering method (GCM) including the stochastic simulation was proposed. In the proposed GCM, iterative and clustering approaches were used to solve the problem. To obtain the best value of the parameter of the model and to analyze its influence on the final solution, numerical experiments were carried out. Consequently, to show the performance of their proposed method, associated results were compared with the lower bound of solutions. In work of Ghaffari-Nasab, Ghazanfar Ahari, and Ghazanfar (2013), the location-routing problem with fuzzy demands (LRP-FD) was considered, and a fuzzy chance-constrained program was designed to model it, based on the fuzzy credibility theory. A hybrid SA based heuristic incorporated with stochastic simulation was developed and proposed to solve the problem. The efficiency of the solution procedure was demonstrated via comparing its performance with those of some other existing solution procedures from literature using a standard benchmark set of test problems.

The concept of fuzzy set was initiated by Zadeh (1965) via the membership function and applied to the wide varieties of real problems thereafter. To measure a fuzzy event, the term fuzzy variable was proposed by Kaufmann (1975) and later Zadeh (1978) proposed the possibility measure theory of fuzzy variable. Although, possibility measure has been widely used, it has no self-duality property. However, a self-dual measure is absolutely necessary in both theory and practice. In order to define a self-dual measure, a modified form of the possibility theory called credibility theory was introduced by Liu (2004) and studied very recently by many scholars all around the world. Since a fuzzy version of dynamic CLRP with credibility theory will be modeled in this paper, a brief introduction on the basic concepts and definitions used are presented as follows:

Let Θ be a nonempty set, and P the power set of Θ. Each element in P is called an event, and ϕ is an empty set. In order to present an axiomatic definition of possibility, it is necessary to assign a numberPos{A} to each event A, which indicates the possibility that A will occur. To ensure that the number Pos{A} has certain mathematical properties, the following four axioms are approved (Liu, 2004):
                        Axiom 3.1
                        Pos{Θ}=1;

Pos{ϕ}=0;

For each 
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 p
                                 (
                                 Θ
                                 )
                                 ,
                                 
                                 Pos
                                 
                                    
                                       
                                          
                                             
                                                ∪
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                A
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       supremum
                                    
                                    
                                       i
                                    
                                 
                                 Pos
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 ;
                              
                           
                        

If Θi
                            is a non-empty set, and the set function Pos
                              i
                           {};
                           i
                           =1, 2, …, n, satisfies above three axioms, and Θ
                           =
                           Θ
                           1
                           ×
                           Θ
                           2
                           ×⋯×
                           Θn
                           , then for each A
                           ∈
                           p(Θ), 
                              
                                 Pos
                                 {
                                 A
                                 }
                                 =
                                 
                                    
                                       supremum
                                    
                                    
                                       (
                                       
                                          
                                             θ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                            Pos1{θ
                           1}∧Pos2{θ
                           2}∧
                           …Pos
                              n
                           {θn
                           }.

The above four axioms form the basis of credibility measure theory, all concepts of credibility theory can be obtained from them (Liu, 2004).
                        Definition 3.5
                        (Liu, 2004)


                        Let (Θ, P(Θ), Pos) be a possibility space, and A be a set in p(Θ), then the necessity measure of A is defined by Nec{A}=1−Pos{Ac
                           }, that Ac
                            is the complement of event A.

Let (Θ, P(Θ), Pos) be a possibility space, and A be a set in p(Θ), then the credibility measure of A is defined by 
                              
                                 Cr
                                 {
                                 A
                                 }
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                            (Pos{A}+Nec{A}).

Considering definition 3.6, the credibility of a fuzzy event is defined as the average of its possibility and necessity. A fuzzy event may fail even though its possibility achieves 1, and hold even though its necessity is 0. However, the fuzzy event must hold if its credibility is 1, and fail if its credibility is 0 (Liu, 2004). As mentioned before, the credibility measure is self-dual, and in the theory of fuzzy subsets, the law of credibility plays a role similar to that played by the law of probability in measurement theory for ordinary sets (Erbao & Mingyong, 2010).

Now consider a triangular fuzzy variable 
                        
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                           =
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                           )
                        
                      for demand of a customer that 
                        
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                        
                      is described by its left boundary d
                     1, and its right boundary d
                     3. Thus, the dispatcher or analyst studying that problem can subjectively estimate, based upon his experience and intuition and/or available data, the demand of the customer will not be less than d
                     1 or greater than d
                     3. The value of d
                     2 corresponding to a grade of membership of 1 can also be determined by a subjective estimate. If the actual demand of a customer is considered by the value of r, the possibility, necessity, and credibility are easily obtained as follows (Erbao & Mingyong, 2009):
                        
                           (1)
                           
                              Pos
                              
                              {
                              
                                 
                                    d
                                 
                                 
                                    ̃
                                 
                              
                              ⩾
                              r
                              }
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      r
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩽
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩾
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              Nec
                              
                              {
                              
                                 
                                    d
                                 
                                 
                                    ̃
                                 
                              
                              ⩾
                              r
                              }
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      r
                                                   
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩽
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩾
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              Cr
                              
                              {
                              
                                 
                                    d
                                 
                                 
                                    ̃
                                 
                              
                              ⩾
                              r
                              }
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      -
                                                      r
                                                   
                                                   
                                                      2
                                                      (
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ⩽
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      r
                                                   
                                                   
                                                      2
                                                      (
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ⩽
                                                r
                                                ⩽
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                r
                                                ⩾
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the DCLRP-FD, there is a time horizon with multiple periods. In each time period, the demand of each customer should be supplied by a single vehicle, while the total load of each route must not exceed the capacity of the vehicle. The routes start and end to the same depot and the total load of all allocated customers to a depot must be less than or equal to the capacity of that depot. At the beginning of the time horizon, the number of available vehicles and candidate depots are determined. Vehicles that are heterogeneous and have the maximum travel distance can just take one tour in each time period. Furthermore, each vehicle has an availability level that varies within [0,1] in each time period. This means that a vehicle can serve some customers in part time of each period. The main objective of the problem is to minimize the total cost of the system, taking the costs of depot, routing costs and lost opportunity costs due to the lack of serving capacity into consideration.

In the DCLRP-FD, in addition to the above assumptions, the customers’ demand at each period is a triangular fuzzy number such as 
                        
                           
                              
                                 d
                              
                              
                                 ̃
                              
                           
                           =
                           (
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                           )
                           .
                        
                      To model the problem with credibility theory, the fuzzy number representing demand at the jth customer of the tth period is denoted by 
                        
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                           =
                           (
                           
                              
                                 d
                              
                              
                                 1
                                 j
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 2
                                 j
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 d
                              
                              
                                 3
                                 j
                              
                              
                                 t
                              
                           
                           )
                        
                     . Let each vehicle have a limited capacity that is denoted by Qk
                     . After serving the first c customers at period t, the available capacity of the vehicle will equal 
                        
                           
                              
                                 Q
                              
                              
                                 kk
                              
                           
                           =
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                           -
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 c
                              
                           
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                        
                      in which Qkk
                      is also a triangular fuzzy number by using the rules of fuzzy arithmetic, and
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    kk
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             3
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                             j
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              (
                              
                                 
                                    q
                                 
                                 
                                    1
                                    ,
                                    kk
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    2
                                    ,
                                    kk
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    3
                                    ,
                                    kk
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        
                     the credibility that the next customer demand does not exceed the remaining capacity of the vehicle can be obtained as follows:
                        
                           (4)
                           
                              Cr
                              =
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             c
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             Q
                                          
                                          
                                             kk
                                          
                                       
                                    
                                 
                              
                              =
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       0
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             c
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             Q
                                          
                                          
                                             kk
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            3
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            3
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            2
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      3
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            1
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            2
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            2
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            1
                                                            ,
                                                            kk
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      1
                                                      ,
                                                      kk
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Similarly, let the capacity of ith candidate depot is given by Pi
                     . After allocating c customers to the ith depot, the available capacity of the depot at period t will equal 
                        
                           
                              
                                 P
                              
                              
                                 ii
                              
                           
                           =
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           -
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 c
                              
                           
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 j
                              
                              
                                 t
                              
                           
                        
                      in which Pii
                      is also a triangular fuzzy number by using the rules of fuzzy arithmetic, and
                        
                           
                              
                                 
                                    P
                                 
                                 
                                    ii
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             3
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                c
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             1
                                             j
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              =
                              (
                              
                                 
                                    p
                                 
                                 
                                    1
                                    ,
                                    ii
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    2
                                    ,
                                    ii
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    3
                                    ,
                                    ii
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        
                     the credibility that the next allocated customer demand does not exceed the remaining capacity of the depot can be shown as follows:
                        
                           (6)
                           
                              Cr
                              =
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             c
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             P
                                          
                                          
                                             ii
                                          
                                       
                                    
                                 
                              
                              =
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       ⩽
                                       0
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             c
                                             +
                                             1
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             P
                                          
                                          
                                             ii
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            3
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            3
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            1
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      1
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                      ×
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            3
                                                            ,
                                                            c
                                                            +
                                                            1
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                            ,
                                                            ii
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      2
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      2
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      3
                                                      ,
                                                      c
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                      ,
                                                      ii
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

There is no doubt that if the remaining goods in the vehicle is high and the demand at the next customer is low, then the vehicle’s chance of being able to finish the next customer’s service become greater. This means that the greater the difference between available goods and demand at the next customer, the greater preference to send the vehicle to serve the next customer. According to formulation (5), the preference index is designated by Cr which denotes the magnitude of the preference for sending the vehicle to the next customer after it served current customer. It is obvious that Cr
                     ∈[0, 1]. When Cr
                     =0 driver is completely sure that he should return the vehicle to the depot. When Cr
                     =1, the driver is absolutely certain that he can serve the next customer by the remaining goods having in his vehicle. Let the dispatcher preference index designated by DPI, where DPI
                     ∈[0, 1]. So, according to the DPI value and the credibility that the next customer demand does not exceed the remaining capacity of the vehicle, a decision must be made as to whether to send the vehicle to the next customer or return that to the depot. Thus, if relation Cr
                     ⩾
                     DPI is fulfilled, then the vehicle should be sent to the next customer; otherwise, the vehicle should be returned to the depot, and go back again to the next customer after loading sufficient goods. The process does not terminate until all of the customers’ demands are fulfilled.

Similarly, in formulation (7) if the depot’s remaining capacity for serving customers is high and the demand at the next customer being low, then the depot’s chance of being able to serve the next customer become greater. This means that the greater the difference between the available capacity of the depot and the demand at the next customer, the greater the preference to allocate the next customer to the depot for receiving the service. The preference index is designated by Cr with the value of Cr
                     ∈[0,1]. When Cr
                     =0, then the depot manager is completely sure that he should not accept the next customer for giving the service. On the other hand, when Cr
                     =1, the depot manager is absolutely certain that he can serve the next customer. Let the assignment preference index for allocating customers to a depot is designated by API, API
                     ∈[0,1]. So, according to the API value and the credibility that the next customer demand does not exceed the remaining capacity of the depot, a decision must be made as to whether to allocate it to the current depot or the next opened depot should accept it. Thus, if the relation Cr
                     ⩾
                     API is fulfilled, then the depot should serve the next customer; otherwise, the customer should receive service from another opened depot. This procedure does not end until all of the customers are allocated.

Moreover, the vehicle routes (or planned routes) are designed in advance by applying the proposed hybrid heuristic algorithm. But, the actual value of demand of a customer is only known when the vehicle reaches the customer. Due to demand uncertainty at the customers, a vehicle might not be able to serve a customer once it arrives there due to insufficient capacity when the vehicle implements the planned route. It is assumed that in such situations the vehicle returns to the depot to load itself and then returns to the customer where it had a “failure” and continue its service along the rest of the planned route and its maximum traveling distance. This results in an additional distance due to route failure. Hence, an additional distance should be considered for the vehicle due to the “failure” arises at some customers’ locations along the route when evaluating the planned route (Erbao & Mingyong, 2009).

Both parameters DPI and API which are empirically determined have an extremely great impact on both the total length of the planned routes and on the additional distance. For example, lower values of parameter DPI express the dispatcher’s desire to use vehicle capacity the best he can. These values result in shorter planned distances. But lower values of parameter DPI increase the number of circumstances where a vehicle meet a customer but is unable to serve that, thereby increasing the total distance it covers due to the “failure”. In this work, stochastic simulation is used to evaluate the additional distance due to route failure. On the other hand, higher values of parameter DPI are characterized by less utilization of vehicle capacity along with less additional distance to cover due to failures. Moreover, it requires a greater number of vehicles at high DPI value and it may be due to the unavailability of vehicles, the cost of lost opportunity increases due to the lack of customer service. As a result, the sensitive parameters DPI and API significantly influence the sum of planed route lengths, additional distances and lost opportunity costs that should be determined properly.

The following notations are used to represent the mathematical programming formulation for the DCLRP-FD.


                     Sets and parameters:
                        
                           
                              I: Set of candidate depots indexed by i and I
                              ={1,2,…,
                              M}, that M is the number of depots.


                              J: Set of customers indexed by j and J
                              ={1,2,…,
                              N}, that N is the number of customers.


                              V: Set of all depots and customers: V
                              =
                              I
                              ∪
                              J and V
                              ={1,2,…,
                              M,
                              M
                              +1,
                              M
                              +2,…,
                              M
                              +
                              N}.


                              E: Set of arcs (i, j) connecting every pair of nodes i, j
                              ∈
                              V.


                              K: Set of vehicles indexed by k and 
                                 
                                    K
                                    =
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          K
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                              , that 
                                 
                                    
                                       
                                          K
                                       
                                       
                                          ‾
                                       
                                    
                                 
                               is the number of available vehicles.


                              T: Set of time periods indexed by t and 
                                 
                                    T
                                    =
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          ‾
                                       
                                    
                                    }
                                 
                              , that 
                                 
                                    
                                       
                                          T
                                       
                                       
                                          ‾
                                       
                                    
                                 
                               is the number of periods.


                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                              : Demand of customer j at period t.


                              Pi
                              : Capacity of ith depot.


                              Qk
                              : Capacity of kth vehicle.


                              Oi
                              : Fixed cost of opening a depot at the candidate site i.


                              Fk
                              : Fixed cost of employing the vehicle k.


                              Cij
                              : Traveling cost associated with arc (i, j)∈
                              E.


                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                              : Cost of the lost opportunity for the lack of serving to customer j at period t.


                              sj
                              : Serving time to customer j.


                              fk
                              : Additional distances of vehicle k.


                              D: Maximum travel distance of vehicles.


                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                 
                              : Availability level of vehicle k at period tin which 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                    ∈
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              .


                     Decision variables:
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if vehicle
                                                
                                                k
                                                
                                                at period
                                                
                                                t
                                                
                                                goes directly from customer
                                                
                                                i
                                                
                                                to customer
                                                
                                                j
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                other wise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    Y
                                 
                                 
                                    ij
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if in period
                                                
                                                t
                                                
                                                the demand of customer
                                                
                                                j
                                                
                                                is served by the depot
                                                
                                                i
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                other wise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if a depot at candidate site
                                                
                                                i
                                                
                                                is opened
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                other wise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 U
                              
                              
                                 jk
                              
                              
                                 t
                              
                           
                        
                     
                     =Auxiliary variables for sub-tour elimination constraints in route k.

The corresponding fuzzy chance-constrained programming (FCCP) formulation of the DCLRP-FD based upon the credibility theory is demonstrated in (8)–(21):
                        
                           (8)
                           
                              Minimize
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    O
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                ∈
                                                K
                                             
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             ijk
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              Minimize
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                           
                        
                     Subject to
                        
                           (10)
                           
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             ijk
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             Q
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                              ⩾
                              DPI
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (11)
                           
                              Cr
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ̃
                                                
                                             
                                          
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             Y
                                          
                                          
                                             ij
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             Z
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              ⩾
                              API
                              
                              ∀
                              
                              i
                              ∈
                              I
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       ∈
                                       K
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              
                              j
                              ∈
                              J
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    U
                                 
                                 
                                    lk
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    U
                                 
                                 
                                    jk
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    NX
                                 
                                 
                                    ljk
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              N
                              -
                              1
                              
                              ∀
                              
                              l
                              ,
                              j
                              ∈
                              J
                              ;
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    jik
                                 
                                 
                                    t
                                 
                              
                              =
                              0
                              
                              ∀
                              
                              i
                              ∈
                              V
                              ;
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       I
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       ∈
                                       J
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    iuk
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       u
                                       ∈
                                       V
                                       ⧹
                                       {
                                       j
                                       }
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    ujk
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              1
                              +
                              
                                 
                                    Y
                                 
                                 
                                    ij
                                 
                                 
                                    t
                                 
                              
                              
                              ∀
                              
                              i
                              ∈
                              I
                              ;
                              
                              ∀
                              
                              j
                              ∈
                              J
                              ;
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       V
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       V
                                    
                                 
                              
                              (
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              )
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    f
                                 
                                 
                                    k
                                 
                              
                              ⩽
                              
                                 
                                    A
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              D
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    X
                                 
                                 
                                    ijk
                                 
                                 
                                    t
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              
                              i
                              ∈
                              V
                              ;
                              
                              ∀
                              
                              j
                              ∈
                              V
                              ;
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 
                                    Y
                                 
                                 
                                    ij
                                 
                                 
                                    t
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              
                              i
                              ∈
                              I
                              ;
                              
                              ∀
                              
                              j
                              ∈
                              J
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              
                              i
                              ∈
                              I
                           
                        
                     
                     
                        
                           (21)
                           
                              
                                 
                                    U
                                 
                                 
                                    jk
                                 
                                 
                                    t
                                 
                              
                              ∈
                              {
                              N
                              ∪
                              0
                              }
                              
                              ∀
                              
                              j
                              ∈
                              J
                              ;
                              
                              ∀
                              
                              k
                              ∈
                              K
                              ;
                              
                              ∀
                              
                              t
                              ∈
                              T
                           
                        
                     
                  

The objective function (8) represents the sum of the fixed depot location costs, the fixed costs of employing vehicles, the travel costs, total cost of the lost opportunities, respectively. The objective function (9) shows the total additional travel distances. Note that, the total additional travel distances of vehicle k, denoted by fk
                     , can be obtained by stochastic simulation algorithm in Section 5.4.2. Fuzzy chance constraints (10) and (11) assure that all customers are visited within vehicle capacity and are allocated within depot capacity with a confidence level, respectively. Constraints (12) stated that each customer should be served within one route only and it has only one customer connected in its predecessor, if it received the service. The sub-tour elimination constraints are assured in (13). The continuity of the routes and return to the original depot is guaranteed through constraints (14). Constraints (15) ensure every vehicle k could be used in each time period once. Constraints (16) ensure that a customer must be assigned to a depot if there is a route connected to it. Constraints (17) express the limitation of travel distance of vehicles. Note that, the service times should be transformed to the distance scale in constraints (17). Constraints (18)–(20) specify the binary variables used in the formulation and finally, auxiliary variables taking positive values are declared in (21).

A hybrid heuristic algorithm (HHA) is presented in this section to solve the DCLRP-FD. In general, HHA consists of four phases in each time period, which is illustrated in Fig. 1
                     . In the first phase, the depots are selected between the candidate depots sites based on the coordination of customers (Fig. 1(a)). In the second phase, customers are clustered using a greedy search algorithm (Fig. 1(b)). The clusters are allocated to the opened depot(s) in the third phase, considering the distance between the depots and the gravity center of the clusters as well as the capacity of the depots (Fig. 1(c)). Finally, in the fourth phase, ant colony system (ACS) forms an admissible tour between each cluster and depot (Fig. 1(d)). In this phase, the stochastic simulation is used to determine the demands of customers and a local search method is applied to evaluate the opened depot(s) in the first phase.

The problem is initialized by defining a plane comprising the set of depots, M, customers, N, and their coordinate points. The hybrid heuristic algorithm is repeated for a predefined number of iterations. When algorithm obtains a better solution, it is replaced to the last best known solution. Moreover, since in the second phase of HHA, the first customer in each cluster is selected randomly, clusters formed in each iteration of the proposed algorithm are different together. Furthermore, a local search method is applied to assess the performance of the opened depot(s). Thus, the proposed algorithm can search some feasible solutions among all the solution space. This can ensure that HHA avoid confining sub-optimal solutions. Details of HHA are described in the following sections.

As mentioned before, at the beginning of the planning horizon of the DCLRP-FD, the proper depot(s) should be opened and should be fixed during the planning horizon. Thus, the first phase of the HHA searches among the potential sites to establish the depot(s). First, the sum of distances between the locations of customers and each potential depot is calculated. The Euclidean distance is calculated by Eq. (22). In this equation, wi
                         is the total Euclidean distance between potential depot i and the locations of customers, (xi
                        , yi
                        ) is the coordinates of potential site i, (aj
                        , bj
                        ) is the coordinates of customer j, N is the number of customers, and M is the number of potential depots.
                           
                              (22)
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       /
                                       2
                                    
                                 
                                 
                                 ∀
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                        
                     

For each potential depot, the amount of factor 
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          i
                                       
                                    
                                    ×
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         is calculated. In this factor, Pi
                         and Oi
                         are the capacity and fixed cost of ith depot, respectively and wi
                         is the amount of Eq. (22). After that, the depots are sorted in descending order and ranked from 1 to M. Finally, the top-ranked potential depot, that has the maximum amount of 
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          O
                                       
                                       
                                          i
                                       
                                    
                                    ×
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        , is selected to be established. The number of depots that should be opened in this phase depends on the total upper bound of fuzzy demands. To perform this, the value of 
                           
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    3
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         is calculated for each period of t and the maximum value of dt
                        , denoted by d
                        ∗, is then selected. Consequently, the depots in sorted list should be opened one by one until the total capacity of the opened depots can support the value of d
                        ∗. It is important to note that, the depots established by the mentioned procedure in this phase, will be evaluated by a local search method in the fourth phase.

The second phase of the HHA is the clustering of the customers. The customers are grouped considering their intra distance, their fuzzy demands and the capacity of the vehicles. A greedy search algorithm is used to form a cluster of customers. At first, to form a cluster, a customer is selected randomly from the set of non-clustered customers belongs to N. The algorithm searches for the nearest customer to the last selected customer of the current cluster. The nearest customer is not assigned to the cluster if its demand exceeds the remaining capacity of the vehicle, considering the DPI value and the credibility of the customer. When a new customer is selected to be assigned to a cluster, total fuzzy demand of current members of the cluster is calculated and compared to the capacity of the vehicle. If the relation Cr
                        ⩾
                        DPI is fulfilled (according to the formulation (10)), the new customer is allowed to assign to the current cluster. Otherwise, last selected customer is withdrawn from the cluster. The greedy search algorithm searches for a new customer closest to the last added member of the cluster among the ungrouped customers. This procedure helps to use the maximum capacity of a vehicle. The algorithm forms a new cluster if there is no customer to be assigned to current cluster considering the capacity of vehicle and fuzzy demand of customers. When there is no unassigned customer, the process of clustering stops. Fig. 2
                         illustrates the greedy search algorithm in each period.

It is important to note that, since the capacity of vehicles is not equal (i.e., vehicles are heterogeneous), the clustering of customers may be different together in terms of the number of customers and the total demands in each cluster. In this phase, the fixed cost of the vehicles, denoted by Fk
                        , is used to determine which vehicles type should be selected earlier. To perform this, the vehicles based on their fixed costs are sorted in ascending order from 1 to 
                           
                              
                                 
                                    K
                                 
                                 
                                    ‾
                                 
                              
                           
                         (
                           
                              
                                 
                                    K
                                 
                                 
                                    ‾
                                 
                              
                           
                         is the number of available vehicles). After that, by a greedy search algorithm, the clusters of customers are formed one by one according to the vehicles’ capacity of sorted list. Then, each vehicle that has a higher rank in sorted list serve the cluster formed based on its capacity and similarly, next ranked vehicles support their clusters. In this case, the available vehicles may not be able to serve all customers due to the low number, lack of capacity, or limitation of the maximum travel distances, causes that the cost of lost opportunity arises.

In the third phase of HHA, the clusters are respectively allocated to the ranked depots. Each depot serves as many clusters as possible, based on the API value and the credibility that the next cluster demand does not exceed the remaining capacity of the depot. To allocate the clusters, the Euclidian distance of gravity center of each cluster to the top-ranked depot is calculated. The gravity center of each cluster is calculated according to Eq. (23), in which (a
                        (
                        
                           C
                        
                        ), b
                        (
                        
                           C
                        
                        )) is the coordinates of the gravity center of cluster C, (aj
                        , bj
                        ) is the coordinates of customer j, and nC
                         is the number of customers assigned to cluster C.
                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                (
                                                C
                                                )
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                (
                                                C
                                                )
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      C
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      ∈
                                                      C
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      C
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Afterwards, the unassigned clusters are ranked in an ascending order based upon the distance of their gravity centers to the depot. The top-ranked cluster is allocated to the top-ranked depot, if the relation Cr
                        ⩾
                        API is fulfilled (according to the formulation (11)). If there is an empty capacity for the top-ranked depot, the second-ranked cluster is allocated to the depot considering the above relation. The allocation process to a depot will be finished when there is not enough capacity to allocate new cluster. In this situation, the allocating procedure is repeated for the next-ranked depot until all clusters are allocated.

In the fourth and last phase of the HHA the routing problem is solved for each cluster together with the relevant depot. The routing problem of the DCLRP-FD is the same as traveling salesman problem (TSP), which is solved by using ACS. In addition, the stochastic simulation to determine the actual demand of customers and a local search method to evaluate the opened depots is used in this phase that explained as follows.

ACS is referred to ants’ treatment to find food (Dorigo, Maniezzo, & Colorni, 1996). The ants spread a material called pheromone and put it on their way so that other ants can pass the same route. The pheromone of shorter route increases due to lower evaporation and therefore more ants move from that way. Artificial ants construct a solution by selecting a customer to visit sequentially until all the customers in a route are visited. Ants select the next customer to visit using a combination of heuristic and pheromone information. A local updating rule is applied to modify the pheromone on the selected route, during the construction of a route. When all ants construct their tours, the amount of pheromone of the best selected route and the global best solution, are updated according to the global updating rule. More details on ACS can be found in Bouhafs, Hajjam, and Koukam (2010), Gambardella, Montemanni, and Weyland (2012).

As mentioned before, the demand of each customer is a triangular fuzzy number, so it cannot be directly considered as a deterministic number like other algorithms that solve the deterministic CLRP. Since the real value of demand is identified as the vehicle reaches the customer, the simulation experiment is used to determine the deterministic value of each customer demand. Moreover, for each feasible planned route that the solution of the HHA stands for, additional distances due to route failures (fk
                           ) are obtained by a stochastic simulation algorithm.

To reveal the “actual” demand of each customer, the following stochastic simulation with four steps is proposed:
                              
                                 •
                                 
                                    Step 1: For each customer in each time period, estimate the additional distances by simulating “actual” demands. The “actual” demands were generated by following processes: (1) randomly generate a real number d in the interval between the left and right bounds of the triangular fuzzy number representing demand of the customer, and compute its membership m; (2) generate a random number r; r
                                    ∊[0,1]; (3) compare r and m, if r
                                    ⩽
                                    m, then “actual” demand of the customer is adopted as d; otherwise, it is not accepted that the demand of the customer equals d. In this case, random numbers d and r are generated again and again until random numbers d and r are found such that relation r
                                    ⩽
                                    m is satisfied; (4) check and repeat (1) till (3), and terminate the process when each customer in each time period has a simulation “actual” demand quantity.


                                    Step 2: For each time period, move along the route designed by ACS and calculate the additional distance due to route failures in terms of the “actual” demands.


                                    Step 3: Repeat Steps 1 and 2 R times. In this work, the proper value of R is considered 400 after some computational experiments.


                                    Step 4: For each time period, compute the average additional distances that comes out of simulation, and return it as the additional distance.

Note that, the routing cost of the DCLRP-FD consists of two amounts: additional distances and planned routes distances. In the DCLRP-FD, each planned routes distances between the depots and allocated clusters are obtained by ACS and additional distances are calculated by stochastic simulation algorithm.

At the end of the routing phase, a local search method is presented to assess the depots opened in the first phase. In fact, by swapping of opened depot(s) with closed depots, the local search method tries to improve the quality of solutions. In order to decrease the solving time of evaluating of the opened depot(s), half of the closed depots sorted in the first phase are used as a neighborhood in the local search method. When a better depot in the neighborhood is obtained, it can be replaced with the current opened depot. The details of the local search method are shown by a flowchart in Fig. 3
                           .

In this section, some numerical experiments are given to show the performance of the DCLRP-FD’s model and the efficiency of the HHA. In the first experiment, to evaluate the sensitivity of the parameter DPI, different size of instances is considered to conduct computational experiments. It is assumed that there are 30 customers and 5 candidate depots for a small size instance and 100 customers and 7 candidate depots for a large size instance. In two instances, the coordinates of all customers and depots are generated randomly in [100×100]. Furthermore, six time periods are considered in two test instances and the fuzzy demands of customers in each time period, which are triangular fuzzy numbers such as 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              =
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                    j
                                 
                                 
                                    t
                                 
                              
                              )
                              ,
                           
                         are selected randomly. In such a way, 
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    d
                                 
                                 
                                    3
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         are generated within [10,35], [36,60] and [61,110], respectively. The number of vehicles available is 5 and 10 for small and large-size test instances, respectively. Moreover, in two instances, the availability level of each vehicle is considered 1, the capacity of vehicles and depots are selected equally and maximum travel distances of each vehicle are given 240 in each time period. The relative data for two test instances are listed in Table 1
                        . Note that, in Table 1, the serving and loading times of vehicles are expressed based on the distance scale. Consequently, the name of each instance can be summarized as the number of potential depots, |I|,the number of customers, |J|, the number of time periods, 
                           
                              |
                              
                                 
                                    T
                                 
                                 
                                    ‾
                                 
                              
                              |
                              ,
                           
                         and the number of vehicles, 
                           
                              |
                              
                                 
                                    K
                                 
                                 
                                    ‾
                                 
                              
                              |
                           
                        , (i.e., 
                           
                              |
                              I
                              |
                              ×
                              |
                              J
                              |
                              ×
                              |
                              
                                 
                                    T
                                 
                                 
                                    ‾
                                 
                              
                              |
                              ×
                              |
                              
                                 
                                    K
                                 
                                 
                                    ‾
                                 
                              
                              |
                           
                        ).

The HHA is encoded in MATLAB 7.10.0 on a computer, holding Intel® Core™ Duo CPU T2450 2.00gigahertz and 1.00gigabyte of RAM. The value of DPI varied with the interval of 0.1–1 with a step of 0.1. In this section, the value of API is considered 1 due to only the effect of DPI is studied. In next section the effect of two parameters DPI and API have been considered together. The average computational results of 10 times are given in Tables 2 and 3
                        
                         for small and large size instances, respectively. The columns of the tables respectively labeled: the dispatcher preference index, the planned routes, the additional distances, the routing costs that include the planned routes and additional distances, the lost opportunity costs, the depot costs, the vehicle costs, the total costs that consist of routing costs as well as lost opportunity, depots and vehicles costs. The last column also shows the CPU time of solutions. For convenience, the results of Tables 2 and 3 are depicted by Figs. 4 and 5
                        
                        , respectively. As is shown in Tables 2 and 3 and also in Figs. 4 and 5, when the value of dispatcher preference index equals 0.6, the total cost has a minimum value.

According to Figs. 4 and 5, lower values of parameter DPI denote a tendency to use total vehicle capacity. These values are associated with the routes with the shorter planned distances. Furthermore, lower values of parameter DPI increase the number of cases in which vehicles visit customers but are unable to serve them, thereby increase the total additional distance due to the “route failure”. Higher values of parameter DPI are characterized by less utilization of vehicle capacity along with less additional distance to cover due to failures. Moreover, at high DPI value, to ensure high delivery of service to customers, the decision maker considers fewer customers for each cluster so that increases the number of clusters. In addition, because each cluster is supported by one vehicle, the cost of employing the vehicle may be high due to the unavailability of vehicles, so that the cost of lost opportunity will be increased. Consequently, the proper DPI value is approximately around 0.6, considering the total cost.

In this section the effect of two parameters DPI and API on solving the model is investigated simultaneously. Tables 4 and 5
                        
                         show the summarized results of two instances described in Section 6.1. In first and second columns of Tables 4 and 5, the values of DPI and API varied with the interval of 0.2–1 with a step of 0.2, respectively. Next other columns of Tables 4 and 5 are similar to Tables 2 and 3. As shown in last column of Tables 4 and 5 by bold number, when the value of the dispatcher preference index equals 0.6 and the value of assignment preference index equals 1, the total cost has a minimum value.

It is noted that, when the value of API grows, it ensures that the depot is more able to respond to customers’ demand. On the other hand, establishment of more depots or depots with high capacity can provide high confidence for supporting more customers. As seen in Table 4, for each constant value of DPI, when the API value has increased, the cost (or the number) of deploying the depots is also grown.

To evaluate the efficiency of the HHA, showed in Tables 2–5, the results are compared with lower bounds of solutions. Since no research has been done in the literature of the DCLRP-FD so far, it is impossible to compare the HHA results with the previous works. Hence, a straightforward way to determine the quality of the solutions is through the construction of “lower bound”. On the other hand, a simple way of creating a lower bound is through the relaxation of some assumptions that problem is based upon or the constraint(s) used in the model building of the problem.

In this work, to obtain the lower bound, the assumption of fuzzy demand of customers is ignored and the demand of each customer in each time period is set to its left boundary. In other words, the problem of the DCLRP-FD changes to DCLRP in such a way that the left boundary of the triangular fuzzy demand is considered as the demand of each customer (i.e., 
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         instead of 
                           
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              =
                              (
                              
                                 
                                    d
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                    j
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        ). To do so, the constraints (10) and (11) in the model are changed as follows:
                           
                              (24)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          V
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ijk
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 
                                 ∀
                                 
                                 k
                                 ∈
                                 K
                                 ;
                                 
                                 ∀
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       1
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 
                                 ∀
                                 
                                 i
                                 ∈
                                 I
                                 ;
                                 
                                 ∀
                                 
                                 t
                                 ∈
                                 T
                              
                           
                        
                     

Clearly, when the left boundary of fuzzy demands are considered as the deterministic demands of customers, the total demand of customers is decreased as compared with a case in which the demands are fuzzy. Moreover, fewer total demands result in less utilization of depots and vehicles and then less total cost. Thus, considering the 
                           
                              
                                 
                                    d
                                 
                                 
                                    1
                                    j
                                 
                                 
                                    t
                                 
                              
                           
                         as the demand of customer j in time period t, it can provide a lower bound for the DCLRP-FD’s solution. Table 6
                         shows the lower bound of the two test problems as well as a summary of the results in terms of the quality of solutions and the computational solution times. The first column gives the size of test instances, which has been explained in Section 6.1. The next three columns summarize the quality of solutions consists of HHA solution, lower bound obtained by a commercial solver (i.e., GAMS 24.0.2), and the gap between them. Note that, the column named HHA solution is obtained from the total cost of Tables 4 and 5 with DPI of 0.6 and API of 1, which have the minimum total costs among other DPI and API values. The gap percentage for each instance is also computed as 100×[(HHA−Lower bound)/Lower bound]. The last three columns of Table 6 indicate the CPU time of HHA solution, GAMS solution and the gap between them calculated as 100×[(GAMS−HHA)/HHA].

Considering Table 6, GAMS was unable to solve the 7×100×6×10 instance and the solution was not found after 8hour of running time. Consequently, as seen in Table 6, the proposed HHA is more efficient in comparison to GAMS solver in terms of not only CPU times of solution (i.e.,1429.6% and 113.4% for small and large-size problems, respectively), but also being able to solve large-size instances.

To obtain a proper lower bound for the large-size instance, the size of 7×100×6×10 is reduced to 1×100×6×10. Because in this specific instance, only one depot is opened (Tables 3 and 5: Depot costs=100.0), by opening each candidate depot exactly once and solve the problem (i.e., repeat 7 times of solving the problem size 100×6×10 or solving 7 times VRP) the lower bound solution can be found. Table 7
                        , that their columns are similar to Table 6, shows the summarized results of solving 7 times VRP for the 7×100×6×10 instance. As seen in Table 7, by reducing the size of instance, the lower bound of it with value of 7046.2 and the gap of 18% is obtained.

Further results of the numerical experiment for evaluating the efficiency of HHA and the performance of DCLRP-FD’s model is shown in Table 8
                        . Table 8 consists of 9 standard test instances that exist in the literature of CLRP with single-period planning (Ghaffari-Nasab et al., 2013; Prodhon, 2010). To use the standard test instances of CLRP in case of DCLRP-FD, some changes on CLRP instances are required. The following heuristic steps show the process of changing a CLRP instance to a DCLRP-FD one:
                           
                              •
                              
                                 Step 1: At first, the deterministic demand of each customer transforms to a triangular fuzzy demand as follows: (1) consider the deterministic demand of each customer in the CLRP as the left boundary of fuzzy demand in DCLRP-FD; (2) calculate the right boundary of fuzzy demand by triple the left boundary obtained from (1); (3) consider a random number in the range of 1.5–2.5 times of the left boundary as the middle number of triangular fuzzy demand.


                                 Step 2: For six planning periods (i.e., 
                                    
                                       |
                                       
                                          
                                             T
                                          
                                          
                                             ‾
                                          
                                       
                                       |
                                       =
                                       6
                                    
                                 ), do step 1 for calculating of customers’ demand in each period.


                                 Step 3: Consider the maximum right boundaries of fuzzy demands of all customers as D
                                 3j (i.e., 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             3
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             max
                                          
                                          
                                             j
                                             ∈
                                             J
                                          
                                       
                                       {
                                       
                                          
                                             d
                                          
                                          
                                             3
                                             j
                                          
                                       
                                       }
                                    
                                 . Compare D
                                 3j with the vehicle capacity of the CLRP instance denoted by Q. If the relation 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             3
                                             j
                                          
                                       
                                       ⩽
                                       Q
                                    
                                  is satisfied, then consider Q as the vehicle capacity of the DCLRP-FD instance. Otherwise, consider D
                                 3j as the vehicle capacity of the DCLRP-FD instance.


                                 Step 4: Triple the depot’s capacity of the CLRP instance and consider that as the depot’s capacity of DCLRP-FD instance.

According to above steps, it is clear when the left boundaries of fuzzy demands of DCLRP-FD instance are equal with the demands of CLRP instance, the solution of CLRP instance will be as a lower bound for the solution of DCLRP-FD instance. Table 8 shows the summary of results on several standard test instances. First column of the table indicates the name of standard test instances on CLRP that can be found in Barreto et al. (2007) and Prins, Prodhon, and Wolfler Calvo (2006). Next column shows the optimal solutions obtained from the algorithms in the literature of CLRP. Note that, since six-period planning problem is considered for the DCLRP-FD, the optimal solutions of second column also have been six times. The solutions obtained by HHA with DPI value of 0.6 and API value of 1 are shown at the next four columns. The last column of Table 8 indicates the gap of costs between HHA and optimal solutions. As seen and expected in Table 8, it is clear that the solution of CLRP for each instance is a lower bound for the solution of DCLRP-FD.

Since the logistics costs often represent a large portion of the expenses of companies, facility location and vehicle routing are crucial. In the management decisions of the logistics, facility location problems and vehicle routing problems are interdependent and most of the time, they are considered separately. The location-routing problem (LRP) overcomes this drawback by simultaneously tackling facility location problem and vehicle routing problem. Nowadays, there are many literatures to research LRP, but most of them have focused on single time period and deterministic parameters.

This paper contributed to the dynamic capacitated location-routing problem with fuzzy demands. A fuzzy chance-constrained programming formulation was given for the problem. To solve the problem, a hybrid heuristic algorithm (HHA) with four phases was proposed. The additional distances due to fuzzy demands and route failures were estimated by stochastic simulation for each planned route. In the HHA, a local search method is also applied to evaluate the performance of the opened depot(s) and to improve the quality of the solution. For obtaining the best sensitive parameters of the model, two test instances with different size which are compatible with real data were generated. The computational experiments showed that the dispatcher preference index (DPI) greatly influences the planned routes’ length, additional distance, lost opportunity and fixed cost of vehicles. Moreover, another experiment indicated that the assignment preference index (API) has more influences on fixed cost of depots. Furthermore, to show the efficiency of the proposed HHA, the lower bound of the solutions was created and computed by the commercial solver of GAMS 24.0.2. Finally, numerical experiments with standard test instances of CLRP with some changes were carried out to show the performance of the model and the efficiency of the proposed algorithm.

In the proposed HHA, both iterative and clustering-based approaches are used and the second phase of it can be strengthened with improvement procedure such as swapping or re-assignment methods (i.e., 2-Opt or 3-Opt). More future researches could be as: (a) considering the model with pickup and delivery demands, (b) developing the model under more realistic assumptions, e.g. considering a stochastic function for the parameter of availability level (i.e., 
                        
                           
                              
                                 A
                              
                              
                                 k
                              
                              
                                 t
                              
                           
                        
                      in constraints of (17) be stochastic).

@&#ACKNOWLEDGEMENTS@&#

The authors wish to thank the reviewers for their valuable comments who helped us to improve this research.

@&#REFERENCES@&#

