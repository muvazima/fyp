@&#MAIN-TITLE@&#A bilateral analysis scheme for false positive reduction in mammogram mass detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The proposed region matching method using shape context is robust to segmentation error.


                        
                        
                           
                           Matching cost is defined to quantify the matching credibility, which is discarded by existing bilateral analysis schemes.


                        
                        
                           
                           A hierarchical similarity is designed for FP reduction in bilateral mass detection.


                        
                        
                           
                           Promising FP reduction is obtained using bilateral analysis in mass detection.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bilateral analysis

Mammogram

Mass detection

Similarity measurement

Region matching

@&#ABSTRACT@&#


               
               
                  In this paper, a bilateral image analysis scheme is developed for the purpose of reducing false positives (FPs) in the detection of masses in dense mammograms. It consists of two steps: a region matching step for determining the correspondence between a pair of mammograms, and a bilateral similarity analysis step for discarding FPs in the detection. For the first step, a matching cost is defined to quantify the credibility of the corresponding region in a pair of bilateral mammograms. For the second step, a similarity measurement is introduced to discriminate between mass and normal for a pair of bilateral regions based on both global and local image appearances. The proposed scheme is tested on a set of 332 mammograms. The results show that the proposed scheme could obtain better performance when compared with several existing bilateral analysis schemes. With detection sensitivity at 85%, the proposed bilateral scheme could reduce the FP rate of a unilateral scheme from 3.64 to 2.39 per image, a 34% reduction.
               
            

@&#INTRODUCTION@&#

Breast cancer is a leading cause of death among women in developed countries. The morbidity of breast cancer is increasing with a fast speed in developing countries due to the increase of life expectancy, urbanization, and change in lifestyles [1]. For example, China is among such countries where the incidence growth of breast cancer is fast increasing. Unfortunately, only 20% of the breast cancer patients are diagnosed at the early stage [2]. As the cause of breast cancer is not clearly known, early detection remains the cornerstone in breast cancer treatment [3].

Mass is one of the main signs of breast cancer. A mass is a space-occupying lesion which usually exhibits higher intensity compared with fat tissues in a mammogram. The distinction between normal and mass has been largely a difficult task for the radiologists, as masses can be subtle at an early stage and exhibit a great variability in margins, shapes, and sizes. In dense breasts, masses are overlapped with glandular tissues and may be falsely diagnosed as normal, which are called false negatives (FNs). Also, glandular tissues may be compressed in a mammogram exam, exhibiting similar characteristics as masses. In such a case, they may be falsely diagnosed as masses, which are called false positives (FPs). The difficulty in detection has led to the development of computer-aided detection (CAD) schemes for the purpose of providing a second opinion [4].

In the clinics, radiologists may compare mammograms of the left and right breasts to identify abnormalities and avoid FP regions when interpreting mammograms, which can be called bilateral analysis. The basic idea of bilateral analysis is that the corresponding regions in a pair of bilateral mammograms in the same view are often similar for normal tissue and dissimilar for a mass [5]. For a mass region of interest (ROI) in one mammogram, when its corresponding ROI is normal tissue in the contralateral mammogram, we call it a mass-to-normal pair. For a normal ROI, when its corresponding ROI is also normal in the contralateral mammogram, we call it a normal-to-normal pair.

In this paper, a bilateral image analysis scheme is proposed for the purpose of reducing FPs in the detection of masses in dense mammograms, which consists of two steps. First, a region matching step is used to determine the correspondence between a pair of bilateral mammograms. Matching cost is defined and calculated to evaluate the matching credibility. This information is discarded by existing bilateral analysis schemes. Then a similarity analysis step is used to discriminate between mass-to-normal pairs and normal-to-normal pairs for detected ROIs. The similarity measurement between bilateral ROI pairs is based on both global and local image features.

The rest of the paper is organized as follows. Section 2 reviews some related work in bilateral mass detection. Section 3 descrbes the proposed region matching procedure for bilateral mammogram pairs. Section 4 furnishes the similarity measurement for discriminating between mass-to-normal pairs and normal-to-normal pairs. Section 5 presents the overall FP reduction scheme. Experiment results are given in Section 6, and conclusions are given in Section 7.

@&#RELATED WORK@&#

There are two important issues in a bilateral analysis scheme for FP reduction. One is how to find the matching region for a detected ROI in a contralateral mammogram. The other is how to determine the level of similarity between the detected ROI and its contralateral matched ROI.

For the first issue of finding contralateral correspondence, a number of methods have been studied. One type of such methods is to apply image registration so that the contralateral mammogram is registered to the object mammogram. Trbalić [6] used an interpolation method with thin-plate splines. Then this interpolation was integrated into an intensity-based non-rigid registration approach to find corresponding regions in the two mammograms. Mohanalin [7] described a mammogram registration method using mutual information measurement based on Tsallis entropy. It was demonstrated that Tsallis entropy could achieve better registration results compared with Shannon entropy. Another mammogram registration method was given in [8]. However, explicitly warping the images in registration could produce undesirable image artifacts [9].

Different from the registration-based warping approach described above, another type of methods for finding corresponding regions in bilateral mammograms is region matching. In this type of methods, the centroid of the corresponding region was found based on some reference points. The matched region was defined as the region with the matched centroid and same size with detected ROI. Region matching methods avoided the need to warp the images and the registration artifacts could be avoided. Méndez [10] used nipple and breast boundary as reference points to find the matched regions, where the nipple locations were used to determine the amount of translation and the points along the breast boundary were used to determine the angle of rotation. In Stamatakis [11], the point with maximum curvature on the breast profile was selected as the reference point. In Wirth [12], a set of points on the breast contour was employed as the reference points. Then a multiquadric radial basis function (RBF) was used to determine the matched region in the contralateral mammogram. Wu [5] used the nipple as the reference point and constructed a polar coordinate system. Brandt [8] used the pectoral muscle, the nipple and the shape of the breast boundary as reference points for region matching in mediolateral oblique (MLO) or mediolateral (ML) mammograms. One issue in some of these region matching methods was that the reference points need to be manually drawn in order to ensure matching accuracy.

For measuring the similarity level between a detected ROI and its contralateral ROI, Georgsson [13] used both absolute image intensity difference and statistical intensity difference. Maitra [14] employed a histogram based distance to measure the image similarity. Wu [5] extracted texture features from gray level co-occurrence matrix (GLCM) and morphological features to discriminate mass-to-normal pairs and normal-to-normal pairs. Tzikopoulosa [15] extracted a set of statistical features for each breast to detect breast asymmetry. Wang [16] and Tan [17] computed image features related to the bilateral tissue asymmetry to predict the breast cancer risk. One difficulty in some of these similarity measurements is that each mass contour needs to be drawn, which can be particularly problematic in dense mammograms.

Overall, there are two challenges in a bilateral mass detection scheme. First, the matching accuracy of the contralateral correspondence region is difficult to determine. When a correspondence region is wrong, it would adversely affect the performance of bilateral analysis. Second, accurately segmenting each mass contour is difficult to achieve in dense mammograms. And the similarity measurement did not have high discriminating ability between mass-to-normal pairs and normal-to-normal pairs without accurately segmenting the mass contour.

To address these two issues, we proposed a region matching scheme and a matching similarity measurement for bilateral mass detection. First, a matching cost was defined to assess the matching credibility. When the region matching was determined to be acceptable, bilateral analysis was used; otherwise, unilateral analysis was used. Second, a hierarchical similarity measurement combining both global and local image features was designed, which did not need mass segmentation. This similarity measurement was shown to have higher discriminating ability in mass-to-normal pairs and normal-to-normal pairs compared with several existing similarity measurements.

In order to find the matched region in the contralateral mammogram, a new region matching method was put forward. The main advantage of the proposed region matching method was that matching cost was defined and calculated to assess the matching credibility. Matching cost could tell if the matched region was correct or not, thus avoiding bilateral analysis on incorrect corresponding regions. This region matching method contained three parts: region division, correspondence calculation and matching cost calculation. Layer segmentation was used for region division. For correspondence calculation, control points were first selected and matched using shape context. Then correspondences of these points were employed to drive a position transform matrix. Finally the centroid of the matched ROI was found under this transform matrix and matching cost was computed.

The reason for dividing the whole breast region into sub-regions is that matched error may be large when finding the matched regions in the whole breast. Intuitively, region matching becomes faster and more accurate if the searching area is reasonably local.

Based on the analysis mentioned above, the whole breast was divided into a set of layers based on the breast profile. As the breasts were compressed, the further the regions from the breast boundary, the more difference the position between the region and its matched one is. Therefore, when the region is near the breast boundary, the width of the layer should be small. When the region is far from the boundary, the width of the layer should be big.

All mammograms were divided into five layers experimentally. The width of each layer is determined by the width of a breast and its position. The outermost layer representing the region near the breast boundary is the thinnest. The innermost layer representing the region far from the breast boundary is the widest. Let the width of the breast be w
                        b, then the width of each layer, w(i), is:
                           
                              (1)
                              
                                 w
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       i
                                       
                                          
                                       
                                       
                                          
                                             w
                                          
                                          
                                             b
                                          
                                       
                                    
                                    α
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 5
                                 .
                              
                           
                        
                     

In (1), α is the width interval parameter. Its value is determined by the number of layer, such that the sum of all layers is approximately to be w
                        b. In our experiment, the number of layer is 5. Thus, α equals 15. The details of layer segmentation were as follows:
                           
                              Step 1: Segment the mammogram to a two-value image bw
                                 0;

Step 2: Iteratively apply morphology operation erosion onto the two-value image under a disk structure with a radius of w(i) and obtain a set of two-value image bw
                                 
                                    i
                                 .

Step 3: When i is in the range from 1 to 4, the layer image with a layer width of w(i) is obtained by subtracting bw
                                 
                                    i
                                  from bw
                                 
                                    i−1. When i equals 5, the layer image is bw
                                 5.

An example of layer segmentation result is shown in 
                        Fig. 1. After layer segmentation, region matching and matching cost calculations were performed using shape context in each layer individually.

Existing research have shown that rich descriptors reduced the ambiguity in correspondence calculation. Shape context [18] was a descriptor showing the position relationship of one point to all the other points. It contained very rich information and was robust to small segmentation error of the breast profile. Thus shape context distributed over different relative positions was selected to find matched regions and define matching cost in the contralateral mammogram.

The bins in shape context were different combinations of distance r and angle θ. In distance domain, a log operator was applied to r, making the influence of nearby points larger and faraway points smaller. In angle domain, uniform interval was applied. So the bins were defined as uniform space in log(r) and θ domain. An example of bins with 4 intervals in log(r) and 8 intervals in θ is shown in 
                        Fig. 2. The shaded area in (a) and (b) are one of the bins.

Consider a set of points P={
                           p
                        
                        1, …, 
                           p
                        
                        
                           n
                        }. The shape context for point 
                           p
                        
                        
                           i
                         is calculated as:
                           
                              (2)
                              
                                 h
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 k
                                 )
                                 =
                                 #
                                 {
                                 p
                                 ∈
                                 P
                                 |
                                 d
                                 (
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ∈
                                 b
                                 i
                                 n
                                 (
                                 k
                                 )
                                 ,
                                 p
                                 ≠
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                        where d(
                           p
                        ,
                           p
                        
                        
                           i
                        ) is the coordinate distance between point 
                           p
                         and point 
                           p
                        
                        
                           i
                        . d has two elements, magnitude and angle. Now point 
                           p
                        
                        
                           i
                         is represented by the shape context, hs
                        
                           i
                        . It is a K-length vector. K equals N
                        
                           r
                        ×Φ. N
                        
                           r
                         is the number of distance intervals. Φ is the number of angle intervals.

Usually normalization was applied to hs as in (3) to make the range of hs from 0 to 1.
                           
                              (3)
                              
                                 h
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       h
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       k
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          K
                                       
                                       
                                          h
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          k
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

For different layers, the deformations of the tissue are different and hence the correspondences are different. To solve this problem, region correspondence and matching cost calculation were performed in each layer individually. Correspondence calculation was implemented in two steps. First, correspondence of control points was calculated using shape context. Second, a position transform matrix was driven based on the correspondence of control points.

Skeleton points from the same layer in the bilateral mammograms were used to define control points individually. To guarantee that the number of control points in the bilateral mammograms was the same, we uniformly sampled the two set of skeleton points from the same layer to a size of n and called the sampled points as control points. Control points on the detected mammogram are treated as the reference point set P={
                           p
                        
                        1, …, 
                           p
                        
                        
                           n
                        }. Control points on the contralateral mammogram are defined as the floating point set Q={
                           q
                        
                        1, …, 
                           q
                        
                        
                           n
                        }. An example of control points from the same layer in the bilateral mammograms is shown in 
                        Fig. 3. The blue lines indicate the skeleton points. The red circles are the sampled points, called control points.

Now we want to find a point 
                           q
                        
                        
                           M(i) in Q that best matches the point 
                           p
                        
                        
                           i
                         in P for every 
                           p
                        
                        
                           i
                        . Define the cost of mapping point 
                           q
                        
                        
                           j
                         to point 
                           p
                        
                        
                           i
                         as C(
                           p
                        
                        
                           i
                        , 
                           q
                        
                        
                           j
                        ). For a simplification, let C(i, j)=C(
                           p
                        
                        
                           i
                        , 
                           q
                        
                        
                           j
                        ). As 
                           p
                        
                        
                           i
                         and 
                           q
                        
                        
                           j
                         are represented by their shape context, a reasonable C(i, j) is defined as the χ
                        2 distance, given by (4).
                           
                              (4)
                              
                                 C
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    K
                                 
                                 
                                    
                                       
                                          
                                             
                                                [
                                                h
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                k
                                                )
                                                −
                                                h
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      j
                                                   
                                                
                                                (
                                                k
                                                )
                                                ]
                                             
                                             2
                                          
                                       
                                       
                                          h
                                          
                                             
                                                s
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          k
                                          )
                                          +
                                          h
                                          
                                             
                                                s
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          k
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The mapping relationship, M, between 
                           p
                        
                        
                           i
                         and 
                           q
                        
                        
                           j
                         should satisfy the condition that the total mapping cost is minimized, given by (5).
                           
                              (5)
                              
                                 M
                                 =
                                 
                                    
                                       arg
                                       
                                       min
                                    
                                    M
                                 
                                 
                                    {
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          C
                                          [
                                          i
                                          ,
                                          M
                                          (
                                          i
                                          )
                                          ]
                                       
                                    
                                    }
                                 
                              
                           
                        
                     

An additional constraint for Eq. (5) is that the mapping is one-to-one. The solution for (5) can be viewed as linear assignment problem (LAP). We used an efficient algorithm, called LAPJV [19] to solve Eq. (5). Compared with traditional LAP, LAPJV bared new initialization routines and a special implementation of Dijkstra’s shortest path method.

When mapping relationship, M, is solved, the matched points for P is known and denoted as Q
                        
                           M
                        =(
                           q
                        
                        
                           M(1), 
                           q
                        
                        
                           M(2), …, 
                           q
                        
                        
                           M(n)). A position transform matrix for any points could be estimated based on P and Q
                        
                           M
                         in a least square fashion [20]. The affine transform between point 
                           p
                        
                        
                           i
                        =[
                           p
                        
                        
                           i
                        (1), 
                           p
                        
                        
                           i
                        (2)]
                           T
                        ∈R
                        2 and its matched point 
                           q
                        
                        
                           M(i) is given by
                           
                              (6)
                              
                                 
                                    
                                       q
                                    
                                    
                                       M
                                       (
                                       i
                                       )
                                    
                                 
                                 =
                                 F
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 o
                              
                           
                        where F corresponds to rotation and scaling while o represents offset. The details of least square estimation for position transform matrix 
                           (
                           
                              
                                 
                                    
                                       
                                          F
                                          ^
                                       
                                    
                                    
                                       
                                          o
                                          ^
                                       
                                    
                                 
                              
                           
                           )
                         are given in Appendix A.

For a detected mass ROI, its centroid is 
                           v
                        =[
                           v
                        (1), 
                           v
                        (2)]
                           T
                        . The width and height are wid
                        d and hei
                        d, respectively. The centroid of its matched ROI 
                           v
                        
                        m is computed by (7), which is the matched point with 
                           v
                        . As stated by existing region matching method, the size of the matched ROI was defined as the same size with the detected ROI, [wid
                        d, hei
                        d].
                           
                              (7)
                              
                                 
                                    
                                       v
                                    
                                    
                                       m
                                    
                                 
                                 ≡
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   (
                                                   2
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    F
                                    ^
                                 
                                 v
                                 +
                                 
                                    o
                                    ^
                                 
                              
                           
                        
                     

An example of obtaining the matched ROI is shown in 
                        Fig. 4. ROI contained with the rectangle in Fig. 4(a) is the detected mass ROI. ROI contained with the rectangle in Fig. 4(b) is the matched ROI. Their centroids are matched.

We also define the matching cost, MC, to quantify the matching credibility. It is defined as the total cost of the whole matching process, expressed as
                           
                              (8)
                              
                                 M
                                 C
                                 =
                                 
                                    1
                                    n
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    C
                                    [
                                    i
                                    ,
                                    M
                                    (
                                    i
                                    )
                                    ]
                                 
                              
                           
                        
                     

An example of the region matching result is shown in 
                        Fig. 5. Visually, the regions found by the proposed matching method are credible. Also, the matching cost is low for these matched regions. For regions indexed by 1–10, the maximum of matching costs, MCs, is 0.15.

As the matching relationship was driven by shape context, the region matching results may be not good when the two mammograms have different breast profiles. An example is shown in 
                        Fig. 6. The matched region in Fig. 6(b) is not satisfactory. However, matching cost can convey this information. Matching cost for region in Fig. 6 is 0.24, which is higher than that of regions in Fig. 5, showing matched regions in Fig. 6(b) is not credible.

When the matched region in the contralateral mammogram was found, similarity between bilateral ROI pairs was measured to tell if the detected ROI is an FP. A two-layer hierarchal arrangement considering both global appearance and local detail was designed to measure the similarity between bilateral ROI pairs.

Features related to wavelets transform (WT) have displayed good performance in discriminating mass and normal tissue [21]. WT deforms an image into low frequency coefficients and high frequency coefficients. The low frequency part is the approximation of the image. Thus the difference of the low frequency part can measure the image distance under global appearance. The distance between image 
                        I
                     
                     1 and 
                        I
                     
                     2 under global appearance, d
                     WT(
                        I
                     
                     1, 
                        I
                     
                     2), is computed as:
                        
                           (9)
                           
                              
                                 
                                    d
                                 
                                 
                                    WT
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              
                                 1
                                 
                                    h
                                    e
                                    
                                       
                                          i
                                       
                                       
                                          d
                                       
                                    
                                    w
                                    i
                                    
                                       
                                          d
                                       
                                       
                                          d
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          h
                                          e
                                          
                                             
                                                i
                                             
                                             
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             w
                                             i
                                             
                                                
                                                   d
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                −
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where A
                     1 and A
                     2 are the low frequency coefficients in WT for image 
                        I
                     
                     1 and 
                        I
                     
                     2, respectively. Here, one-level ‘sym8’ wavelet decomposition was applied.

Local binary pattern (LBP) [22] operator is effective and efficient for FP reduction in mass detection [23]. The LBP operator labels every pixel of an image by thresholding its surrounding neighbors with the gray value of itself. Then the result of this thresholding is translated to a binary code. When all the pixels have been labeled as LBP codes, the histogram of these labels is computed and used as a descriptor. Conventional LBP is sensitive to noise in the near-uniform image regions. To overcome this problem, local ternary patterns (LTP) [24] was proposed. LTP also used a histogram to represent the image. The details of how to compute LTP histogram is as follows:
                        
                           Step 1: For each pixel, thresholding the surrounding neighbors using a parameter t to a 3-valued number, computed by (10). A proper range for t may be 5 to 8.
                                 
                                    (10)
                                    
                                       s
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             c
                                          
                                       
                                       ,
                                       t
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         ≥
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         +
                                                         t
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         |
                                                         <
                                                         t
                                                         ;
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         ≤
                                                         
                                                            
                                                               i
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         −
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              where i
                              c is the gray value of the center pixel and i
                              u is the gray value of the neighbor.

Step 2: Split the 3-valued number into positive and negative binary parts and treat them as two separate channels.

Step 3: Translate the positive and negative binary parts into a decimal value separately and compute their histograms corresponding to the decimal value.

Step 4: The two histograms are concatenated to from a LTP histogram, h.

LTP can characterize micro patterns in an image and is more resistant to noise. Thus histogram of uniform LTP was selected to measure the image distance under local details. The distance between image 
                        I
                     
                     1 and 
                        I
                     
                     2 under local details is thus defined as:
                        
                           (11)
                           
                              
                                 
                                    d
                                 
                                 
                                    LTP
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              
                                 1
                                 2
                              
                              
                                 
                                    ∑
                                    i
                                 
                                 
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                i
                                                )
                                                −
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                i
                                                )
                                                ]
                                             
                                             2
                                          
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          i
                                          )
                                          +
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          i
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where h
                     1 and h
                     2 are LTP histograms of image 
                        I
                     
                     1 and 
                        I
                     
                     2.

A hierarchical arrangement was designed to combine WT based distance and LTP based distance. The distances were placed at different layers in terms of their importance. The distance placed at the first layer was regarded as the major characteristics. When comparing two objects, global appearance was the first characteristic to interpret according to human eyes. Thus global appearance, d
                     WT, was placed in the first layer and local details, d
                     LTP, was placed in the second layer.

Let T
                     WT be the threshold for distance d
                     WT and T
                     LTP be the threshold for distance d
                     LTP, respectively. A mass candidate will be considered as normal when its d
                     WT and d
                     LTP to its matched ROI are both lower than the thresholds. For candidates that are not satisfied with the threshold criteria, it will be further analyzed. Examples of FP and TP mass candidates are shown in 
                     Fig. 7(a) and (b). For mass candidate in Fig. 7(a), it will be considered as normal as its d
                     WT and d
                     LTP are both lower than T
                     WT and T
                     LTP, respectively. For mass candidate in Fig. 7(b), it will be further analyzed as either d
                     WT or d
                     LTP is higher than its threshold.

The mammograms used in this paper were obtained from the Breast Center of Peking University People’s Hospital (BCPKUPH). This dataset consists of 83 cases. Each case contains one left cranio-caudal (CC) view, one left MLO view, one right CC view and one right MLO view. Thus the total number of mammograms is 332. All these mammograms are full field digital mammograms (FFDM). The resolution of the mammograms is 81.4μm/pixel at 12bit/pixel, with a size of 2816 rows and 2016 columns. To reduce the processing time, the resolution of the mammograms was down sampled to 448μm/pixel with 512 rows and 366 columns. Due to the difference in lifestyle, breasts of Chinese women tend to have high density [25], where the glandular tissue and mass are similar. The density distribution of the whole dataset is shown in 
                        Fig. 8.

Before locating the mass candidates, the breast boundary and pectoral muscle in the MLO mammogram should be segmented first. These segmentations have been implemented in our previous work [26]. Then morphology operators were used to locate mass candidates as follows:
                           
                              Step 1: The mammograms were processed by a top-hat operator with a radius of r
                                 1 to remove tissue whose radius is more than r
                                 1. Then an open operator was added to remove tissue whose radius is less than r
                                 2 
                                 [27]. In this experiment, the minimum mass was with a radius of about 3mm and the maximum mass was with a radius of about 40mm. As the resolution of the mammogram images after donwsampling was 448μm/pixel, r
                                 1 was set as 80 (about 40mm) and r
                                 2 was set as 6 (about 3mm). This can eliminate small and large tissues and preserve mass regions.

Step 2: Local maximums of the processed image are selected as the mass candidates. Some local maximums may correspond to the same mass. To solve this problem, for mass candidates whose distances were closer than a predetermined distance, only the one with a higher gray level was reserved. When the employed distance threshold r
                                 thr is large, the mass with lower gray level may be missed. Thus r
                                 thr is set as 30pixel (about 13mm), experimentally.

Step 3: To get a balance between computation efficiency and detection accuracy, only the top 10 local maximums with higher gray level were selected as the mass candidates. Finally a phase portrait analysis was applied to eliminate some duct or vessel tissues [28].

After FP reduction of bilateral analysis, mass candidates that were very similar to their matched regions were removed. Then the remaining mass candidates were tested by concentric morphology model (CMM) [29] to obtain the final mass detection result. Mass candidate that occupied multiple concentric layers was determined as true mass. There are two reasons for choosing CMM for final mass detection. First, CMM is a morphological model that is relevant to mass growth [29]. Second, there is no need to extract mass contours compared with some region based methods. In dense mammogram, accurately segmenting mass contour is difficult. A scheme for the proposed mass detection scheme using bilateral analysis is shown in 
                        Fig. 9.

The detail steps of the overall method were given below:
                           
                              Step 1: Locate mass candidates by morphology operators.

Step 2: For each mass candidate, find its matched region in the contralateral mammogram and calculate the matching cost MC.

Step 3: If the matching cost, MC, is lower than the cost threshold T
                                 c, the matched region is thought to be correct and will be input to Step 4 for similarity analysis. If MC is higher than the cost threshold T
                                 c, the matched region is thought to be incorrect and will directly go to Step 5 for unilateral analysis.

Step 4: Calculate the distance between the detected region and the matched region under WT and LTP manner. If the WT and LTP based distance are both lower than T
                                 WT and T
                                 LTP, respectively, this mass candidate is determined as normal; else go to Step 5 for unilateral analysis.

Step 5: Calculate the CMM character of the mass candidate. If the mass candidate has more than n
                                 CMM layers, it is determined as a mass; else it is determined as normal.

An example of how the FP regions are removed is shown in 
                        Fig. 10. In Fig. 10, the true mass is indicated by the blue rectangle with solid line. Ten mass candidates were detected by the morphology operators, indicated by the yellow dots. Among the 10 candidates, four candidates were with a MC higher than cost threshold T
                        
                           c
                         and six candidates were with a MC lower than cost threshold T
                        c. After Step 4, four FP regions were removed by measuring the bilateral similarity. The remaining candidates were tested by CMM and three FPs were further removed. The final detection of this mammogram was one TP indicated by the blue rectangle and two FPs indicated by the red rectangle.

‘5-fold cross validation’ scheme were employed to get the optimized set of parameter values. Parameters and their values used in this experiment were shown in 
                        Table 1. Parameters whose value was in a range were optimized using ‘5-fold cross validation’. After segmenting the breast boundary and cropping the image to the minimum rectangle containing the breast, w
                        b is the width of the cropped image. It is a constant. When the number of skeleton points n is large, the time for region matching is fast increased and the matching error is not obviously decreased. A proper range for n may be from 10% to 20% of the number of skeleton points. In our experiment, 15% was selected. The next parameter was matching cost threshold, T
                        c. This parameter was set to avoid bilateral analysis on incorrect matched regions. A proper range for T
                        c may be from 0.2 to 0.25. In our experiment, T
                        c is set as 0.2. The following two parameters were T
                        WT and T
                        LTP. For higher detection sensitivity, these two thresholds should be set lower. Conversely, for higher FP reduction, these two thresholds should be set higher. In our experiment, T
                        WT was set in the range from 10 to 12. T
                        LTP was set in the range from 0.3 to 0.5. The final parameter was mass candidate layer parameter, n
                        CMM. When n
                        CMM was large, some true masses may be missed. When n
                        CMM was small, the number of FP regions is fast increased. To balance the trade-off, the value range for n
                        CMM is set from 1 to 3.

@&#EXPERIMENTAL RESULTS@&#

We divide the evaluation into three parts: matching results evaluation, matching cost evaluation and FP reduction results evaluation. Then a discussion about the masses that are not detected by the proposed scheme is given.

To evaluate the region matching results of the proposed method, distance error between the true matched region and region found by different methods was selected as the measurement. As the mammograms are compressed, it is even hard for a radiologist to find the exact positions in the contralateral mammogram. Nipple is considered invariant during compression. For a simplification, nipple in each mammogram was selected as the detected region. The distance between the matched region and the nipple in the contralateral mammogram was used to evaluate the matching performance.

Nipples in every mammogram were drawn manually for this comparison. For nipple in the left breast, the matched regions found in the right breast by different methods were used as the matched regions. The manually drawn nipple in the right breast was used as the true region. It was all the same for the nipples in the right breasts. Let 
                           v
                        
                        m
                        
                           i
                         be the centroid of the matched nipple found by different algorithms for mammogram i. v
                        
                        t
                        
                           i
                         is the centroid of the true nipple region drawn manually for mammogram i. The distance error for one mammogram, err(i), is defined as the Euclidean distance between 
                           v
                        
                        m
                        
                           i
                         and 
                           v
                        
                        t
                        
                           i
                        . To further test the performance of the proposed region matching method, the original images were rotated with angles of 90°, 180° and 270°. The distance error, err, for all rotated images and images without rotation were computed. The mean err
                        m and standard deviation err
                        s of distance error are then calculated as
                           
                              (12)
                              
                                 e
                                 r
                                 
                                    
                                       r
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    1
                                    L
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    L
                                 
                                 
                                    e
                                    r
                                    r
                                    (
                                    i
                                    )
                                 
                                 ,
                                 e
                                 r
                                 
                                    
                                       r
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                          
                                             L
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          L
                                       
                                       
                                          
                                             
                                                (
                                                e
                                                r
                                                r
                                                (
                                                i
                                                )
                                                −
                                                e
                                                r
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

In (12), L is the number of all mammograms with or without rotation.

The matching cost can be calculated from our region matching method, which tells the region matching credibility. To test if the matching cost defined in this paper can reveal the credibility of region matching, the distribution of matching error on the matching cost was computed and selected as the measurement. Following the region matching results evaluation, the distribution of matching error on the matching cost for all nipples is computed. For all matched nipples, the matching cost was divided into four grades. That are
                           
                              (13)
                              
                                 
                                    
                                       g
                                    
                                    
                                       MC
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       0
                                       ,
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       
                                          
                                             M
                                             
                                                
                                                   C
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       MC
                                    
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       
                                          
                                             M
                                             
                                                
                                                   C
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                       ,
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       MC
                                    
                                 
                                 
                                    (
                                    3
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             M
                                             
                                                
                                                   C
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       MC
                                    
                                 
                                 
                                    (
                                    4
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       M
                                       
                                          
                                             C
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             M
                                             
                                                
                                                   C
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                       ,
                                       
                                       max
                                       
                                          (
                                          
                                             M
                                             C
                                          
                                          )
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     

In (13), g
                        MC(1) is the grade with the smallest matching cost, g
                        MC(4) is the grade with the largest matching cost. MC
                        m and MC
                        s are the mean and standard deviation of MC, respectively.

Likewise, the matching error for all matched nipples was divided into three grades. That are:
                           
                              (14)
                              
                                 
                                    
                                       g
                                    
                                    
                                       e
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       0
                                       ,
                                       e
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       
                                          
                                             e
                                             r
                                             
                                                
                                                   r
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       e
                                    
                                 
                                 
                                    (
                                    2
                                    )
                                 
                                 =
                                 
                                    [
                                    
                                       e
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                       
                                       −
                                       
                                          
                                             e
                                             r
                                             
                                                
                                                   r
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                       ,
                                       e
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             e
                                             r
                                             
                                                
                                                   r
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          /
                                          2
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       e
                                    
                                 
                                 
                                    (
                                    3
                                    )
                                 
                                 =
                                 [
                                 e
                                 r
                                 
                                    
                                       r
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       e
                                       r
                                       
                                          
                                             r
                                          
                                          
                                             s
                                          
                                       
                                    
                                    /
                                    2
                                 
                                 ,
                                 
                                 max
                                 (
                                 e
                                 r
                                 r
                                 )
                                 ]
                                 .
                              
                           
                        
                     

In (14), g
                        e(1) is the grade with the smallest matching error, g
                        e(3) is the grade with the largest matching error. The distribution of three matching error grades on the four matching cost grades was used to test if the matching cost defined in this paper can reveal the credibility of region matching.

To evaluate the performance of FP reduction for bilateral mass detection, free receiver operating characteristic (FROC) curve was used. The FROC curve shows the relationship between the true positive rate (TPR) and the false positives per images (FPs/I) as the decision threshold varies.

Some existing region matching methods [11,12] were employed to evaluate the performance of the proposed region matching method. The computed err
                        m and err
                        s for different methods are shown in 
                        Table 2. To see if the matched results for MLO mammograms and CC mammograms are different, distance errors are computed for MLO and CC separately.

The mean value indicates the overall performance of the matching and the standard deviation indicates the reliability of the matching method. The mean and standard deviation distance error of the proposed method are both lower than that of Refs. [11,12] for CC, MLO and all views. This shows that better region matching results can be obtained by the proposed method. The reasons maybe that layer segmentation divided the whole breast into reasonably local layers when finding matched regions. Second, shape context was employed to compute correspondence, which was robust to segmentation error. We can also observe that the matching results in CC views are better than that in MLO views for the proposed method. The reason may be that the shape difference between left and right MLO views is larger than that in CC views due to compression.

To test if the matching cost defined in this paper can reveal the credibility of region matching, the distribution of three matching error grades on the four matching cost grades was used. The distribution is shown in 
                        Fig. 11.


                        Fig. 11 shows that small matching error have small matching cost and large matching error have large matching cost. For g
                        e(1), where images have small matching error, most of the matching cost are distributed on small value (48% are distributed on g
                        MC(1) and 28% on g
                        MC(2)). For g
                        e(3), where images have large matching error, most of the matching cost are distributed on large value (50% are distributed on g
                        MC(4) and 21% on g
                        MC(3)). The data clearly demonstrated that the computed matching cost, MC, is consistent with the actual matching result. It can reveal the matching credibility.

The performance of the proposed FP reduction for bilateral mass detection was assessed by three viewpoints. First, a comparison between the FP reduction for bilateral mass detection and unilateral mass detection was implemented. Second, a comparison between the proposed similarity measurement and other similarity measurements for FP reduction was tested. Finally, a comparison between the proposed mass detection method and other existing mass detection methods was shown.

To test the importance of bilateral analysis for mass detection in dense mammogram, the performances between the proposed FP reduction scheme for bilateral analysis and unilateral mass detection scheme using CMM [29] were compared. Their image-based FROC curves are drawn in 
                        Fig. 12.

It was found that the proposed FP reduction scheme achieved a TPR of 65%, 75%, 85%, and 95% at 1.67, 1.90, 2.39 and 3.16 FPs/I, respectively. For the unilateral mass detection scheme, the FPs/I were 3.00, 3.24, 3.64 and 4.06 at the corresponding TPRs. The reduced FPs/I rates in the proposed FP reduction scheme were 44%, 41%, 34% and 22%, respectively. The improvement in FP reduction was statistically significant (p<0.05) by t-test analysis. It can be seen that bilateral analysis is very important for mass detection in dense mammograms.

For the comparison of different similarity measurements in FP reduction for bilateral mass detection, intensity difference [13], intensity histogram [14] and texture features obtained from GLCM [5] were selected. These similarity measurements were all used for discriminating mass and normal. Furthermore, no mass contour segmentation was needed, which is the same with the proposed measurement. For intensity difference, the total sum of absolute intensity difference d
                        
                           a
                         and the statistical intensity differences d
                        
                           s
                         were tested. Experiment results showed that d
                        
                           s
                         was better for FP reduction. For intensity histogram, two distances obtained from intensity histogram were tested. They were quadratic-form distance d
                        
                           q
                         and match-form distance d
                        
                           m
                         
                        [30]. Experiment results showed that d
                        
                           q
                         was better for FP reduction. For texture features extracted from GLCM, 13 features extracted at 4 angles and 5 distances were used. The total number of texture features is 260. The image-based FROC curves for these similarity measurements are drawn in 
                        Fig. 13.

It can be seen that image similarity proposed in this paper is better in FP reduction compared with existing similarities. For other similarity measurements, the discriminating performance orders are statistical intensity difference d
                        
                           s
                        , GLCM based distance and histogram based distance d
                        
                           q
                        . The performance differences of these measurements were statistically significant (p<0.05) by t-test analysis. It can also be observed that statistical intensity difference is slightly worse than our similarity measurement. The reason maybe that both global and local appearances were considered in the proposed similarity and statistical intensity difference. This strategy interpret the images in a comprehensive manner. Some FPs/I for these similarities under the same TPR are shown in 
                        Table 3.

In order to reveal the advantages of the proposed method for mass detection in dense mammograms, existing mass detection methods were employed for a comparison. The method presented by Ericeira [31] was selected. There are two reasons for choosing this method for a comparison. First, the method in [31] displayed a similar mass detection procedure with the proposed method. Second, no mass contour segmentation was needed for both method [31] and our method. Thus the comparison was relative fair. The image-based FROC curves for the proposed method and Ericeira method [31] are drawn in 
                        Fig. 14.

For the mass detection scheme in [31], the FPs/I were 3.24, 3.93, 5.73 and 7.17 at TPR of 65%, 75%, 85%, and 95%. Compared with [31], the reduced FPs/I rates of the proposed method were 48%, 52%, 58% and 56% at corresponding TPRs, respectively. It can be seen that the proposed method is more effective for mass detection in dense mammograms.

Though the proposed method obtains a promising results in mass detection. Some problems also exist. First, the size of the dataset is not that large. Second, for the mass that is very similar with its matched region, the bilateral scheme may regard it as normal. An example is shown in 
                        Fig. 15.

Third, for the mass that is very small and has low intensity, the proposed scheme may also miss it. The reason is that this mass may not be found by mass candidate locating used in this paper. 
                        Fig. 16(a) is an example of this type of mass that is not detected. In this case it is even hard for some radiologists to recognize it.

Future work will focus on combining CC view and MLO view mammograms. A mass may be very similar with its matched region in one view due to breast compression. However, this mass in the other view may display difference with its matched region, which can increase the mass detection rate.

@&#CONCLUSIONS@&#

In this paper, a novel region matching method and similarity measurement were proposed. Integrating them, a FP reduction scheme for bilateral mass detection was designed. The proposed scheme had two advantages. First, matching cost was defined and employed to evaluate the actual matching credibility. Thus bilateral analysis on incorrect corresponding region pairs could be avoided. The idea of matching cost can also be used for matching mammograms in CC and MLO views. Second, a hierarchical similarity measurement considering both global and local appearance was given to discriminate mass-to-normal and normal-to-normal pairs. This hierarchical measurement displayed better performance compared with existing distance measurements. Experiment results showed that a promising FP reduction result was obtained. Future work will be focused on four mammogram analysis.

None declared.

@&#ACKNOWLEDGEMENT@&#

This work was supported in part by the National Natural Science Foundation of China 
                  61271305, 61201363 and the National Research Foundation for the Doctoral Program of Ministry of Education of China 
                  20110009110001.

The affine transform between point 
                        p
                     
                     
                        i
                     =[
                        p
                     
                     
                        i
                     (1), 
                        p
                     
                     
                        i
                     (2)]
                        T
                     ∈R
                     2 and its matched point 
                        q
                     
                     
                        M(i) is given by:
                        
                           (A1)
                           
                              
                                 
                                    q
                                 
                                 
                                    M
                                    (
                                    i
                                    )
                                 
                              
                              =
                              F
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              +
                              o
                           
                        
                     
                  

In (A1), F is a 2×2 matrix and o is a 2-dimensional vector. To let (A1) be a linear form, rewritten it as
                        
                           (A2)
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   M
                                                   (
                                                   i
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             o
                                          
                                       
                                       
                                          
                                             
                                                0
                                                
                                                0
                                             
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     
                  

Then the least square estimation is thus given as
                        
                           (A3)
                           
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                F
                                                ^
                                             
                                          
                                          
                                             
                                                o
                                                ^
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    Q
                                 
                                 
                                    A
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    A
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          A
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          A
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                        
                     where
                        
                           
                              
                                 
                                    Q
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      M
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      M
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      M
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      M
                                                      (
                                                      n
                                                      )
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                    
                                 
                                 )
                              
                              
                              
                              and
                              
                              
                                 
                                    P
                                 
                                 
                                    A
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      n
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      n
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             ⋯
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 )
                              
                              .
                           
                        
                     
                  

@&#REFERENCES@&#

