@&#MAIN-TITLE@&#A security gateway application for End-to-End M2M communications

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The SGA is first proposed to improve the GA of the ITU-T M2M service layer in the IoT reference model;


                        
                        
                           
                           Secure Exchange Key scheme is used among smart devices and SGA server for secure E2E M2M communication in IoTs;


                        
                        
                           
                           Lightweight symmetric key cryptographic negotiation function is first proposed;


                        
                        
                           
                           The proposal functions of the SGA in this paper are suitable to be a new standard interface because their meet the basic security requirements of the M2M service layer.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Security gateway application

IoTs

M2M

End-to-End

Mutual authentication

@&#ABSTRACT@&#


               
               
                  M2M (Machine-to-Machine) communication for the Internet of Things (IoTs) system is considered to be one of the major issues in future networks. Considering the characteristics of M2M networks in IoTs systems, traditional security solutions are not able to be applied to E2E (End-to-End) M2M networks because the M2M network itself is vulnerable to various attacks. We consider security aspects for M2M communications and then propose a security gateway application (SGA) including the lightweight symmetric key cryptographic negotiation function, secure E2E M2M key exchange generation function and secure E2E M2M messages delivery function. The proposal of the SGA is newly suggested to improve the gateway application (GA) of the ITU-T M2M service layer in the IoTs reference model. We prove that it could prevent various attacks via the theoretical security analyses. Therefore, it could meet the basic security requirements of the M2M service layer.
               
            

@&#INTRODUCTION@&#

In recent years, with the development of computer science, communication technology and perception recognition technology, the network of things has made a great breakthrough. The Internet of Things (IoTs) [1,2] has immense potential to change many of our daily activities, routines and behaviors. The IoTs could find applications in many fields, from the earliest wireless sensor networks such as the military reconnaissance to the present intelligent transportation, smart grid, smart healthcare, smart agriculture, smart logistics and so on [3]. IoTs [4–7] are also defined as a global infrastructure for the information society, enabling advanced services by interconnecting (physical and virtual) things based on, existing and evolving, interoperable information and communication technologies. Through the exploitation of identification, data capture, processing and communication capabilities, the IoTs make full use of things to offer services to all kinds of applications, while ensuring that security and privacy requirements are fulfilled [4–7]. The pervasive nature of the information sources means that a great amount of data pertaining to possibly every aspect of human activity, both public and private, will be produced, transmitted, collected, stored and processed. Consequently, integrity and confidentiality of transmitted data as well as the authentication of (and trust in) the services offering that data is crucial. Hence, security is a critical functionality for the IoTs [2]. Data networks, especially wireless, are prone to a large number of attacks such as eavesdropping, spoofing, denial of service and so on. Legacy Internet systems mitigate these attacks by relying on link layer, network layer, transport layer or application layer encryption and authentication of the underlying data. Though some of these solutions are applicable to the IoTs domain, the inherently limited processing and communication capabilities of IoTs devices prevent the use of full-fledged security suites [2].

In an ubiquitous environment, more and more devices are deployed in our daily life, and they need to communicate with one another. M2M (Machine-to-Machine) communication is considered to be one of the major issues in future networks. M2M is expected to bring various benefits in wireless communications when it is interconnected with the Internet [8]. Considering the characteristics of M2M networks, traditional security solutions are not suitable when being applied to M2M service networks because the M2M server network itself is vulnerable to various attacks [8]. A machine could communicate with another machine directly in wireless manners. The M2M communication has attracted a lot of people and industries for its ability to increase efficiency and improve productivity while reducing operating costs. It has great application areas and it could be connected with other infrastructure and brings much more powerful and efficient results. M2M devices or smart devices will ultimately connect to core services networks through a variety of means, from direct broadband or capillary wireless networks, to wired networks [8]. From the ITU-T perspective, the M2M technologies are a key enabler of the IoTs [4–7]. The M2M service layer in the ITU-T scope of the ITU-T M2M service layer includes a set of generic and specific functions for the support of a variety of applications enabled by the M2M technologies [4–7]. These functions include management functions and security functions as well as service support and application support functions. The capabilities of the ITU-T M2M service layer are a subset of the whole set of capabilities of the IoTs [4–7].

Moreover, in 2014, the number of mobile subscribers who use smart mobile devices has now surpassed more than 1.2 billion people in the world [9]. Smart devices especially in the third and fourth generations of cellular systems are able to connect fast to the Internet, and the subscribers are easily capable of sending and receiving M2M messages via the smart devices. Therefore, the M2M plays a very important role in the IoTs communications. Despite the critical role of IoTs in the typical Internet users' life, M2M is not so secure. The processing capabilities of smart devices are increasingly enhanced but it cannot compete with the processing capabilities of personal computers. With the increasingly growing reliance on E2E and M2M for the IoTs system in one hand, and the growing number of vulnerabilities and attacks on the other hand, there is an increasingly demand for security solutions [10–12]. There are also some additional security problems in the M2M communication that are not the case in the IoTs system. Therefore, special secure protocols are required for variety E2E (End-to-End) and M2M for the IoTs platforms.

In addition, data confidentiality, authentication, integrity, non-repudiation, access control, and availability are the most important security services in the security criteria that should be taken into account in secure applications and systems [13,10–12,14–17]. However, there is no provision for such security services in the E2E M2M for IoTs system. Both smart device and M2M gateway applications servers are vulnerable to both passive and active attacks. Passive threats include release of message contents, and traffic analysis while active threats include modification of message contents, masquerade, replay, and denial of Service (DoS) [10–12,18–20]. Actually, all the mentioned threats are applicable to the E2E M2M communications [21,22].

The requirement of secure E2E M2M communication enables smart devices to securely communicate in the relationship of M2M. Despite the many solutions [13,10–12,14] that are available now that provide the E2E secure communications, most of them are using the classical ciphers, traditional symmetric cryptosystems and public key cryptography which are dealing with processing the secure communications among a variety of personal computers and server platforms, the solutions designed for M2M could not be suitable for E2E and secure M2M communication. However, several implementations [13,10–12] provide these services, but none of them offers real simple utility security and preserve the privacy of the end-users. However, it will permit traditional security solutions to become more vulnerable, because it is easily suffers from key guessing attacks [16,17]. In the other words, the new SGA approach for E2E M2M service proposed in this paper will realize new applications that are more suitable for secure E2E M2M communications for use with IoTs systems.

Our contribution is that we have newly suggested the basic definitions of a security gateway application (SGA) to improve the gateway application (GA) of the ITU-T M2M service layer in the IoTs reference model [4–7]. The SGA is proposed and defined as a security gateway application for secure E2E M2M communication consisting of the Lightweight Symmetric Key Cryptographic Negotiation Function, Secure E2E M2M Key Exchange Generation Function and Secure E2E M2M Messages Delivery Function for the IoTs system. In addition to that, a lightweight cryptographic symmetric key algorithm will be negotiated by both smart devices for each E2E M2M communication session, which is an efficient choice in the energy and flexibility for the energy-limited smart device. However, the proposed lightweight cryptographic exchange key algorithm could provide the mutual authentication mechanism and prevent the key guessing attack, the undetectable on-line key guessing attack, the data privacy attack as well as the relay attack. The proposed SGA in this paper meets the basic security requirements of the M2M service layer [4–7]. Our proposal includes following:
                        
                           •
                           Secure Exchange Key establishment between a pair of smart devices and SGA server for E2E M2M communication in the IoTs;

Lightweight Symmetric Key Cryptographic Negotiation Function;

The basic definitions of the SGA is first proposed to improve the GA of the ITU-T M2M service layer in the IoTs reference model [4–7];

The proposed SGA in this paper meets the basic security requirements of the M2M service layer.

The remainder of the paper is structured as follows: the next section addresses previous work on the topic. Section 3 describes the system's overall architecture and presence. Section 4 introduces the designed SGA approach for E2E M2M service. Section 5 evaluates the proposed schemes in terms of security and provides theoretical analyses. Section 5.3 describes why the proposed SGA in this paper is suitable to be a new standard interface. The last session concludes the paper and gives pointers to future work.

@&#RELATED WORKS@&#

In this section, the introduction of the ITU-T Machine to Machine (M2M) service layer and requirements of the ITU-T M2M security service layer in secure E2E M2M communication are described briefly below.

The M2M service layer and their relationship with the IoTs reference model are described as follows: from the ITU-T perspective, the M2M technologies are a key enabler of the IoTs [4–7]. The M2M service layer in the ITU-T scope, the “ITU-T M2M service layer,” includes a set of generic and specific functions for the support of a variety of applications enabled by the M2M technologies. These functions include management functions and security functions as well as service support and application support functions. The capabilities of the ITU-T M2M service layer are a subset of the entire set of capabilities of the IoTs. Fig. 1
                      shows the ITU-T M2M service layer and its position in the IoTs reference model [4–7]. The layered architectural approach, as illustrated in Fig. 1, reduces the implementation complexity while providing interoperability between different applications enabled by the M2M technologies. The specific support capabilities in the service support and application support layer include application specific support capabilities (e.g., the e-health support and telematics support capabilities as shown in Fig. 1). Three types of applications are identified on top of the ITU-T M2M service layer (Application layer): device applications (DAs), gateway applications (GAs) and network application servers (NAs). DA, GA and NA reside, respectively, in a device, gateway and network application server. All these applications can use capabilities provided by the ITU-T M2M service layer [4–7].

The ETSI M2M SCL, the ITU-T M2M service layer as shown in Fig. 1 
                     [4–7] includes specific support capabilities in the service support and application support layer, specific management capabilities and specific security capabilities which are compared in Ref. [4–7]. The interfaces are anticipated and are required to extend including the support of the specific support capabilities in the service support and application support layer, the specific management capabilities and the specific security capabilities [4–7].

However, the ITU-T M2M service layer and ETSI M2M service layer in the IoTs reference model mentioned above did not address the mutual authentication mechanism for the smart device in secure E2E M2M communication. Thus, the mutual authentication mechanism is suggested into the basic requirements of the secure M2M service layer in this paper for smart devices. The basic requirements of the secure M2M service layer are listed below.
                        
                           •
                           Mutual Authentication: The M2M service layer is required to provide authentication mechanism for applications, smart devices and prevent unauthorized use of the smart devices in secure E2E M2M communication.

Privacy: The M2M service layer is required to support privacy protection capabilities, such as temporary session key, anonymity of identity and location, according to regulation and laws in secure E2E M2M communication.

Confidentiality: The M2M service layer is required to support data transfer confidentiality in secure E2E M2M communication.

Integrity: The M2M service layer is required to support data integrity protection in secure E2E M2M communication.

Due to the definitions of the ITU-T M2M service layer and ETSI M2M service layer, they did not address the SGA. In this paper, the basic definitions of the SGA are defined as SGA functions for secure E2E M2M communication consisting of the lightweight Symmetric Key Cryptographic Function Negotiation, Secure E2E M2M Key Exchange Generation and Secure E2E M2M Messages Delivery and secure protocols which smart devices could use when building SGA functions for a specific E2E M2M communication system for an IoTs system. SGAs are E2E-based, and they also enable the performance, scalability and security needed for high scale M2M deployments. At a high level, SGAs are ideal for the integration of an E2E M2M enabled infrastructure, and indeed many readily available SGAs could be used for this purpose. The Architecture of Secure E2E M2M SGA as shown in Fig. 2
                     .

It is assumed that there are m smart devices (SDs) in the IoTs system. First, each smart device needs to then initiate the registration phase which is used to create a new account consisting of a distinct Identification 
                        I
                        
                           D
                           
                              d
                              i
                           
                        
                     , e.g. a Radio Frequency Identification (RFID), a set of lightweight symmetric key cryptographic functions ℂ
                        G
                     
                     ={(E
                     
                        G,x
                     (·),
                     D
                     
                        G,x
                     (·)),
                     x
                     =1,2,3,…} plus their identification set ℂidSet
                     
                        G
                     
                     ={(E
                     
                        G,x
                     ,
                     D
                     
                        G,x
                     ),
                     x
                     =1,2,3,…} and an initial key 
                        
                           k
                           
                              d
                              G
                           
                        
                      shared and kept secure by the SGA Server and itself for getting the secure M2M services in the IoTs System. Second, if the smart device wants to securely communicate to a group of machines or smart devices which consist of some invited members for a specific purpose, e.g. secure broadcasting and multicasting messages, the smart device needs to launch a group request for the M2M construct phase to the SGA Server in the IoTs System for organizing a special secure group.

The system's overall architecture including smart device registration for the SGA and Secure E2E M2M for SGA in the IoTs system is presented below.

This subsection will illustrate the scheme of the registration phase as shown in Fig. 3
                        . The Cryptographic Accelerator (CA for short) module connects with the SGA server and selects and then generates a series of parameters for the exchange of public information while holding a secure M2M communication in the IoTs system as per the procedure below. The secret key PR is only kept secure by the SGA server, a large prime number p and a generator, g
                        ∈
                        F
                        
                           p
                        
                        ⁎, are pre-chosen. The public key PK is computed, such that D
                        
                           PR
                        (E
                        
                           PK
                        (M))=
                        M. The CA of the SGA server provides a public key encryption algorithm E
                        
                           G
                        (·), decryption algorithm D
                        
                           G
                        (·) and public key PK together with the secret key PR. The CA of the SGA server also provides a set of lightweight symmetric key cryptographic functions ℂ
                           G
                        
                        ={(E
                        
                           G,x
                        (·),
                        D
                        
                           G,x
                        (·)),
                        x
                        =1,2,3,…} and their relevant cryptographic identification set ℂidSet
                        
                           G
                        
                        ={(E
                        
                           G,x
                        ,
                        D
                        
                           G,x
                        ),
                        x
                        =1,2,3,…} for the security gateway of the smart device. For the key exchange phase, the CA of the SGA server prepares a trapdoor one-way hash function F
                        
                           G
                        (·) and a one-way hash function f
                        
                           k
                        (·). The important parameters and relative functions mentioned above will be packed into a download package.

After downloading the package from the SGA server, the smart device di
                         chooses an identity 
                           I
                           
                              D
                              
                                 d
                                 i
                              
                           
                        , secret initial or registered key 
                           
                              k
                              
                                 d
                                 i
                              
                           
                         and the lightweight symmetric key cryptographic function set ℂidSet
                        
                           i
                        . In this registration phase, the smart device di
                         will send the registration request messages 
                           
                              E
                              
                                 P
                                 K
                              
                              G
                           
                           
                              
                                 k
                                 
                                    d
                                    i
                                 
                              
                           
                           
                              
                                 E
                                 
                                    i
                                    ,
                                    x
                                 
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                              
                           
                           
                              
                                 ℂ
                                 idse
                                 
                                    t
                                    i
                                 
                              
                           
                         to the CA of the SGA server, where the initial cryptographic function E
                        
                           i,x
                        (·)∈ℂ
                           i
                         is arbitrary choice by the smart device di
                        . Once receiving the request messages from the smart device di
                        , the CA of the SGA server will decrypt and verify the initial and registered secret key 
                           
                              D
                              
                                 P
                                 R
                              
                              G
                           
                           
                              
                                 k
                                 
                                    d
                                    i
                                 
                              
                           
                           =
                           
                              k
                              
                                 d
                                 i
                              
                           
                        , the device identity 
                           I
                           
                              D
                              
                                 d
                                 i
                              
                           
                        , the set of lightweight symmetric key cryptographic functions ℂ
                           G
                        
                        ={(E
                        
                           G,x
                        (·),
                        D
                        
                           G,x
                        (·)),
                        x
                        =1,2,3…} plus their relevant cryptographic identifications in the set ℂidSet
                        
                           i
                         whether they are available for the IoTs system or not. If they are available, then the device identity 
                           I
                           
                              D
                              
                                 u
                                 i
                              
                           
                        , corresponding cryptographic sets and secret key 
                           
                              k
                              
                                 d
                                 i
                              
                           
                         will be secure kept and stored by the SGA server and the acceptance acknowledgment will be sent to the requestor di
                        .

For example, the smart devices di
                         and dj
                         initial the registration processes in Fig. 3. Finally, CA of SGA server will keep their identities, secret keys together with the set of lightweight symmetric key cryptographic functions as well as their relevant cryptographic identification sets: 
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 
                                    k
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 
                                    ℂ
                                    i
                                 
                                 ,
                                 ℂ
                                 idSe
                                 
                                    t
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    k
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    ℂ
                                    j
                                 
                                 ,
                                 ℂ
                                 idSe
                                 
                                    t
                                    j
                                 
                              
                           
                         for smart devices di
                         and dj
                        , individually.

This subsection will illustrate the secure E2E M2M for SGA in the IoTs system. There are three phases consisting of the Symmetric Key Cryptographic Function Negotiation Phase, Secure E2E M2M Key Exchange Generation Phase and Secure E2E M2M Messages Delivery Phase in this SGA. In the Symmetric Key Cryptographic Function Negotiation Phase as shown in Fig. 4
                        , two smart devices negotiate the lightweight symmetric key cryptographic function and generate the temporary key via their GA modules and SGA server. In the Secure E2E M2M Key Exchange Phase as shown in Fig. 5
                        , two smart devices cooperatively generate the exchange session key via their GA modules and SGA server. The secure M2M E2E communication will be held by the processes shown in the Secure E2E M2M Messages Delivery Phase in the IoTs System.


                        
                           
                              Step A1:
                              Secure E2E M2M symmetric key cryptographic function invitation request (SE2E M2M SKCF invitation request): If a smart device di
                                  wants to launch a secure M2M communication with smart device dj
                                 . At first, the smart device di
                                  will choose a symmetric key cryptographic function E
                                 
                                    i,x
                                 (·)∈ℂ
                                    i
                                  together with a temporary session key k
                                 
                                    t
                                 
                                 
                                    i
                                  via his GA module, where the relevant identity of the symmetric key cryptographic function is E
                                 
                                    i,x
                                 
                                 ∈ℂidSet
                                 
                                    i
                                 . The smart device di
                                  will then perform 
                                    
                                       E
                                       
                                          P
                                          K
                                       
                                       G
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   
                                                      d
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      i
                                                   
                                                
                                             
                                          
                                          I
                                          
                                             D
                                             G
                                          
                                          
                                             
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                E
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  by using the public key and cryptographic function of the SGA server. Moreover, the smart device di
                                  sends these encrypted messages 
                                    
                                       E
                                       
                                          P
                                          K
                                       
                                       G
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   
                                                      d
                                                      i
                                                   
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   i
                                                   ,
                                                   x
                                                   s
                                                
                                             
                                          
                                       
                                    
                                  to the SGA server.

Because of all the messages are delivered from the smart devices in the IoTs system, they will be stored in the database of the SGA server.

Secure E2E M2M cryptographic function negotiation request (SE2E M2M CF negotiation request): After receiving the encrypted messages sent by the smart device di
                                 , the server SGA performs the decryption 
                                    
                                       D
                                       
                                          P
                                          R
                                       
                                       G
                                    
                                    
                                       
                                          
                                             E
                                             
                                                P
                                                k
                                             
                                             G
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                         t
                                                         i
                                                      
                                                      ⊕
                                                      
                                                         k
                                                         
                                                            d
                                                            i
                                                         
                                                      
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      i
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   G
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      j
                                                   
                                                
                                                |
                                                |
                                                
                                                   
                                                      E
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             k
                                             t
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                i
                                             
                                          
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       G
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          E
                                          
                                             i
                                             ,
                                             x
                                          
                                       
                                       
                                          D
                                          
                                             i
                                             ,
                                             x
                                          
                                       
                                    
                                 , and verifies his registered identity, the secret key 
                                    
                                       
                                          
                                             k
                                             t
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                i
                                             
                                          
                                       
                                    
                                    ⊕
                                    
                                       k
                                       
                                          d
                                          i
                                       
                                    
                                    =
                                    
                                       k
                                       t
                                       i
                                    
                                  and the identity of the lightweight symmetric key cryptographic function (E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 )∈ℂidSet
                                 
                                    i
                                 . The server SGA will also verify the lightweight symmetric key cryptographic functions whether they are satisfying the equation (E
                                 
                                    i,x
                                 (·),
                                 D
                                 
                                    i,x
                                 (·))=(E
                                 
                                    i,x
                                 (·),
                                 D
                                 
                                    i,x
                                 (·))∈{ℂ
                                    i
                                 
                                 ∩ℂ
                                    j
                                 } or not. If the condition (E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 )≠(E
                                 
                                    j,x
                                 ,
                                 D
                                 
                                    j,x
                                 ) is satisfied, it implies that (E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 )or(E
                                 
                                    j,x
                                 ,
                                 D
                                 
                                    j,x
                                 )∉{ℂidSet
                                 
                                    i
                                 
                                 ∩ℂidSet
                                 
                                    j
                                 }. Thus, the SGA server will reject the request and send a response to the smart device di
                                 . On the contrary, the SGA server calculates the SE2E M2M CF negotiation request messages 
                                    
                                       E
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                       
                                          j
                                          ,
                                          
                                             x
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   
                                                      d
                                                      j
                                                   
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  via the initial and registered encryption function 
                                    
                                       E
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                       
                                          j
                                          ,
                                          
                                             x
                                             ′
                                          
                                       
                                    
                                    
                                       •
                                    
                                  of the target smart device dj
                                  and forwards them to it.

Secure E2E M2M cryptographic function negotiation response (SE2E M2M CF negotiation response): Similarly, when the smart device dj
                                  receives the SE2E M2M CF negotiation request messages from the SGA server, it decrypts 
                                    
                                       D
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                       
                                          j
                                          ,
                                          
                                             x
                                             ′
                                          
                                       
                                    
                                    
                                       
                                          
                                             E
                                             
                                                k
                                                
                                                   d
                                                   j
                                                
                                             
                                             
                                                j
                                                ,
                                                
                                                   x
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      k
                                                      t
                                                      i
                                                   
                                                   ⊕
                                                   
                                                      k
                                                      
                                                         d
                                                         j
                                                      
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      
                                                         d
                                                         i
                                                      
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      G
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      
                                                         d
                                                         j
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      E
                                                      
                                                         j
                                                         ,
                                                         x
                                                      
                                                   
                                                   ,
                                                   
                                                      D
                                                      
                                                         j
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             k
                                             t
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                j
                                             
                                          
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       G
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          E
                                          
                                             j
                                             ,
                                             x
                                          
                                       
                                       
                                          D
                                          
                                             j
                                             ,
                                             x
                                          
                                       
                                    
                                 . In addition, if the smart device dj
                                  accepts the request, then he will find the negotiated symmetric key cryptographic 
                                    
                                       E
                                       
                                          j
                                          ,
                                          x
                                       
                                    
                                    
                                       •
                                    
                                    ∈
                                    
                                       ℂ
                                       j
                                    
                                  with a temporary key k
                                 
                                    t
                                 
                                 
                                    j
                                  via his GA module, where the relevant identity the symmetric key cryptographic is E
                                 
                                    j,x
                                 
                                 ∈ℂidSet
                                 
                                    j
                                 , and encrypts the response messages 
                                    
                                       E
                                       
                                          P
                                          K
                                       
                                       G
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   t
                                                   j
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  by using the public key and cryptographic function of SGA server and replies back to them via the SGA server.

Negotiation and coordination processes by the SGA server (Negotiation and coordination by SGA): After receiving the encrypted messages 
                                    
                                       E
                                       
                                          P
                                          K
                                       
                                       G
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   t
                                                   j
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  sent by the smart device dj
                                 , the CA of the SGA will then decrypt 
                                    
                                       D
                                       
                                          P
                                          R
                                       
                                       G
                                    
                                    
                                       
                                          
                                             E
                                             
                                                P
                                                K
                                             
                                             G
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                         t
                                                         i
                                                      
                                                      ⊕
                                                      
                                                         k
                                                         t
                                                         j
                                                      
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   G
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      j
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      i
                                                   
                                                
                                                |
                                                |
                                                
                                                   
                                                      E
                                                      
                                                         j
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         j
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             k
                                             t
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             t
                                             j
                                          
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       G
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          E
                                          
                                             j
                                             ,
                                             x
                                          
                                       
                                       
                                          D
                                          
                                             j
                                             ,
                                             x
                                          
                                       
                                    
                                  by using the private key, retrieve k
                                 
                                    t
                                 
                                 
                                    j
                                  by the equations (k
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 ⊕
                                 k
                                 
                                    t
                                 
                                 
                                    j
                                 )⊕
                                 k
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 =
                                 k
                                 
                                    t
                                 
                                 
                                    j
                                 , verify (E
                                 
                                    j,x
                                 ,
                                 D
                                 
                                    j,x
                                 )=(E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 ) and compute 
                                    
                                       E
                                       
                                          k
                                          t
                                          i
                                       
                                       
                                          i
                                          ,
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   t
                                                   j
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   j
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  by using the symmetric key cryptographic function E
                                 
                                    i,x
                                 (·)∈ℂ
                                    i
                                  together with the temporary session key k
                                 
                                    t
                                 
                                 
                                    i
                                  chosen by the smart device di
                                  in Step A1, respectively. Furthermore, the SGA server will respond to these encrypted messages 
                                    
                                       E
                                       
                                          k
                                          t
                                          i
                                       
                                       
                                          i
                                          ,
                                          x
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   t
                                                   j
                                                
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          
                                             
                                                E
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                D
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                          
                                       
                                    
                                  to the smart device di
                                 .

After receiving the response from SGA server, the smart device di
                                  will decrypt these messages 
                                    
                                       D
                                       
                                          k
                                          t
                                          i
                                       
                                       
                                          i
                                          ,
                                          x
                                       
                                    
                                    
                                       
                                          
                                             E
                                             
                                                k
                                                t
                                                i
                                             
                                             
                                                i
                                                ,
                                                x
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                         t
                                                         i
                                                      
                                                      ⊕
                                                      
                                                         k
                                                         t
                                                         j
                                                      
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   G
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      j
                                                   
                                                
                                                |
                                                |
                                                I
                                                
                                                   D
                                                   
                                                      d
                                                      i
                                                   
                                                
                                                |
                                                |
                                                
                                                   
                                                      E
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      D
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             k
                                             t
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             t
                                             j
                                          
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       G
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                    |
                                    |
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    |
                                    |
                                    
                                       
                                          E
                                          
                                             i
                                             ,
                                             x
                                          
                                       
                                       
                                          D
                                          
                                             i
                                             ,
                                             x
                                          
                                       
                                    
                                  by using the symmetric key cryptographic function E
                                 
                                    i,x
                                 (·)∈ℂ
                                    i
                                  together with the temporary session key k
                                 
                                    t
                                 
                                 
                                    i
                                  choice by the smart device di
                                  in Step A1. Next, smart device di
                                  derives k
                                 
                                    t
                                 
                                 
                                    j
                                  by the equation (k
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 ⊕
                                 k
                                 
                                    t
                                 
                                 
                                    j
                                 )⊕
                                 k
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 =
                                 k
                                 
                                    t
                                 
                                 
                                    j
                                 .


                        
                           
                              Step B1:
                              Secure E2E M2M Key Exchange Generation request (SE2E M2M Key EG Request): If a smart device di
                                  wants to launch an E2E M2M Key Exchange Generation request for a secure M2M communication with smart device dj
                                  during a session s, then the smart device di
                                  needs to generate two random numbers Ri
                                  and ri
                                 , and performs 
                                    
                                       N
                                       i
                                    
                                    =
                                    
                                       g
                                       
                                          R
                                          i
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                  and 
                                    
                                       K
                                       is
                                    
                                    =
                                    
                                       
                                          N
                                          i
                                       
                                       
                                          r
                                          i
                                       
                                    
                                    
                                       
                                          mod
                                          p
                                       
                                    
                                  for the session s. Moreover, he performs 
                                    
                                       E
                                       
                                          k
                                          
                                             d
                                             i
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                i
                                             
                                          
                                       
                                    
                                 , F
                                 
                                    G
                                 (r
                                 
                                    i
                                 ), and 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          N
                                          i
                                       
                                    
                                 . Finally, smart device di
                                  sends the messages 
                                    
                                       E
                                       
                                          k
                                          t
                                          i
                                       
                                       
                                          i
                                          ,
                                          x
                                       
                                    
                                    
                                       
                                          
                                             N
                                             i
                                          
                                          ,
                                          |
                                          |
                                          
                                             K
                                             is
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          
                                             E
                                             
                                                k
                                                
                                                   d
                                                   
                                                      
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                   i
                                                
                                                ⊕
                                                
                                                   k
                                                   
                                                      d
                                                      i
                                                   
                                                
                                             
                                          
                                          |
                                          |
                                          
                                             F
                                             G
                                          
                                          
                                             
                                                r
                                                i
                                             
                                          
                                          |
                                          |
                                          
                                             f
                                             
                                                K
                                                is
                                             
                                          
                                          
                                             
                                                N
                                                i
                                             
                                          
                                       
                                    
                                  encrypted by using the temporary session key k
                                 
                                    t
                                 
                                 
                                    i
                                  and a choice cryptographic function pair (E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 ), which are obtained by the Symmetric Key Cryptographic Function Negotiation Phase, to the server.

Secure E2E M2M Key Exchange Invitation Request (SE2E M2M KEI Request): After receiving the encrypted messages sent by the smart device di
                                 , the SGA server decrypts the messages 
                                    
                                       
                                          
                                             
                                                D
                                                
                                                   k
                                                   t
                                                   i
                                                
                                                
                                                   i
                                                   ,
                                                   x
                                                
                                             
                                             
                                                
                                                   
                                                      E
                                                      
                                                         k
                                                         t
                                                         i
                                                      
                                                      
                                                         i
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                            i
                                                         
                                                         |
                                                         |
                                                         
                                                            K
                                                            is
                                                         
                                                         |
                                                         |
                                                         I
                                                         
                                                            D
                                                            
                                                               d
                                                               i
                                                            
                                                         
                                                         |
                                                         |
                                                         I
                                                         
                                                            D
                                                            
                                                               d
                                                               j
                                                            
                                                         
                                                         |
                                                         |
                                                         I
                                                         
                                                            D
                                                            G
                                                         
                                                         |
                                                         |
                                                         
                                                            E
                                                            
                                                               k
                                                               
                                                                  d
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                                  i
                                                               
                                                               ⊕
                                                               
                                                                  k
                                                                  
                                                                     d
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         |
                                                         |
                                                         
                                                            F
                                                            s
                                                         
                                                         
                                                            
                                                               r
                                                               i
                                                            
                                                         
                                                         |
                                                         |
                                                         
                                                            f
                                                            
                                                               k
                                                               is
                                                            
                                                         
                                                         
                                                            
                                                               N
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                             
                                                N
                                                i
                                             
                                             |
                                             |
                                             
                                                K
                                                is
                                             
                                             |
                                             |
                                             I
                                             
                                                D
                                                
                                                   d
                                                   i
                                                
                                             
                                             |
                                             |
                                             I
                                             
                                                D
                                                
                                                   d
                                                   j
                                                
                                             
                                             |
                                             |
                                             I
                                             
                                                D
                                                G
                                             
                                             |
                                             |
                                             
                                                E
                                                
                                                   k
                                                   
                                                      d
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      N
                                                      i
                                                   
                                                   ⊕
                                                   
                                                      k
                                                      
                                                         d
                                                         i
                                                      
                                                   
                                                
                                             
                                             |
                                             |
                                             
                                                F
                                                s
                                             
                                             
                                                
                                                   r
                                                   i
                                                
                                             
                                             |
                                             |
                                             
                                                f
                                                
                                                   K
                                                   is
                                                
                                             
                                             
                                                
                                                   N
                                                   i
                                                
                                             
                                             ,
                                          
                                       
                                    
                                  by using the temporary session key k
                                 
                                    t
                                 
                                 
                                    i
                                  and a chosen cryptographic function pair E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                  of the smart device di
                                  kept by the SGA server. In addition, the SGA server sends the SE2E M2M KEI request to the smart device dj
                                 .

Secure E2E M2M Key Exchange Invitation Response (SE2E M2M KEI Response): After receiving the request from the SGA server, the smart device dj
                                  also generates two random numbers Rj
                                  and rj
                                 , and performs 
                                    
                                       N
                                       j
                                    
                                    =
                                    
                                       g
                                       
                                          R
                                          j
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                  and 
                                    
                                       K
                                       
                                          j
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          N
                                          j
                                       
                                       
                                          r
                                          j
                                       
                                    
                                    
                                       
                                          mod
                                          p
                                       
                                    
                                 . Moreover, it performs 
                                    
                                       E
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                             j
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       F
                                       G
                                    
                                    
                                       
                                          r
                                          j
                                       
                                    
                                 , and 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    =
                                    
                                       
                                          N
                                          j
                                       
                                    
                                 . Finally, it sends these messages the messages 
                                    
                                       E
                                       
                                          K
                                          t
                                          j
                                       
                                       
                                          j
                                          ,
                                          x
                                       
                                    
                                    
                                       
                                          
                                             N
                                             j
                                          
                                          |
                                          |
                                          
                                             K
                                             
                                                j
                                                s
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          |
                                          |
                                          I
                                          
                                             D
                                             G
                                          
                                          |
                                          |
                                          
                                             E
                                             
                                                k
                                                
                                                   d
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                   j
                                                
                                                ⊕
                                                
                                                   k
                                                   
                                                      d
                                                      j
                                                   
                                                
                                             
                                          
                                          |
                                          |
                                          
                                             F
                                             s
                                          
                                          
                                             
                                                r
                                                j
                                             
                                          
                                          |
                                          |
                                          
                                             f
                                             
                                                K
                                                
                                                   j
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                N
                                                j
                                             
                                          
                                       
                                    
                                  encrypted by using the temporary session key k
                                 
                                    t
                                 
                                 
                                    j
                                  and a choice cryptographic function pair (E
                                 
                                    j,x
                                 ,
                                 D
                                 
                                    j,x
                                 )=(E
                                 
                                    i,x
                                 ,
                                 D
                                 
                                    i,x
                                 ), which are obtained by the Symmetric Key Cryptographic Function Negotiation Phase, to the SGA server.

Verification by SGA server: After collecting the messages sent by the smart device dj
                                 , the CA of the SGA server will also decrypt
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                      
                                                         k
                                                         t
                                                         j
                                                      
                                                      
                                                         j
                                                         ,
                                                         x
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                            
                                                               k
                                                               t
                                                               j
                                                            
                                                            
                                                               j
                                                               ,
                                                               x
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                                  j
                                                               
                                                               |
                                                               |
                                                               
                                                                  K
                                                                  
                                                                     j
                                                                     s
                                                                  
                                                               
                                                               |
                                                               |
                                                               I
                                                               
                                                                  D
                                                                  
                                                                     d
                                                                     i
                                                                  
                                                               
                                                               |
                                                               |
                                                               I
                                                               
                                                                  D
                                                                  
                                                                     d
                                                                     j
                                                                  
                                                               
                                                               |
                                                               |
                                                               I
                                                               
                                                                  D
                                                                  G
                                                               
                                                               |
                                                               |
                                                               
                                                                  E
                                                                  
                                                                     k
                                                                     
                                                                        d
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        N
                                                                        j
                                                                     
                                                                     ⊕
                                                                     
                                                                        k
                                                                        
                                                                           d
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                               |
                                                               |
                                                               
                                                                  F
                                                                  G
                                                               
                                                               
                                                                  
                                                                     r
                                                                     j
                                                                  
                                                               
                                                               |
                                                               |
                                                               
                                                                  f
                                                                  
                                                                     K
                                                                     
                                                                        j
                                                                        s
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     N
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      N
                                                      j
                                                   
                                                   |
                                                   |
                                                   
                                                      K
                                                      
                                                         j
                                                         s
                                                      
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      
                                                         d
                                                         i
                                                      
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      
                                                         d
                                                         j
                                                      
                                                   
                                                   |
                                                   |
                                                   I
                                                   
                                                      D
                                                      G
                                                   
                                                   |
                                                   |
                                                   
                                                      E
                                                      
                                                         k
                                                         
                                                            d
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                            j
                                                         
                                                         ⊕
                                                         
                                                            k
                                                            
                                                               d
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      F
                                                      G
                                                   
                                                   
                                                      
                                                         r
                                                         j
                                                      
                                                   
                                                   |
                                                   |
                                                   
                                                      f
                                                      
                                                         K
                                                         
                                                            j
                                                            s
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                         j
                                                      
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              

Next, the CA of the SGA server decrypts 
                                    
                                       D
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                             j
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       N
                                       j
                                    
                                    ⊕
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                  by using the corresponding key 
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                 . Similarly, the 
                                    
                                       D
                                       
                                          k
                                          
                                             d
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             N
                                             j
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    
                                       N
                                       j
                                    
                                    ⊕
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                  is decrypted by using the corresponding key 
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                 . In addition, the CA of the SGA server retrieves Ni
                                  and Nj
                                  by the equations 
                                    
                                       
                                          
                                             N
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                j
                                             
                                          
                                       
                                    
                                    ⊕
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                    =
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                    =
                                    
                                       N
                                       j
                                    
                                  and 
                                    
                                       
                                          
                                             N
                                             i
                                          
                                          ⊕
                                          
                                             k
                                             
                                                d
                                                i
                                             
                                          
                                          =
                                          
                                             N
                                             i
                                          
                                       
                                    
                                  using the corresponding keys 
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                  and 
                                    
                                       k
                                       
                                          d
                                          j
                                       
                                    
                                 , respectively. Moreover, the CA of the SGA server derives ri
                                  and rj
                                  from the trapdoor one-way hash functions F
                                 
                                    G
                                 (r
                                 
                                    i
                                 ) and F
                                 
                                    G
                                 (r
                                 
                                    j
                                 ). Then, the CA of the SGA server performs 
                                    
                                       K
                                       is
                                    
                                    =
                                    
                                       N
                                       i
                                       
                                          r
                                          i
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                  and K
                                 
                                    js
                                 
                                 =
                                 N
                                 
                                    j
                                 
                                 
                                    rj
                                 (mod p) from the values ri
                                 , rj
                                 , Ni
                                  and Nj
                                 . Additionally, the CA of the SGA server then verifies that the received hash values are 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          N
                                          i
                                       
                                    
                                  and 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    
                                       
                                          N
                                          j
                                       
                                    
                                 . If these verifications for authentication between both smart device di
                                  and dj
                                  are successful, then the CA of the SGA server will generate a random number RS
                                  for this session s. But, if these verifications for authentication are unsuccessful, the CA of the SGA server will reject this request.

Secure E2E M2M Session Key Generation (SE2E M2M SK Generation): The CA of the SGA server performs the secure E2E M2M Session key 
                                    
                                       K
                                       
                                          i
                                          S
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                       
                                          R
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   
                                                      R
                                                      i
                                                   
                                                
                                             
                                             
                                                R
                                                s
                                             
                                          
                                       
                                       
                                          R
                                          j
                                       
                                    
                                    =
                                    
                                       g
                                       
                                          
                                             R
                                             i
                                          
                                          
                                             R
                                             S
                                          
                                          
                                             R
                                             j
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   
                                                      R
                                                      j
                                                   
                                                
                                             
                                             
                                                R
                                                s
                                             
                                          
                                       
                                       
                                          R
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             N
                                             j
                                             
                                                R
                                                s
                                             
                                          
                                       
                                       
                                          R
                                          i
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          i
                                          S
                                          j
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                  for both smart device di
                                  and dj
                                 , and calculates the messages 
                                    
                                       N
                                       i
                                       
                                          R
                                          s
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                  and 
                                    
                                       N
                                       j
                                       
                                          R
                                          s
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                 , 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             is
                                          
                                          ,
                                          
                                             N
                                             j
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             
                                                j
                                                s
                                             
                                          
                                          ,
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                 .

Secure E2E M2M Session Key Distribution (SE2E M2M SK Distribution): Finally, the SGA server will send back only the messages 
                                    
                                       
                                          N
                                          j
                                       
                                       
                                          R
                                          S
                                       
                                    
                                 , 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             is
                                          
                                          ,
                                          
                                             N
                                             j
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                  to smart device di
                                 , and the messages 
                                    
                                       
                                          N
                                          i
                                       
                                       
                                          R
                                          S
                                       
                                    
                                  and 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             
                                                j
                                                s
                                             
                                          
                                          ,
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                  to smart device dj
                                 , individually.

Secure E2E M2M Session Recovery (SE2E M2M SK Recovery): After receiving both messages 
                                    
                                       N
                                       j
                                       
                                          R
                                          s
                                       
                                    
                                  and 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             is
                                          
                                          ,
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                 , the smart device di
                                  could verify 
                                    
                                       f
                                       
                                          K
                                          is
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          ,
                                          
                                             K
                                             is
                                          
                                          ,
                                          
                                             N
                                             j
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                  by using 
                                    
                                       N
                                       j
                                       
                                          R
                                          s
                                       
                                    
                                  and the messages 
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    ,
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                 , and K
                                 
                                    is
                                 . If the messages are verified as successful, then the smart device di
                                  will compute the secure E2E M2M Session key by the equation 
                                    
                                       
                                          
                                             
                                                N
                                                j
                                             
                                             
                                                R
                                                S
                                             
                                          
                                       
                                       
                                          R
                                          i
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          i
                                          s
                                          j
                                       
                                    
                                    
                                       
                                          mod
                                          p
                                       
                                    
                                 . Similarly, after receiving the messages 
                                    
                                       N
                                       i
                                       
                                          R
                                          s
                                       
                                    
                                  and 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          
                                             K
                                             
                                                j
                                                s
                                             
                                          
                                          ,
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                 , the smart device dj
                                  could verify 
                                    
                                       f
                                       
                                          K
                                          
                                             j
                                             s
                                          
                                       
                                    
                                    
                                       
                                          I
                                          
                                             D
                                             
                                                d
                                                i
                                             
                                          
                                          ,
                                          I
                                          
                                             D
                                             
                                                d
                                                j
                                             
                                          
                                          
                                             K
                                             
                                                j
                                                s
                                             
                                          
                                          ,
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                    
                                  by using 
                                    
                                       N
                                       i
                                       
                                          R
                                          s
                                       
                                    
                                  and the messages 
                                    I
                                    
                                       D
                                       
                                          d
                                          i
                                       
                                    
                                    ,
                                    I
                                    
                                       D
                                       
                                          d
                                          j
                                       
                                    
                                 , and K
                                 
                                    js
                                 . If the messages are verified as successful, then the smart device dj
                                  performs the secure E2E M2M key by the equation 
                                    
                                       
                                          
                                             N
                                             i
                                             
                                                R
                                                s
                                             
                                          
                                       
                                       
                                          R
                                          j
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          j
                                          s
                                          i
                                       
                                    
                                    =
                                    
                                       K
                                       
                                          i
                                          s
                                          j
                                       
                                    
                                    
                                       
                                          mod
                                          
                                          p
                                       
                                    
                                 .

In the phase, assumed that the smart device di
                         will securely send the set of the messages M
                        ={m
                        1,
                        m
                        2,…,
                        m
                        
                           i
                        ,…},
                        x
                        ∈
                        Z*={1,2,3,…} to the smart device dj
                         during a session s. First, the smart device di
                         computes the ciphertext 
                           
                              c
                              i
                           
                           =
                           
                              E
                              
                                 
                                 
                                    K
                                    
                                       i
                                       s
                                       j
                                    
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              
                                 m
                                 i
                              
                           
                           ,
                           i
                           ∈
                           
                              Z
                              *
                           
                         by using the symmetric key cryptographic function 
                           
                              E
                              
                                 K
                                 
                                    i
                                    s
                                    j
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              i
                           
                           =
                           
                              E
                              
                                 K
                                 
                                    j
                                    s
                                    i
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              j
                           
                         together with the secure E2E M2M exchange session key K
                        
                           isj
                        
                        =
                        K
                        
                           jsi
                         negotiated by Secure E2E M2M Key Exchange Phase. Upon receiving the secure messages, the SGA Server will store them to the Storage and forward them to the smart device dj
                        . After receiving each ciphertext message 
                           
                              c
                              i
                           
                           =
                           
                              E
                              
                                 
                                 
                                    K
                                    
                                       i
                                       s
                                       j
                                    
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              
                                 m
                                 i
                              
                           
                           ,
                           i
                           ∈
                           
                              Z
                              *
                           
                        , the smart device dj
                         will decrypt them by the symmetric key cryptographic function 
                           
                              E
                              
                                 K
                                 
                                    j
                                    s
                                    i
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              j
                           
                           =
                           
                              E
                              
                                 K
                                 
                                    i
                                    s
                                    j
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              i
                           
                         such as 
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       j
                                       s
                                       i
                                    
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              
                                 c
                                 i
                              
                           
                           =
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       j
                                       s
                                       i
                                    
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              
                                 
                                    E
                                    
                                       
                                       
                                          K
                                          
                                             i
                                             s
                                             j
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       x
                                    
                                 
                                 
                                    
                                       m
                                       i
                                    
                                 
                              
                           
                           =
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       j
                                       s
                                       i
                                    
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              
                                 
                                    E
                                    
                                       
                                       
                                          K
                                          
                                             j
                                             s
                                             i
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       x
                                    
                                 
                                 
                                    
                                       m
                                       i
                                    
                                 
                              
                           
                           =
                           
                              m
                              i
                           
                           ,
                           i
                           ∈
                           
                              Z
                              *
                           
                        .

On the contrary, if the message set M
                        ={m
                        1,
                        m
                        2,…,
                        m
                        
                           j
                        ,…},
                        j
                        ∈
                        Z*={1,2,3,…} will be secure sent one by one to the smart device di
                         by the smart device dj
                        . The smart device dj
                         compute the ciphertext c
                        
                           j
                        
                        =
                        E
                        
                           jsi
                        
                        
                           j,x
                        (m
                        
                           i
                        ),
                        i
                        ∈
                        Z* by using the symmetric key cryptographic function 
                           
                              E
                              
                                 K
                                 
                                    j
                                    s
                                    i
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              j
                           
                           =
                           
                              E
                              
                                 K
                                 
                                    i
                                    s
                                    j
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              i
                           
                         together with the secure E2E M2M exchange session key K
                        
                           jsi
                        
                        =
                        K
                        
                           isj
                         negotiated by Secure E2E M2M Key Exchange Phase. Upon receiving the secure messages, the SGA server will store them to message storage of SGA server, and forward them to the smart device di
                        . After receiving each ciphertext message c
                        
                           j
                        
                        =
                        E
                        
                           jsi
                        
                        
                           j,x
                        (m
                        
                           i
                        ),
                        i
                        ∈
                        Z*, the smart device di
                         will decrypt them by the same the symmetric key cryptographic function 
                           
                              E
                              
                                 K
                                 
                                    i
                                    s
                                    j
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              i
                           
                           =
                           
                              E
                              
                                 K
                                 
                                    j
                                    s
                                    i
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              j
                           
                        , such as 
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       i
                                       s
                                       j
                                    
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              
                                 c
                                 j
                              
                           
                           =
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       i
                                       s
                                       j
                                    
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              
                                 
                                    E
                                    
                                       
                                       
                                          K
                                          
                                             j
                                             s
                                             i
                                          
                                       
                                    
                                    
                                       j
                                       ,
                                       x
                                    
                                 
                                 
                                    
                                       c
                                       j
                                    
                                 
                              
                           
                           =
                           
                              D
                              
                                 
                                 
                                    K
                                    
                                       j
                                       s
                                       i
                                    
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              
                                 
                                    E
                                    
                                       
                                       
                                          K
                                          
                                             j
                                             s
                                             i
                                          
                                       
                                    
                                    
                                       j
                                       ,
                                       x
                                    
                                 
                                 
                                    
                                       c
                                       j
                                    
                                 
                              
                           
                           =
                           
                              m
                              j
                           
                           ,
                           j
                           ∈
                           
                              Z
                              *
                           
                        .

In this section, the Secure E2E M2M SGA is discussed and analyzed. This could provide a mutual authentication mechanism and prevent the key guessing attack, the undetectable on-line key guessing attack, the data privacy attack, and the relay attack. The proposed SGA in this paper meets the basic security requirements of the M2M service layer [19, 20]. The details of the discussions and analyses are described below.

The mutual authentication function is proposed in the Secure E2E M2M SGA, which is applied to the smart devices di
                        , dj
                         and CA of SGA server. First, both smart devices di
                         and dj
                         in the proposed scheme are protected by the trapdoor hash function F
                        
                           S
                        (•) together with the random numbers ri
                         and rj
                        . Only CA of SGA server knows this trapdoor information. Therefore, the two generated random number Ri
                         and ri
                         only CA of SGA server could be securely retrieved from F
                        
                           S
                        (r
                        
                           i
                        ) and F
                        
                           S
                        (r
                        
                           j
                        ) during the communication session s. Moreover, both smart devices di
                         and dj
                         utilize the negotiated symmetric encryption function in order to encrypt and decrypt 
                           
                              N
                              i
                           
                           ⊕
                           
                              k
                              
                                 d
                                 i
                              
                           
                         and 
                           
                              N
                              j
                           
                           ⊕
                           
                              k
                              
                                 d
                                 j
                              
                           
                        , where the two secret keys 
                           
                              k
                              
                                 d
                                 i
                              
                           
                         and 
                           
                              k
                              
                                 d
                                 j
                              
                           
                         will be needed to pending some bits in order to fit the same length of Ni
                         or Nj
                        . In the proposed SGA, the secret key of smart device di
                         is 
                           
                              k
                              
                                 d
                                 i
                              
                           
                        , and the key of smart device dj
                         is 
                           
                              k
                              
                                 d
                                 j
                              
                           
                        , which are shared securely to CA of SGA server. Thus, CA of SGA server could decrypt Ni
                         and Nj
                         via the both equations 
                           
                              E
                              
                                 k
                                 
                                    d
                                    i
                                 
                              
                           
                           
                              
                                 
                                    N
                                    i
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       i
                                    
                                 
                              
                           
                         and 
                           
                              E
                              
                                 k
                                 
                                    d
                                    j
                                 
                              
                           
                           
                              
                                 
                                    N
                                    j
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       j
                                    
                                 
                              
                           
                         by using the corresponding secret keys. Furthermore, CA of SGA server then extracts ri
                         and rj
                         from the one-way trapdoor hash functions F
                        
                           S
                        (r
                        
                           i
                        ) and F
                        
                           S
                        (r
                        
                           j
                        ). And then, CA of SGA server could compute the one-time strong keys 
                           
                              K
                              is
                           
                           =
                           
                              
                                 N
                                 i
                              
                              
                                 r
                                 i
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                         and 
                           
                              K
                              
                                 j
                                 s
                              
                           
                           =
                           
                              
                                 N
                                 j
                              
                              
                                 r
                                 j
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                         from the values ri
                        , rj
                        , Ni
                         and Nj
                        . Accordingly, CA of SGA server could verify the received hash values 
                           
                              f
                              
                                 K
                                 is
                              
                           
                           
                              
                                 N
                                 i
                              
                           
                         and 
                           
                              f
                              
                                 K
                                 
                                    j
                                    s
                                 
                              
                           
                           
                              
                                 N
                                 j
                              
                           
                        . If these mutual authentication procedures between both smart devices di
                         and dj
                         are successful, then both smart devices di
                         and dj
                         are the legitimate users in the IoTs system.

On the contrary, when the mutual authentication procedure are checked and performed by both smart devices di
                         and dj
                        , CA of SGA server could use the pre-computed keys 
                           
                              K
                              is
                           
                           =
                           
                              
                                 N
                                 i
                              
                              
                                 r
                                 i
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                         and 
                           
                              K
                              
                                 j
                                 s
                              
                           
                           =
                           
                              
                                 N
                                 j
                              
                              
                                 r
                                 j
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                         to compute the hash values 
                           
                              f
                              
                                 K
                                 is
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    is
                                 
                                 ,
                                 
                                    
                                       N
                                       j
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                         and 
                           
                              f
                              
                                 K
                                 
                                    j
                                    s
                                 
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    
                                       j
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                       i
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                        . Consequently, CA of SGA server sends the messages 
                           
                              
                                 N
                                 j
                              
                              
                                 R
                                 S
                              
                           
                        , 
                           
                              f
                              
                                 K
                                 is
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    is
                                 
                                 ,
                                 
                                    
                                       N
                                       j
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                         to smart device di
                        . Similarly, CA of SGA server will be asked to send the messages 
                           
                              
                                 N
                                 i
                              
                              
                                 R
                                 S
                              
                           
                         and 
                           
                              f
                              
                                 K
                                 
                                    j
                                    s
                                 
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    
                                       j
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                       i
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                         to smart device dj
                        . When the smart device di
                         or dj
                         receives the messages sent from CA of SGA server, the smart device di
                         or dj
                         then checks 
                           
                              f
                              
                                 K
                                 is
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    is
                                 
                                 ,
                                 
                                    
                                       N
                                       j
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                         or 
                           
                              f
                              
                                 K
                                 
                                    j
                                    s
                                 
                              
                           
                           
                              
                                 I
                                 
                                    D
                                    
                                       d
                                       i
                                    
                                 
                                 ,
                                 I
                                 
                                    D
                                    
                                       d
                                       j
                                    
                                 
                                 ,
                                 
                                    K
                                    
                                       j
                                       s
                                    
                                 
                                 ,
                                 
                                    
                                       N
                                       i
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                           
                         in order to verify them again. If the authentication procedure for SGA sever is successful, then the smart device di
                         or dj
                         could trust the SGA sever in order to further perform the secure E2E M2M key as 
                           
                              
                                 
                                    
                                       N
                                       j
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                              
                                 R
                                 i
                              
                           
                           =
                           
                              K
                              
                                 i
                                 s
                                 j
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                        
                        =
                        
                           
                              
                                 
                                    
                                       N
                                       i
                                    
                                    
                                       R
                                       S
                                    
                                 
                              
                              
                                 R
                                 j
                              
                           
                           =
                           
                              K
                              
                                 j
                                 s
                                 i
                              
                           
                           
                              
                                 mod
                                 p
                              
                           
                        .

Finally, through the above discussions, CA of SGA server could verify the both smart devices di
                         and dj
                         are legal or not. Conversely, both smart devices di
                         and dj
                         could also verify the CA of SGA server is fake or not. Therefore, the proposed secure E2E M2M SGA could provide the mutual authentication mechanism in IoTs system.

In the subsection, the secure E2E M2M SGA is respectively analyzed how it could prevent the key guessing attack. Generally, an attacker may use the detectable/undetectable on-line guessing attacks to get the key of Smart device. Because of the sensitivity information such as 
                           
                              E
                              
                                 k
                                 
                                    d
                                    i
                                 
                              
                           
                           
                              
                                 
                                    N
                                    i
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       i
                                    
                                 
                              
                           
                        , 
                           
                              E
                              
                                 k
                                 
                                    d
                                    j
                                 
                              
                           
                           
                              
                                 
                                    N
                                    j
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       j
                                    
                                 
                              
                           
                        , F
                        
                           s
                        (r
                        
                           i
                        ),
                        F
                        
                           s
                        (r
                        
                           i
                        ), 
                           
                              f
                              
                                 K
                                 is
                              
                           
                           
                              
                                 N
                                 i
                              
                           
                         and 
                           
                              f
                              
                                 K
                                 
                                    j
                                    s
                                 
                              
                           
                           
                              
                                 N
                                 j
                              
                           
                         are protected by using the 
                           
                              k
                              
                                 d
                                 i
                              
                           
                        , 
                           
                              k
                              
                                 d
                                 j
                              
                           
                        , Ni
                        , Nj
                        , ri
                        , rj
                         and the trapdoor hash function. Therefore, the attacker doesn't know the M2M's key via variety guessing attacks. However, each smart device has her/him own key only shared by the CA of SGA server. If the authentication procedure is fail, the request will be reject. Thus, the proposed schemes could effectually protect the off-line key guessing attack.

For preventing the on-line undetectable key guessing attacks, the operations of both 
                           
                              N
                              i
                           
                           ⊕
                           
                              k
                              
                                 d
                                 i
                              
                           
                         and 
                           
                              N
                              j
                           
                           ⊕
                           
                              k
                              
                                 d
                                 j
                              
                           
                         are added into the symmetric key exchange algorithms as 
                           
                              E
                              
                                 k
                                 
                                    d
                                    i
                                 
                              
                           
                           
                              
                                 
                                    N
                                    i
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       i
                                    
                                 
                              
                           
                        , 
                           
                              E
                              
                                 k
                                 
                                    d
                                    j
                                 
                              
                           
                           
                              
                                 
                                    N
                                    j
                                 
                                 ⊕
                                 
                                    k
                                    
                                       d
                                       j
                                    
                                 
                              
                           
                        . However, the keys are shared between the CA of SGA server and the corresponding smart devices. When attackers want to guess the corresponding secret key of both smart devices, they need to pass the authentication procedure. Owing to the corresponding secret keys are only kept by the CA of SGA server and corresponding smart devices, such that the secret key 
                           
                              k
                              
                                 d
                                 i
                              
                           
                         corresponds to smart device di
                         and the key 
                           
                              k
                              
                                 d
                                 j
                              
                           
                         corresponds to smart device dj
                        . Therefore, the proposed schemes could resist the undetectable on-line key guessing attack.

In the original standard [4–7,19,15–17], messages transmitted between smart devices and the GA (Gateway Application) are not protected. Adversaries can utilize a malicious smart device to hear any message transmitted between the GA and other smart devices. Our proposed scheme exploits the idea of the SGA in E2E M2M communication. Messages are encrypted by using the negotiated symmetric key cryptographic function 
                           
                              E
                              
                                 K
                                 
                                    i
                                    s
                                    j
                                 
                              
                              
                                 i
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              i
                           
                           =
                           
                              E
                              
                                 K
                                 
                                    j
                                    s
                                    i
                                 
                              
                              
                                 j
                                 ,
                                 x
                              
                           
                           
                              ·
                           
                           ∈
                           
                              ℂ
                              j
                           
                         together with the secure E2E M2M exchange session key K
                        
                           isj
                        
                        =
                        K
                        
                           jsi
                         by the Secure E2E M2M Key Exchange Phase. Without the symmetric key, adversaries only derive non-meaningful binary data from the cipher. Due to each round of encrypted/decrypted procedures in both the smart devices being protected by two random numbers Rj
                         and rj
                         for a specific session s, the proposed SGA can easily prevent the data privacy attack.

The relay attack means that both smart devices and the SGA server in E2E M2M communication controlled by an adversary. The adversary relays a message sent by the smart device to trick the SGA server. In the proposed Secure E2E M2M SGA, messages are encrypted using a negotiated symmetric key cryptographic function and exchange session key produced according to distinct random numbers kept by the CA of the SGA server only for session s. Only if the adversary could derive the symmetric key, the adversary cannot know any message within them. In the proposed Secure End to End M2M SGA, adversaries cannot tamper with messages because they doesn't know the symmetric keys because we use the distinct to distinct random numbers kept by the CA of the SGA server only for each session s. Also, the mutual authentication information mechanism could detect the illegal smart devices that want to obtain confidential information by using a false identity. When both smart devices and SCA server execute the authentication procedures as described above, attackers engaging in relay attacks will be detected by the transponders. Thus, our scheme can prevent the relay attack.

@&#DISCUSSION@&#

Due to traditional security solutions are not able to be applied to E2E M2M networks in IoTs systems, the M2M networks itself are vulnerable to various attacks. The proposal functions of the SGA are defined for secure M2M communications including the Lightweight Symmetric Key Cryptographic Negotiation Function, Secure E2E M2M Key Exchange Generation Function and Secure E2E M2M Messages Delivery Function. It is a newly suggestion for improving the gateway application (GA) of the ITU-T M2M service layer in the IoTs reference model [19]. Its lightweight cryptographic symmetric key algorithm could be used to negotiate by both smart devices for each E2E M2M communication session. It could be choice flexibility for the energy-limited smart devices. In addition, the cryptographic exchange key algorithm could provide the mutual authentication mechanism. We prove that it is could prevent the key guessing attack, the undetectable online key guessing attack, the data privacy attack, and the relay attack. Therefore, the proposal functions of the SGA in this paper are suitable to be a new standard interface because their meet the basic security requirements of the M2M service layer mentioned in Section 1.

@&#CONCLUSIONS@&#

Owing to the increasingly growing reliance on M2M services plays a very important role in the IoTs system, which is accompanied by the growing number of vulnerabilities and attacks on their smart devices and application servers. Thus, there is an increasingly huge demand for security solutions. Therefore, the proposed SGA could provide a mutual authentication mechanism, and prevent the key guessing attack, the undetectable on-line key guessing attack, the data privacy attack as well as the relay attack. The SGA proposed in this paper meets the core security requirements of the M2M service layer [4–7]. Considering the characteristics of the E2E M2M service layer for IoTs systems, traditional security solutions are not proper to be applied to E2E M2M networks. To ensure each smart device is able to securely communicate with each other, the SGA includes the Lightweight Symmetric Key Cryptographic Negotiation Function, Secure E2E M2M Key Exchange Generation Function and Secure E2E M2M Messages Delivery Function. Moreover, the lightweight cryptographic symmetric key algorithm is proposed to negotiate by both E2E energy-limited smart devices providing a flexible choice for each M2M communication session. The proposed SGA could provide a mutual authentication mechanism and prevent the key guessing attack, the undetectable on-line key guessing attack, the data privacy attack and the relay attack. Furthermore, the suggested SGA could be a newly standard interface for satisfying the basic security requirements of the M2M service layer.

@&#ACKNOWLEDGMENT@&#

This work was supported in part by the Ministry of Science and Technology, Taiwan, Republic of China, under Grant MOST 104-2221-E-468-002.

@&#REFERENCES@&#

