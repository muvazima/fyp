@&#MAIN-TITLE@&#A diagnostic tool for population models using non-compartmental analysis: The ncappc package for R

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                              
                           
                           
                              ncappc performs (i) NCA and (ii) simulation-based posterior predictive checks using NCA metrics.


                        
                        
                           
                              
                           
                           
                              ncappc package is highly flexible and comprehensive.


                        
                        
                           
                           Can perform both individual and population level diagnostics.


                        
                        
                           
                           Produces output summarizing the diagnostic results including the model specific outliers.


                        
                        
                           
                           The output is easy to interpret and to use in evaluation of a population PK model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Non-compartmental analysis (NCA)

PK

NONMEM

Posterior predictive check

Simulation-based diagnostic

@&#ABSTRACT@&#


               
               
                  Background and objective
                  Non-compartmental analysis (NCA) calculates pharmacokinetic (PK) metrics related to the systemic exposure to a drug following administration, e.g. area under the concentration–time curve and peak concentration. We developed a new package in R, called ncappc, to perform (i) a NCA and (ii) simulation-based posterior predictive checks (ppc) for a population PK (PopPK) model using NCA metrics.
               
               
                  Methods
                  The nca feature of ncappc package estimates the NCA metrics by NCA. The ppc feature of ncappc estimates the NCA metrics from multiple sets of simulated concentration–time data and compares them with those estimated from the observed data. The diagnostic analysis is performed at the population as well as the individual level. The distribution of the simulated population means of each NCA metric is compared with the corresponding observed population mean. The individual level comparison is performed based on the deviation of the mean of any NCA metric based on simulations for an individual from the corresponding NCA metric obtained from the observed data. The ncappc package also reports the normalized prediction distribution error (NPDE) of the simulated NCA metrics for each individual and their distribution within a population.
               
               
                  Results
                  The ncappc produces two default outputs depending on the type of analysis performed, i.e., NCA and PopPK diagnosis. The PopPK diagnosis feature of ncappc produces 8 sets of graphical outputs to assess the ability of a population model to simulate the concentration–time profile of a drug and thereby evaluate model adequacy. In addition, tabular outputs are generated showing the values of the NCA metrics estimated from the observed and the simulated data, along with the deviation, NPDE, regression parameters used to estimate the elimination rate constant and the related population statistics.
               
               
                  Conclusions
                  The ncappc package is a versatile and flexible tool-set written in R that successfully estimates NCA metrics from concentration–time data and produces a comprehensive set of graphical and tabular output to summarize the diagnostic results including the model specific outliers. The output is easy to interpret and to use in evaluation of a population PK model. ncappc is freely available on CRAN (http://cran.r-project.org/web/packages/ncappc/index.html/) and GitHub (https://github.com/cacha0227/ncappc/).
               
            

@&#INTRODUCTION@&#

The principal objective of the pharmacokinetics (PK) studies is to understand the kinetics of a drug molecule in terms of absorption, distribution, metabolism and elimination (ADME). PK data analysis can primarily be classified into non-compartmental analysis (NCA) and model-based analysis, where the latter can range from compartment models to physiology-based models [1]. The NCA benefits from fewer assumptions, compared to model-based approaches. In NCA, the area under the curve (AUC), peak observed drug concentration (C
                     max), time of peak concentration (T
                     max), terminal elimination rate constant (Lambda_z), terminal half-life (HL_Lambda_z) and other metrics are estimated to determine the systemic exposure of a drug following administration. NCA is typically an essential part of PK analysis in the field of drug discovery and in richly sampled clinical PK studies. Regulatory decisions regarding bioequivalence studies are often based on comparisons of AUC and C
                     max, in particular. Additionally, NCA may also be used as a diagnostic tool to evaluate the performance of any compartmental population pharmacokinetic (PopPK) models by comparing the NCA metrics obtained from simulated concentration–time data to the same metrics obtained from the observed concentration–time profile. This can provide information on the models ability to provide adequate description of exposure measures that are typically judged as important for richly sampled concentration–time profiles.

A number of software tools (such as Kinetica [2], WinNonlin [3], PK module in R [4], Scientist [5], PKSolver [6]) are available that can perform NCA. As a novelty, we have extended the use of NCA as a pharmacometric model diagnostic tool employing the principles of a posterior predictive check [7] with the NCA metrics as test statistics. In this article we report a simulation-based diagnostic package, called ncappc, written in R [8] that (i) provides a simple and flexible method to estimate the NCA metrics from the observed data and (ii) compares them with the same metric estimated from multiple data sets simulated using the PopPK model to be diagnosed. Thus ncappc helps to bridge the gap between NCA and population model analyses. ncappc package can potentially facilitate the early stage of the drug discovery process by evaluating the performance of the related PopPK model and identify the model specific outliers.

@&#METHODS@&#

The ncappc package is implemented in R and accepts a set of input arguments, resulting in certain processing of data and output production. Table 1
                         depicts the list of acceptable arguments with default values of the arguments. The names of most of the NCA metrics estimated by the ncappc function are consistent with those used in WinNonlin [3]. A comparison of NCA metrics obtained by the ncappc package and WinNonlin showed no discrepancies and the results can be found in the Supplementary material-I.


                        obsFile and simFile arguments, used in ncappc, represent the observed and the simulated data. The default values of these two arguments are “nca_original.npctab.dta” and “nca_simulation.1.npctab.dta”, respectively. To perform NCA, obsFile argument should be adjusted to the correct name of the observed data file. If simFile argument is NULL and the working directory does not contain “nca_simulation.1.npctab.dta”, only nca feature of this package will be executed. The name of the simulation output file, structured as is common in table files of many software including NONMEM [9] is supplied via simFile argument to use the ppc feature of the package. All other arguments are optional and their default value may be adjusted according to the description given in Table 1.

There are three arguments (namely str1Nm, str2Nm and str3Nm) in ncappc that can be used to stratify the study population. For a single layer of stratification any of these arguments can be used. If they are used in combination, the population is stratified into nested layers, where str1Nm, str2Nm and str3Nm represent the 1st, 2nd and 3rd levels of stratification, respectively.

If no units are supplied for the dose, time or concentration, ncappc labels the NCA metrics with appropriate dimensionality in terms of mass (M), length (L) and time (T). Fig. 1
                         displays the workflow of this function. If the simFile argument is omitted only NCA on observed data is performed while inclusion of the simFile argument results in both NCA calculations and the ppc-based diagnostics. Details of the output generated by ncappc package are described in the Supplementary material-II. In brief, the NCA feature produces two sets of figures displaying the concentration vs. time profile for each individual within a certain population group and the histogram of four NCA metrics (AUClast, AUCINF_obs, C
                        max and T
                        max) estimated from the observed data (see the Supplementary material-I for the definitions). Additionally, two tables are produced representing the estimated individual values of the NCA metrics obtained from the observed data and the values of various population statistics of each of the NCA metrics estimated from the observed data, respectively. Please see the Supplementary material-II for the description of the output tables and figures generated by ncappc.

In the presence of the simulated data obtained using of the concerned PopPK model, ncappc function estimates the same set of NCA metrics from each set of the simulations. Next, the function performs the individual and population level diagnostic tests and produces a complete report with the graphical and tabular outputs reporting the individual and population level diagnostic results involving simulation mean, deviation from the observed value and Normalized Prediction Distribution Error (NPDE) values of each NCA metric. All tables produced by ncappc are in tab-separated text format and can be easily loaded in generic data visualization software like Excel, R, etc.

The objective of this feature of the ncappc package is to perform a PopPK model evaluation using simulation-based diagnostics by comparing the NCA metrics estimated from the simulated data with the same metrics estimated from the observed data. As NONMEM [9] is the most widely used software in non-linear mixed-effect modeling of PK/PD data, currently the model evaluation part of the ncappc package is based on the simulation output obtained from NONMEM, but other software can generate the same type of output to be used as input for this routine. The PopPK model to be evaluated is used to simulate k sets of the plasma concentration vs. time profile using NONMEM, where k is a positive integer. ncappc produces k sets of NCA metrics for each individual from the simulated data. This package allows the user to employ any combination of the following eight NCA metrics for the model evaluation tests: AUClast, AUClower_upper, AUCINF_obs, AUCINF_pred, AUMClast, C
                        max, T
                        max, HL_Lambda_z (see the Supplementary material-I for the definitions). As a defult, ncappc uses AUClast and C
                        max for model evaluation tests. The NCA metrics obtained from the observed and the simulated data are subjected to the following set of diagnostic tests to evaluate the performance of the PopPK model.

A complete set of NCA metrics are estimated for each individual from each set of simulated data. The population mean of each of the NCA metrics is calculated for every single set of the simulated data. The probability distribution of the population means of each NCA metric estimated from the simulated data is compared graphically with the population mean of the corresponding NCA metric estimated from the observed data. In the presence of stratified population, the population means are calculated for each stratum separately for the comparison. Depending on the value of the spread argument to the function, the spread of the simulated distribution can be quantified as: (i) 95% parametric prediction interval (ppi) or (ii) 95% nonparametric prediction interval (npi). For derivation of prediction intervals, see Supplementary material-I. As a preliminary graphical analysis, this function detects if the NCA metric estimated from the observed data lies within 95% ppi or npi of the distribution of the population mean of the NCA metric estimated from the simulated data.

Based on the simulated data sets the NPDE of the NCA metrics for each individual is computed using the method reported by Comets et al. [10]. The population mean and SD (including imprecision) of the NPDEs are compared with the expected values (i.e. mean 0, SD 1) in forest plots. The probability density of the NPDE values for the entire population is produced and compared with respect to the normal distribution with mean 0 and variance 1.

As a part of the individual level diagnosis, deviation of the simulation-based mean of the NCA metrics for each individual from the corresponding NCA metrics estimated from the observed data are calculated by subtracting the individual simulation-based mean of the NCA metrics from the same estimated from the observed data. The value of the deviation is scaled by the spread of the corresponding simulated distribution (measured either as 95% ppi or 95% npi). In case of ppi, the deviation is divided by the distance of the simulation mean to the 95% ppi boundary; in case of 95% npi, the deviation is divided by the distance of the simulation mean to the 95% npi boundary nearer to the observed value. Such deviation is calculated for each of the NCA metrics used for model diagnosis. A negative value of the deviation signifies over-prediction of the corresponding NCA metric, while a positive value of the deviation signifies under-prediction of the same. An individual yielding the absolute value of the scaled deviation >1, corresponding to the individual lying outside of the corresponding 95% prediction interval of the model, for any of the NCA metrics used for model diagnosis is considered as an outlier for the specific model. For an outlier the probability distribution of the NCA metric compared with the corresponding observed values are reported graphically.

The NPDE values for the NCA metrics for each individual are calculated and reported. Theoretically the NPDE values should be distributed normally with a mean of 0 and SD of 1. The distribution of the individual NPDE values for each NCA metric is plotted for each population stratum to detect any trend or model bias.

@&#RESULTS@&#

Moxonidine is a centrally acting antihypertensive drug used for the treatment of mild to moderate hypertension. Here we present a case study to illustrate the package of ncappc package using the data obtained from the population pharmacokinetic study reported by Karlsson et al. [11]. The basic information regarding the Moxonidine PK data set is shown in Table 2
                        . In this study 74 patients were included in the active treatment group and treated with extravascular dose of Moxonidine. Patients receiving the active treatment were divided into three population groups or treatment arms (DGRP 7, 8 and 9) and each arm received Moxonidine in two different occasions (VISI 3 and 8). The individuals in DGRP 7 received 200μg of daily dose for both occasions (VISI 3 and VISI 8); the individuals in DGRP 8 received 200μg daily dose at the first occasion (VISI 3) and then 400μg daily dose at the second occasion (VISI 8) and the individuals in DGRP 9 received 200μg daily dose and 600μg daily dose of Moxonidine in VISI 3 and VISI 8, respectively. Pharmacokinetic sampling was performed at both occasions for each subject. A one-compartmental linear PopPK model with first-order absorption with lagtime was used to simulate the concentration vs. time profile 1000 times for each individual. The NCA metrics were estimated from both observed and simulated data sets. AUClast and C
                        max metrics were used for the diagnostic tests. Fig. 2
                         presents the plasma concentration profile of the individuals obtained from the observed data. Fig. 3
                         represents the population distribution of four NCA metrics (AUClast, AUCINF_obs, C
                        max and T
                        max) estimated from the observed data. The solid and dashed blue vertical lines represent the population mean and the spread of the NCA metrics estimated from the observed data. The spread is defined by the 2.5th and 97.5th percentile boundaries of the NCA metrics obtained from the observed data.


                           Fig. 4
                            represents the histogram of the population mean of the NCA metrics estimated from the set of simulated data. The spread of the distribution of the simulated NCA metrics was measured by the 95% npi, calculated from the distribution of the population means estimated from each set of simulated data.

The graphical report of the distribution of the estimated population means compared to the observed population of the NCA metrics is used to determine the general performance of the PopPK model to reproduce the drug exposure profile for the entire population. In general, if the 95% npi of the distribution of the simulated NCA metrics used for the diagnostics fail to encompass the population mean of the corresponding NCA metrics estimated from the observed data, the PopPK model may be revisited for improvement. In this case, the given PopPK model is able to satisfy the condition with respect to AUClast and C
                              max.


                           Fig. 5
                            represents the deviation of the mean of each of the two NCA metrics for each individual within DGRP 7 and VISI 3 estimated from the 1000 sets of simulated data from the value of the same metric estimated from the observed data. The raw values of the deviations were scaled by dividing them by the distance between the simulation mean and the 95% npi boundary nearer to the observed value.

The values of the scaled deviation for each individual within a specific treatment arm or population group are used to detect model misspecification and individual outliers. Any individual yielding the absolute value of the scaled deviation greater than 1 is labeled as an outlier by ncappc for the PopPK model. The total number of identified outliers in the case of Moxonidine data set was 5 out of 74 individuals and across 2 different metrics (C
                              max and AUClast) and 2 profiles per subject. Last column in Table 2 lists the ID numbers and the corresponding NCA metric of the individuals who are assigned as outliers for their corresponding population groups under the given PopPK model. Fig. 6
                               illustrate the probability distribution of the NCA metrics of one of these outliers (ID-402_DGRP-7_VISI-8) where the absolute value of the scaled deviation of C
                              max was greater than 1.

The NPDE values of all NCA metrics used in diagnostics for each individual are reported. The population mean and the standard deviation of the NPDE values for the NCA metrics are also calculated and shown in a forest plot (Fig. 7
                           ) along with the corresponding 95% confidence intervals. For derivation of confidence intervals, see Supplementary material-I. Fig. 8
                            represents the NPDE values of AUClast and C
                           max for each individual in DGRP 7 and VISI 3. Fig. 9
                            represents the probability distribution of the NPDE values for all individuals within a specific treatment arm and occasion group DGRP 7 and VISI 3.

The forest plot (Fig. 6) shows that the mean NPDE values of AUClast and C
                              max of all treatment arms and occasions. For an acceptable PopPK model, the population mean and SD along with their confidence interval should encompass 0 and 1, respectively. The population model successfully produces the 95% confidence intervals of the mean of the NPDE values encompassing 0, however, the 95% confidence intervals of the SD of the NPDEs of AUClast in DGRP 8 for VISI 3 and the same of C
                              max in DGRP 8 for VISI 8 fail to encompass 1. This indicates a discrepancy between the PopPK model and the observed data for these metrics in these treatment groups. Nonetheless, Figs. 8 and 9 do not show any systematic trend of errors for AUClast and C
                              max.

The results of the above mentioned set of population level and individual level diagnostic tests for the studied PopPK model are systematically reported by the ncappc package and it produces a complete report in HTML and PDF format. The results of the diagnostic tests can be used to identify model misspecifications at the population level; the results of the ncappc can also be used to identify specific individuals, which are misfits to the concerned PopPK model or to the definition of the population strata. The conclusions drawn based on the diagnostics will be dependent on the intended use of the model and also which specific model aspect that this diagnostic is used for. Thus, the consequence of the diagnostics for the further model development will vary between project and criteria. An acceptable discrepancy may need to be defined for each case. For example, if the main purpose of the model is to describe the general tendency in the data, the population level diagnostics will be of most importance.

@&#CONCLUSION@&#

The ncappc package is a versatile and flexible tool-set written in R that successfully estimates the NCA metrics related to NCA from the observed and a set of simulated concentration–time data. It produces a comprehensive set of graphical and tabular output to summarize the results of the diagnostic tests including the model specific outliers. The output is easy to interpret and to use in evaluation of a population model. This program also produces a complete report in PDF and HTML format. ncappc is freely available on CRAN and GitHub at the following URL, respectively.

CRAN: http://cran.r-project.org/web/packages/ncappc/index.html/.

GitHub: https://github.com/cacha0227/ncappc/.

@&#ACKNOWLEDGEMENTS@&#

The research leading to these results has received support from the Innovative Medicines Initiative Joint Undertaking under grant agreement n° 115156, resources of which are composed of financial contributions from the European Union's Seventh Framework Programme (FP7/2007–2013) and EFPIA companies’ in kind contribution. The DDMoRe project is also financially supported by contributions from Academic and SME partners. The authors would also like to acknowledge The Scientific and Technological Research Council of Turkey (TÜBİTAK) for supporting postdoctoral research of Gülbeyaz Yıldız Türkyılmaz and Ege University, Center for Drug Research & Development and Pharmacokinetic Applications (ARGEFAR), İzmir, Turkey for providing us with the license of WinNonlin.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cmpb.2016.01.013.

The following are the supplementary data to this article:
                        
                           
                        
                     
                     
                        
                           
                        
                     
                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

