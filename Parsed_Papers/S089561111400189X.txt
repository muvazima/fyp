@&#MAIN-TITLE@&#The voxel visibility model: An efficient framework for transfer function design

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose the voxel visibility model for transfer function in volume rendering.


                        
                        
                           
                           We propose an optimization algorithm for automatic transfer function design.


                        
                        
                           
                           The voxel visibility model is a feature- and voxel-level model.


                        
                        
                           
                           The voxel visibility model can be efficiently used by users.


                        
                        
                           
                           The voxel visibility model provides an importance-based strategy.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Volume visualization

Visibility

Transfer function design

Gaussian mixture model

GPU

@&#ABSTRACT@&#


               
               
                  Volume visualization is a very important work in medical imaging and surgery plan. However, determining an ideal transfer function is still a challenging task because of the lack of measurable metrics for quality of volume visualization. In the paper, we presented the voxel vibility model as a quality metric to design the desired visibility for voxels instead of designing transfer functions directly. Transfer functions are obtained by minimizing the distance between the desired visibility distribution and the actual visibility distribution. The voxel model is a mapping function from the feature attributes of voxels to the visibility of voxels. To consider between-class information and with-class information simultaneously, the voxel visibility model is described as a Gaussian mixture model. To highlight the important features, the matched result can be obtained by changing the parameters in the voxel visibility model through a simple and effective interface. Simultaneously, we also proposed an algorithm for transfer functions optimization. The effectiveness of this method is demonstrated through experimental results on several volumetric data sets.
               
            

@&#INTRODUCTION@&#

Volume visualization is an effective and flexible technique for exploring meaningful structures in 3D scalar fields. It is often used in medical imaging and surgery plan. The key to comprehensible volume visualization still lies in the design of effective transfer functions. A transfer function provides a map for the attributes in volume space to the attributes in visual space. It plays an important role in the understanding of the overall volumetric data and the individual features contained within the volume space. However, an effective transfer function design is difficult and time-consuming, as witnessed by the large amounts of literature on transfer function designs.

Several problems prevent users from effectively obtaining satisfactory rendered images of volumes. First, the domain of the transfer function space is too large. In traditional 1D or multi-dimensional transfer functions, users design transfer functions through trial-and-error modifications of opacity and color values to obtain accurately identifying and visually distinguishing various objects in a volume. However, there are more than 104 different transfer functions for trials when the step is 0.1 in the domain and range, even in 1D transfer function space, which causes the transfer function design to be ineffective. To improve efficiency, two types of strategy are proposed. The traditional strategy is to reduce the domain of the transfer function space using a feature cluster approach[1,2]. Recently, a semi-automatic transfer function design based on a visibility metric [3–5] was proposed. In the visibility histogram [3], the metric is defined on bins of volume data sets, and users can design visibility at the voxel level. However, the influence of each feature on the rendered image, which is of greater concern to users, is not considered. In feature visibility [4], the metric is defined directly on the features. It is efficient for users to adjust the visibility of different features. However, feature visibility is designed at the feature level. The visibility of voxels in the same feature, which represents greater detail, cannot be adjusted.

In this paper, a new concept, i.e. the voxel visibility model, is proposed to automate transfer function design. The voxel visibility model is a mapping function from voxels feature attributes to their visibility attributes, which allows users to directly adjust the visibility of each voxel. Additionally, feature information is contained in the model. Thus, users can design a visibility metric at both the feature and voxel levels simultaneously. Based on the voxel visibility model, an energy function is defined to model the mismatch between the actual projected visibility distribution and the desired visibility distribution. The opacity is automatically obtained by an optimization process of the energy function. In this paper, we provide two distribution models: the average distribution model and the accumulated distribution model. The voxel visibility model is provided by the Gaussian mixture model (GMM). Different desired visibility distributions can be obtained by manipulating the shape, size and orientation of the voxel visibility model for flexible volume exploration. Fig. 1
                     . provides a two-step exploration procedure.

@&#RELATED WORK@&#

Generally, transfer function is categorized as data-centric method and image-centric method. In this section, we mainly review a few recent data-centric methods for transfer function design. At the same time, these methods are categorized as attributes-space method, cluster-space method and goal-oriented method. Here, attributes-space method means that the feature attributes of voxels are directly mapped to opacities and colors. Cluster-space method means that voxels are first clustered by the feature attributes, then different cluster are directly mapped to different opacities and colors. Goal-oriented method means that transfer function design is modeling as a optimization process.

The most commonly used function is the 1D transfer function, which is based on scalar data values [6]. Furthermore, researchers have proposed higher-dimensional transfer functions based on the first- and second-derivative attributes of the volume, i.e., gradient [7] and curvature [8], respectively. Recently, other statistical attributes were used for transfer function design. Haidacher et al. [9] proposed mean value and standard deviation of the data value to define the transfer-function space. Correa and Ma [10] described a size-based transfer function. Sereda et al. [11] proposed a method for the visualization of boundaries based on an LH histogram, which used lower and higher intensities of materials as attributes. Caban [12] developed a texture-based transfer function that mapped local textural properties to the voxels opacity and color. However, determining the appropriate transfer functions remains difficult because users must understand the dimensionality of the attributes space with which they are interacting.

To simplify the creation of transfer functions from feature attributes to opacity and color, significant work has been performed to enable users to work in cluster space. The transfer function is designed in cluster space rather than in attribute space. Tzeng and Ma [1] used an ISO-DATA algorithm to perform clustering for regions of interest. Maciejewski et al. [2] applied a non-parametric kernel density estimation to group voxels with similar features within a 2D histogram. Wang et al. [13] explored volumetric features by modeling the attributes space using the GMM to maximize the likelihood of feature separation. Roettger et al. [14] proposed spatial transfer functions by grouping spatially connected regions in the 2D histograms. Selver and Gzelis [15] used a fully self-generating hierarchical radial basis function network to analyze a volume histogram stack. Guo et al. [16] proposed an interface to enable users to identify interesting clusters and assign optical properties based on parallel coordinate plots. Cheuk et al. [17] presented a semiautomatic approach to discover embedded features and spatial structures. The cluster-space transfer function improved the efficiency of the transfer function design. Harald et al. [18] presented a solution that aims at alleviating the problems of interactive multi-dimensional transfer function design. However, evaluating the quality of the transfer function is still subjective.

The lack of an objective measure to quantify the quality of the transfer function makes the effective transfer function design to be time-consuming. Recently, researchers have proposed goal-oriented transfer functions, which describe transfer function design as an optimizing model. Rafael et al. [19] suggested a topology-motivated noise measure based on the Euler Characteristic to aid transfer function design. Chan et al. [20] introduced a suite of measures based on psychological principles to evaluate the perceptual quality of transparent structures in rendered images. Correa and Ma [3] proposed a visibility metric to measure the impact of individual samples on the image generated. Wu and Qu [21] proposed a method that used editing operations and a stochastic search of transfer parameters to maximize the similarity between images provided by the user. Ruiz et al. [5] designed transfer functions by minimizing the informational divergence between the visibility distribution captured and a target distribution. Guo et al. proposed a WYSIWYG [22] approach to match the sparse sketching input with the clustered features both in image and volume space. Wang et al. [4] extended visibility histograms to feature visibility, which measures the contribution of each feature in the rendered image. Zhou et al. [23] proposed a transfer function design approach using selected samples from the spatial domain represented as slices for a more intuitive exploration of the volume datasets. Lathen et al. [24] proposed an automatic, optimization-based method that shifts transfer function presets to account for general deviations and local variations in intensity for contrast-enhanced blood vessels.

In this paper, the proposed voxel visibility model is both cluster-based and goal-oriented. Our method provides a flexible interaction technique to explore the volume data by modifying the voxel visibility model in transfer function space, which is similar to the control of the visibility of features in importance-driven volume rendering [25].

@&#METHODOLOGY@&#

In this section, we first introduce our framework for transfer function design based on the voxel visibility model. In the second part, we describe the voxel visibility model in the detail. Then, the objective function and the optimizer is constructed. At last, GPU-assisted computation is discussed.

The goal of volume visualization is to transfer information from the volume data space to the visual space. In the paper, the voxel visibility model is constructed as a quality metric to describe the desired distribution of visibility. Then, the idea of the transfer function specification is to minimize the distance between the distribution of the projected visibility of volume and the desired distribution of visibility.

The pipeline of the opacity specification based on the voxel visibility model is presented in Fig. 2
                        . The process begins with the volume data. Then, a data distribution model is constructed for the volume data using the GMM. The data distribution model provides both the original transfer function and the original voxel visibility model. Using the initial transfer function and the voxel visibility model, the objective function, based on the distance between the distribution of the projected visibility of volume and the desired distribution of visibility, is evaluated. By minimizing the objective function, the optimizer assesses a new transfer function using an iterative algorithm. To reveal different features and their details, the voxel visibility model can be specified repeatedly by changing the parameters.

To consider between-class information and within-class information simultaneously, the voxel visibility model is defined as a feature- and voxel-level model. It specifies the visibility for each voxel based on the feature information, is represented as:
                           
                              (1)
                              
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    v
                                    
                                       max
                                       i
                                    
                                 
                                 
                                    g
                                    i
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                              
                           
                        where x is the feature attributes vector of voxels,
                           
                              v
                              
                                 max
                                 i
                              
                           
                         is the maximum desired visibility of the i-th feature, g
                        
                           i
                        (x) is the visibility distribution function for the i-th feature. g
                        
                           i
                        (x) can be a constant function, linear function, Gaussian function, or other functions. In the paper, we used Gaussian function as the visibility distribution function. Thus, the voxel visibility model is designed as follows:


                        
                           
                              (2)
                              
                                 v
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    
                                       v
                                       
                                          max
                                          i
                                       
                                    
                                 
                                 
                                    e
                                    
                                       −
                                       
                                          1
                                          2
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      μ
                                                   
                                                
                                                i
                                                v
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      Σ
                                                   
                                                
                                                i
                                                v
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             
                                                μ
                                             
                                          
                                          i
                                          v
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                              
                              i
                              v
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                              
                              i
                              v
                           
                         are the mean value vector and covariance matrix of the visibility distribution for the i-th feature, respectively.

To efficiently explore the volume data based on the voxel visibility model, it is very important to provide an initial voxel visibility model that helps users to understand data globally. Thus, we proposed the GMM to model volumes in the 2D histogram space (density vs. gradient magnitude). Volumes are modeled as a composition of one or more materials. The voxel's composition is described by the percentage of each material present in the voxel. Each homogenous region in the histogram space is represented by a Gaussian distribution:
                           
                              
                                 g
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    1
                                    
                                       2
                                       π
                                       |
                                       
                                          
                                             Σ
                                          
                                       
                                       
                                          |
                                          
                                             (
                                             1
                                             /
                                             2
                                             )
                                          
                                       
                                    
                                 
                                 
                                    e
                                    
                                       −
                                       (
                                       1
                                       /
                                       2
                                       )
                                       
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                             
                                             −
                                             
                                                
                                                   μ
                                                
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          
                                             
                                                Σ
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       −
                                       
                                          
                                             μ
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           μ
                         is the mean value and 
                           Σ
                         is the covariance matrix in the 2D histogram space. The distribution density of voxels is represented as:
                           
                              
                                 p
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    
                                       α
                                       i
                                    
                                 
                                 
                                    
                                       g
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 |
                                 
                                    
                                       
                                          μ
                                       
                                    
                                    i
                                 
                                 ,
                                 
                                    
                                       
                                          Σ
                                       
                                    
                                    i
                                 
                                 )
                              
                           
                        where α
                        
                           i
                         is the mixing probability of the ith feature, and 
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              k
                           
                           
                              
                                 α
                                 i
                              
                           
                           =
                           1
                        .

Based on the distribution density of voxels, the initial voxel visibility model is built as 
                           
                              v
                              
                                 max
                                 i
                              
                           
                           =
                           
                              v
                              
                                 max
                                 j
                              
                           
                           (
                           i
                           ≠
                           j
                           )
                        , 
                           
                              
                                 
                                    μ
                                 
                              
                              i
                              v
                           
                           =
                           
                              
                                 
                                    μ
                                 
                              
                              i
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                              
                              i
                              v
                           
                           =
                           
                              
                                 
                                    Σ
                                 
                              
                              i
                           
                        . Because 
                           
                              v
                              
                                 max
                                 i
                              
                           
                           =
                           
                              v
                              
                                 max
                                 j
                              
                           
                        , users can observe the different features that are included in the volume data. Fig. 3
                         provides the rendering results of different volume data based on the initial visibility model. Based on the initial rendering result, users can easily modify a small set of parameters in the voxel visibility model to obtain a desired voxel visibility model.

As other goal-oriented transfer function, the transfer function based on the voxel visibility model is obtained by minimizing the objective function. In the paper, the objective function is designed as a distance between the desired visibility distribution of voxels and the actual projected visibility distribution of voxels in the transfer function space. The desired visibility of voxels is calculated in terms of the voxel visibility model. The actual projected visibility of voxels is based on the transfer function and the rendering model.

The desired visibility of voxels represents a description of what the user expects to be visualized, i.e., the visibility of each voxel in the final rendered image. However, it is not a trivial task to specify the visibility of voxels in the 3D volume data space due to attenuation and occlusion. Meanwhile, users are concerned with the relative influence more than the absolute visibility. Thus, the desired visibility distribution of voxels in the transfer function space is proposed as follows:
                           
                              (3)
                              
                                 
                                    
                                       D
                                       ˜
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       v
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   y
                                                
                                             
                                             ∈
                                             
                                                Ω
                                                h
                                             
                                          
                                       
                                       v
                                       (
                                       
                                          
                                             y
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           v
                           (
                           ·
                           )
                         is the voxel visibility model represented in Eq. (2) and Ω
                           h
                         is the transfer function space. To highlight the important i-th feature in the volume, a large value is set for 
                           
                              v
                              maxi
                           
                         and small values are set for other 
                           
                              v
                              
                                 max
                                 j
                              
                           
                        . Thus, voxels belongs to the i-th feature will be set more visibility 
                           
                              
                                 D
                                 ˜
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         than other voxels.

The actual projected visibility of voxels refers to the contribution of a sample to the final image. Based on the lighting model of volume rendering, the visibility or contribution of a sample point p can be represented as follows:
                           
                              (4)
                              
                                 
                                    v
                                    ¯
                                 
                                 (
                                 p
                                 )
                                 =
                                 A
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 (
                                 p
                                 )
                                 )
                                 T
                                 (
                                 p
                                 )
                                 =
                                 A
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 (
                                 p
                                 )
                                 )
                                 
                                    e
                                    
                                       −
                                       
                                          ∫
                                          p
                                          E
                                       
                                       τ
                                       (
                                       t
                                       )
                                       dt
                                    
                                 
                              
                           
                        where A(·) is the transfer function and T(p) is the accumulated opacity from the sample p to the eye position E. Thus, the accumulated visibility or visibility histogram in x can be expressed as follows:
                           
                              (5)
                              
                                 V
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       p
                                       ∈
                                       Ω
                                    
                                 
                                 δ
                                 (
                                 p
                                 ,
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 
                                    v
                                    ¯
                                 
                                 (
                                 p
                                 )
                                 dp
                              
                           
                        where Ω is the volume data space. δ(p, x) is a membership function defined as follows:


                        
                           
                              (6)
                              
                                 δ
                                 (
                                 p
                                 ,
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      if
                                                      
                                                         
                                                            S
                                                         
                                                      
                                                      (
                                                      p
                                                      )
                                                      =
                                                      
                                                         
                                                            x
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   others
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where S(p) is the vector at the sampled point p. To reveal the visibility distribution of voxels, two types of actual projected visibility distributions are provided. One is the accumulated visibility distribution, and the other is the average visibility distribution. The accumulated visibility distribution represents the distribution of V(x) in the histogram space. It is analogous to the visibility histogram in [3] and can be represented as follows:
                           
                              (7)
                              
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             p
                                             ∈
                                             Ω
                                          
                                       
                                       δ
                                       (
                                       p
                                       ,
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       
                                          v
                                          ¯
                                       
                                       (
                                       p
                                       )
                                       dp
                                    
                                    
                                       
                                          ∫
                                          
                                             p
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          v
                                          ¯
                                       
                                       (
                                       p
                                       )
                                       dp
                                    
                                 
                              
                           
                        Compared with the accumulated visibility distribution, the average visibility distribution statistically describes the visibility distribution in a volumetric set 3D space and can be represented as follows:
                           
                              (8)
                              
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    a
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             p
                                             ∈
                                             Ω
                                          
                                       
                                       δ
                                       (
                                       p
                                       ,
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       
                                          v
                                          ¯
                                       
                                       (
                                       p
                                       )
                                       /
                                       p
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       dp
                                    
                                    
                                       
                                          ∫
                                          
                                             p
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          v
                                          ¯
                                       
                                       (
                                       p
                                       )
                                       /
                                       p
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       dp
                                    
                                 
                              
                           
                        where p(·) is the distribution density function in Ω
                           h
                        .


                        Objective function: The goal of our approach is to minimize the mismatch between the actual projected visibility distribution and the desired visibility distribution. The kernel is given by the square difference between the two visibility distributions as follows:
                           
                              (9)
                              
                                 
                                    E
                                    s
                                 
                                 (
                                 Θ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       
                                          
                                             x
                                          
                                       
                                       ∈
                                       
                                          
                                             Ω
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             D
                                             ˜
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       −
                                       
                                          
                                             D
                                             ˆ
                                          
                                       
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                       )
                                    
                                    2
                                 
                              
                           
                        where 
                           
                              
                                 D
                                 ˜
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         is the desired visibility distribution, 
                           
                              
                                 D
                                 ˆ
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         is the actual projected visibility distribution 
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         or 
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              a
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                        , and Θ=(θ
                        1, θ
                        2, …, θ
                        
                           i
                        , …, θ
                        
                           n
                        ) is a vector of the parameters used to define opacities of transfer functions, and i is the i-th bin in the transfer function space.

Because the kernel is based on the visibility distribution and not the absolute visibility values, the final transfer function can be given by opacity values that are extremely low, i.e., the final solution could be overly transparent. However, an excessive transparency is not a desired feature. Thus, an opacity constraint is introduced into the objective function to protect the absolute accumulated visibility. The constraint can be represented as follows:
                           
                              (10)
                              
                                 
                                    E
                                    c
                                 
                                 (
                                 Θ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   −
                                                   
                                                      V
                                                      max
                                                   
                                                
                                                
                                                   
                                                      V
                                                      max
                                                   
                                                
                                             
                                          
                                       
                                    
                                    2
                                 
                              
                           
                        where V is the accumulated visibility of all sampled voxels on the parameter Θ, and V
                        max is the possible maximum accumulated visibility. In the paper, V
                        max is defined as the accumulated visibility on the initial transfer function.

Then, the objective function can be defined as follows:
                           
                              (11)
                              
                                 F
                                 (
                                 Θ
                                 )
                                 =
                                 (
                                 1
                                 −
                                 β
                                 )
                                 
                                    E
                                    s
                                 
                                 (
                                 Θ
                                 )
                                 +
                                 β
                                 
                                    E
                                    c
                                 
                                 (
                                 Θ
                                 )
                              
                           
                        where β is a scale factor that adjusts the weight between the square difference and the constraint term. Finally, the desired transfer function is obtained by minimizing the objective function.

To solve the minimization problem(Eq. (11)), the steepest gradient descent optimizer is implemented to determine the vector of parameters Θ. The optimization process consists of an iterative algorithm, that is:
                           
                              (12)
                              
                                 
                                    Θ
                                    t
                                 
                                 =
                                 
                                    Θ
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 
                                    s
                                    
                                       t
                                       −
                                       1
                                    
                                 
                                 
                                    Λ
                                    
                                       t
                                       −
                                       1
                                    
                                 
                              
                           
                        where s
                        
                           t−1 is the step size and Λ
                           t−1
                        =−∇
                        F is the search direction. Unfortunately, it is not a trivial work to determine an analytical expression for the gradient ∇F.

Next, we use 
                           
                              
                                 D
                                 ˆ
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                           =
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         in Eq. (9) as an example to compute the gradient ∇F. When 
                           
                              
                                 D
                                 ˆ
                              
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                           =
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              a
                           
                           (
                           
                              
                                 x
                              
                           
                           )
                         is used, the same approach can be applied.

From the linearity property of the derivative, we can state that
                           
                              (13)
                              
                                 
                                    
                                       ∂
                                       F
                                       (
                                       Θ
                                       )
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 (
                                 1
                                 −
                                 β
                                 )
                                 
                                    
                                       ∂
                                       
                                          E
                                          s
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 +
                                 β
                                 
                                    
                                       ∂
                                       
                                          E
                                          c
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                              
                           
                        
                     

Let 
                           X
                           =
                           {
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                              1
                           
                           ,
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                              2
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                              n
                           
                           }
                         be the original accumulated visibility distribution, 
                           Y
                           =
                           {
                           
                              
                                 
                                    D
                                    ˜
                                 
                              
                              1
                           
                           ,
                           
                              
                                 
                                    D
                                    ˜
                                 
                              
                              2
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    D
                                    ˜
                                 
                              
                              n
                           
                           }
                         be the desired visibility distribution. Let us observe what occurs in X when the opacity θ
                        
                           i
                         is modified. In terms of Eqs. (4) and (7), the accumulated visibility distribution density 
                           
                              
                                 
                                    D
                                    ˆ
                                 
                              
                              c
                              i
                           
                         can be represented as:
                           
                              (14)
                              
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          k
                                       
                                       
                                          I
                                          k
                                       
                                       
                                          θ
                                          i
                                       
                                    
                                    
                                       
                                          ∑
                                          i
                                       
                                       
                                          ∑
                                          k
                                       
                                       
                                          I
                                          k
                                       
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          e
                                          i
                                       
                                       
                                          θ
                                          i
                                       
                                    
                                    M
                                 
                              
                           
                        where the index k represents a sample with the bin i, I
                        
                           k
                         is the remaining transparency corresponding to the sample k, e
                        
                           i
                        
                        =∑
                           k
                        
                        I
                        
                           k
                         is a multiplicative factor that depends on the number of samples of the bin i and their remaining transparencies, and M is a normalization factor that represents the absorbed energy of all bins. If we assumed that the opacity θ
                        
                           i
                         of the bin i is increased by Δθ
                        
                           i
                        , the new accumulated visibility distribution density can be approximated as:


                        
                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                D
                                                ′
                                             
                                          
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          k
                                       
                                       
                                          I
                                          k
                                          ′
                                       
                                       (
                                       
                                          θ
                                          i
                                       
                                       +
                                       Δ
                                       
                                          θ
                                          i
                                       
                                       )
                                    
                                    
                                       
                                          M
                                          ′
                                       
                                    
                                 
                                 ≈
                                 
                                    
                                       
                                          ∑
                                          k
                                       
                                       
                                          I
                                          k
                                       
                                       (
                                       
                                          θ
                                          i
                                       
                                       +
                                       Δ
                                       
                                          θ
                                          i
                                       
                                       )
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       
                                          e
                                          i
                                       
                                       (
                                       
                                          θ
                                          i
                                       
                                       +
                                       Δ
                                       
                                          θ
                                          i
                                       
                                       )
                                    
                                    M
                                 
                                 =
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                             
                                             
                                                
                                                   θ
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We assume here that the remaining transparency is approximately the same because the opacities remain the same except for Δθ
                        
                           i
                        . Let 
                           
                              k
                              i
                           
                           =
                           1
                           +
                           
                              
                                 Δ
                                 
                                    θ
                                    i
                                 
                              
                              
                                 
                                    θ
                                    i
                                 
                              
                           
                        . We assumed that the accumulated visibility distribution density of other bins are modified by a multiplicative factor K
                        
                           i
                        . For the summation of the distribution density to be 1, we obtain the equation
                           
                              (16)
                              
                                 
                                    k
                                    i
                                 
                                 
                                    
                                       
                                          
                                             
                                                D
                                                ′
                                             
                                          
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 +
                                 
                                    K
                                    i
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             
                                                D
                                                ′
                                             
                                          
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 )
                                 =
                                 1
                                 .
                              
                           
                        Thus, K
                        
                           i
                         can be represented as follows:
                           
                              (17)
                              
                                 
                                    K
                                    i
                                 
                                 =
                                 
                                    
                                       1
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                      ′
                                                   
                                                
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                       
                                          k
                                          i
                                       
                                    
                                    
                                       1
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                      ′
                                                   
                                                
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                    
                                 
                                 .
                              
                           
                        The accumulated visibility distribution density X′ after modifying the opacity θ
                        
                           i
                         is 
                           
                              X
                              ′
                           
                           ≈
                           {
                           
                              K
                              i
                           
                           
                              
                                 
                                    
                                       
                                          D
                                          ′
                                       
                                    
                                    ˆ
                                 
                              
                              c
                              1
                           
                           ,
                           
                              K
                              i
                           
                           
                              
                                 
                                    
                                       
                                          D
                                          ′
                                       
                                    
                                    ˆ
                                 
                              
                              c
                              2
                           
                           ,
                           …
                           ,
                           
                              k
                              i
                           
                           
                              
                                 
                                    
                                       
                                          D
                                          ′
                                       
                                    
                                    ˆ
                                 
                              
                              c
                              i
                           
                           ,
                           …
                           ,
                           
                              K
                              i
                           
                           
                              
                                 
                                    
                                       
                                          D
                                          ′
                                       
                                    
                                    ˆ
                                 
                              
                              c
                              n
                           
                           }
                        .

Then, we used the following expression to compute the derivative of E
                        
                           s
                        .
                           
                              (18)
                              
                                 
                                    
                                       ∂
                                       
                                          E
                                          s
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    lim
                                    
                                       Δ
                                       
                                          θ
                                          i
                                       
                                       →
                                       0
                                    
                                 
                                 
                                    
                                       
                                          E
                                          s
                                          ′
                                       
                                       −
                                       
                                          E
                                          s
                                       
                                    
                                    
                                       Δ
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 .
                              
                           
                        where 
                           
                              E
                              s
                              ′
                           
                         is the square difference between the actual accumulated visibility distribution and the desired visibility distribution with the modified opacity. It can be computed as follows:


                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             E
                                             s
                                             ′
                                          
                                       
                                       
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   j
                                                
                                                −
                                                
                                                   
                                                      
                                                         
                                                            
                                                               D
                                                               ′
                                                            
                                                         
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   j
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   j
                                                
                                                −
                                                
                                                   K
                                                   i
                                                
                                                
                                                   
                                                      
                                                         D
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   j
                                                
                                                )
                                             
                                             2
                                          
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   i
                                                
                                                −
                                                
                                                   K
                                                   i
                                                
                                                
                                                   
                                                      
                                                         D
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   i
                                                
                                                )
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   i
                                                
                                                −
                                                
                                                   k
                                                   i
                                                
                                                
                                                   
                                                      
                                                         D
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   i
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        The derivative is represented as follows:


                        
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                
                                                   E
                                                   s
                                                
                                             
                                             
                                                ∂
                                                
                                                   θ
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          =
                                          
                                             lim
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                                →
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   E
                                                   s
                                                   ′
                                                
                                                −
                                                
                                                   E
                                                   s
                                                
                                             
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             lim
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                                →
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   n
                                                
                                                (
                                                (
                                                
                                                   K
                                                   i
                                                
                                                −
                                                1
                                                )
                                                (
                                                
                                                   K
                                                   i
                                                
                                                +
                                                1
                                                )
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                                  ˆ
                                                               
                                                            
                                                            c
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                −
                                                2
                                                (
                                                
                                                   K
                                                   i
                                                
                                                −
                                                1
                                                )
                                                
                                                   
                                                      
                                                         D
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   j
                                                
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   j
                                                
                                                )
                                             
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                             
                                          
                                          +
                                          
                                             
                                                2
                                                (
                                                
                                                   K
                                                   i
                                                
                                                −
                                                
                                                   k
                                                   i
                                                
                                                )
                                                
                                                   
                                                      
                                                         D
                                                         ˆ
                                                      
                                                   
                                                   c
                                                   i
                                                
                                                
                                                   
                                                      
                                                         D
                                                         ˜
                                                      
                                                   
                                                   i
                                                
                                                −
                                                (
                                                
                                                   K
                                                   i
                                                
                                                −
                                                
                                                   k
                                                   i
                                                
                                                )
                                                (
                                                
                                                   K
                                                   i
                                                
                                                +
                                                
                                                   k
                                                   i
                                                
                                                )
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               D
                                                               ˆ
                                                            
                                                         
                                                         c
                                                         i
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                             
                                                Δ
                                                
                                                   θ
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        By computing the limit, an analytical expression is obtained as follows:


                        
                           
                              (21)
                              
                                 
                                    
                                       ∂
                                       
                                          E
                                          s
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    
                                       2
                                       
                                          
                                             
                                                D
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                    
                                    
                                       
                                          θ
                                          i
                                       
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                D
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                    j
                                 
                                 (
                                 
                                    
                                       
                                          D
                                          ˜
                                       
                                    
                                    j
                                 
                                 −
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                    j
                                 
                                 )
                                 +
                                 
                                    
                                       2
                                       
                                          
                                             
                                                D
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                    
                                    
                                       
                                          θ
                                          i
                                       
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                D
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       
                                          D
                                          ˜
                                       
                                    
                                    i
                                 
                                 −
                                 
                                    
                                       
                                          D
                                          ˆ
                                       
                                    
                                    c
                                    i
                                 
                                 )
                              
                           
                        The second derivative term in Eq. (12) is ∂E
                        
                           c
                        /∂θ
                        
                           i
                        . In terms of
                           
                              (22)
                              
                                 V
                                 =
                                 
                                    ∑
                                    j
                                 
                                 
                                    ∑
                                    k
                                 
                                 
                                    I
                                    k
                                 
                                 
                                    θ
                                    j
                                 
                                 =
                                 
                                    ∑
                                    i
                                 
                                 
                                    e
                                    j
                                 
                                 
                                    θ
                                    j
                                 
                                 .
                              
                           
                        Then, ∂V/∂θ
                        
                           i
                         can be approximated by
                           
                              (23)
                              
                                 
                                    
                                       ∂
                                       V
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 ≈
                                 
                                    ∑
                                    k
                                 
                                 
                                    I
                                    k
                                 
                                 =
                                 
                                    e
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                v
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                       V
                                    
                                    
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 .
                              
                           
                        The derivative E
                        
                           c
                         can be approximated by


                        
                           
                              (24)
                              
                                 
                                    
                                       ∂
                                       
                                          E
                                          c
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    1
                                    
                                       
                                          V
                                          max
                                          2
                                       
                                    
                                 
                                 
                                    
                                       ∂
                                       
                                          
                                             (
                                             V
                                             −
                                             
                                                V
                                                max
                                             
                                             )
                                          
                                          2
                                       
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 =
                                 
                                    2
                                    
                                       
                                          V
                                          max
                                          2
                                       
                                    
                                 
                                 (
                                 V
                                 −
                                 
                                    V
                                    max
                                 
                                 )
                                 
                                    
                                       ∂
                                       V
                                    
                                    
                                       ∂
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 ≈
                                 
                                    2
                                    
                                       
                                          V
                                          max
                                          2
                                       
                                    
                                 
                                 (
                                 V
                                 −
                                 
                                    V
                                    max
                                 
                                 )
                                 
                                    
                                       
                                          
                                             
                                                D
                                                ˆ
                                             
                                          
                                          c
                                          i
                                       
                                       V
                                    
                                    
                                       
                                          θ
                                          i
                                       
                                    
                                 
                                 .
                              
                           
                        Based on ∂E
                        
                           s
                        /∂θ
                        
                           i
                        (Eq. (21)) and ∂E
                        
                           c
                        /∂θ
                        
                           i
                        (Eq. (24)), the gradient ∇F can be represented as:
                           
                              (25)
                              
                                 ∇
                                 F
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             ∂
                                             F
                                          
                                          
                                             ∂
                                             
                                                θ
                                                1
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                             F
                                          
                                          
                                             ∂
                                             
                                                θ
                                                2
                                             
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ∂
                                             F
                                          
                                          
                                             ∂
                                             
                                                θ
                                                n
                                             
                                          
                                       
                                       )
                                    
                                    T
                                 
                              
                           
                        
                     

As described above, computing the visibility distribution is a high-cost task in the algorithm. The computation complexity is O(m
                        ×
                        n), where m
                        ×
                        n is the size of 2D histogram space. Thus, the accumulated visibility of each bin in the histogram space is computed on CUDA. Then, it is read back from the GPU to the CPU to compute the visibility distribution. Since the accumulated visibility of m
                        ×
                        n bins is computed parallelly on CUDA, the computation complexity is reduced to O(1).

For the accumulated visibility of the bins, a matrix for the 2D space or a vector for the 1D space is allocated as an accumulator. The accumulated visibility of each bin is computed in different rays. m
                        ×
                        n blocks are specified per grid to accumulate visibility for m
                        ×
                        n rays in each viewpoint. s
                        ×1 threads are specified per block for s viewpoints. In the paper, m and n are set at 256, and s is set at 6. Based on the parallel computing on CUDA, the time of each iteration for transfer function optimization is shown in Table 1
                        . Compared with parallel computing on GLSL, the efficiency is almost improved four times on CUDA.

@&#EXPERIMENTS AND RESULTS@&#

In this section, we present several experiments that were conducted to evaluate the proposed approach. Used data sets are described in Table 1. All of the experiments were conducted on a PC equipped with an Intel Core 2 Xeon E5503 CPU, 2 GB of RAM and a Nvidia GeForce GTX 280 graphics card. By default, the average visibility distribution function, β
                     =0, and 6 uniformly distributed viewpoints are used in the following experiments.


                     Fig. 3 compared the rendering result on the Gaussian transfer function [13] and the voxel visibility model. In the experiments, same mean vectors and same covariance matrixes are used for Gaussian functions of same features in two approach. Meanwhile, the maximum opacity of each feature in the Gaussian transfer function is also same with the desired maximum visibility of the same feature. For the Head (Visible Male) and the Foot, the desired maximum visibility of each feature is set to 0.4. We noted that the bones are occluded by the muscle in Fig. 3(a) and (c) although same maximum opacity is used for each feature. Fig. 3(b) and (d) on the voxel visibility model display the bones and muscles clearly. Thus, compared with the traditional transfer function design approach, the voxel visibility model provides a more efficient approach to help users understand the global structures of volume data.

To inspect each feature clearly, the experiment was designed to illustrate the importance-driven strategy in Fig. 4
                     . The importance of each feature is controlled by the desired maximum visibility in the voxel visibility model. Meanwhile, we also compared the rendering results using the feature visibility model [4] and the voxel visibility model. Fig. 4(a)–(c) show the results using the feature visibility [4], and Fig. 4(d)–(f) are the results on our approach. By comparing Fig. 4(d)–(f), we can observe how the selected feature, of which the visibility is the largest, is more prominent. If the following pairs were put in comparison: Fig. 4(a) and (d), Fig. 4(b) and (e), Fig. 4(c) and (f), we can observe that the results on our approach displays details more clearly than on the feature visibility. The reason is that the visibility and the opacity are defined on bins in our approach, while the visibility and the transfer function are described only on the features.


                     Figs. 5 and 6
                      
                      provide the iteration process. Fig. 5 plots the F(Θ) values for the MRI Head and Visible Male cases using the average visibility distribution, β
                     =0, and Fig. 6 viewpoints. As observed, the measure tends to 0 and converges with fewer than 30 iterations. For the MRI Head case, we obtained the ideal result after 20 iterations. For the Visible Male case, the ideal result was obtained after 13 iterations. Fig. 6 presents the evolution result after different iterations. By comparing the evolution results for the two cases, the change for the MRI Head can be observed in each iteration, and the change for the Visible Male from the first to ninth iteration are extremely insignificant. The main reason is that the number of voxels belonging to soft tissue is mass and these voxels are around other structures.

In Fig. 7
                     , the different visualization effects are shown on the different visibility distributions model and the same target visibility distribution. Fig. 7(a) uses the average visibility distribution, and Fig. 7(b) uses the accumulated visibility distribution. It can be observed that the feature, which is a small part in the volume data, is highlighted in the result with the accumulated visibility distribution. Thus, the accumulated visibility distribution model is adapted to be used for exploring small features in the volume data.

The next experiment focused on determining the effects of the parameter β. Fig. 8
                      presents the visualization of the Engine Block. These visualizations were obtained by separately setting β to values of 0, 0.3, 0.6 and 0.9. The parameter weighs the contribution of the opacity and ensures that the target visibility is close to the maximum accumulated visibility. Thus, a higher value of β results in a higher total opacity of volume visualization. As observed, Fig. 8(d) becomes more opaque by increasing β.


                     Fig. 9
                      provides a visualization of the Skull data set. This example presents the view-dependent nature of the voxel visibility model. First, we display the results in Fig. 9(a)–(c), which were obtained by computing the visibility distribution from 6 viewpoints. The desired maximum visibilities of bone, tooth and vessel were set at 0.2, 0.25, and 0.5, respectively. The vessel can be observed in Fig. 9(c), and it is occluded by the bone in Fig. 9(a). Fig. 9(d) presents the result that was obtained by computing the visibility distribution from a single viewpoint. Comparing figures Fig. 9(a) and (d), the vessel is more clearly visible in Fig. 9(d) than (a). Thus, more viewpoint occlusions do not allow all structures to be perceived from any viewpoints.

@&#CONCLUSION@&#

In this paper, we presented a new visibility metric, i.e., the voxel visibility model, as a framework for automatic transfer function design. Based on the voxel visibility model, users can design the desired voxel visibility distribution using a few parameters. The opacity transfer function is obtained by minimizing the distance between the desired voxel visibility distribution and the actual projected voxel visibility distribution. To help users understand the data systematically, we proposed two strategies. First, a good overall visualization of the volume data set is obtained using a global strategy, which sets the same desired maximum visibilities for different features. Based on the overall visualization, the importance feature can be highlighted by adjusting the desired maximum visibilities. Additionally, we proposed two different visibility distribution functions: the average visibility distribution and the accumulated visibility distribution. The experiments indicate that the voxel visibility model is an efficient framework for transfer function design that can easily help users determine interested features in the volume data set. The accumulated visibility distribution is adapted to be used when the volume data includes very small features.

In this paper, a Gaussian mixture model is used to build the visibility distribution function. However, the number of clusters is set by users in our approach. How to get the optimized number of clusters is a challenging problem. Simultaneously, the performance of other models is also expected to be explored in the future. Additionally, the optimal transfer function depends on iterative algorithm. Since the problem space can be concave, the local minima may be converged on the current algorithm. Other higher-order algorithms may be explored to find the global minima. Future work will also be performed to obtain a full GPU implementation and improve the computational cost.

@&#ACKNOWLEDGMENTS@&#

This work was partly supported by the National Natural Science Foundation of China (61100113, U1401252), Chongqing Research Program of Application Foundation and Advanced Technology (cstc2013jcyjA40062), the Scientific Research Foundation for the Returned Overseas Chinese Scholars (2012-940). The volume data are download from the Volume Library(http://www9.informatik.-uni-erlangen.de/External/vollib/) and VolVis Data Sets(http://www.volvis.org/).

@&#REFERENCES@&#

