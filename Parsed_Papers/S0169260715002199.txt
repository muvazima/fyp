@&#MAIN-TITLE@&#Tuberculine reaction measured by infrared thermography

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           First paper devoted to tuberculine reaction measurement based on thermal imaging.


                        
                        
                           
                           There is good agreement in area length of tuberculin reaction between visual and thermographic evaluation.


                        
                        
                           
                           Automatic generation of positive and negative results of the tuberculin skin test evaluated by infrared imaging.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Tuberculine test

Infrared thermography

Image processing

@&#ABSTRACT@&#


               
               
                  Setting
                  The infection with Mycobacterium tuberculosis gives a delayed immune response, measured by the tuberculine skin test. We present a new technique for evaluation based on automatic detection and measurement of skin temperature due to infrared emission.
               
               
                  Design
                  34 subjects (46.8±16.9 years) (12/22, M/F) with suspected tuberculosis disease were examined with an IR thermal camera, 48h after tuberculin skin injection.
               
               
                  Results
                  In 20 subjects, IR analysis was positive for tuberculine test. Mean temperature of injection area was higher, around 1°C, for the positive group (36.2±1.1°C positive group; 35.1±1.6°C negative group, p
                     <0.02 T test for unpaired groups).
               
               
                  Conclusion
                  IR image analysis achieves similar estimation of tuberculin reaction as the visual evaluation, based on higher temperature due to increased heat radiation from the skin lesion.
               
            

@&#INTRODUCTION@&#

According to the World Health Organization, two billion people are infected with the tuberculosis (TB) bacilli [1], and it is estimated that every year eight million new cases appear. TB is a contagious disease not totally under control with great differences between rich and poor countries [2]. The diagnosis of TB is based on the interpretation of a skin immunologic reaction. The infection with Mycobacterium tuberculosis gives a delayed immune response, measured by the tuberculin skin test (TST) [3]. This consists of the intradermal injection of tuberculin purified protein derivative (PPD) and measurement of the resulting reaction. The induration size, measured in millimeters, indicates if the test result is negative or positive. Palpation and pen methods have been typically applied to measure the PPD reaction, but the measurement depends on the subjective interpretation of the reaction area [4,5]. New technologies are currently being developed to improve the sensitivity and specificity of the TB diagnosis [6].

In this study, we present a new technique for the evaluation of the tuberculine reaction based on the automatic detection and measurement of infrared (IR) emission of inflammatory effects produced by tuberculine immune response. IR thermal imaging is a noninvasive technique for monitoring temperatures and is widely applied in medicine [7,8]. The IR radiation increases due to inflammatory processes, such as that in the tuberculine reaction. An increased IR radiation is most likely caused by elevated blood flow, metabolic activity, and inflammatory reactions [9]. Therefore IR thermal imaging can be used to measure the rise in temperature due to an inflammatory process, which causes the increase of the blood flow with vascular dilatation, blood proteins and cellular extravasations [10]. PPD inflammatory response is characterized by edema, leukocyte lymphocyte-mononuclear infiltration, and erythrocyte extravasation in the dermis and epidermis [11]. Our hypothesis in the present work was that intradermal inflammatory PPD reaction produced an increase in the temperature of the injected area, which can be measured by IR thermal imaging, and the features extracted from the resulting IR images after applying digital image processing techniques helped to improve the reliability in the TB diagnosis.

@&#MATERIAL AND METHODS@&#

The study was conducted in the Respiratory Function Laboratory at HUGTIP, from February–September 2014, and approved by the Hospital's Human Research and Ethics Committee. All participants came from pulmonology dept to discard tuberculosis contact and gave written informed consent, following the World Medical Association's Declaration of Helsinki on Ethical Principles for Medical Research Involving Human Subjects (Ref 10/00214-28/03/2014).

The Mantoux tuberculin skin test (TST) was performed in all subjects by intradermal injection of 0.1ml of tuberculine purified protein derivative (PPD) (Tuberculina PPD Evans 2 UT/0.1ml, UCB Pharma S.A., Madrid, Spain) in the anterior forearm. First, the reading of the Mantoux TST was manually performed 48h following the skin injection [3] by inspection, palpation, and measurement of the induration. The longer distance within indurated skin was measured using a measuring tape. An induration size greater than 0.5cm was considered to be a positive TST result. An experienced technician in TST readings made all TST tests [12].

The size of the induration was also measured by IR thermal imaging. Subjects remained in the laboratory room for at least 15min to achieve thermal equilibrium. Temperature, humidity and air circulation were all controlled. Laboratory temperature was maintained between 23±1°C, and humidity was around 50%. Subjects were requested not to consume hot drinks or food for at least an hour before image session, nor use any skin preparations such as creams or talcum powder. Emissivity of the skin was assumed at a value of 0.98±0.01. There was no ceiling air filter. The lighting in the laboratory was maintained at wavelengths longer than 1 micron.

The IR thermal images were obtained from the anterior surface of the forearm of each subject, using a TiR32 Fluke Camera (2009 Fluke Corporation USA; 320×240 focal plane array; 0.01°C noise equivalent temperature difference; 8–14μm spectral range). The IR thermal camera was installed on a tripod with a fluke compact photo-movie. The distance between the camera focus and the forearm was 40cm. The forearm was placed on a black foam cushion over a wooden table, with the anterior surface facing the camera focus. To take a reference distance, we placed a 24mm diameter coin below the area to be measured. The detection of that reference object allowed us to convert pixels to millimeters (Fig. 1
                        ). The image acquisition and storage were made with the SmartView® software. Each image was exported in JPG format. Additionally, the temperature measurements were transferred to a text file.

The IR image processing was performed using Matlab 2014b and following the scheme shown in Fig. 2
                        . Each text file containing the temperature data of an IR image was imported in a 2D numerical array (temp). As IR images had different temperature ranges, each temp array was scaled, as in (1), in order to have values between 0 and 1, thus obtaining the gray scale image temp_n (Fig. 3a).
                           
                              (1)
                              
                                 
                                    t
                                    e
                                    m
                                    p
                                    _
                                    n
                                    =
                                    
                                       
                                          t
                                          e
                                          m
                                          p
                                          −
                                          
                                             T
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                       
                                       
                                          
                                             T
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                          −
                                          
                                             T
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        T
                        
                           min
                         and T
                        
                           max
                         are the minimum and the maximum temperatures in temp, respectively. After obtaining the gray scale image temp_n, we detected the reference object of known size that was present in the image in order to obtain the conversion factor from pixels to millimeters. For that purpose, we first applied the Canny edge detector to the normalized image temp_n (Fig. 3b). Then, since the reference object was a circle, we used the circular Hough transformer to detect its position and match its edge (note that the Hough transform can be adapted to detect specific shapes in an image) [13]. As the radius in millimeters of the reference object was known, we were able to calculate the conversion factor to express measured lengths in millimeters (Fig. 3c).

The temperature in the forearm area was much higher than the surrounding temperature outside the forearm area (air). Therefore, the values of all pixels in the forearm area were in the upper range of the scaled temp_n image. In order to clarify the differences between the internal pixels of the forearm area, we applied an intensity transformation to temp_n. All pixels below 0.5 were set at 0, whereas pixels in the range 0.5–1 were expanded to the range 0–1, thus obtaining the temp_e image (Fig. 3d). The difference between the PPD reaction area and the rest of the forearm was more noticeable in temp_e than in temp_n.

The segmentation algorithm sought to define two different regions: region 1 (PPD reaction area) and region 2 (erythema). A region growing method was used for the image segmentation. Assuming that the PPD reaction area (region 1) was near the image center, the first seed pixel was the pixel with the maximum temperature 
                           
                              
                                 
                                    
                                       P
                                       
                                          
                                             T
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                         inside a centered rectangle area. A binarization was applied to the image temp_e. Pixels of the surface of the forearm were retained (set at 1) and pixels outside the forearm (air) were rejected (set at 0), thus obtaining the temp_b binary image (Fig. 3e). Then, a 5×5cm2 square, which was centered at 
                           
                              
                                 
                                    
                                       P
                                       
                                          
                                             T
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , was selected as the analysis area mask.

Having found the first seed point and defined the analysis area, the region growing algorithm was applied to temp_e by means of the following iterative procedure until convergence until a fixed point was reached. At each iteration, new sub-regions 1 and 2 were grown from a new seed point by adding in neighboring pixels according to each sub-region membership criterion. First, sub-region 1 was grown by adding in neighboring pixels that met the criterion in (2).
                           
                              (2)
                              
                                 
                                    −
                                    A
                                    ×
                                    T
                                    h
                                    1
                                    <
                                    min
                                    
                                       S
                                       1
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    <
                                    T
                                    h
                                    1
                                    →
                                    
                                       S
                                       1
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    r
                                    e
                                    
                                       g
                                       
                                          m
                                          e
                                          a
                                          
                                             n
                                             1
                                          
                                       
                                    
                                    −
                                    t
                                    e
                                    m
                                    
                                       p
                                       
                                          e
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The parameter reg_mean
                        1 was the mean intensity (from temp_e) of all pixels included in the whole of region 1, temp_e(i,j) was the intensity value of a neighboring pixel, S
                        1(i,j) was the membership criterion of a neighboring pixel, Th1 was the threshold used to either include or not a neighboring pixel in sub-region 1, and A was the scale factor of Th1 to define the lower limit of S
                        1(i,j). Region 1 was grown until a difference in intensity of Th1 between the area and neighboring pixels was achieved. The threshold Th1 was empirically set to 0.49/(T
                        
                           max
                        
                        −
                        T
                        
                           min
                        ) (low), 0.6/(T
                        
                           max
                        
                        −
                        T
                        
                           min
                        ) (medium), or 0.71/(T
                        
                           max
                        
                        −
                        T
                        
                           min
                        ) (high). In the same way, the scale factor A could be set to 1, 2, or 3. Having different combinations of parameters Th1 and A allowed us to detect from weak to strongly marked regions 1. When there were no neighboring pixels meeting the criterion defined in (2), a new criterion, as defined in (3), was used for addition in neighboring pixels to sub-region 2.
                           
                              (3)
                              
                                 
                                    min
                                    (
                                    |
                                    
                                       S
                                       2
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    |
                                    )
                                    <
                                    T
                                    h
                                    2
                                    →
                                    
                                       S
                                       2
                                    
                                    (
                                    i
                                    ,
                                    j
                                    )
                                    =
                                    r
                                    e
                                    
                                       g
                                       
                                          m
                                          e
                                          a
                                          
                                             n
                                             2
                                          
                                       
                                    
                                    −
                                    t
                                    e
                                    m
                                    
                                       p
                                       
                                          e
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

The parameter reg_mean
                        2 was the mean value of all pixels included in the whole of region 2, temp_e(i,j) was the intensity value of a neighboring pixel, S
                        2(i,j) was the membership criterion of a neighboring pixel, and Th2 was the threshold used to either include or not a neighboring pixel in sub-region 2. Region 2 was grown until a difference in intensity of Th2 between the area and neighboring pixels was achieved. The threshold Th2 was empirically set to 1.18/(T
                        
                           max
                        
                        −
                        T
                        
                           min
                        ). When no neighboring pixels met the criterion defined in (3), a new seed point was selected and a new iteration started. Each new seed point had to meet the criterion defined in (2) and be located at a maximum distance of 15mm from the sub-region 1 obtained in the first iteration.

After the region growing process was completed, when no new seed points existed, regions 1 and 2 were formed by a set of sub-regions 1 and 2, respectively (Fig. 3f). The maximum length of both region 1 and region 2 were calculated as the sum of the maximum length of their corresponding sub-regions (Fig. 3g and h).

The background region (region 3) was calculated by removing the pixels belonging to either region 1, region 2 or the reference circular object from the analysis area mask. Then, the area (cm2), the minimum, the maximum, the mean and the standard deviation temperatures (°C) were calculated either for region 1, region 2, and the background.

The algorithm always returns three regions for each subject. The differences between positive and negative responses are not in the number of regions, but in the differences between the mean temperatures of these three regions. Subjects with a positive response will have significant differences either between the mean temperature of region 1 and the mean temperature of region 2 plus background or between the mean temperature of region 2 and the mean temperature of background. On the contrary, subjects with a negative response will not have significant differences between regions. Therefore, we are able to define some simple rules to retain significantly different regions and merge similar regions. Region 2 was merged with the background if the following criterion was met:
                           
                              (4)
                              
                                 
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          2
                                       
                                    
                                    −
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          3
                                       
                                    
                                    ≤
                                    0.3
                                 
                              
                           
                        where t
                        
                           meank
                         (k
                        =2,3) were the mean temperatures of region 2 and background, respectively. The mean temperature of the new region 2 plus background was calculated along all pixels of the two regions. Furthermore, region 1 was merged with region 2 and the background if criterion defined in (4) and the following criteria were met:
                           
                              (5)
                              
                                 
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          1
                                       
                                    
                                    −
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          2
                                          +
                                          3
                                       
                                    
                                    ≤
                                    0.7
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          1
                                       
                                    
                                    −
                                    
                                       t
                                       
                                          m
                                          e
                                          a
                                          n
                                          2
                                       
                                    
                                    ≤
                                    0.7
                                 
                              
                           
                        where t
                        
                           meank
                         (k
                        =1, 2+3, or 3) were the mean temperatures of region 1, region 2 plus background, and background, respectively. In this case, only a background area was obtained as the final result of the image segmentation and the mean temperature was calculated along all pixels of regions 1, 2, and the background. Therefore, no reaction area was found and the test was negative. Otherwise, the test was positive. A negative-positive segmentation indicated an IR negative-positive result, respectively. In addition, for an expert in IR imaging that made all readings of patient IR images, the non-existence of significant geometric IR color differences in the injection area was considered classified as a negative result.

Statistical results were made by means of SPSS soft. Parametric tests were applied to observe the differences between groups (T-test was the data distribution applied).

@&#RESULTS@&#


                     Table 1
                      expresses the anthropometric characteristics of 34 subjects (12/22 M/F) with a tuberculosis contact. Mean age was 57 (17.9) years. Twenty had a positive TST reading (more than 5mm of papule) with positive IR analysis. In 14 subjects the TST and IR images were negative. Six with a positive TST test had tuberculosis disease demonstrated by positive sputum cultive for tuberculosis bacillus and Rx Thorax lesions compatible with lung tuberculosis.

Positive reaction of the IR visual examination was identified as one or more central geometric images with circular, elliptic or with more irregular contours, and easy to differentiate from the rest of the IR surface (Fig. 1). A higher temperature of this area appeared with a more intense color with respect to the neighboring (blue to red color scale). In subjects with a negative TST test these characteristics were not evident in the IR image.


                     Table 2
                      depicts IR parameters for the two groups of subjects: Group 1 with a positive TST reaction (20 subjects) and Group 2 with a negative TST reaction (14 subjects). Mean, min, and maximum temperatures were higher for group 1 than group 2 (T-test for unpaired groups, p
                     <0.04 in the regions 1 and 2). Differences for mean temperature between both groups were around 1 to 1.3°C for these temperature parameters in regions 1 and 2.

In Table 3
                      we express the differences in mean temperature for areas 1, 2 and 3 and between both groups. Mean Temperature differences between both groups for region 1 and region 3, region 2 and region 3, and region 1 and region 2 plus 3 were significant.

For subjects with a TST(+), TST diameter was 14.35 (7.39) mm, (range 5–40mm) and the diameter measured by IR analysis of area 1 was 16.52 (6.52) mm. This difference was not significant (T-test for paired groups, p
                     >0.1). Regression coefficient between TST diameter and IR image analysis for the 20 subjects with a positive TST was R
                     =0.65 (R
                     2
                     =0.42, constant=2.25, beta coefficient=0.65, p
                     <0.001).

There were not differences in IR temperatures of region 1 between subjects with and without tuberculosis disease (T
                     
                        mean
                      36.22 (0.27) in 6 subjects with tuberculosis disease; T
                     
                        mean
                      36.20 (1.38) for 14 subjects without tuberculosis disease).

@&#DISCUSSION@&#

The authors studied the skin tuberculine reaction in 34 tuberculosis contacts by infrared emission image analysis and compared it with the classical tuberculine examination. Twenty subjects with a tuberculin reaction size more than 5mm had an IR positive image reaction. Fourteen subjects with negative tuberculin test also had a negative IR image. The diameter of the IR central reaction was very similar to the diameter measured by skin examination.

Infrared imaging has been extensity applied in medicine since the 1960s. Detection of peripheral vascular disorders and breast cancer are some examples [7,14–17]. In areas affected by an inflammation process characterized by arteriolar capilar and venula dilatation with inflammatory infiltrate, there is an increase of heat [10]. IR is able to detect skin temperature differences as low as 0.1°C [18]. These properties were applied in several medical cases as control of postsurgical infection [19], total knee replacement [20] and dermatological treatments [21,22].

The current test of tuberculine reaction is the subjective measurement of skin induration by tact. However, the reading of induration could be a potential error source [5]. Margins of the induration are difficult locate regardless of technique (ballpoint-pen, palpation) [4].

The histopathologic pattern of human intracutaneous tuberculine reaction was first described by Kuramoto and more recently by Haholu [11,23]. These reactions take place in the epidermis and dermis. The cellular infiltrations with an extensive vascular component (vasodilatation, edema exudation) are responsible for an increase in the heat generation at the injection site that can be measured by an IR camera [10]. Changes from 0.2 to 2°C have been demonstrated in inflammatory dermatologic processes [20,24–26].

We observed a significant difference in the mean temperature between the central segmented IR area and window hand area of around 1°C. This temperature was above that measured in (−) TST subjects where temperature differences were not significant. In addition, the difference between the central and surrounding area temperatures was also significant, around 0.5°C. A higher temperature might indicate different inflammatory events in the same ways as the histopathology of the skin induration is different from the area of skin erythema. Infection with M tuberculosis causes a cell-mediated immune response leading to sensibilized T lymphocyte [27]. Intradermal injection of PPD evokes a delayed hyper sensibility response mediated by sensitized T cells that produces a skin induration [23]. The erythema multiform type has an important component of edema with erythrocyte extravasations. As a result we believe that marked edema as a consequence of a prolonged vasodilatation with cellular extravasations is responsible for increased temperature in the central area. This fact is shown by an increase of radiated heat as observed in other inflammatory diseases [10].

Several issues related to methodology of the present paper must be addressed. First, the reduced group of patients has not permitted us to draw general conclusions, but in the present work a positive IR reaction was observed in all TST by manual reading. In conclusion, although a large sample size is required to extract definitive conclusion, we believe that these results should induce the carrying out of a multicentre study that will permit both the definitive generalization of present procedure and the definitive method validation. Additionally, infrared reading was made following the guidelines for standardization in Medical Thermography [17], measuring the IR reaction in a short area of the forearm to determine if there was a positive o negative response. We believe that this procedure could applied with unrestrictive conditions, permitting to use simple elements such as an IR mobile-camera in varying settings for general use [28].

@&#CONCLUSION@&#

IR may represent an alternative estimation of tuberculosis infection. Its reading does not depend on reader skill and only measures the increase of heat radiation produced by the allergic tuberculin response, which the IR physical principle can objectively measure.

The authors state that they have no conflict of interest in the elaboration of this paper.


                     
                        
                           •
                           José Antonio Fiz Fernández: Inventor of procedure, design of the study, process and automation of image analysis; data analysis and interpretation for the work; writing the article and guarantor of same.

Manuel Lozano: Processing and automation of image analysis; analysis and interpretation of the data; writing the article.

Enrique Monte Moreno: Analysis and interpretation of the data; writing the article; revision of the work.

Marcos Faundez: Revision of the work. Infrared technician assessor.

Adela Gonzalez_Martinez: PPD test realization.

Caroline Bake and Laura Rodriguez-Pons: Inclusion of patients.

Juan Ruiz Manzano: Clinical study of patient inclusion.

@&#ACKNOWLEDGEMENTS@&#

The authors wish to thank our nurses Rosa Gomez and Aurora Torrents for their special assistance. This work has been partially supported by FEDER and Ministerio de ciencia e Innovación, TEC2012-38630-C04-03.

@&#REFERENCES@&#

