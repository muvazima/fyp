@&#MAIN-TITLE@&#Evaluation of vermillion border descriptors and relevance vector machines discrimination model for making probabilistic predictions of solar cheilosis on digital lip photographs

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Robust descriptors of lip vermillion border.


                        
                        
                           
                           Probabilistic model for lip abnormality assessment.


                        
                        
                           
                           Reliability and reproducibility evaluation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Lip features

Solar cheilosis

Actinic cheilitis

Image analysis

Relevance vector machines

@&#ABSTRACT@&#


               
               
                  Introduction
                  Solar cheilosis (SC), a common precancer of the lower lip with a high potential to progress to invasive squamous cell carcinoma, presents with characteristic morphological vermillion-skin border alterations, like the border retraction.
               
               
                  Aim
                  To determine robust macro-morphological descriptors of the vermillion border from non-standardized digital photographs and to exploit a probabilistic model for SC recognition in real clinical environments.
               
               
                  Methods
                  Lip borders of 150 individuals (75 SC patients, 75 non-SC controls) were quantified on the basis of the extent of vermillion retraction and the degree of border irregularity employing fractal features and type-P Fourier descriptors. Eight lip border quantifiers were evaluated in terms of their reliability and reproducibility. The probabilistic ‘diagnostic’ model was implemented using the relevance vector machine (RVM) algorithm.
               
               
                  Results
                  Picture acquisition contributes substantially to overall variability of lip border images; however, for the different lip descriptors 33% to 65% of border morphological variability is due to differences among individuals. Different camera operators or the use of cameras with different specifications did not affect significantly the extracted lip features. The proposed RVM probabilistic model yielded a high sensitivity and specificity of 94.6% and 96%, respectively.
               
               
                  Conclusion
                  We explored the use of digital photography within the clinical routine setting to validate a probabilistic model for the assessment of lip conditions like SC. The proposed method opens new perspectives toward a cost effective, non-invasive monitoring of SC to support large scale epidemiological and interventional studies in different clinical environments.
               
            

@&#INTRODUCTION@&#

Solar cheilosis (SC) is a common condition that mainly affects the lower lip of elderly, chronically sun exposed individuals. It is considered an in situ carcinoma equivalent to actinic keratoses of the skin [1,2]. However, the likelihood that precancer will progress into invasive squamous cell carcinoma (SCC) in a SC affected lip is about 2.5 fold higher than that for a comparable skin area with actinic keratoses [2,3]. Consequently the development of SC more than doubles the SCC risk of an individual [2,4]. Moreover, lower lip localization is considered as a distinct risk factor for recurrence or metastasis of SCC [5,6]. The predominant etiologic factor of SC is long term exposure to ambient sunlight ultraviolet radiation and for this reason it affects almost exclusively the stronger exposed lower lip (95% of the cases) [2,7,8]. Since as a rule SCC develops many years after the diagnosis of SC the current consensus for the prevention of lip SCC is timely treatment of all patients with SC and structured follow-up to monitor for disease recurrences [4,9]. However, all currently recommended therapeutic modalities for SC are associated with substantial discomfort and morbidity as they inflict significant symptoms (primarily pain in the highly innervated lower lip), while abrasive surfaces that result from treatment interfere with the daily intake of food and water for weeks. Thus development of objective measures that would assist appropriate patient selection who need treatment is pivotal for improving healthcare in this subset of patients. Currently the evaluation of SC severity is primarily subjective based on clinical criteria as are alterations of the configuration of lower lip vermillion-skin border [4,10] and variations of color, consistency or keratinization of the lower lip surface as well as relapsing fissuring. Histopathological evaluation offers insight of the presence and severity of the condition at tissue, yet, as SC involves the entire lower lip at various degrees of severity, it is only representative of the biopsy site [5,11]. Persistent erosions or ulcers usually denote the development of SCC [2]. A reliable, objective evaluation of lip alterations would significantly contribute in the identification and monitoring of disease progression and treatment outcome.

In a recent publication, utilizing digital photography and image analysis techniques we introduced a workable methodology for accurate vermillion border detection and we applied it to monitor SC improvement after treatment with immunocryosurgery [12]. We presently expand this approach by exploiting the application of additional, robust lip border descriptors that provide both, adequate agreement with our visual perception of the irregularity of the lip boundary and sufficient ability to discriminate between lip boundaries with different degrees of abnormality.

In addition, the dichotomous classification approach to discriminate healthy from SC diseased lips, presented in our previous study [12], is now expanded to assess the degree of lip abnormality by incorporating a probabilistic model approach based on relevance vector machine (RVM). The Bayesian framework of RVM formulation constitutes an attractive discriminative model alternative, since it permits the prediction of the posterior probability of abnormal lip configurations which is essential in treatment evaluation and patient monitoring. RVM have been used with success in different bio-medical application fields, such as, neonate pain intensity assessment [13], epilepsy diagnosis [14], gene selection in cancer classification [15], identification of functionally significant promoter sequences by microarray data analysis [16], detection of micro-calcifications in mammograms [17], and the diagnosis of glaucoma [18].

From a clinical point of view, the proposed methodology is adequately efficient with respect to time and resource sparing as it did not require any specific equipment (e.g. chin holders or customized cameras). However, to establish the applicability of the proposed approach we need to safeguard for sufficient reliability and reproducibility of the evaluated macro-morphological lip border markers. Reliability is inherently flowed by different face postures taken by the subject, while practical problems that may interfere with the reproducibility of lip feature evaluation, include the use of dissimilar cameras with variable specifications or even different operators (different dermatologists). These confounding parameters have been herein addressed in order to make the suggested automated approach to the identification and quantification of SC suitable for large scale epidemiological studies in different clinical settings.

@&#MATERIAL AND METHODS@&#

The probabilistic model for SC assessment was trained and validated, incorporating lower lip vermillion border features extracted from non-standardized pictures taken from 75 SC patients and 75 healthy control volunteers.

Institutional Review Committee approval was granted and patients with SC and appropriate controls (patients with non-SC related skin conditions and healthy patients’ companions) attending the Dermatology ambulatory of the University Hospital of Ioannina were recruited after informed consent for clinical evaluation of the lower lip and subsequent photography.

The diagnosis and severity assessment of SC relies on the recognition of certain macro-morphological disease characteristics [4]. In this study diagnosis and severity assessment resulted from a consensus of clinical examination and independent review of the clinical pictures by two certified Dermatologists (GG, IDB).

The clinical examination included inspection for the presence of whitish-gray or brown, scaling or not plaques, areas of dryness or fissuring and of course alterations of the lip vermillion border that was the target of our study. Clinical examination was completed with palpation for recording roughness of the texture of the lip. SCC suspicion was raised and a 3mm punch biopsy was performed when persistent erosion with distinct borders was present or when a palpably indurated hyperkeratotic papule was present. In the case of SCC histopathological confirmation the patient was excluded from subsequent analysis.

All pictures were taken with the volunteers seated and instructed to look straightforward at the camera, to keep their head perpendicular to the floor and to slightly open their mouth so that both mouth corners become visible. Images were taken to demonstrate the lower third of the face. To save computation time all images were manually cropped to include only the mouth area for further processing. All digital pictures employed in the core analysis were taken by one and the same ‘operator’ (physician) with a Nikon SLR 5100 camera and original resolution 4928×3264pixel.

The method of image pre-processing and the segmentation of lower lip border has been presented in our previous study [12]. The procedure can be summarized in the following steps:
                           
                              i.
                              Image rescale, to have approximately the same spatial resolution in all cropped images

Image correction for non-uniform illumination

Image enhancement based on local gamma correction.

Image transformation from RGB to YIQ color space. Q color channel was retained to discriminate between lip and non-lip pixels.

Lip border segmentation using a spatial fuzzy c-means clustering algorithm with adaptive selection of fuzzy exponent m.

Estimation of the “ideal” lip border by the four degree polynomial curve that best fits the convex hull points of the segmented lip border.

With respect to the characteristic alterations of the lower lip vermillion-skin border in SC patients [2], two types of morphological features were quantified: (i) The extent of vermillion replacement by expanding skin or erosions and (ii) the degree of the irregularity of this border.

The degree of pathological deviation of the vermillion border was quantified using the distance between the extracted and modeled vermillion lip border C and C
                           ⁎ respectively [12]. Three different metrics were employed:

The average version of Hausdorff distance (H
                           AVG) [19], the 0.95 quantile partial Hausdorff distance (95%-HD) [20], and the Mean Sum of Square Distance (MSSD):
                              
                                 (1)
                                 
                                    M
                                    S
                                    S
                                    D
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    D
                                    
                                       
                                          (
                                          C
                                          ,
                                          
                                             
                                                C
                                             
                                             ⁎
                                          
                                          )
                                       
                                       2
                                    
                                 
                              
                           where 
                              N
                              
                           is the size of the result contour, and
                              
                                 (2)
                                 
                                    D
                                    
                                       (
                                       
                                          C
                                          ,
                                          
                                             
                                                C
                                             
                                             ⁎
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                c
                                             
                                             ⁎
                                          
                                          ∈
                                          
                                             
                                                C
                                             
                                             ⁎
                                          
                                       
                                    
                                    
                                       
                                          |
                                          |
                                          c
                                       
                                       ⁎
                                    
                                    −
                                    c
                                    |
                                    |
                                 
                              
                           
                        

The metric 
                              
                              
                                 
                                    |
                                    |
                                    c
                                 
                                 ⁎
                              
                              −
                              c
                              |
                              |
                            is the Euclidean distance, between coordinates of modeled and extracted lip border (
                           Fig. 1).

The lip border irregularity was encoded by calculating fractal features of lip contour, and features based on Fourier descriptors applicable to open curves [21].

Fractal analysis has been widely used in the analysis of biomedical images for quantifying the irregularities of lesion borders [22–24]. Several empirical methods for estimating fractal features have been proposed in the literature [25].

However, results from different estimators were found to differ from each other [26].

In this work, two methods have been employed: box counting and a method proposed by Sevcik [27]. For box counting, two approaches have been implemented, the image resampling and the grid methods [24,28]. For the first approach, lip images were resampled to a series of image sets with scale factors r={1, 0.5, 0.33, 0.25, 0.2}, lip boundary pixels were counted at each resolution and the fractal dimension of lip contour was determined by a linear fitting:
                              
                                 (3)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          B
                                          C
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                          ln
                                          (
                                          L
                                          )
                                       
                                       
                                          ln
                                          (
                                          r
                                          )
                                       
                                    
                                    +
                                    c
                                 
                              
                           where 
                              L
                            is the number of lip boundary pixels with a scaling factor of r, and c is a constant.

The grid approach was implemented by superimposing on the extracted vermilion boundary a grid composed of squares of side length δ, and counting the number of grid squares 
                              L
                              ′
                            that contain at least one pixel of vermilion boundary. By varying the value δ={1, 4, 8, 16, 32, 64, 128}, it is possible to calculate again the fractal dimension by the linear fitting:
                              
                                 (4)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          B
                                          C
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          −
                                          
                                          ln
                                          (
                                          
                                             L
                                             ′
                                          
                                          )
                                       
                                       
                                          ln
                                          (
                                          δ
                                          )
                                       
                                    
                                    +
                                    c
                                 
                              
                           
                        

The main difference in the computation of 
                              
                                 
                                    F
                                 
                                 
                                    B
                                    C
                                    1
                                 
                              
                            and 
                              
                                 
                                    F
                                 
                                 
                                    B
                                    C
                                    2
                                 
                              
                            is that for the first, scaling is applied on the lip image and the procedure of lip border extraction is repeated for all different scales, whereas for the second, gridding is applied to the extracted lip boundary which is treated as a binary image, requiring thus much less computation time.

According to a method introduced by Sevcik, and assuming
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                           , 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            are the lip contour pixel coordinates, 
                              
                                 
                                    F
                                 
                                 
                                    s
                                 
                              
                            is given by:
                              
                                 (5)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    1
                                    +
                                    
                                       
                                          ln
                                          (
                                          L
                                          )
                                       
                                       
                                          ln
                                          (
                                          2
                                          ×
                                          
                                             N
                                             ′
                                          
                                          )
                                       
                                    
                                 
                              
                           where L is the length of lip contour in the unit square and 
                              N
                              =
                              
                                 N
                                 ′
                              
                              −
                              1
                           . 
                              N
                            is the number of lip boundary pixels. Before estimating Eq. (5), pixel coordinates were transformed to unit square as follows:
                              
                                 (6)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         m
                                                         a
                                                         x
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          y
                                       
                                       
                                          i
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         m
                                                         a
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ⁎
                                       
                                    
                                 
                              
                           
                        

Fourier descriptors are known for their use in describing planar curves in frequency domain [29]. A curve can be treated as a complex-valued function that can be expanded into Fourier series, the coefficients of which are used as the curve descriptors. However the traditional Fourier descriptors are not applicable to any open curve, which is in our case.

In the present work we adapt the type-P Fourier descriptors which are calculated based on the slope information [30].

Consider the lip border as a general planar curve 
                              C
                            that consists of 
                              N
                            points:


                           
                              
                              
                              C
                              :
                              
                                 {
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    +
                                    i
                                    
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                 
                                 }
                              
                              ,
                              
                              
                              j
                              =
                              0
                              ,
                              …
                              N
                           , where 
                              i
                            is the complex number unit.

The slope of curve 
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                            at any point 
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                            can be approximated by:
                              
                                 (7)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          j
                                          =
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                z
                                             
                                             
                                                j
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                z
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       δ
                                    
                                    ,
                                    where
                                    
                                    j
                                    =
                                    0
                                    ,
                                    …
                                    N
                                    −
                                    1
                                    
                                    
                                    and
                                    
                                    
                                    δ
                                    =
                                    
                                       ‖
                                       
                                          (
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   z
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       ‖
                                    
                                 
                              
                           
                        

One method for describing the shape of curves is first to select a starting point as a reference point, then the other points on the curve can be described as bending some angle related to the tangent of its preceding point. This means that solving Eq. (7) with respect to z we have the following:
                              
                                 (8)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          z
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    δ
                                    
                                       ∑
                                       
                                          r
                                          =
                                          0
                                       
                                       
                                          j
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          r
                                          
                                          
                                       
                                    
                                    j
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    N
                                 
                              
                           
                        

Hence there is one to one correspondence between curve points and their slope.

The type-P Fourier descriptor of a planar curve is defined as the discrete Fourier transformation of slope w by:
                              
                                 (9)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       1
                                       N
                                    
                                    
                                       ∑
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          j
                                       
                                    
                                    ×
                                    exp
                                    
                                       (
                                       
                                          −
                                          2
                                          p
                                          i
                                          ×
                                          
                                             
                                                j
                                                ×
                                                k
                                             
                                             N
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    k
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    …
                                    N
                                    −
                                    1
                                    
                                 
                              
                           
                        

The inverse Fourier transform of 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              
                           gives back 
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                            and Eq. (8) restores the original curve
                              
                              C
                           .

The computation of the first Fourier feature, F
                           OC1 is derived as follows:
                              
                                 (10)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          O
                                          C
                                          1
                                       
                                    
                                    =
                                    1
                                    −
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   c
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                ‖
                                             
                                             k
                                          
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             1
                                          
                                          
                                             ‖
                                             
                                                c
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             ‖
                                          
                                       
                                    
                                 
                              
                           
                           
                              c
                              
                                 
                                    0
                                 
                                 
                                    k
                                 
                              
                            are the normalized Fourier descriptors, defined as:
                              
                                 (11)
                                 
                                    c
                                    
                                       
                                          0
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      k
                                                      =
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            |
                                                            
                                                               
                                                                  
                                                                     c
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                            |
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    otherwise
                                 
                              
                           
                        


                           
                              
                                 
                                    F
                                 
                                 
                                    O
                                    C
                                    1
                                 
                              
                            descriptor, is limited to the range [0 1], and increases in value as lip border erodes [23,31].

As SC progresses the lip border indentations become more evident and severe. In an attempt to capture less prominent lip border alterations, we used the type-P Fourier descriptors to focus on high frequency components. We experimentally found that using the first 
                              M
                              =
                              0.05
                              ×
                              N
                            coefficients, that is setting 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                              =
                              0
                            for k>M−1, we remove high frequency components of the lip border. Assuming C and C
                           ⁎ are the planar curves of the original and the restored lip border retaining 5% of type-P Fourier descriptors respectively, the second Fourier feature 
                              
                                 
                                    F
                                 
                                 
                                    O
                                    C
                                    2
                                 
                              
                              
                           was estimated as the Euclidean distance of their type-P Fourier descriptors [30]:
                              
                                 (12)
                                 
                                    
                                       
                                          F
                                       
                                       
                                          O
                                          C
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                k
                                                =
                                                0
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ⁎
                                                      
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                              
                            and 
                              
                                 
                                    c
                                 
                                 
                                    k
                                 
                                 
                                    ⁎
                                 
                              
                            are the Fourier coefficients of the two curves calculated in Eq. (9).


                           
                              The
                              
                              feature
                              
                                 
                                    F
                                 
                                 
                                    O
                                    C
                                    2
                                 
                              
                            emphasizes on the high frequency components of lip border, and is more sensitive in detecting early manifestations of SC.


                           
                           Fig. 2 illustrates an example where high frequency components are essential in the discrimination between healthy subjects, and patients with SC of low grades.

The extracted lip vermillion border descriptors are summarized in 
                           Table 1.

To investigate the repeatability of the proposed method, that is the variability of repeated lip border measures from pictures taken from the same subject due to different face postures, the intra-class correlation coefficient (ICC), also known as reliability, was estimated for each lip border descriptor [32]. ICC is the measure of the amount of the total variance attributable to true differences among individuals, and is expressed as the ratio of the true variance S
                        true to the total observed variance S
                        total:
                           
                              (13)
                              
                                 I
                                 C
                                 C
                                 =
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             t
                                             r
                                             u
                                             e
                                          
                                       
                                    
                                    
                                       
                                          
                                             S
                                          
                                          
                                             t
                                             o
                                             t
                                             a
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (14)
                              
                                 
                                    
                                       S
                                    
                                    
                                       total
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       true
                                    
                                 
                                 +
                                 E
                              
                           
                        
                     

We assume that E is the part of lip feature variability attributable to measurement error, due to different face postures. ICC takes values between 0 and 1. As the total observed variance approaches the true variance the ICC increases, so that with zero error there is a perfect reliability and an ICC coefficient of 1.

However, if the ICC is applied to data from a group of individuals demonstrating a wide range of the measured characteristics, reliability will appear to be higher than when applied to a group demonstrating a narrow range of the same characteristic [33]. For this, to ensure that reliability has been tested on a sample group with similar characteristics, we used the control group. For each individual in the control group 3 pictures were acquired using the same camera (Nicon SLR 5100). The ICC coefficient was estimated, by fitting a one-way analysis of variance (ANOVA) model to the data containing the repeat measurements made on the control group. The one-way ANOVA yields a between-subject S
                        b variance and a within-subject variance S
                        w.

The S
                        w is the residual error E used in Eq. 13. In addition, the true variance can be estimated as follows [34]:
                           
                              (15)
                              
                                 
                                    
                                       S
                                    
                                    
                                       true
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             S
                                          
                                          
                                             b
                                          
                                       
                                       −
                                       
                                          
                                             S
                                          
                                          
                                             w
                                          
                                       
                                       )
                                    
                                    k
                                 
                              
                           
                        where 
                           k
                        =3 is the number of repeated measurements.

To investigate the variation in lip border features made on a subject using different cameras, images from 20 subjects (10 controls) were acquired and analyzed using three cameras with different specifications; a NiconD5100 (4928×3264pixel), a NiconD90 system for standardized clinical photographs (kindly provided by Canfield Scientific, 4288×2848pixel) and a SonnyDSC-HX5V (3648×2736pixel). A two-way ANOVA test was carried out to examine whether: (i) different cameras affect the feature extraction and (ii) the extracted lip features are different in controls and SC patients. Furthermore, to explore whether different camera operators introduce significant variation in lip border features, 10 subjects were photographed twice by two dermatologists. A Wilcoxon rank sign test for paired samples was used to analyze the variability introduced by different operators.

To determine whether the extracted features are effective in predicting lip abnormality with high accuracy, a classification was carried out using an RVM classifier. RVM based classification model not only gives a binary decision of the presence or not of lip disease, but also provides a characterization of its strength (for a detailed description of RVM formulation see: [35]). In addition the results of the analysis with the RVM approach are compared with the outcomes with two additional classifiers, the SVM which is a state-of-the-art classifier, and the Mahalanobis distance classifier (to provide a uniform comparison with our previous work [12]). Both RVM and SVM classification models were implemented using a radial basis function kernel of sigma equal to 0.5. Classification rates were estimated by the leaving-one-out method. The evaluation set was composed of 75 patients diagnosed with solar cheilosis and a control group of 75 volunteers.

The software for image pre-processing, vermillion border detection, feature extraction, and discriminant analysis was developed using MATLAB (2010a, The MathWorks).

@&#RESULTS@&#


                     
                     Table 2 compiles the estimated ICC values of the selected descriptors of the lower lip vermillion-skin border contour morphology of the control group. ICC determinations yielded values ranging between 0.3260 and 0.6485 (Table 2), meaning that 33% to 65% of variability in lip descriptors is due to differences among individuals, whereas the rest is due to the variability of picture acquisition mainly depending on face posture. In order to further reduce the intra-individual variability of lip features measurements were averaged over 3 pictures taken from the same individual. Following, SC patients differ significantly from controls with regard to the distributions of the values of all lower lip border descriptors (p<0.01, ANOVA; 
                     Table 3). It is worth noting, however, that by the same analysis no significant differences were found between the values of the descriptors determined from pictures of the same individuals acquired with three different cameras (Table 3). There is also no significant effect of the camera operator on the resulting lip feature descriptor determinations (comparison of images taken from two different operators; Wilcoxon rank sign test).

Next, in order to select a set of features that combined improve information mining an exhaustive search in feature space revealed the optimum feature vector with the highest efficiency in recognizing alterations in the course of the lower lip vermillion border. Illustrative examples of RVM assessments of SC are given in 
                     Fig. 3 and comparison results are provided in 
                     Table 4 for RVM, SVM and Mahalanobis distance classifiers. All classifiers provided adequate sensitivity levels for the discrimination between control and SC lips; however, Mahalanobis model showed significantly inferior specificity. The best feature combination for the RVM model was the vector {H
                     AVG, F
                     BC2} (Table 4), which by comparable sensitivity level of about 95% (94.6%; 71/75 cases) improved substantially the specificity of the correct classification of the SC lips from 80% (60/75 cases) with the Mahalanobis method for the same feature vector to 96% (72/75 cases).

During the study 7 biopsies were performed and one patient has SCC confirmed and was excluded from the digital image analysis.

@&#DISCUSSION@&#

Clinical photography is a valuable asset particularly in highly visual medical specialties such as dermatology and has been accepted for decades as a standard means for documenting skin conditions, in both practice and research.

In a previous study, we have introduced an efficient methodology for lower lip vermillion border extraction from non-standardized clinical images acquired by digital photography. The extraction was based on spatial fuzzy c-means algorithm with adaptive fuzzy exponent selection. We have highlighted the average Hausdorff distance between the extracted and modeled vermillion borders as a morphological feature with adequate accuracy in discriminating between SC patients and healthy individuals [12].

In our present approach we focused on the evaluation of a probabilistic model for the assessment of clinical images of patients with lip diseases such as SC. In order to realize this goal we integrated two processes: (1) Recognition of quantitative robust macro-morphological descriptors of the lower lip border and (2) identification of the relationship between these descriptors and the target lip diagnosis SC. We decided to center our analysis on morphological descriptors of the lower lip vermillion-skin boundary not only because this tissue interface is a rich source of visual information but also because its morphological features are of central importance in evaluating patients with SC in clinical practice.

Overall, the proposed vermillion-skin border retraction and irregularity indices succeeded high discrimination accuracy between SC and control lips, likewise. Lip vermillion retraction was encoded by the distance between the extracted and modeled vermillion border using three different metrics (Table 1). Among them, H
                     AVG (the averaged Hausdorff distance) resulted in the highest intra-class repeatability coefficient (ICC, Table 2) and was also chosen more consistently than the rest by the multidimensional feature selection method based on optimal classification accuracy (Table 4). Considering the three fractal dimensions and the two Fourier metrics of the lip border, the fractality F
                     BC2 (grid method) and the Fourier F
                     OC2 (high frequency feature) descriptors respectively, seem to be the most appropriate irregularity measures for the present application (Tables 2 and 4).

In the clinical practice specificity and sensitivity of a decision process are not mere evaluators of the quality of a classification. In the ideal case, a diagnostic tool should perform with highest degrees of positive and negative predictive values simultaneously. All classification schemes under testing resulted acceptably high levels of sensitivity (Table 4). However, the specificity improvement achieved by SVM and RVM schemes compared to Mahalanobis algorithm renders our current proposal more viable for clinical applications. To figure out the impact of this latter operational improvement with a numerical example consider that epidemiological studies in populations chronically exposed to UV sun irradiation have reported a prevalence of SC that ranges from 4.6% (Italy, Europe) [36] to 16.7% (Brazil, South America) [37]. Accordingly a SC diagnostic test with a sensitivity and specificity of 95% and 85% respectively, and assuming disease prevalence of the order between 5% and 15%, will have a positive predictive value between 25% and 53%. Comparing, assuming the same sensitivity level (95%) and improving the specificity up to the level of 96% (RVM and SVM models) the positive predictive value of the test will be raised in the range between 56% and 81%.

Additionally, the visual inspection of RVM probabilistic assessments of SC (examples in Fig. 3) supported our strategy towards the quantification of the degree of lip contour alteration. The RVM approach fits better to the probabilistic biologic nature of the putative progression of SC into invasive carcinoma, a process which is clinically perceived as a morphological continuum that parallels the increasing likelihood of a malignant transition. Consequently, from this point of view RVM is anticipated to support more effectively SC monitoring and treatment follow-up.

The main limitation of the proposed method is the variability introduced by the image acquisition procedure due to different face postures. In this study we used the ICC coefficient to measure the intra-subject variability in repeated lip border measures. As with other reliability coefficients proposed in the literature, there are also no generally acceptable ICC cut-off levels to measure reliability in all applications. However, Chinn [38] recommended that only metrics with an ICC of at least 0.6 should be considered useful for practical applications. Four out of the presently eight descriptors (Table 2) had ICC values >0.6. It is worth noting that three of them were collected by the classifiers in their best feature vector configurations that yielded the most efficient discrimination between SC patients and controls (Table 4). An important outcome of the present study was also the reproducibility of the proposed method: We experimentally found that neither the use of different cameras with deviate specifications nor different operators affect significantly the estimations of the selected descriptors of the lower lip.

In conclusion, the aim of the present study was to develop a robust, clinical instrument to assist the objective evaluation of the clinical severity of SC using digital photography within the everyday clinical practice. Thus, the proposed approach, coupled by our previous observations on the evaluation of SC therapy outcome [12] opens new perspectives toward a cost effective, non-invasive monitoring of SC to support large scale epidemiological and interventional studies. Prospective studies with adequate follow-up periods are needed to appraise the potential of image analysis in the objective identification and grading of SC and the efficacy of relevant therapeutic interventions.

We wish to confirm that there are no known conflicts of interest associated with this publication and there has been no significant financial support for this work that could have influenced its outcome. We confirm that the manuscript has been read and approved by all named authors and that there are no other persons who satisfied the criteria for authorship but are not listed. We further confirm that the order of authors listed in the manuscript has been approved by all of us. We confirm that we have given due consideration to the protection of intellectual property associated with this work and that there are no impediments to publication, including the timing of publication, with respect to intellectual property. In so doing we confirm that we have followed the regulations of our institutions concerning intellectual property.

We further confirm that any aspect of the work covered in this manuscript that has involved human patients has been conducted with the ethical approval of all relevant bodies and that such approvals are acknowledged within the manuscript.

We understand that the Corresponding Author, Panagiota Spyridonos, is the sole contact for the Editorial process (including Editorial Manager and direct communications with the office). She is responsible for communicating with the other authors about progress, submissions of revisions and final approval of proofs. We confirm that we have provided a current, correct email address which is accessible by the Corresponding Author and which has been configured to accept email from.

Panagiota Spyridonos, Department of Medical Physics, Faculty of Medicine, School of Health Sciences, University of Ioannina, University Campus, 45110 Ioannina, Greece.

@&#ACKNOWLEDGEMENTS@&#

We are grateful to Mr. Larry Buchner, Canfield Scientific, Fairfield, NJ 07004, U.S.A. for the kind permission to use the Nikon D90 Canfield system for standardized clinical photographs in this study.

@&#REFERENCES@&#

