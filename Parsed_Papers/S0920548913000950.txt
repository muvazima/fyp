@&#MAIN-TITLE@&#An access authentication protocol for trusted handoff in wireless mesh networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A trust-based protocol is proposed for secure handoff in wireless mesh networks.


                        
                        
                           
                           Security properties are formally verified based on an enhanced Strand model.


                        
                        
                           
                           Performance is evaluated and shown to be more advantageous than the EMSA scheme.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Wireless mesh network

Seamless handoff

Security

Access authentication

Trusted network connect

@&#ABSTRACT@&#


               
               
                  WMNs (Wireless Mesh Networks) are a new wireless broadband network structure based completely on IP technologies and have rapidly become a broadband access measure to offer high capacity, high speed and wide coverage. Trusted handoff in WMNs requires that mobile nodes complete access authentication not only with a short delay, but also with the security protection for the mobile nodes as well as the handoff network. In this paper, we propose a trusted handoff protocol based on several technologies, such as hierarchical network model, ECC (Elliptic Curve Cryptography), trust evaluation and gray relevance analysis. In the protocol, the mobile platform's configuration must be measured before access to the handoff network can proceed and only those platforms whose configuration meets the security requirements can be allowed to access the network. We also verify the security properties through formal analysis based on an enhanced Strand model and evaluate the performance of the proposed protocol through simulation to show that our protocol is more advantageous than the EMSA (Efficient Mesh Security Association) authentication scheme in terms of success rate and average delay.
               
            

@&#INTRODUCTION@&#

WMNs are a new wireless network structure that is expected to set free the restrictions of Ad Hoc networks, WLANs (wireless local area networks), WPANs (wireless personal area networks) and WMANs (wireless metropolitan area networks), and will be used to establish commercial wireless mobile networks. Combining the advantages that WLANs and Ad Hoc networks can offer, WMNs are a wireless broadband network structure based completely on IP technologies, and become a growing effective broadband access measure that can provide high capacity, high speed and wide coverage. To some extent, WMNs are mainly a network design idea with features including no-center, self-organization, multi-hops, best routing-judgment, etc. [1]. Since a WMN does not rely on fixed infrastructure and is operated in an open space, any user within the coverage area of the radio waves can access the network. Therefore, secure access authentication is the first provision to prevent unauthorized users from accessing the network [2,3,4]. For handoff in WMNs, it is required that mobile nodes complete access authentication not only with a short delay, but also with the protection for the mobile nodes as well as the handoff network.

Past practice in the areas of information security has shown that most security problems just come from the network but more from terminal nodes [5,6,7]. Thus, the original idea of trusted computing was proposed to ensure the security of network terminals. Moreover, trusted computing is relied upon to secure the entire computer system through successive steps. First, a root of trust is established to construct a chain of trust, namely, from the root to the hardware platform to the operating system and finally to applications. Thus, trust can spread to the entire system through graded trusted authentications. For handoff in a WMN, the platform's configuration must be measured before access to the network can proceed and only those platforms whose configuration meets the security demands of the network can be allowed to access the network. Consequently, a terminal with potential threat cannot gain access to the network directly. Moreover, the terminal can verify the security of the AP (Access Point) with which it is associated and will only connect to the network when it satisfies the terminal's security demands [8].

Based on the current 802.1× authentication scheme and trusted computing technologies, we present a trusted handoff protocol in this paper to ensure security and trust in WMNs. Our goal in the design of the protocol presented in this paper is to ensure that only a legitimate user operated on a trusted platform can complete handoff to a new secure network without too much sacrifice on performance. In addition to proposing a trust-based authentication protocol to achieve the above goal for secure handoff from one network zone to another, our other contributions in this paper include the following. We propose a trust model for the trust evaluation of both starting and runtime system states, prove the security properties of the protocol through formal analysis based on an enhanced Strand model, evaluate the performance of the protocol in terms of success rate and handoff delay using simulation, and compare our protocol to a comparable scheme to demonstrate the advantages of our protocol over the other scheme.

The rest of this paper is organized as follows. Section 2 reviews some related work on handoff protocols in WMNs. Section 3 provides some background information on TPM (trusted platform module) and TNC (trusted network connect). Section 4 contains a zone-based hierarchical network model for hybrid WMNs and a universal handoff model in WMNs. Section 5 describes the method for evaluating the trust degrees of both the starting and the runtime states in a trusted system. Section 6 presents our handoff protocol, which is based on several technologies such as the hierarchical network model, ECC, trust evaluation and gray relevance analysis. Then, a formal analysis of the security properties of the protocol based on the strand space model and a demonstration of the security performance based on experiment results are provided in Sections 7 and 8, respectively. Finally, Section 9 concludes the paper, which also contains a description of our future work.

@&#RELATED WORK@&#

The IEEE 802.11 [9] protocol outlines the basic steps of the handoff process. Unfortunately, the handoff latency of the original protocol is several hundred milliseconds [10] while real-time applications require that MAC layer handoff latency be 50ms or lower. As the result, a lot of work has been done to reduce the handoff latency in recent years. However, most of the work has failed to consider a complete authentication process which is useful in real scenarios.

MIP (Mobile IP) is the most widely known mobility management proposal and has, thus, become the most common solution that can offer seamless handoff to mobile devices on the Internet [11]. Essentially, MIP uses two addresses to handle the movement of the user. Every time the MN (Mobile Node) connects to a foreign network, it obtains a temporary address called CoA (care-of-address) from a mobile agent called FA (foreign agent) through the exchange of ASAA (agent solicitation and agent advertisement) messages. However, MIP is originally designed to operate at L3 (Layer 3) only regardless of the underlying link layer (L2). This approach thus implies a clear separation between L2 and L3 handoff functionality, which may lead to unacceptable handoff latency. Actually, the messages generated by the registration process need some time to propagate through the network and the MN is unable to send or receive packets during that time [12].

IEEE P802.11s™/D1.01 [13] provides an EMSA (efficient mesh security association) authentication scheme based on the IEEE 802.11i standard where the 802.1× scheme and four handshakes are adopted to implement access authentication and key establishment. EMSA can be used to achieve efficient establishment of link security between two MNs in a WMN. It relies on a mesh key hierarchy in which keys are derived through the use of a PSK or when a MN performs IEEE 802.1× authentication. EMSA makes use of EAP (extended authentication protocol) just like EAP-SIM (subscriber identity module), EAP-TLS (transport layer security), EAP-TTLS (tunneled transport layer security) and PEAP (protected extensible authentication protocol). However, handoff in WMNs is not adequately addressed in EMSA due primarily to the reason that EMSA cannot meet the requirement of performance and identity protection in handoff.

A predictive authentication scheme is proposed in [14] using FHR (frequent handoff region). In the scheme, a statistical method is used to modulate the mobility pattern of the mobile terminal. A set of access points are selected as the FHR access points with which the mobile terminal may be associated in the near future. Before handoff, the mobile terminal sends an authentication request to the authentication server and the authentication server sends the authentication response to the FHR access points with authentication information. During handoff, the mobile terminal only needs to exchange a few messages with the new access point. However, how to select an appropriate FHR member and establish a secure connection with the FHR is not adequately addressed in the paper.

A scheme for efficient mobility management in WMNs was presented in [15]. In the scheme, a new model of location service is proposed based on several design principles. First, the proposal distinguishes between an allotted address, which changes according to the geographical location of the node, and a persistent identifier, which remains unchangeable despite the movement. This requirement thus needs the presence of a mapping service to locate each station and can be carried out by installing “Distributed Location Service”, resulting in additional centralized equipment in the network. In addition, the scheme causes additional resource consumption and great computation latency.

An efficient and robust identity-based handoff authentication in wireless networks was proposed in [16] in which a special double-trapdoor chameleon hash function is the key. Compared to other existing identity-based handoff schemes, the main advantage of this scheme is to remove the assumption that PKG (private key generator) must be fully trusted, which could result in high security and simply deployment. However, this scheme is more suitable for WLAN since in a multi-hop WMN, there may not be any PKG in a more complicated environment.

A TPM (Trusted Platform Module) is usually implemented on a chip and is hence integrated into the hardware of a platform, such as a PC, a laptop, a PDA or a mobile phone. A property of TPM is that it owns shielded locations, meaning that only TPM itself can access the storage inside the TPM, as well as protected functionality, meaning that the functions computed inside the TPM cannot be tampered with and can only be accessed directly via TPM commands or via higher layer application interfaces TSS (TCG Software Stack).

In order to verify the configuration of a platform, all parts engaged in the boot process of the platform, e.g. BIOS and master boot record are measured using some integrity measurement hash values and the final result of the accumulated hash values is stored inside the TPM in an area called PCR (platform configuration registers). An entity that needs to verify if the platform is in a certain configuration will require TPM to sign the content of the PCR using its AIK (attestation identity key) that is generated specifically for this purpose. Then, the verifier would check the signature, compare the PCR values with some reference values to verify that the platform is indeed in a desired state and to verify the trustworthiness of an AIK's signature through the certificate Cert
                     
                        AIK
                     . Note that Cert
                     
                        AIK
                      does not prove the identity of the TPM owner, but only the identity of the TPM device [17].

As shown in Fig. 1
                     , the TNC architecture based on trusted computing technologies establishes connections from the viewpoint of the integrity of the terminals in which there are three types of entities: AR (access requestor), PEP (policy enforcement point) and PDP (policy decision point) [18]. The basic concept is that the platform's configuration must be measured before access to the network can proceed and only those platforms whose configurations meet the security requirements of the network are allowed to access the network. Thus, a terminal with potential threat cannot access the network directly. Moreover, the terminal can verify the security of the AP with which it is associated and will only connect to the network when it satisfies its own security requirements. TNC is an active pre-alerted mutual network access measure.


                     Fig. 2
                      shows a zone-based hierarchical network model for hybrid WMNs, where dash and solid lines indicate wireless and wired links, respectively [19]. The whole network consists of one backbone network, one or more local area networks called zones and some scattered wired or wireless terminals.

In the backbone network, the mesh routers form a mesh infrastructure with self-configuring, self-healing and self-organizing links among which there are at least two backbone routers connected to the Internet. All backbone routers share a single database that stores authorized certificates (not explicitly shown in the figure). There is an offline CA (certificate authority) supported by an ISP (internet service provider) or a network carrier. The CA connects to the network only when it is notified of the introduction of a new terminal user, a new zone router or a new backbone router. The backbone network can be built using various types of radio technologies including the IEEE 802.11 technologies.

Zones are connected to the backbone network through border mesh routers called gateways, which enables the integration of existing wireless networks such as multi-hop networks, Wi-Fi networks, sensor networks and cellular networks. In each zone, there is at least one mobile node called AP (access point) that is connected to the backbone. APs can be MAPs (mesh access point) in multi-hop networks and microwave towers in cellular networks which may use different radio technologies. It is therefore required that the backbone border routers support various radio technologies. There is also a database that stores user information like user ID, zone ID, authorized key, etc. in each zone. Terminal nodes can roam from one zone to another or handoff from one AP to another in the same or different zones.

Conventional terminals with an Ethernet interface can be connected to mesh routers via Ethernet links, whether wired or wireless. For conventional terminals with the same radio technologies as mesh routers, they can directly communicate with the mesh routers. If a different radio technology is used, a terminal must communicate with the AP of a zone that has Ethernet connections to the mesh routers. Especially, mesh terminals can access the network through mesh routers or directly meshing with other mesh terminals in multi-hop networks whose routing capabilities can provide improved connectivity and coverage. When a user wants to access a trusted WMN, the network administrator needs to measure its platform configuration information and compare the measured value with some reference values of the network to verify its security under the current network security policies [20].


                     Fig. 3
                      shows that an MT (mobile terminal) first connects to the OAP (old access point) at point A and moves along route A→B→C. When it moves to point B, it needs to handoff from the OAP to the NAP (new access point) since it is about to get out of the radio coverage of the OAP. After successful trusted authentication, the terminal will connect to the NAP at point C. According to the framework of the network model shown in Fig. 2, both the OAP and the NAP are connected to the backbone network while the terminal completes handoff from the old zone network to the new one. It is assumed that a predefined security association and a secure connection already exist between the OAP and the NAP, i.e., they can get each other's public-key certificate securely [21,22].

Integrity measurement is a basic mechanism for the establishment of the trust of a system. The basic concept is that any entity that wants to gain control must be measured in terms of trust and validated in terms of integrity, which includes hardware, operating system, shared libraries, configuration documents, etc. From the power supply to the platform to the establishment of the operation environment, all the applications loaded as well as related data must be measured and validated. The standards of TCG (Trusted Computing Group) specify in details a series of trust measurement about the starting process of the operating system that can be easily implemented in a defined sequence. But the integrity of a running software or application has not been specified by TCG and can thus be different from one system to another [23].

The trust evaluation of states relies mostly on the current integrity message and trust measurement collected by the trusted group administrator. In this paper, we define three ranks of trust: extremely trusted, critically trusted and untrusted. Suppose X
                     ={x
                     1,x
                     2,…,x
                     
                        n
                     } is a trusted group, x is one entity in X, and S
                     :
                     x
                     →[0,1] is the trust evaluation function of the entity x. Then,
                        
                           1)
                           
                              x is untrusted if 0≤
                              S(x)≤
                              E
                              0;


                              x is critically trusted if E
                              0
                              ≤
                              S(x)<
                              E
                              1;


                              x is extremely trusted if E
                              1
                              ≤
                              S(x)<
                              E
                              2
                           

Suppose BAC
                        ={α,
                        β,
                        γ,
                        η[1].........
                        η[n]} is the basic value of the user's trust measurement in which α, β and γ are the measured hash values of the BIOS, the OS (Operation System) Loader and the OS Kernel, respectively, and η[1].........
                        η[n] are the measure hash values of the extended security applications. Also, suppose P
                        ={α′,
                        β′,
                        γ′,
                        η[1]′.........
                        η[n]′} is the measured value expected and stored by the administrator.

The administrator will then compute the result R
                        =(α
                        ∧
                        α′)∧(β
                        ∧
                        β′)∧(γ
                        ∧
                        γ′). If R
                        =0, the user is totally untrusted and not allowed to access the network. Otherwise, define 
                           
                              S
                              
                                 x
                              
                              =
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    η
                                    
                                       i
                                    
                                    ∧
                                    η
                                    
                                       
                                          i
                                       
                                       ′
                                    
                                 
                              
                           
                         and determine x's trust degree following the rules described above.

It is infeasible to collect all the integrity messages at runtime. So, a parameter T is defined by the administrator to define the cycle time for trust measurement and evaluation of the runtime states. In addition, current trust evaluation always takes into consideration the previous trust evaluations. Therefore, we use gray relevance analysis [24] to relate S
                        :
                        x
                        →[0,1] to former trust measurements.

Suppose there are n applications A
                        1,
                        A
                        2,…,
                        A
                        
                           n
                         running in member x and the trust measurements in cycle k for all the applications are denoted as P(k)={A
                        1(k),
                        A
                        2(k),…,
                        A
                        
                           n
                        (k)}. The collected integrity measurement for all the m cycles is defined as:
                           
                              
                                 
                                    P
                                    =
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                P
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                .
                                                .
                                                .
                                             
                                          
                                          
                                             
                                                P
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   A
                                                   2
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                
                                                   A
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   A
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                
                                                   A
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   1
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   A
                                                   2
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                .
                                                .
                                                .
                                             
                                             
                                                
                                                   A
                                                   n
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 0≤
                        A
                        
                           i
                        (j)≤1. The optimal reference data is set as P(0)={1,1,…,1}, which is the highest trust in the design and should never be reached in theory. Then, the correlation coefficient between application Ai
                         in each cycle k and the optimal data is calculated as:
                           
                              
                                 
                                    
                                       ξ
                                       i
                                    
                                    
                                       k
                                    
                                    =
                                    
                                       
                                          
                                             min
                                             i
                                          
                                          
                                             min
                                             k
                                          
                                          
                                             
                                                
                                                   A
                                                   0
                                                
                                                
                                                   k
                                                
                                                −
                                                
                                                   A
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          +
                                          ρ
                                          •
                                          
                                             max
                                             i
                                          
                                          
                                             max
                                             k
                                          
                                          
                                             
                                                
                                                   A
                                                   0
                                                
                                                
                                                   k
                                                
                                                −
                                                
                                                   A
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                   0
                                                
                                                
                                                   k
                                                
                                                −
                                                
                                                   A
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          +
                                          ρ
                                          •
                                          
                                             max
                                             i
                                          
                                          
                                             max
                                             k
                                          
                                          
                                             
                                                
                                                   A
                                                   0
                                                
                                                
                                                   k
                                                
                                                −
                                                
                                                   A
                                                   i
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ρ is the relative parameter which is usually assigned with value 0.5 without specific orientation.

The trust evaluation function then becomes:
                           
                              
                                 
                                    S
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      m
                                                   
                                                   
                                                      
                                                         ξ
                                                         i
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          i
                                          •
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Furthermore, if each application has a different weigh Wi
                         that is determined by the administrator, then:
                           
                              
                                 
                                    S
                                    
                                       x
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      m
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               W
                                                               i
                                                            
                                                            •
                                                            
                                                               ξ
                                                               i
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          i
                                          •
                                          m
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Lastly, the administrator can determine whether member x's current state can be trusted using the value S(x) and the thresholds E
                        0,
                        E
                        1,
                        E
                        2.

Regarding handoff in WMNs, a terminal wants to access a new zone network by connecting to a new AP. Since the thresholds E
                        0,
                        E
                        1,
                        E
                        2 defined in the old zone may be different from the thresholds 
                           
                              
                                 
                                    E
                                    ′
                                 
                                 0
                              
                              ,
                              
                                 
                                    E
                                    ′
                                 
                                 1
                              
                              ,
                              
                                 
                                    E
                                    ′
                                 
                                 2
                              
                           
                         defined in the new zone, some strategy may be used by an ISP or network carrier to handle the difference. A few such strategies are listed below:
                           
                              1)
                              Maximum compatibility strategy: 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       =
                                       max
                                       
                                          
                                             E
                                             0
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             0
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       =
                                       max
                                       
                                          
                                             E
                                             1
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                       =
                                       max
                                       
                                          
                                             E
                                             2
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             2
                                          
                                       
                                    
                                 . 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                    
                                  are the new thresholds and 
                                    
                                       max
                                       
                                          x
                                          y
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                            ,
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            ≥
                                                            y
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

Minimum compatibility strategy: 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       =
                                       min
                                       
                                          
                                             E
                                             0
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             0
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       =
                                       min
                                       
                                          
                                             E
                                             1
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                       =
                                       min
                                       
                                          
                                             E
                                             2
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             2
                                          
                                       
                                    
                                 . 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                    
                                  are the new thresholds and 
                                    
                                       min
                                       
                                          x
                                          y
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                            ,
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            ≥
                                                            y
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            x
                                                            <
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

Customization strategy: 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       =
                                       f
                                       
                                          
                                             E
                                             0
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             0
                                          
                                          
                                             E
                                             1
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             1
                                          
                                          
                                             E
                                             2
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             2
                                          
                                       
                                    
                                 , 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       =
                                       g
                                       
                                          
                                             E
                                             0
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             0
                                          
                                          
                                             E
                                             1
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             1
                                          
                                          
                                             E
                                             2
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             2
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                       =
                                       h
                                       
                                          
                                             E
                                             0
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             0
                                          
                                          
                                             E
                                             1
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             1
                                          
                                          
                                             E
                                             2
                                          
                                          
                                             
                                                E
                                                ′
                                             
                                             2
                                          
                                       
                                    
                                 . 
                                    
                                       
                                          
                                             E
                                             ¯
                                          
                                          0
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          1
                                       
                                       ,
                                       
                                          
                                             E
                                             ¯
                                          
                                          2
                                       
                                    
                                  are the new thresholds and f,
                                 g,
                                 h are custom functions.

After the thresholds 
                           
                              
                                 
                                    E
                                    ¯
                                 
                                 0
                              
                              ,
                              
                                 
                                    E
                                    ¯
                                 
                                 1
                              
                              ,
                              
                                 
                                    E
                                    ¯
                                 
                                 2
                              
                           
                         are negotiated between the old and the new APs, trust evaluation of the starting states and the runtime states can be carried out.
                           
                              1)
                              If the result is untrusted, the terminal is denied of access to the network.

If the result is critically trusted, the terminal will be allowed to only access an isolated region with limited capability while the terminal could ask for a trust repair. With a repair, the trust degree may increase to the extremely trusted and access to the network can be authorized accordingly.

If the result is extremely trusted, the terminal can access the network.

Based on the TPM hardware and the TNC architecture, we propose an access authentication protocol for trusted handoff in WMNs in which several technologies are used, e.g., hierarchical topology, ECC public key cryptography, verifiable secret sharing, three-party key agreement, etc.

We adopt ECC-based key pair generation and key agreement protocol in this paper because ECC offers the same level of security with smaller key sizes and faster computation speed compared to other schemes such as RSA.

All cryptography is built on a suitably chosen elliptic curve E defined over a finite field F
                        
                           q
                         of characteristic p as well as a base point P
                        ∈
                        E(F
                        
                           q
                        ). The ECDLP (elliptic curve discrete logarithm problem) on E(F
                        
                           q
                        ) is to find an integer m that satisfies Q
                        =
                        mP while P and Q are given. This is shown to be an NP-hard intractability problem. As described in [25], some domain parameters are defined as follows:
                           
                              1)
                              A field size q, where q is a prime power (in practice, either q
                                 =
                                 p, or an odd prime, q
                                 =2
                                    m
                                 ).

An indication FR (field representation) of the representation used for the elements of F
                                 
                                    q
                                 .

Two field elements a and b in F
                                 
                                    q
                                  which define the equation of the elliptic curve E over F
                                 
                                    q
                                  (e.g., y
                                 2
                                 =
                                 x
                                 3
                                 +
                                 ax
                                 +
                                 b in the case p
                                 >3, and y
                                 2
                                 +
                                 xy
                                 =
                                 x
                                 3
                                 +
                                 ax
                                 2
                                 +
                                 b in the case p
                                 =2).

A finite point P
                                 =(x
                                 
                                    P
                                 ,y
                                 
                                    P
                                 ) of prime order in E(F
                                 
                                    q
                                 ) and P
                                 ≠
                                 O where O denotes the point at infinity.

The order n of the point P with nP
                                 =
                                 O and n
                                 >2160 as commonly recommended.

The cofactor h
                                 =#
                                 E(F
                                 
                                    q
                                 )/n where #
                                 E(F
                                 
                                    q
                                 ) denotes the number of F
                                 
                                    q
                                 -rational points on E.

Given a valid set of domain parameters (q,FR,a,b,P,n,h), an entity A's private key is an integer ω
                        
                           A
                        
                        ∈
                        R[1,
                        n
                        −1] while its public key is the point W
                        
                           A
                        
                        =
                        ω
                        
                           A
                        
                        P. A's public-key certificate, represented as CERT
                        
                           A
                        , contains a string of information that uniquely identifies A, its public key W
                        
                           A
                        , the domain parameters if these are not known from the context and a certifying authority CA's signature over this information. Any other entity B can use his authentic copy of the CA's public key obtained a priori to verify A's certificate, therefore obtaining an authentic copy of A's public key. In the protocol proposed in this paper, all entities should acquire an authorized certificate from the offline CA before accessing the network.

Two entities A and B can complete key agreement as follows:
                           
                              1)
                              A selects x
                                 ∈
                                 
                                    R
                                 [1,
                                 n
                                 −1], computes point R
                                 
                                    A
                                 
                                 =
                                 xP and sends R
                                 
                                    A
                                  to B.

B selects y
                                 ∈
                                 
                                    R
                                 [1,
                                 n
                                 −1], computes point R
                                 
                                    B
                                 
                                 =
                                 yP and sends R
                                 
                                    B
                                  to A.

The session key is then the point K
                        
                           S
                        
                        =
                        yR
                        
                           A
                        
                        =
                        xR
                        
                           B
                        
                        =
                        xyP.


                        Table 1
                         lists some terms and notations used in this paper. Note that Cert
                        
                           AIK
                         proves the identity of the TPM device while CERT
                        
                           i
                         proves the identity of the user, and Cert
                        
                           AIK
                        
                        ≠
                        CERT
                        
                           i
                        .

The proposed protocol is depicted in Fig. 4
                         in which the following eight steps are needed for completing the authentication:
                           
                              1)
                              MT sends a Request Handoff message to OAP, which includes information about NAP.

After receiving a handoff request, OAP generates a random integer N
                                 
                                    OAP
                                  and replies it to MT.

MT constructs 
                                    
                                       ms
                                       
                                          g
                                          MT
                                       
                                       =
                                       
                                          N
                                          OAP
                                       
                                       ,
                                       
                                          N
                                          MT
                                       
                                       ,
                                       xP
                                       ,
                                       
                                          
                                             
                                                plat
                                                −
                                                ver
                                                
                                                   t
                                                   MT
                                                
                                             
                                          
                                          
                                             k
                                             old
                                          
                                       
                                    
                                  and its digital signature Sig
                                 
                                    MT
                                 (msg
                                 
                                    MT
                                 ), then sends them to OAP. In this step, N
                                 
                                    MT
                                  is a random integer generated by MT, x is a random integer and should be kept secret by MT, xP is used to accomplish key agreement, where P is the selected base point of E(F
                                 
                                    q
                                 ), 
                                    
                                       plat
                                       _
                                       ver
                                       
                                          t
                                          MN
                                       
                                       =
                                       SM
                                       
                                          L
                                          MT
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   N
                                                   MT
                                                
                                                ,
                                                
                                                   N
                                                   OAP
                                                
                                                ,
                                                PC
                                                
                                                   R
                                                   MT
                                                
                                             
                                          
                                          
                                             pr
                                             
                                                i
                                                
                                                   AIK
                                                   ,
                                                   MT
                                                
                                             
                                          
                                       
                                       ,
                                       Cer
                                       
                                          t
                                          
                                             AIK
                                             ,
                                             MT
                                          
                                       
                                    
                                  where SML
                                 
                                    MT
                                 ,
                                 PCR
                                 
                                    MT
                                  and Cert
                                 
                                    AIK,MT
                                  are used to ensure MT's platform authentication and integrity verification, k
                                 
                                    old
                                  is the current session key between MT and OAP, and Sig
                                 
                                    MT
                                 (msg
                                 
                                    MT
                                 ) is MT's digital signature on the message msg
                                 
                                    MT
                                  with its private key ω
                                 
                                    MT
                                  and is used to authenticate the user's identity of MT.

After receiving the message, OAP can decrypt 
                                    
                                       
                                          
                                             plat
                                             −
                                             ver
                                             
                                                t
                                                MT
                                             
                                          
                                       
                                       
                                          k
                                          old
                                       
                                    
                                  with the old session key k
                                 
                                    old
                                  to get plat
                                 −
                                 vert
                                 
                                    MT
                                 . It then combines MT's current trust plat
                                 −
                                 vert
                                 
                                    MT
                                 , MT's history trusts H
                                 
                                    MT
                                  and MT's public certificate CERT
                                 
                                    MT
                                 , and then encrypts them with the new AP's public key W
                                 
                                    NAP
                                 . Finally, OAP constructs 
                                    
                                       ms
                                       
                                          g
                                          OAP
                                       
                                       =
                                       ms
                                       
                                          g
                                          MT
                                       
                                       ,
                                       Si
                                       
                                          g
                                          MT
                                       
                                       
                                          
                                             ms
                                             
                                                g
                                                MT
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                plat
                                                −
                                                ver
                                                
                                                   t
                                                   MT
                                                
                                                ,
                                                
                                                   H
                                                   MT
                                                
                                                ,
                                                CER
                                                
                                                   T
                                                   MT
                                                
                                             
                                          
                                          
                                             W
                                             NAP
                                          
                                       
                                    
                                  and its digital signature Sig
                                 
                                    OAP
                                 (msg
                                 
                                    OAP
                                 ), and then sends them to NAP.

After receiving the message, NAP verifies both MT's identity and platform to ensure that MT is valid under the network's current security policy. NAP can check OAP's signature to authenticate OAP's identity and the message's integrity. NAP then decrypts 
                                    
                                       
                                          
                                             plat
                                             −
                                             ver
                                             
                                                t
                                                MT
                                             
                                             ,
                                             
                                                H
                                                MT
                                             
                                             ,
                                             CER
                                             
                                                T
                                                MT
                                             
                                          
                                       
                                       
                                          W
                                          NAP
                                       
                                    
                                  with its private key ω
                                 
                                    NAP
                                 . NAP will verify Cert
                                 
                                    AIK,MT
                                  inside plat
                                 −
                                 vert
                                 
                                    MT
                                  and decrypts 
                                    
                                       
                                          
                                             
                                                N
                                                MT
                                             
                                             ,
                                             
                                                N
                                                OAP
                                             
                                             ,
                                             PC
                                             
                                                R
                                                MT
                                             
                                          
                                       
                                       
                                          pr
                                          
                                             i
                                             
                                                AIK
                                                ,
                                                MT
                                             
                                          
                                       
                                    
                                  to get PCR
                                 
                                    MT
                                 . It can then calculate the trust degree S(x) and compare S(x) with the reference values of the current network to evaluate MT's platform's trust. NAP gets CERT
                                 
                                    MT
                                  which contains MT's public key W
                                 
                                    MT
                                  and verifies Sig
                                 
                                    MT
                                 (msg
                                 
                                    MT
                                 ) to authenticate MT's user identity.

Only when both verifications are successful, will NAP allow MT to connect to the new network. NAP constructs 
                                    
                                       ms
                                       
                                          g
                                          NAP
                                       
                                       =
                                       
                                          N
                                          OAP
                                       
                                       ,
                                       
                                          N
                                          MT
                                       
                                       ,
                                       
                                          N
                                          NAP
                                       
                                       ,
                                       yP
                                       ,
                                       
                                          
                                             
                                                plat
                                                −
                                                ver
                                                
                                                   t
                                                   NAP
                                                
                                                ,
                                                CER
                                                
                                                   T
                                                   NAP
                                                
                                             
                                          
                                          
                                             W
                                             MT
                                          
                                       
                                    
                                  and its digital signature Sig
                                 
                                    NAP
                                 (msg
                                 
                                    NAP
                                 ) and then sends them to OAP. NAP can calculate the new session key between it and MT k
                                 
                                    new
                                 
                                 =
                                 y(xP)=
                                 xyP.

OAP encrypts the receiving message with k
                                 
                                    old
                                  and forwards it to MT.

After receiving the message, MT decrypts 
                                    
                                       
                                          
                                             ms
                                             
                                                g
                                                NAP
                                             
                                             ,
                                             Si
                                             
                                                g
                                                NAP
                                             
                                             
                                                
                                                   ms
                                                   
                                                      g
                                                      NAP
                                                   
                                                
                                             
                                          
                                       
                                       
                                          k
                                          old
                                       
                                    
                                  with the old session key k
                                 
                                    old
                                  to get 
                                    
                                       ms
                                       
                                          g
                                          
                                             
                                             NAP
                                          
                                       
                                    
                                 . It will do the same verification as NAP did. If successful, MT will get the session key through k
                                 
                                    new
                                 
                                 =
                                 x(yP)=
                                 xyP. Then it will encrypt the random integer set {N
                                 
                                    OAP
                                 ,N
                                 
                                    MT
                                 ,N
                                 
                                    NAP
                                 } with the new session key k
                                 
                                    new
                                  and send it to OAP.

OAP can check the validity of 
                                    
                                       
                                          
                                             N
                                             OAP
                                          
                                          
                                             N
                                             MT
                                          
                                          
                                             N
                                             NAP
                                          
                                       
                                       
                                          k
                                          new
                                       
                                    
                                  and allow MT to bind if it is valid.

Formal analysis is currently the most effective way to analyze security protocols among which the strand space model [26] is one of the most effective formal analysis methods. Strand space model is an analyzing model of security protocols based on the Dolev–Yao model [27] built on graph theory and partial ordering, and can be used to analyze complicated protocols because of its excellent expansibility. In this section, we formally analyze our proposed protocol with an extended strand space model.

In the original strand space model, message terms only include atomic terms, encrypted terms and joined terms. Since there are two new operations, i.e., the signature and the ECC operations in our protocol, we will add some new data collections into the model [28].
                           Definition 1
                           
                              M is a collection of message terms. Term t is an element of M if it is an element of collection T of plaintexts or collection K of key symbols. Complex terms of M can be constructed using the following four operations:
                                 
                                    1)
                                    Encryption operation, expressed as {M}
                                          K
                                       
                                       :
                                       M
                                       ×
                                       K
                                       →
                                       M.

Join operation, expressed as M
                                       1
                                       M
                                       2
                                       :
                                       M
                                       ×
                                       M
                                       →
                                       M.

Signature operation, expressed as [M]
                                          K
                                       
                                       :
                                       M
                                       ×
                                       K
                                       →
                                       M.

ECC operation, expressed as tP
                                       :
                                       K
                                       ×
                                       T
                                       →
                                       K.

A subterm relation ∠ is defined as follows, where A and N are terms:
                                 
                                    1)
                                    
                                       A
                                       ∠
                                       A.


                                       k
                                       ∈
                                       K, if A
                                       ∠
                                       N, then A
                                       ∠{N}
                                          k
                                       , especially, k
                                       ∠{N}
                                          k
                                        only if k
                                       ∠
                                       N.


                                       N
                                       1
                                       ∈
                                       M, if A
                                       ∠
                                       N, then A
                                       ∠
                                       NN
                                       1 and A
                                       ∠
                                       N
                                       1
                                       N.


                                       k
                                       ∈
                                       K, if A
                                       ∠
                                       N, then A
                                       ∠[N]
                                          k
                                       , especially, k
                                       ∠[N]
                                          k
                                        only if k
                                       ∠
                                       N.

If x
                                       ∈
                                       T and x
                                       ∠
                                       N, then xP
                                       ∠
                                       N, but not vice versa, especially, x
                                       ∠
                                       xP is disproved, which results from the NP-hard intractability of ECDLP.

We can deduce that ∠ is a partially ordered relation and that if 
                                 
                                    K
                                    ≠
                                    
                                       K
                                       1
                                    
                                    
                                    and
                                    
                                       
                                          h
                                       
                                       K
                                    
                                    ∠
                                    
                                       
                                          
                                             h
                                             1
                                          
                                       
                                       
                                          K
                                          1
                                       
                                    
                                 
                              , then {h}
                                 K
                              
                              ∠
                              h
                              1.

If M is a message term, then +
                              M is an event that means sending message M while −
                              M is an event that means receiving message M. If E
                              
                                 i
                              
                              =±
                              M, then un
                              _
                              term(E
                              
                                 i
                              )=
                              M. The strand is an array of events and a strand space graph is a set Σ and traces in Σ: Σ
                              →(±
                              A)*. Node n on trace σ is labeled as 〈σ,i〉 and the number of nodes on σ is labeled as height(σ). Term t originates on node n if and only if sign(n)=+ and t
                              ⊂
                              term(n). If n′ is a preorder node on the trace, i.e., ∀
                              n′→
                              +
                              n, then t
                              ∉
                              term(n′).

In addition to the original eight attack strands, M-strand, F-strand, Tee-strand, C-strand, S-strand, K-strand, E-strand and D-strand, we add two new attack strands:
                                 
                                    1)
                                    Sig-strand: −
                                       k,−
                                       h,+[h]
                                          k
                                       ,
                                       k
                                       ∈
                                       K,
                                       h
                                       ∈
                                       M.

ECC-strand: −
                                       x,−
                                       yP,+
                                       xyP.


                              K-ideal of collection M is a collection, expressed as I
                              
                                 K
                              [h]⊆
                              M, that satisfies the following requirements:
                                 
                                    1)
                                    ∀
                                       h
                                       ∈
                                       I,∀
                                       g
                                       ∈
                                       M, then gh
                                       ∈
                                       I and hg
                                       ∈
                                       I.

∀
                                       h
                                       ∈
                                       I,∀
                                       k
                                       ∈
                                       K, then {h}
                                          k
                                       
                                       ∈
                                       I.

∀
                                       h
                                       ∈
                                       I,∀
                                       k
                                       ∈
                                       K, then [h]
                                          k
                                       
                                       ∈
                                       I.

Node n is the entry point of I if and only if sign(n)=+, term(n)∈
                              I. If n′ is a preorder node on the trace, i.e., ∀
                              n′→
                              +
                              n, then term(n
                              ')∉
                              I.

Omitting the information that has nothing to do with security in the protocol, the strand space of our protocol as depicted in Fig. 5
                         can be expressed as a Strand Graph ∑. Labeled as p
                        
                           i
                         in the graph, plat
                        _
                        vert
                        
                           i
                         is computed in the TPM's protected functionality and cannot be tampered with or faked. The private and public key pair (ω
                        
                           i
                        ,W
                        
                           i
                        ) is labeled as 
                           
                              
                                 k
                                 
                                    
                                    i
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 k
                                 i
                              
                           
                         while the new and the old session keys are labeled as k
                        
                           S
                         and k
                        
                           O
                        , respectively. Let T
                        
                           names
                         denote the collection of names and K
                        
                           P
                         the collection of keys that an attacker has already obtained, then X
                        ∈
                        T
                        
                           names
                        , public keys k
                        
                           X
                        
                        ∈
                        K
                        
                           P
                         and the corresponding private keys k
                        
                           X
                        
                        −1
                        ∈
                        K
                        −
                        K
                        
                           P
                        .
                           
                              1)
                              M1=
                                 N
                                 
                                    OAP
                                 .

M2=
                                 
                                    
                                       
                                          N
                                          OAP
                                       
                                       
                                          N
                                          MT
                                       
                                       
                                          xP
                                       
                                       
                                          
                                             
                                                p
                                                MT
                                             
                                          
                                          
                                             k
                                             O
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                   OAP
                                                
                                                
                                                   N
                                                   MT
                                                
                                                
                                                   xP
                                                
                                                
                                                   
                                                      
                                                         p
                                                         MT
                                                      
                                                   
                                                   
                                                      k
                                                      O
                                                   
                                                
                                             
                                          
                                          
                                             k
                                             MT
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 .

M3=
                                 
                                    
                                       
                                          
                                             
                                                N
                                                OAP
                                             
                                             
                                                N
                                                MT
                                             
                                             
                                                xP
                                             
                                             
                                                
                                                   
                                                      p
                                                      MT
                                                   
                                                
                                                
                                                   k
                                                   O
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                         OAP
                                                      
                                                      
                                                         N
                                                         MT
                                                      
                                                      
                                                         xP
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                               MT
                                                            
                                                         
                                                         
                                                            k
                                                            O
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   MT
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                         MT
                                                      
                                                      
                                                         H
                                                         MT
                                                      
                                                      
                                                         k
                                                         MT
                                                      
                                                   
                                                
                                                
                                                   k
                                                   NAP
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         N
                                                         OAP
                                                      
                                                      
                                                         N
                                                         MT
                                                      
                                                      
                                                         xP
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                               MT
                                                            
                                                         
                                                         
                                                            k
                                                            O
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  N
                                                                  OAP
                                                               
                                                               
                                                                  N
                                                                  MT
                                                               
                                                               
                                                                  xP
                                                               
                                                               
                                                                  
                                                                     
                                                                        p
                                                                        MT
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     O
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            MT
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                                  MT
                                                               
                                                               
                                                                  H
                                                                  MT
                                                               
                                                               
                                                                  k
                                                                  MT
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            NAP
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   OAP
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

M4=
                                 
                                    
                                       
                                          N
                                          OAP
                                       
                                       
                                          N
                                          MT
                                       
                                       
                                          N
                                          NAP
                                       
                                       
                                          yP
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                   NAP
                                                
                                                
                                                   k
                                                   NAP
                                                
                                             
                                          
                                          
                                             k
                                             MT
                                          
                                       
                                       
                                          
                                             
                                                
                                                   N
                                                   OAP
                                                
                                                
                                                   N
                                                   MT
                                                
                                                
                                                   N
                                                   NAP
                                                
                                                
                                                   yP
                                                
                                                
                                                   
                                                      
                                                         
                                                            p
                                                            NAP
                                                         
                                                         
                                                            k
                                                            NAP
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      MT
                                                   
                                                
                                             
                                          
                                          
                                             k
                                             NAP
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 .

M5=
                                 
                                    
                                       
                                          
                                             
                                                N
                                                OAP
                                             
                                             
                                                N
                                                MT
                                             
                                             
                                                N
                                                NAP
                                             
                                             
                                                yP
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                         NAP
                                                      
                                                      
                                                         k
                                                         NAP
                                                      
                                                   
                                                
                                                
                                                   k
                                                   MT
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                         OAP
                                                      
                                                      
                                                         N
                                                         MT
                                                      
                                                      
                                                         N
                                                         NAP
                                                      
                                                      
                                                         yP
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                                  NAP
                                                               
                                                               
                                                                  k
                                                                  NAP
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            MT
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   NAP
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          k
                                          O
                                       
                                    
                                 .

M6=
                                 
                                    
                                       
                                          
                                             
                                                N
                                                OAP
                                             
                                             
                                                N
                                                MT
                                             
                                             
                                                N
                                                NAP
                                             
                                          
                                       
                                       
                                          k
                                          S
                                       
                                    
                                 .

There are therefore three regular strands in the protocol:Init[N,N′,N″,p,p′,k
                        
                           S
                        ] is the set of strand s
                        ∈
                        Σ whose trace is <−M1,+M2,−M5,+M6>.Mid[N,N′,N″,p,p′,k
                        
                           S
                        ] is the set of strand s
                        ∈
                        Σ whose trace is <+M1,−M2,+M3,−M4,+M5>.Resp[N,
                        N
                        ',
                        N
                        '',
                        p,
                        p
                        ',
                        k
                        
                           S
                        ] is the set of strand s
                        ∈
                        Σ whose trace is <−M3,+M4,−M6>.

Obviously, they are pairwise disjoint.

Message m is secret in the strand graph G of a protocol if there is no strand n which meets the following two conditions: n
                        ∈
                        G and un
                        _
                        term(n)≠
                        m.
                           Theorem 1
                           
                              Suppose C is a bundle in Σ and k
                              
                                 S
                               
                              is uniquely originated. Let S
                              ={k
                              
                                 MT
                              
                              −1,k
                              
                                 OAP
                              
                              −1,k
                              
                                 NAP
                              
                              −1,k
                              
                                 O
                              ,k
                              
                                 S
                              } and K
                              ∗
                              =
                              K
                              −
                              S. For every node n
                              ∈
                              C, term(n)∉
                              I
                              
                                 K
                                 *[k
                              
                                 S
                              ].
                           

According to the theory of K-ideal, we just need to prove that no regular node n is an entry point of I
                              
                                 K
                                 *[S], which we will argue by contradiction. Assume that n is a regular node which is an entry point of I
                              
                                 K
                                 *[S]. Then one of the keys k
                              
                                 MT
                              
                              −1,
                              k
                              
                                 OAP
                              
                              −1,
                              k
                              
                                 NAP
                              
                              −1,
                              k
                              
                                 O
                              ,
                              k
                              
                                 S
                               is a subterm of term(n). Since there is no regular node that contains k
                              
                                 MT
                              
                              −1,
                              k
                              
                                 OAP
                              
                              −1,
                              k
                              
                                 NAP
                              
                              −1,
                              k
                              
                                 O
                               as a subterm, k
                              
                                 S
                               must be a subterm of term(n).


                        k
                        
                           S
                        
                        =
                        xyP does not appear in any message term, but it can be gained through the following ECC operations: x(yP), y(xP) and (xy)P. The form in which term x appears in all message terms is xP, so x
                        ∠
                        term(n) if and only if x
                        ∠
                        xP. But in our extended strand model, x
                        ∠
                        xP is disproved due to the NP-hard intractability of ECDLP. So x
                        ∠
                        term(n) is disproved and none of x,
                        y,
                        xy is a subterm of term(n). So, the operations listed above cannot be carried out in Σ, that is, k
                        
                           S
                         is not a subterm of term(n).

Therefore, no regular node n can be an entry point of I
                        
                           K
                           *[S]. That is, for every node n
                        ∈
                        C, term(n)∉
                        I
                        
                           K
                           *[k
                        
                           S
                        ].

A protocol guarantees agreement to a participant B as the responder for certain data items d if each time participant B completes a run of the protocol as the responder using d, which to B appears to be a run with A, then there is a unique run of the protocol with a principal A as the initiator using d, which to A appears to be a run with B.
                           Lemma 1
                           
                              Suppose C is a bundle in Σ, X
                              ∈
                              T
                              
                                 names
                               
                              and k
                              
                                 X
                              
                              −1
                              ∈
                              K
                              −
                              K
                              
                                 P
                              
                              , then no term of the form 
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                       X
                                       
                                          −
                                          1
                                       
                                    
                                 
                               
                              can originate on a penetrator node in C.
                           

Let S
                              ={k
                              
                                 X
                              
                              −1}. First, it is obvious that there is no regular node that takes k
                              
                                 X
                              
                              −1 as its subterm. So, k
                              
                                 X
                              
                              −1 cannot originate on any regular node and no regular strand is an entry of I
                              
                                 K
                              [S].

Suppose 
                           
                              
                                 g
                              
                              
                                 k
                                 X
                                 
                                    −
                                    1
                                 
                              
                           
                         originates on a penetrator strand s in Σ. Obviously, s cannot be M-strand, F-strand, Tee-strand, C-strand, S-strand, K-strand, E-strand, D-strand or ECC-strand.

If s is a Sig-strand, then s
                        =〈−
                        k,−
                        h,+[h]
                           k
                        〉. From 
                           
                              
                                 
                                    g
                                 
                                 
                                    k
                                    X
                                    
                                       −
                                       1
                                    
                                 
                              
                              ∠
                              
                                 
                                    h
                                 
                                 k
                              
                           
                         and k
                        ≠
                        k
                        
                           X
                        
                        −1, we can get 
                           
                              
                                 
                                    g
                                 
                                 
                                    k
                                    X
                                    
                                       −
                                       1
                                    
                                 
                              
                              ∠
                              h
                           
                        . Since h does not originate from s, there must be another strand s′=〈…,+
                        h,..〉 that satisfies the condition s′→
                        s, which means that 
                           
                              
                                 g
                              
                              
                                 k
                                 X
                                 
                                    −
                                    1
                                 
                              
                           
                         does not originate from s and it should originate on s′, which is clearly a contradiction.

So, no term of the form 
                           
                              
                                 g
                              
                              
                                 k
                                 X
                                 
                                    −
                                    1
                                 
                              
                           
                         can originate on a penetrator node in C.
                           Lemma 2
                           
                              Suppose 
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                       X
                                       
                                          −
                                          1
                                       
                                    
                                 
                               
                              originates on a regular strand s.
                              
                                 
                                    1)
                                    
                                       If s
                                       ∈
                                       Init[N,N′,N″,p,p′,k
                                       
                                          S
                                       ], then H
                                       =
                                       N
                                       
                                          A
                                       
                                       N
                                       
                                          B
                                       
                                       LL′, where N
                                       
                                          A
                                       ,
                                       N
                                       
                                          B
                                       
                                       ∈
                                       T
                                       
                                          names
                                        
                                       and L
                                       ∈
                                       K,
                                       L′∈
                                       M.
                                    


                                       If s
                                       ∈
                                       Mid[N,N′,N″,p,p′,k
                                       
                                          S
                                       ], then H
                                       =
                                       N
                                       
                                          A
                                       
                                       N
                                       
                                          B
                                       
                                       LL′L″L‴, where N
                                       
                                          A
                                       ,
                                       N
                                       
                                          B
                                       
                                       ∈
                                       T
                                       
                                          names
                                        
                                       and L
                                       ∈
                                       K,
                                       L′L″L‴∈
                                       M.
                                    


                                       If s
                                       ∈Resp[N,N′,N″,p,p′,k
                                       
                                          S
                                       ], then H
                                       =
                                       N
                                       
                                          A
                                       
                                       N
                                       
                                          B
                                       
                                       N
                                       
                                          c
                                       
                                       LL′, where N
                                       
                                          A
                                       ,
                                       N
                                       
                                          B
                                       ,
                                       N
                                       
                                          C
                                       
                                       ∈
                                       T
                                       
                                          names
                                        
                                       and L
                                       ∈
                                       K,
                                       L′∈
                                       M.
                                    


                              s needs to be positive sign.

If s is an Init-strand, then m
                              =〈s,2〉 and 
                                 
                                    term
                                    
                                       m
                                    
                                    =
                                    
                                       N
                                       A
                                    
                                    
                                       N
                                       B
                                    
                                    
                                       K
                                    
                                    
                                       
                                          
                                             p
                                             A
                                          
                                       
                                       
                                          k
                                          B
                                       
                                    
                                    
                                       
                                          
                                             
                                                N
                                                A
                                             
                                             
                                                N
                                                B
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      p
                                                      A
                                                   
                                                
                                                
                                                   k
                                                   B
                                                
                                             
                                          
                                       
                                       
                                          k
                                          
                                             
                                             A
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                              . At the moment, H
                              =
                              N
                              
                                 A
                              
                              N
                              
                                 B
                              
                              LL′.

If s is an Mid-strand, then m
                              =〈s,3〉 and 
                                 
                                    term
                                    
                                       m
                                    
                                    =
                                    
                                       N
                                       A
                                    
                                    
                                       N
                                       B
                                    
                                    
                                       K
                                    
                                    
                                       
                                          
                                             p
                                             A
                                          
                                       
                                       
                                          k
                                          O
                                       
                                    
                                    
                                       
                                          
                                             
                                                N
                                                A
                                             
                                             
                                                N
                                                B
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      p
                                                      A
                                                   
                                                
                                                
                                                   k
                                                   O
                                                
                                             
                                          
                                       
                                       
                                          k
                                          
                                             
                                             A
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                p
                                                A
                                             
                                             
                                                H
                                                A
                                             
                                             
                                                k
                                                A
                                             
                                          
                                       
                                       
                                          k
                                          C
                                       
                                    
                                 
                              . At the moment, H
                              =
                              N
                              
                                 A
                              
                              N
                              
                                 B
                              
                              LL′L″L‴.

If s is a Resp-strand, then m
                              =〈s,2〉 and 
                                 
                                    term
                                    
                                       m
                                    
                                    =
                                    
                                       N
                                       A
                                    
                                    
                                       N
                                       B
                                    
                                    
                                       N
                                       C
                                    
                                    
                                       K
                                    
                                    
                                       
                                          
                                             p
                                             B
                                          
                                       
                                       
                                          k
                                          A
                                       
                                    
                                    
                                       
                                          
                                             
                                                N
                                                A
                                             
                                             
                                                N
                                                B
                                             
                                             
                                                N
                                                C
                                             
                                             
                                                K
                                             
                                             
                                                
                                                   
                                                      p
                                                      B
                                                   
                                                
                                                
                                                   k
                                                   A
                                                
                                             
                                          
                                       
                                       
                                          k
                                          
                                             
                                             B
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                              . At the moment, H
                              =
                              N
                              
                                 A
                              
                              N
                              
                                 B
                              
                              N
                              
                                 c
                              
                              LL′.


                              Suppose s is a regular strand in Σ.
                              
                                 
                                    1)
                                    
                                       If 
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                      A
                                                   
                                                   
                                                      N
                                                      B
                                                   
                                                   L
                                                   
                                                      L
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                                X
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                        
                                       originates on s, then s
                                       ∈
                                       Init[N,N′,N″,p,p′,k
                                       
                                          S
                                       ] and N
                                       
                                          MT
                                       ,
                                       p
                                       
                                          MT
                                        
                                       originate on s.
                                    


                                       If 
                                       
                                          
                                             
                                                
                                                   
                                                      N
                                                      A
                                                   
                                                   
                                                      N
                                                      B
                                                   
                                                   
                                                      N
                                                      C
                                                   
                                                   L
                                                   
                                                      L
                                                      ′
                                                   
                                                
                                             
                                             
                                                k
                                                X
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                        
                                       originates on s, then s
                                       ∈Resp[N,N′,N″,p,p′,k
                                       
                                          S
                                       ] and N
                                       
                                          NAP
                                       ,
                                       p
                                       
                                          NAP
                                        
                                       originate on s.
                                    

The results can be deduced from Lemma 2.


                              Suppose C is a bundle in Σ, N
                              
                                 NAP
                              ,
                              p
                              
                                 NAP
                               
                              is uniquely originating in C and k
                              
                                 X
                              
                              −1
                              ∈
                              K
                              −
                              K
                              
                                 P
                              
                              . If r
                              ∈
                              Init[N,N′,N″,p,p′,k
                              
                                 S
                              ] has C
                              −
                              height(r)≥3, then there is a regular strand s
                              ∈Resp[N,N′,N″,p,p′,k
                              
                                 S
                              ] and C
                              −
                              height(s)≥2.
                           

The trace of r is as follows:
                                 
                                    
                                       
                                          
                                             
                                                r
                                                =
                                                
                                                   
                                                      −
                                                      M
                                                      1
                                                      ,
                                                      +
                                                      M
                                                      2
                                                      ,
                                                      −
                                                      M
                                                      5
                                                      ,
                                                      +
                                                      M
                                                      6
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                <
                                                −
                                                
                                                   N
                                                   OAP
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                +
                                                
                                                   N
                                                   OAP
                                                
                                                
                                                   N
                                                   MT
                                                
                                                
                                                   xP
                                                
                                                
                                                   
                                                      
                                                         p
                                                         MT
                                                      
                                                   
                                                   
                                                      k
                                                      O
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            xP
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                                  MT
                                                               
                                                            
                                                            
                                                               k
                                                               O
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      MT
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            N
                                                            NAP
                                                         
                                                         
                                                            yP
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                     NAP
                                                                  
                                                                  
                                                                     k
                                                                     NAP
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               MT
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     N
                                                                     NAP
                                                                  
                                                                  
                                                                     yP
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                              NAP
                                                                           
                                                                           
                                                                              k
                                                                              NAP
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        MT
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               NAP
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      O
                                                   
                                                
                                             
                                          
                                          
                                             
                                                +
                                                
                                                   
                                                      
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            N
                                                            NAP
                                                         
                                                      
                                                   
                                                   
                                                      k
                                                      S
                                                   
                                                
                                                >
                                             
                                          
                                       
                                    
                                 
                              and 
                                 
                                    term
                                    
                                       
                                          r
                                          3
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                N
                                                OAP
                                             
                                             
                                                N
                                                MT
                                             
                                             
                                                N
                                                NAP
                                             
                                             
                                                yP
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                         NAP
                                                      
                                                      
                                                         k
                                                         NAP
                                                      
                                                   
                                                
                                                
                                                   k
                                                   MT
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         N
                                                         OAP
                                                      
                                                      
                                                         N
                                                         MT
                                                      
                                                      
                                                         N
                                                         NAP
                                                      
                                                      
                                                         yP
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                                  NAP
                                                               
                                                               
                                                                  k
                                                                  NAP
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            MT
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   NAP
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          k
                                          O
                                       
                                    
                                 
                              .

From Lemma 1, 
                           
                              
                                 
                                    
                                       N
                                       OAP
                                    
                                    
                                       N
                                       MT
                                    
                                    
                                       N
                                       NAP
                                    
                                    
                                       yP
                                    
                                    
                                       
                                          
                                             
                                                p
                                                NAP
                                             
                                             
                                                k
                                                NAP
                                             
                                          
                                       
                                       
                                          k
                                          MT
                                       
                                    
                                 
                              
                              
                                 k
                                 NAP
                                 
                                    −
                                    1
                                 
                              
                           
                         originates on a regular strand in G and from Lemma 3, this strand is s
                        ∈Resp[N,N′,N″,p,p′,k
                        
                           S
                        ] and C
                        −
                        height(s)≥2.
                           Theorem 3
                           
                              MT's authentication
                           


                           
                              Suppose C is a bundle in Σ, N
                              
                                 MT
                              ,
                              p
                              
                                 MT
                               
                              is uniquely originating in C and k
                              
                                 X
                              
                              −1
                              ∈
                              K
                              −
                              K
                              
                                 P
                              
                              . If r
                              ∈Resp[N,N′,N″,p,p′,k
                              
                                 S
                              ] has C
                              −
                              height(r)≥1, then there are regular strand s
                              ∈
                              Init[N,N′,N″,p,p′,k
                              
                                 S
                              ] and C
                              −
                              height(s)≥2.
                           

The trace of r is as follows:
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                         =
                                                         
                                                            
                                                               −
                                                               
                                                                  M
                                                                  3
                                                               
                                                               ,
                                                               +
                                                               
                                                                  M
                                                                  4
                                                               
                                                               ,
                                                               −
                                                               
                                                                  M
                                                                  6
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         =
                                                         <
                                                         −
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            xP
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                                  MT
                                                               
                                                            
                                                            
                                                               k
                                                               O
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     xP
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           MT
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        O
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               MT
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                     MT
                                                                  
                                                                  
                                                                     H
                                                                     MT
                                                                  
                                                                  
                                                                     k
                                                                     MT
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               NAP
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     xP
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           MT
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        O
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              N
                                                                              OAP
                                                                           
                                                                           
                                                                              N
                                                                              MT
                                                                           
                                                                           
                                                                              xP
                                                                           
                                                                           
                                                                              
                                                                                 
                                                                                    p
                                                                                    MT
                                                                                 
                                                                              
                                                                              
                                                                                 k
                                                                                 O
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        MT
                                                                        
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                              MT
                                                                           
                                                                           
                                                                              H
                                                                              MT
                                                                           
                                                                           
                                                                              k
                                                                              MT
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        NAP
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               OAP
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         +
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            N
                                                            NAP
                                                         
                                                         
                                                            yP
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                     NAP
                                                                  
                                                                  
                                                                     k
                                                                     NAP
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               MT
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     N
                                                                     NAP
                                                                  
                                                                  
                                                                     yP
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                              NAP
                                                                           
                                                                           
                                                                              k
                                                                              NAP
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        MT
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               NAP
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         −
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     N
                                                                     NAP
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               S
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                and
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         term
                                                         
                                                            
                                                               r
                                                               1
                                                            
                                                         
                                                         =
                                                         
                                                            N
                                                            OAP
                                                         
                                                         
                                                            N
                                                            MT
                                                         
                                                         
                                                            xP
                                                         
                                                         
                                                            
                                                               
                                                                  p
                                                                  MT
                                                               
                                                            
                                                            
                                                               k
                                                               O
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     N
                                                                     OAP
                                                                  
                                                                  
                                                                     N
                                                                     MT
                                                                  
                                                                  
                                                                     xP
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           MT
                                                                        
                                                                     
                                                                     
                                                                        k
                                                                        O
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               MT
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                     MT
                                                                  
                                                                  
                                                                     H
                                                                     MT
                                                                  
                                                                  
                                                                     k
                                                                     MT
                                                                  
                                                               
                                                            
                                                            
                                                               k
                                                               NAP
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                                  N
                                                                  OAP
                                                               
                                                               
                                                                  N
                                                                  MT
                                                               
                                                               
                                                                  xP
                                                               
                                                               
                                                                  
                                                                     
                                                                        p
                                                                        MT
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     O
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           N
                                                                           OAP
                                                                        
                                                                        
                                                                           N
                                                                           MT
                                                                        
                                                                        
                                                                           xP
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 p
                                                                                 MT
                                                                              
                                                                           
                                                                           
                                                                              k
                                                                              O
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     MT
                                                                     
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           p
                                                                           MT
                                                                        
                                                                        
                                                                           H
                                                                           MT
                                                                        
                                                                        
                                                                           k
                                                                           MT
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                     NAP
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            k
                                                            OAP
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           

From Lemma 1, 
                           
                              
                                 
                                    
                                       N
                                       OAP
                                    
                                    
                                       N
                                       MT
                                    
                                    
                                       xP
                                    
                                    
                                       
                                          
                                             p
                                             MT
                                          
                                       
                                       
                                          k
                                          O
                                       
                                    
                                 
                              
                              
                                 k
                                 MT
                                 
                                    −
                                    1
                                 
                              
                           
                         
                        Lemma 3, this strand is s
                        ∈
                        Init[N,N′,N″,p,p′,k
                        
                           S
                        ] and C
                        −
                        height(s)≥2.

Based on the description of our protocol as well as the analysis that we performed in the previous section, we can generally claim the following security properties for our protocol:
                           
                              1)
                              Only legitimate users operated on trusted terminals can connect to the network. Moreover, a user can only connect to those networks that have a higher security strategy.

The session key k
                                 
                                    new
                                  generated through an ECC key agreement is secure. According to the NP-hard intractability of the ECDLP operation, even with all the key materials, the final session key could not be constructed without the availability of the secret key gene.

The identity of MT is well protected and does not appear in the communication.

Mutual authentication and platform verification exist between MT and NAP.

The secret key genes (x,y) and N can all be randomly generated by TPM, which prevents attacks such as the man-in-middle attacks, replay attacks, impersonation attacks, etc.

Perfect forward secrecy (PFS) and known key security (KKS) can be guaranteed by the randomly chosen secret key genes (x,y) in each session.

There is no key compromise impersonation (Non-KCI). If A's private key is compromised, an attacker can only disguise as A rather than as any other participant, which can be guaranteed by the mutual authentication of all participants.

We have performed some experiment using simulation system OPNET 10.5A under Windows XP to compare our proposed protocol, which is labeled as NEW, to EMSA described in Section 2.

The simulation scenario is set as follows:
                           
                              1)
                              The network covers an area of 300m×300m.

Network delay is set at 1ms.

Packet loss ratio is set at 10% in the network according to an average level.

In the experiment, we carried out 32 rounds of simulations in total, starting with one terminal node requesting for handoff service and adding one additional terminal node in the subsequent round. Thus, at the last round of the simulation, 32 terminal nodes participate in requesting for the handoff service. During the simulation, all participating terminal nodes randomly start in 0.5s. The total length of time for the simulation is 20s and three retries are allowed should authentication fail. In our simulation scenario, one modular multiplication takes about 3ms through the experiment.

We first compare the success ratio of authentication, which is defined as the number of MTs getting the handoff successfully divided by the total number of MTs requesting for handoff. The results are shown in Fig. 6
                         from which we can see that the success rate in our protocol (labeled as NEW) is better than that in EMSA since the number of interactions in our protocol is much less than that in EMSA, resulting in less radio conflict and hence higher success ratio.

We then compare the average delay of authentication for all the MTs to get the handoff service, which is defined as the total amount of latency for completing handoff divided by the number of MTs that get handoff service successfully. The results are shown in Fig. 7
                         from which we can see that average delay in our protocol is much less than that in EMSA. Although the delay for calculation in our protocol is longer, the communication delay is much less, which results in lower average delay.

@&#CONCLUSION@&#

In this paper, we proposed a trusted handoff protocol based on several technologies such as the hierarchical network model, ECC, trust evaluation and gray relevance analysis. Our analysis and performance evaluation show that mobile terminal nodes can complete access authentication for handoff not only with a higher success rate and a shorter delay than a comparable scheme EMSA but also with the security protection of mobile nodes and the handoff network. The proposed protocol dictates that the mobile platform's configuration is measured first before access to the handoff network can proceed and only those terminal nodes whose configuration meets the security requirements of the network can be allowed to access the network. We proved the security properties and evaluated the performance of the proposed protocol through formal analysis and experiment, respectively. The ultimate goal in the design of our protocol is to ensure that only a legitimate user operated on a trusted platform can get handed off to a new network in a secure manner. In the future, we will perform more analysis and optimization on the protocol to further improve the performance of our protocol in the aspects of delay, power consumption and computation overhead.

@&#ACKNOWLEDGMENT@&#

This work in this paper has been supported by Core Electronic Devices, High-end General Purpose and Basic Software Products in China (No. 2010ZX01037-001-001), National Soft Science Research Program (No. 2010GXQ5D317) and National Natural Science Foundation of China (No. 61272500).

@&#REFERENCES@&#

