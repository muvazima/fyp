@&#MAIN-TITLE@&#Removal of EOG artefacts by combining wavelet neural network and independent component analysis

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A combination of ICA and WNN is introduced to eliminate EOG artefacts.


                        
                        
                           
                           This method corrects only EOG artefacts within a contaminated component.


                        
                        
                           
                           Minimal low frequency and underlying cerebral activity is lost.


                        
                        
                           
                           EEG quality is increased.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

@&#ABSTRACT@&#


               
               
                  Eye activity has larger electrical potential than the average electroencephalogram (EEG) recording, thus making it one of the major sources of artefacts. Ocular artefacts (OA) must be removed as completely as possible with little or no loss of EEG to obtain a higher quality EEG. Using independent component analysis (ICA), the EEG is separated into independent components (IC) and the contaminated component is removed, thus removing the OA. However, ICA does not separate the sources completely and some of the meaningful EEG is lost. In this paper, a new method combining ICA and wavelet neural networking (WNN) is proposed. In this method, WNN is applied to the contaminated ICs, correcting the OA and thus lowering the data lost. The method was evaluated using simulated and real datasets and the results show that the OA are successfully removed with very little data loss.
               
            

@&#INTRODUCTION@&#

There exist many signal sources known as artefacts that lower the quality of electroencephalography (EEG). Among all the artefacts, ocular artefacts (OA) are the most dominant. OA exist through eye movements and blinks which generates a signal greater in magnitude than EEG signals, allowing it to travel throughout the scalp, masking and distorting EEG signals [1–4]. In order to obtain higher quality EEG signals, these artefacts must be removed without distorting or removing any of the underlying EEG data. There are numerous methods to restrict OA. One of the simpler methods is restricting the eye movements and blinking of the subject by fixating on a stable point. However, during experiments it is difficult for the subject to perform this task especially for infants or persons with certain disabilities. Also, the effort of performing the task can have a significant impact on the acquired EEG data [5]. Another method is to recognize and remove contaminated trials from the study. Contaminated trials are recognized by detecting spike like signals with magnitudes greater than the EEG signal. The removal of these contaminated trials will however lead to loss of EEG data.

Many complex methods for detecting and removing artefacts have been proposed. One such method, known as independent component analysis (ICA), makes use of blind source separation [4,6] to determine the original sources (or an estimate of the sources) of a set of signals where each signal is assumed to be a linear mixture of the sources. There exist different assumptions, such as non-Gaussian (NG), non-stationary (NS), spectral density (SD), and hybrid for the static model of the sources [7]. For this article an assumption was made that the signals are NG (sources are independent processes) and from [7,8] it was determined that INFOMAX, NG ICA tool, produces the best results assisting with OA removal and source separation thus it will be used throughout this article.

ICA has become a popular method in removing artefacts from EEG data. This is accomplished through removal of the component (source) containing the artefact and remixing remaining sources. The disadvantage of ICA is that the components do not necessarily only contain artefact data, but also contains underlying EEG data [2]. Removing the contaminated component will thus lead to loss of EEG data. Addressing this issue, Wang et al. [4] combined ICA and a system identification technique to correct the contaminated component. The system identification technique, auto-regressive exogenous (ARX) uses a short period of clean EEG before the contamination as reference EEG for correction.

Another method known as wavelet thresholding, based on wavelet transform, uses wavelets or wavelet packets to decompose a signal into sets of coefficients which represents the original signal in time and frequency domains. In the low-frequency sub-bands, large coefficients are produced if an OA is present in the original signal. These large coefficients are then decreased by a linear or nonlinear threshold to remove the OA [9]. The decomposition of the signal into detailed coefficients is a great advantage because it can isolate all types of waveform structure in time and space. Using this property, methods have been developed to automatically detect and label OAs [1,3,10].

Neural networks (modelled after biological nervous system) are computational models that consist of an input layer, hidden layers and an output layer. The hidden layers consist of processing elements called neurons that are interconnected. These elements can be trained for specific functions such as signal correction or classification by changing the weights of the elements to obtain a specific input–output relationship. Neural network have been trained to detect and remove OA that are present in EEG [11,12]. Nguyen et al. [9] developed a wavelet neural network (WNN) algorithm, combining the powerful estimation characteristics of neural networks and the time–frequency properties of wavelet transforms. Experimental results on real and simulated EEG datasets proved promising.

In this paper, an ocular artefact removal method is introduced that combines ICA and WNN. EEG data is decomposed into ICs and wavelet transform is used to detect contaminated ICs. Wavelet coefficients are generated from the detected OA and the lowest frequency band outlier coefficients are corrected by a trained neural network. Patterns related only to OA will be rejected and the underlying EEG data will be unaltered.

In this paper the simulated data was used to test the performance of the ICA-WNN correction whereas the EEG dataset was used to validate it.

The EEG signal generator model utilized in [13] was originally designed for research on the effects caused by drugs such as anaesthetics on humans and focuses on 3 areas. Firstly the EEG simulation assists with understanding the brain and how it functions. Secondly EEG simulation provides a means for which algorithms and equipment can be tested. Lastly EEG simulation can be used for educational or training purposes [13]. The EEG simulation model was used to simulate artefact free EEG data.

In order to contaminate the simulated EEG data, OA had to be recorded. Contaminated EEG data was recorded for 5760-points (45s) by a 14 channel Emotiv epoc (Emotiv, San Francisco, USA) system at a sampling rate of 128Hz. Markers were placed at each instant an OA occurred. Considering that OA are situated in the lower frequency band, the recorded data was refined by applying a band-pass filter (FIR, 0-4Hz) and then broken into ICs using infomax, a blind source separation method [8]. OA at each marker was extracted from the ICs that were identified for containing OA.

Contaminated simulated EEG were generated by randomly mixing the extracted OA from ICs with the artefact free simulated EEG. Using the clean and contaminated simulated EEG the WNN were trained and its performance was quantitatively evaluated.

The ICA-WNN method was validated using data recorded in a motor imagery test [14]. The EEG data was recorded from 7 healthy subjects that took part in 11 different experiments. The data was collected using 128 channels sampled at 1000Hz and band-passed filtered between 0.05 and 200Hz. Subjects were seated in a comfortable chair with arms relaxed on the armrest. During the experiment, for 3s, 2, 3 or 6 letters appeared on a computer screen indicating to the subject what action they should imagine i.e., imagining a left hand movement action or an auditory sensation. Two types of visual stimulations were used to indicate the required action. Firstly the letters were indicated at a stable, fixed point, minimizing OA. Secondly the letters were indicated at random points on the screen inducing OA. Due to the lack of OA, datasets that were recorded using the first stimulus method were not used in validating the WNN.

@&#METHODS@&#

The goal of ICA is to determine the independent source signals from a mixture of signals that have been mixed linearly by a full ranked mixing matrix [4,15–17]:


                           
                              
                                 (1)
                                 
                                    
                                       
                                          x
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          As
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           where s(t) represents the source signals, x(t) represents the mixture of source signals and A is the full ranked mixing matrix. To determine the source signals or the full ranked mixing signals information is required of either one to determine the other, as seen in equation Eq. (1), but this information is unknown. To overcome this obstacle, ICA uses blind source separation to determine the unmixing matrix W, which in turn decomposes the mixed signals into temporally independent components, as seen in Eq. (2).


                           
                              
                                 (2)
                                 
                                    
                                       
                                          s
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          Wx
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        

As mentioned in Section 1, INFOMAX is based on the assumption that all sources are NG but further assumptions are made such as the neural electrical recordings are stationary, the sources are independent, and the number of sources match the number of recording channels [17]. Using INFOMAX, the independent components are determined from the recorded data and the components containing the artefacts are removed (zeroed). Using the mixing matrix (A) and the corrected components (s) the recorded data is recreated free of any artefacts using (1). However this is not the true EEG data. As mentioned previously, the independent sources are not the true sources but are still a mixture of sources. Thus completely removing components will lead to a loss in underlying EEG data.

Wavelet transform is the decomposition of a signal using wavelets, which consists of functions known as mother wavelets, into a set of coefficients which represents the signal in time and frequency domains. These coefficients are determined by expanding, contracting and shifting the mother wavelet over the desired signal and creating basic functions. During the decomposition of the signal the coefficients are generated in sets, high and low frequency. For example, if a 0–30Hz signal is decomposed into 3 levels there will be coefficients representing 0–10Hz, 10–20Hz and 20–30Hz.

Using wavelet transform, Krishnaveni et al. [3] detects OA by decomposing EEG using the Haar wavelet (up to level 6) and reconstructing the approximate coefficients at level 6 which results in step functions. This paper uses the same method up to and including the reconstruction. As seen in Fig. 1
                           , after the coefficients are reconstructed, the pattern of rising and then falling edges are labelled as possible artefacts and the time range of the occurrence is noted. The maximum value of the original EEG signal within the time range is compared against a threshold. If the maximum value is greater than the threshold, the OA is centred in a 1s window and labelled as an OA. The threshold was determined from the recorded data in Section 2.1.1 by


                           
                              
                                 (3)
                                 
                                    TH
                                    =
                                    
                                       1
                                       3
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      1
                                                      m
                                                   
                                                   
                                                      OA
                                                      MAX
                                                   
                                                
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           where OA
                           
                              MAX
                            represents the maximum amplitude of the blink, m represents the maximum number of blinks in the contaminated IC, and TH is the threshold value. The average maximum OA value was reduced by a third due to some outlier OAs that were present. During testing it was observed that the current threshold did not produce accurate results thus the threshold had to be determined for each dataset using Eq. (3).

Nguyen et al. [9] introduced a new method to correct OA in online EEG data with very little time delay and processing power needed. By combining the advantages of both neural networks and wavelet transforms they introduced the WNN. In order to train the WNN, artefact free simulated EEG signals were generated and contaminated signals were produced by adding real filter-extracted artefacts to the simulated EEG signals. Both signals were then decomposed up to level 8 using coif3 mother wavelet. The low-frequency sets were then interpolated, to ensure same vector length, and combined as a training dataset. Using a weight optimization backpropagation algorithm and the training dataset, the WNN was trained to correct OA.

Using the trained WNN they decomposed the signals using a coif3 mother wavelet and depending on the dataset, the level of decomposition was determined through experimentation due to the unknown number of OA that will be present. After decomposing the signal into its coefficients, the neural network corrects these outlier coefficients in the low frequency band thus removing the OA. The WNN does not only remove the OA but also over corrects the low frequency band, thus low frequency EEG data is lost.

In this paper, artefact free and contaminated signals were generated using the same methods as described in [9]. OAs and their artefact free counterparts were extracted in 1s windows (Section 2.2.2). Both were decomposed up to level 8 using a coif3 mother wavelet and the lowest frequency band was interpolated to generate more training data. The interpolated data of both signals are combined as the training dataset for each OA. Because only one OA is present in the window, it is forced into the lowest frequency band thus a 1-6-1 (1 input unit, 6 hidden layer, and 1 output unit) is used. Using a backpropagation algorithm the WNN was trained with each OA training dataset until desired performance was accomplished. OAs has small differences from subject to subject such as duration and amplitude but the shape of the OA stays constant, a large spike like activity. This allows the WNN to be trained with only one dataset with numerous OAs thus determining the average values of the coefficients and decreasing the preparation time.

It is apparent that using ICA or WNN for artefact correction, underlying EEG or low frequency cerebral data may be lost. In order to reduce the data loss of each method, they are combined in an artefact removal procedure. As seen in Fig. 2
                           , the contaminated EEG data is decomposed into ICs using ICA. Using visual inspection the contaminated IC is determined and the method in Section 2.2.2 is used to mark the OAs and extracts a 1s window with the OA in the centre. All the extracted windows containing OAs are then corrected one at a time by the WNN. The marked OAs in the contaminated IC are then replaced with the 1s window of corrected data. Finally all the ICs are recombined to create an OA free EEG.

In order to determine whether the method is successful at removing OA from EEG, the performance is assessed using power spectral density (PSD), root mean square error (RMSE), and frequency correlation.

PSD is used to evaluate the frequency content of a signal. In this paper, PSD of the EEG signals are computed using a nonparametric method known as the Welch method. The method is based on averaging a periodogram spectrum data over overlapping data segments.

Jung [18] states that the correlation in the time domain before and after filtering is equivalent to the correlation in the frequency domain before and after artefact removal. Frequency correlation between 
                              
                                 x
                                 ˜
                              
                            and 
                              
                                 y
                                 ˜
                              
                            can be determined by


                           
                              
                                 (4)
                                 
                                    c
                                    =
                                    0.5
                                    *
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   w
                                                   1
                                                
                                             
                                             
                                                
                                                   w
                                                   2
                                                
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   x
                                                   ˜
                                                
                                             
                                             *
                                          
                                          
                                             
                                                y
                                                ˜
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   y
                                                   ˜
                                                
                                             
                                             *
                                          
                                          
                                             
                                                x
                                                ˜
                                             
                                          
                                          )
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      
                                                         w
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                         ˜
                                                      
                                                   
                                                   *
                                                
                                                *
                                                
                                                   ∑
                                                   
                                                      
                                                         w
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                      ˜
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                         ˜
                                                      
                                                   
                                                   *
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    x
                                    ˜
                                 
                                 *
                              
                            and 
                              
                                 
                                    y
                                    ˜
                                 
                                 *
                              
                            are the conjugate complex of 
                              
                                 x
                                 ˜
                              
                            and 
                              
                                 y
                                 ˜
                              
                              ,
                              
                                 w
                                 1
                              
                            and 
                              
                                 w
                                 2
                              
                            are the lower and upper limits of the interested spectrum region and c is the correlation value. The value of c will be between 0 and 1 if 
                              
                                 x
                                 ˜
                              
                            and 
                              
                                 y
                                 ˜
                              
                            are not identical but if they are c will obtain a 1. For computational efficiency the window size (
                              
                                 w
                                 2
                              
                              −
                              
                                 w
                                 1
                              
                           ) was chosen as 2.

RMSE represents the difference between two signals. The smaller the difference is between two signals the smaller the RMSE value becomes. The RMSE will be used to determine the accuracy of the ICA-WNN method and is defined as


                           
                              
                                 (5)
                                 
                                    RMSE
                                    =
                                    
                                       
                                          
                                             1
                                             
                                                
                                                   N
                                                   v
                                                
                                             
                                          
                                          
                                             ∑
                                             1
                                             
                                                
                                                   N
                                                   v
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   EEG
                                                   AR
                                                
                                                −
                                                
                                                   EEG
                                                   AF
                                                
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           where EEG
                           
                              AR
                            and EEG
                           
                              AF
                            are artefact removed EEG and artefact free EEG and 
                              
                                 N
                                 v
                              
                            is the length of the contaminated EEG signal.

@&#RESULTS@&#

In the section below the results that were obtained during training and testing of only the WNN are presented. Afterwards, in Section 3.2, the ICA-WNN results are shown.

As mentioned, the WNN corrects OA in IC by correcting a 1s segment of data containing the OA. Using an EEG signal generator, different 1s (256-points) artefact free segments was generated at a sampling rate of 256Hz. OA were recorded using the Emotiv Epoc system at a sampling rate of 128Hz. Different OAs were extracted, resampled and inserted into each segment of data. Data in Fig. 3
                        (a) were used to train the WNN using a resilient backpropagation algorithm. Fig. 3(b) shows the segment testing data that was chosen from the different segments generated as well as the corrected testing signal. Fig. 4
                         shows the PSD of clean, contaminated and corrected data segments for training and testing and Table 1
                         shows the RMSE values.

After the WNN corrects the 1s data segment, it replaces the contaminated OA segment in the IC. To test the accuracy of the method, a 10s (2560-points) single IC was generated at a sampling rate of 256Hz. OAs that were resampled were inserted into the signal and thus contaminating it. The contaminated and corrected testing signal is shown in Fig. 5
                        . Fig. 6
                         shows the PSD of clean, contaminated and corrected data segments of the testing signal. The frequency correlation among the simulated data for testing is shown in Fig. 7
                         and the difference between the clean and corrected signals are shown in Table 1 as an RMSE value.

The motor imagery test collected data using 128 channels at a sampling rate of 1000Hz. Two data sets (subjects 1 and 4) were chosen to evaluate the system due to its abundance of OA present. These two data sets were then divided into 30s (30,000-point) data segments to improve computational efficiency. Channel AFp1 from subject 1s data was rejected due to it having a bad connection.

ICA was applied to determine the ICs and afterwards visual inspection, based on waveform and topographic information, was conducted to determine the contaminated IC. It was concluded that IC 1 was contaminated with OA for both subjects. Fig. 8
                            shows the contaminated IC1 and its correction for both subjects. The PSD of the contaminated and corrected IC for both subjects is shown in Fig. 9
                            and their frequency correlation in Fig. 10
                           .

Electrodes located in the prefrontal lobe are the most effected by OA due to its location so close to the eyes. Taking this into account, channel Fp1 is chosen to monitor the effects ICA correction has on the EEG data. Fig. 11
                            shows a channel Fp1 contaminated and corrected signal for both subjects. The PSD of the contaminated and corrected channel for both subjects is shown in Fig. 12
                            and their frequency correlation in Fig. 13
                           .

@&#DISCUSSION@&#

The present paper introduced a method in OA removal by combining ICA and WNN. The aim of the method is to correct OA that are present in IC, thus eliminating OA from the EEG data with very little data loss of underlying cerebral activity.

Simulated signals are used to evaluate the method on a quantitative level because it is unknown what the true artefact free EEG is when dealing with contaminated datasets. Fig. 3 shows that the WNN successfully corrects the OA segment. However, sometimes the low frequency range can be overcorrected, as seen in Fig. 4. The cause of this phenomenon originates from the extraction of the OA from the IC. The OA extracted still contained some low frequency data after filtering. The same observation was made by Nguyen et al. [9] thus to minimize the overcorrection effect, small segments of data containing the OA are corrected using the WNN.


                     Fig. 5 shows that only the OA and small extra segments of data is changed thus preserving most of the original signal. Figs. 6 and 7 show that the overcorrection of the low frequency band has decreased a substantial amount when comparing it to Fig. 4. Nguyen et al. [9] applied both wavelet thresholding technique and the WNN to a 5s signal containing 3OAs. The wavelet threshold technique dramatically reduced the low frequency band (almost 30dB drop) from the clean simulated signal. The WNN, applied to the entire signal, slightly overcorrected the signal (almost 10dB drop). From Fig. 6 it is clear that the WNN applied to small segments of data improves the overall performance having almost the exact PSD as that of the clean simulated signal thus preserving the signal in all frequencies.

Nguyen et al. [9] reported that the RMSE during training and testing of the WNN were determined to be 11.2389 and 12.2473. As seen in Table 1 for training and testing of both 1s and 10s data segments RMSE were decreased. The 10s signal, where only segments were corrected, has the lowest RMSE which shows that this method increases the accuracy of the WNN. An issue that occurs and can change the results presented is the mother wavelet used to decompose the signal. If correct mother wavelet not chosen it can decrease the accuracy of the system when applied to EEG data.

After the simulation study the ICA-WNN method was tested on data consisting of 7 healthy subjects. Similar to the simulation results, the results show that all OA are correct in the IC (Fig. 8). Figs. 9 and 10 reinforce the results obtained for the simulation data. It is clear that applying WNN to small segments of data that contains an OA preserves the low frequency cerebral activity and preserves all other frequencies, thus reducing the amount of data loss.

After reconstruction of the corrected IC it is shown in Fig. 11 that the OA have been removed from the EEG. Figs. 12 and 13 indicate that the OA have been removed from the EEG data while preserving the low frequency cerebral activity as well as underlying activity present in the contaminated IC. The ICA-WNN method is an improvement because only applying ICA [9] changes the signals PSD over the entire frequency spectrum whereas applying only WNN overcorrects the low frequency band. Note that in the range of 0–1Hz there still exist a peak. This peak is due to the large low frequency activity present in Fig. 11. Thus, the ICA-WNN method successfully removes OA from EEG data with minimal data loss due to minimizing the overcorrection of low frequency data as well as correcting IC instead of completely removing the IC.

The WNN overcorrection of low frequency data allows it to correct eye movements without the need to train it. This is only true when the entire signal is corrected with the WNN. In the future, OA detection algorithms must be refined to detect not only eye blinks but eye movement artefacts as well. WNN must then be trained for both eye blinks and eye movement artefacts.

@&#CONCLUSIONS@&#

An IC correction method using a WNN was proposed in order to remove OA. A combination of ICA, neural network and wavelet transform was used to detect and remove OA. The results from the simulation and motor imagery data set show that the OA can be successfully removed with minimal data loss.

@&#ACKNOWLEDGEMENTS@&#

This project was funded by NRF. The authors would like to thank Dornhege et al [14] for making their EEG data publicly available.

@&#REFERENCES@&#

