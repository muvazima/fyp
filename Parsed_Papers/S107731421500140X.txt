@&#MAIN-TITLE@&#People re-identification across non-overlapping cameras using group features

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           People is grouped based on the spatio-temporal features of their trajectories.


                        
                        
                           
                           From people groups, new group features for people re-identification are extracted.


                        
                        
                           
                           The group features can be employed with any kind of existing appearance features.


                        
                        
                           
                           Experiments demonstrated that the group features improve people re-identification.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

People re-identification

Non-overlapping cameras

People grouping

@&#ABSTRACT@&#


               
               
                  This paper proposes methods for people re-identification across non-overlapping cameras. We improve the robustness of re-identification by using additional group features acquired from the groups of people detected by each camera. People are grouped by discriminatively classifying the spatio-temporal features of their trajectories into those of grouped people and non-grouped people. Thereafter, three group features are obtained in each group and utilized with other general features of each person (e.g., color histogram, transit time between cameras, etc.) for people re-identification. Our experimental results have demonstrated improvements in people grouping and people re-identification when our proposed methods have been applied to a public dataset.
               
            

@&#INTRODUCTION@&#

Tracking via non-overlapping distributed cameras is crucial for efficient monitoring of people activities over a wide area. Such tracking can be achieved using re-identification methods across multiple cameras following visual tracking in each field of view.

In general, people re-identification in a surveillance scenario should be performed not by recognition using high-level image features, such as face recognition, but by low-level feature matching. This is because image regions of people captured by general surveillance cameras are typically too small for high-level recognition techniques to be applicable.

To improve people re-identification, we propose new features extracted from the group of people detected. The group of people (i.e., each rectangle shown in Fig. 1) is regarded as a set of people who are cohered based on the similarity of their relative positions and trajectories. Under the assumption that people in the same group are, in general, observed together even in different cameras,
                        1
                     
                     
                        1
                        This assumption is reasonable, for example, in indoor scenes where routes among cameras are limited (e.g. corridors in a building) and nearby cameras between which most pedestrians walk along similar trajectories.
                      the new features of each group are employed for people re-identification. To improve the accuracy of re-identification, our proposed method combines the proposed group features with traditional image cues that represent the appearance of each person.

The main contributions of this paper are summarized below.

                        
                           •
                           People grouping using spatio-temporal features of their trajectories: Our proposed spatio-temporal features and classification scheme achieve people grouping such that (i) the co-occurrence of different features are expressed and (ii) noisy and ambiguous features are removed.

People re-identification using group features: The group features are represented by the trajectories of people in each group and the number of these people, as well as the image cues of people in the group.

@&#RELATED WORK@&#

For people grouping, their trajectories are used in the proposed method. These trajectories can be acquired by visually tracking people in a video. While people tracking in a dense crowd[2,3] has been increasingly important in computer vision, this paper focuses on scenes with a relatively-sparse number of people for detecting groups only from trajectory-based features.
                     
                  

For grouping people, the proposed feature is represented by spatio-temporal relationships between the trajectories of two pedestrians. The effectiveness of spatial relationships for grouping people has also been explored in still images [4,5]. Two key differences between using still images and videos are (1) temporal cues are available in videos but not in still images and (2) rich appearance features (e.g. age and gender estimation from a face) are available in still images, whereas it is difficult to extract such features from videos, because people are usually imaged smaller in videos.

As a model for representing interactions between people trajectories, the social force model [6], which adjusts a repulsive force between people depending on their social relationship, has been widely used. This model is employed in several machine vision problems such as abnormal behavior detection [7] as well as people grouping [1,8].

In addition to models, a classification scheme is also crucial for people grouping. Bottom-up hierarchical clustering, iterative clustering using priors of collective behaviors of a group, and conditional random fields (CRFs) have been employed in [9], [14] and, [10], respectively. The classification scheme can also be formulated as a nonlinear optimization problem for finding the optimal trajectories of groups [11,12]. These approaches are superior in terms of accuracy in group detection as compared with those using simple criteria (e.g. only proximity [13]).

For precise grouping in complex situations, the above-mentioned CRF-based method [10] optimizes its parameters by employing the annotation of people groups (i.e. a group to which each person belongs) in training data. These annotations reveal subtle differences of trajectories between people within and outside a group. With the annotation data, discriminative classification is also possible to improve the accuracy of people grouping [15].

For people re-identification, a number of image features have been proposed, for example, using a set of feature points [18] and histogram of oriented gradients (HOG) [20] based features [19]. Among all such approaches, features using a color histogram are robust against the change in viewpoint of a camera (e.g., a color histogram extracted from an HSV color space [21]).

In addition to the change in viewpoint, variations of illumination among cameras also make re-identification difficult. To cope with this problem, several learning techniques and metrics have been studied, including Adaboost [24], RankSVM [25], multi instance learning boosting[26], and distance learning[27]. While these techniques can improve re-identification across non-overlapping cameras, re-identification with poor appearance features in surveillance videos remains a difficult problem.

Unlike existing image features representing the appearance of people, our focus in this paper is on the features of a group of people. Appearance features of people in a group have been proposed in [33,34]; these features are extracted not only from a person of interest but also from people who are in the group with that person. Such features are based only on image features and have also been employed for visual tracking (e.g., in [35]). In addition to those image cues, our proposed features also consist of other properties of people in each group (i.e. the trajectories and the number of people in each group).

@&#OVERVIEW@&#


                     Fig. 2 illustrates the key processes of the proposed method. The entire process consists of two sub-processes, the process performed in each camera and the one that incorporates multiple cameras (these two sub-processes are enclosed by purple rectangles in the figure).

In an image obtained from each camera, several features of each pedestrian used for people re-identification are extracted. To obtain each pedestrian’s region and trajectory, the pedestrian is visually detected and tracked.

While the algorithm of group detection has been proposed in [36], new experiments with image sequences are conducted for demonstrating its applicability to a surveillance camera scenario and the proposed people re-identification method.

For people re-identification across multiple cameras, conventional features extracted from the region of each pedestrian are also used, including color histograms (see Section 5.1.1) and transit times between cameras (see Section 5.1.2). In addition to these two conventional features, new group features are employed in the proposed method; these new features are color features of in-group people (see Section 5.2.1), count features of in-group people (see Section 5.2.2), and spatio-temporal trajectory features (see Section 5.2.3). To obtain these new group features, group detection is achieved by employing the trajectories of pedestrians in each group as described in Section 4 below.

In the proposed method, we determine for each pair of pedestrians whether or not they are together in a group. The trajectories of the pair are represented by their spatio-temporal relationships, detailed as follows. Let i and j be the pedestrian IDs, and let 
                           p
                        
                        
                           i
                         and 
                           v
                        
                        
                           i
                         denote the position and velocity, respectively, of the ith pedestrian. The following five features (i.e. F
                        1, F
                        2, F
                        3, F
                        4, and F
                        5) are used in [15] as basic features between i and j at each moment, as illustrated in Fig. 3
                        :

                           
                              •
                              
                                 F
                                 1: Distance between 
                                    p
                                 
                                 
                                    i
                                  and 
                                    p
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                       
                                       
                                          p
                                          i
                                       
                                       −
                                       
                                          p
                                          j
                                       
                                       
                                          |
                                       
                                    
                                 .


                                 F
                                 2: Absolute difference in speeds of 
                                    v
                                 
                                 
                                    i
                                  and 
                                    v
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                          |
                                       
                                       
                                          v
                                          i
                                       
                                       
                                          |
                                          −
                                          |
                                       
                                       
                                          v
                                          j
                                       
                                       
                                          |
                                          |
                                       
                                    
                                 .


                                 F
                                 3: Absolute difference in directions of 
                                    v
                                 
                                 
                                    i
                                  and 
                                    v
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                          arctan
                                       
                                       
                                          (
                                          
                                             v
                                             i
                                          
                                          )
                                       
                                       −
                                       arctan
                                       
                                          (
                                          
                                             v
                                             j
                                          
                                          )
                                       
                                       
                                          |
                                       
                                    
                                 .


                                 F
                                 4: Absolute difference in direction of 
                                    v
                                 
                                 
                                    i
                                  and relative position between 
                                    p
                                 
                                 
                                    i
                                  and 
                                    p
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                          arctan
                                       
                                       
                                          (
                                          
                                             p
                                             i
                                          
                                          −
                                          
                                             p
                                             j
                                          
                                          )
                                       
                                       −
                                       arctan
                                       
                                          (
                                          
                                             v
                                             i
                                          
                                          )
                                       
                                       
                                          |
                                       
                                    
                                 .


                                 F
                                 5: Time-overlap ratio: |
                                    T
                                 
                                 
                                    i
                                  ∩ 
                                    T
                                 
                                 
                                    j
                                 |/|
                                    T
                                 
                                 
                                    i
                                  ∪ 
                                    T
                                 
                                 
                                    j
                                 |, where 
                                    T
                                 
                                 
                                    i
                                  is a set of time steps in which pedestrian i is observed by a sensor(s).

While F
                        1, F
                        2, F
                        3, and F
                        4 are obtained at each frame, their frame IDs are abbreviated for simplicity. In [15], F
                        5 and the normalized histograms of F
                        1, F
                        2, F
                        3, and F
                        4 are concatenated to obtain feature vector 
                           f
                        . The dimension of this feature is 
                           
                              4
                              
                                 d
                                 h
                              
                              +
                              1
                              ,
                           
                         where dh
                         is the dimension of each histogram.

Although useful, the basic features described above have several problems, including the ones described below:

                           
                              1.
                              Missing cooccurrence due to histogramming: Since F
                                 1, F
                                 2, F
                                 3, and F
                                 4 are each expressed independently by a histogram, co-occurrence among the different features at each moment is not represented.

Non-robustness of overlap between 
                                    T
                                 
                                 
                                    i
                                  and 
                                    T
                                 
                                 
                                    j
                                 : When the trajectory of pedestrian i is intermittent because of occlusion or other reasons, 
                                    T
                                 
                                 
                                    i
                                  is changed. This causes a change in the overlap between 
                                    T
                                 
                                 
                                    i
                                  and 
                                    T
                                 
                                 
                                    j
                                  followed by the change in F
                                 5.

Distant pedestrians in a large group in F
                                 1: Although pedestrians in the same group are expected to be closer to one another, some of F
                                 1 features extracted from a large group might be larger because members in such a group are separated by a distance. This makes the distributions of group and non-group features overlap. In the example illustrated in Fig. 4
                                 , 
                                    
                                       
                                          |
                                       
                                       
                                          p
                                          1
                                       
                                       −
                                       
                                          p
                                          3
                                       
                                       
                                          |
                                       
                                    
                                  is larger and might be closer to a typical distance between pedestrians who are not in the same group.

To solve the problems described in Section 4.1, the five features F
                        1, F
                        2, F
                        3, F
                        4, and F
                        5 are extended to G
                        1, G
                        2, G
                        3, G
                        4, and G
                        5 as follows:

                           
                              1.
                              Featurization in each frame: A feature vector (denoted by 
                                    g
                                 
                                 
                                    t
                                 ) is extracted in each tth frame so that G
                                 1, G
                                 2, G
                                 3, G
                                 4, and G
                                 5 are concatenated, as illustrated in Fig. 5
                                 . Here 
                                    g
                                 
                                 
                                    t
                                  represents the dependence relationships among all five features at each moment.

Temporally-local time-overlap ratio: To suppress negative effects due to intermittent trajectories due to occlusions, a time-overlap ratio, G
                                 5, at frame t is computed only between 
                                    
                                       t
                                       −
                                       
                                          T
                                          r
                                       
                                    
                                  and 
                                    
                                       t
                                       +
                                       
                                          T
                                          r
                                       
                                       ,
                                    
                                  where Tr
                                  is a predefined parameter.

Distance between the nearest neighbors: If three or more pedestrians are in a group in the given training data, only the distance to the nearest neighbor pedestrian is extracted as the feature of the pair in the same group. In the example illustrated in Fig. 4, the nearest neighbors of 
                                    p
                                 
                                 1, 
                                    p
                                 
                                 2, and 
                                    p
                                 
                                 3 are 
                                    p
                                 
                                 2, 
                                    p
                                 
                                 1, and 
                                    p
                                 
                                 2, respectively. In the training step
                                    2
                                 
                                 
                                    2
                                    The training step is described in the last paragraph of Section 4.3.
                                 , the spatio-temporal features of only two pairs “1 and 2” and “2 and 3” are trained as the features of a group. Note that even if “1 and 3” are regarded as being in different groups because 
                                    
                                       
                                          |
                                       
                                       
                                          p
                                          1
                                       
                                       −
                                       
                                          p
                                          3
                                       
                                       
                                          |
                                       
                                    
                                  is larger, they are eventually grouped in the same group if pairs “1 and 2” and “2 and 3” are grouped together.

As with F
                        1, F
                        2, F
                        3, and F
                        4, the frame IDs of G
                        1, G
                        2, G
                        3, G
                        4, and G
                        5 are abbreviated. Their definitions and feature vector 
                           g
                        
                        
                           t
                         are summarized below:

                           
                              •
                              
                                 G
                                 1: Distance between 
                                    p
                                 
                                 
                                    i
                                  and 
                                    p
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                       
                                       
                                          p
                                          i
                                       
                                       −
                                       
                                          p
                                          j
                                       
                                       
                                          |
                                       
                                    
                                 .


                                 G
                                 2: Absolute difference in speeds of 
                                    v
                                 
                                 
                                    i
                                  and 
                                    v
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                          |
                                       
                                       
                                          v
                                          i
                                       
                                       
                                          |
                                          −
                                          |
                                       
                                       
                                          v
                                          j
                                       
                                       
                                          |
                                          |
                                       
                                    
                                 .


                                 G
                                 3: Absolute difference in directions of 
                                    v
                                 
                                 
                                    i
                                  and 
                                    v
                                 
                                 
                                    j
                                 : 
                                    
                                       
                                          |
                                          arctan
                                       
                                       
                                          (
                                          
                                             v
                                             i
                                          
                                          )
                                       
                                       −
                                       arctan
                                       
                                          (
                                          
                                             v
                                             j
                                          
                                          )
                                       
                                       
                                          |
                                       
                                    
                                 .


                                 G
                                 4: Absolute difference in the mean of 
                                    v
                                 
                                 
                                    i
                                  and 
                                    v
                                 
                                 
                                    j
                                  and the relative position between 
                                    p
                                 
                                 
                                    i
                                  and 
                                    p
                                 
                                 
                                    j
                                 : 
                                    
                                       |
                                       arctan
                                       
                                          (
                                          
                                             p
                                             i
                                          
                                          −
                                          
                                             p
                                             i
                                          
                                          )
                                       
                                       −
                                       arctan
                                       
                                          (
                                          
                                             v
                                             ¯
                                          
                                          )
                                       
                                       |
                                    
                                 .


                                 G
                                 5: Time-overlap ratio: 
                                    
                                       
                                          |
                                       
                                       
                                          
                                             T
                                          
                                          i
                                          ′
                                       
                                       ∩
                                       
                                          
                                             T
                                          
                                          j
                                          ′
                                       
                                       
                                          |
                                          /
                                          |
                                       
                                       
                                          
                                             T
                                          
                                          i
                                          ′
                                       
                                       ∪
                                       
                                          
                                             T
                                          
                                          j
                                          ′
                                       
                                       
                                          |
                                          ,
                                       
                                    
                                  where 
                                    
                                       
                                          
                                             T
                                          
                                          i
                                          ′
                                       
                                       =
                                       
                                          [
                                          k
                                          −
                                          
                                             T
                                             r
                                          
                                          ,
                                          …
                                          ,
                                          k
                                          +
                                          
                                             T
                                             r
                                          
                                          ]
                                       
                                    
                                 
                              


                                 
                                    g
                                 
                                 
                                    t
                                  is a 5D vector defined by the concatenation of G
                                 1, G
                                 2, G
                                 3, G
                                 4, and G
                                 5 at tth frame:

                                    
                                       (1)
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                      t
                                                   
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      [
                                                      
                                                         G
                                                         1
                                                      
                                                      ,
                                                      
                                                         G
                                                         2
                                                      
                                                      ,
                                                      
                                                         G
                                                         3
                                                      
                                                      ,
                                                      
                                                         G
                                                         4
                                                      
                                                      ,
                                                      
                                                         G
                                                         5
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

This feature, 
                           g
                        
                        
                           t
                        , is extracted only from frames where both |
                           v
                        
                        
                           i
                        | and |
                           v
                        
                        
                           j
                        | are above threshold Tv
                        . This thresholding allows us to extract the feature robustly to noise in |
                           v
                        
                        
                           i
                        | and |
                           v
                        
                        
                           j
                        | computed from the tracking trajectories of objects. Since the computed velocities, |
                           v
                        
                        
                           i
                        | and |
                           v
                        
                        
                           j
                        |, are noisy and not reliable when the noise level is larger than the walking speed of a person, this thresholding is required for robust feature extraction.

The proposed features defined in Section 4.2 are classified as “group” or “non-group”. One feature vector 
                           g
                        
                        
                           t
                         is extracted in each tth frame. 
                           g
                        
                        
                           t
                         is classified in each frame. Then the set of features of all frames is classified based on the rate of 
                           g
                        
                        
                           t
                         classified as “group”:

                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   N
                                                   p
                                                
                                                
                                                   
                                                      N
                                                      p
                                                   
                                                   +
                                                   
                                                      N
                                                      n
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where Np
                         and Nn
                         denote the number of 
                           g
                        
                        
                           t
                         classified as “group” and “non-group”, respectively. If Tw
                         % or more of frames are classified as “group”, the corresponding pair of pedestrians is regarded as pedestrians in the same group. 
                           
                              
                                 T
                                 w
                              
                              =
                              66
                              ,
                           
                         with the value being selected on the basis of preliminary experiments, was used in all experiments.

Assume that all groups of people are known in given training sequences. In the proposed method, features are discriminatively classified by the SVM [16,17], in which both positive (i.e. group) and negative (i.e. non-group) samples of all training frames are employed for training the classifier.

This section describes people re-identification using group features, which are proposed in Section 5.2, extracted from the results of group detection as well as conventional features introduced in Section 5.1.

As used in previous methods [21–23,26,27], the proposed method also computes the similarity of color histograms extracted from the windows of persons of interest. More specifically, the color histogram is extracted from a rectangle with the size of 25% of the window in order to avoid a negative effect of a background region within the rectangle window. In our experiments, the color histogram was defined as a 24D vector consisting of three 8D vectors that are extracted from R, G, and B channels. Let 
                              C
                           
                           
                              i
                            and 
                              C
                           
                           
                              j
                            denote the color histograms of the ith and jth persons, respectively. The similarity score RC
                           (i, j) is expressed by Bhattacharyya coefficient, which is widely used for non-rigid object tracking [37], between 
                              C
                           
                           
                              i
                            and 
                              C
                           
                           
                              j
                           :

                              
                                 (3)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   C
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         u
                                                         =
                                                         1
                                                      
                                                      24
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                            i
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         
                                                            C
                                                            j
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              C
                           
                           
                              i
                           (u) denotes the uth component of 
                              C
                           
                           
                              i
                           .

As proposed in previous methods [28–31], transit times between cameras, which can be computed from each pedestrian’s entrance and exit in the camera’s fields of view, are useful for people re-identification. As with [31], the transit times in each camera pair are expressed by Gaussian distribution 
                              
                                 
                                    g
                                    T
                                 
                                 
                                    (
                                    t
                                    ;
                                    
                                       m
                                       T
                                    
                                    ,
                                    
                                       σ
                                       T
                                       2
                                    
                                    )
                                 
                              
                           . In the re-identification step, transit time is computed from an exit time at one camera and an entrance time at another camera. Let t
                           out, a, i
                            and t
                           in, b, j
                            denote the time when the ith person exits the FOV of the ath camera and the time when the jth person entered the FOV of the bth camera, respectively. Note that we do not yet know whether or not the ith and jth persons are indeed the same person. By substituting transit time 
                              
                                 
                                    t
                                    
                                       in
                                       ,
                                       b
                                       ,
                                       j
                                    
                                 
                                 −
                                 
                                    t
                                    
                                       out
                                       ,
                                       a
                                       ,
                                       i
                                    
                                 
                              
                            into Gaussian distribution 
                              
                                 
                                    g
                                    T
                                 
                                 
                                    (
                                    t
                                    ;
                                    
                                       m
                                       T
                                    
                                    ,
                                    
                                       σ
                                       T
                                       2
                                    
                                    )
                                 
                                 ,
                              
                            the score of the transit time, RT
                           , is obtained as follows:

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   T
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                =
                                                
                                                   g
                                                   T
                                                
                                                
                                                   (
                                                   
                                                      t
                                                      
                                                         in
                                                         ,
                                                         b
                                                         ,
                                                         j
                                                      
                                                   
                                                   −
                                                   
                                                      t
                                                      
                                                         out
                                                         ,
                                                         a
                                                         ,
                                                         i
                                                      
                                                   
                                                   ;
                                                   
                                                      m
                                                      T
                                                   
                                                   ,
                                                   
                                                      σ
                                                      
                                                         T
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The greater RT
                           (i, j), the higher the similarity between the ith and jth persons.

The proposed method employs the following three features extracted from each group:

                           
                              
                                 Color of all members in a group: As with conventional color features, a color histogram can be extracted from the regions of the members.


                                 The number of people in a group: It is expected that the number of people in each group is not changed when they are observed in different cameras.


                                 Relationship between the trajectories of people in a group:
Independently of fields of view of cameras, the spatio-temporal relationship among people in each group might be uniform; for example, a father is in the center of his children.

Since the latter two features are independent of color, these features might be able to compensate for errors in the color feature. Moreover, the latter two features are undisturbed by any image appearance. This property makes these features robust to a change in viewpoint. Even if the appearance of pedestrians varies between views in terms of orientation and size, these two features are invariant. Therefore, these features are useful for re-identification, if people grouping in each view can be achieved robustly to a change in viewpoint. Since our proposed people grouping is only based on the tracking trajectories of pedestrians, the robustness of the people grouping depends on the performance of visual tracking, which is extensively researched.

Note that, in this work, a person who is alone is regarded as being in a group having only one member. This is because every person must have its group features.

The mean of color histograms of all members in a group is regarded as the color histogram of that group. Let C
                           G, i
                            and C
                           G, j
                            denote the color histograms of two groups to which the ith and jth persons respectively belong. Similarity score RGC
                           (i, j) between these two groups is expressed by the Bhattacharyya coefficient as follows:

                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                      
                                                         G
                                                         C
                                                      
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   =
                                                   
                                                      ∑
                                                      
                                                         u
                                                         =
                                                         1
                                                      
                                                      24
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                            
                                                               G
                                                               ,
                                                               i
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         
                                                            C
                                                            
                                                               G
                                                               ,
                                                               j
                                                            
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The score RGH
                            of the count feature of in-group people is designed so that the score between two persons whose groups are similar in number is higher. Ideally, if the ith and jth persons observed by different cameras are the same person, 
                              
                                 
                                    N
                                    i
                                 
                                 −
                                 
                                    N
                                    j
                                 
                              
                            is 0, where Ni
                            and Nj
                            respectively denote the number of in-group people of i and j. This ideal assumption is often violated because of, for example, unsuccessful group detection and changes in in-group members during inter-camera transitions. These negative effects can be suppressed so that the smaller 
                              
                                 (
                                 
                                    N
                                    i
                                 
                                 −
                                 
                                    N
                                    j
                                 
                                 )
                                 ,
                              
                            the greater the similarity score. Such a property can be expressed by the Gaussian distribution as follows:

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   
                                                      G
                                                      H
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                =
                                                
                                                   g
                                                   
                                                      G
                                                      H
                                                   
                                                
                                                
                                                   (
                                                   
                                                      N
                                                      i
                                                   
                                                   −
                                                   
                                                      N
                                                      j
                                                   
                                                   ;
                                                   0
                                                   ,
                                                   
                                                      σ
                                                      
                                                         G
                                                         H
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Since Gaussian distribution (6) is defined by constant variance 
                              
                                 
                                    σ
                                    
                                       G
                                       H
                                    
                                    2
                                 
                                 ,
                              
                            the probability of successful group detection is considered to be constant independently of the group; however, that probability changes depending on the difficulty in detecting the group of a person of interest. To take into account this difficulty, the variance in score (6) is adjusted on the basis of the discriminativity between the ith person and other people simultaneously observed in a field of view. More specifically, the variance in score (6) is adjusted so that the lower the confidence in the successful classification of i and n, the larger the variance 
                              
                                 σ
                                 
                                    G
                                    H
                                 
                                 2
                              
                            (i.e. the lower the weight of score (6), RGH
                           (i, j)).

How to obtain the confidence of group detection depends on the method used for group detection. The method proposed in Section 4 classifies a pair to an in-group or non-in-group pair by the SVM. The score of the SVM is positive for a pair in the same group and is larger as the confidence of group detection is higher. The score is, on the other hand, a lower negative value, because the confidence that two persons are not in the same group is higher.

Based on the criteria described above, the score (6), RGH
                           (i, j), is modified as follows:

                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   
                                                      G
                                                      H
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   g
                                                   
                                                      G
                                                      H
                                                   
                                                
                                                
                                                   (
                                                   
                                                      N
                                                      i
                                                   
                                                   −
                                                   
                                                      N
                                                      j
                                                   
                                                   ;
                                                   0
                                                   ,
                                                   
                                                      α
                                                      h
                                                   
                                                   
                                                      e
                                                      
                                                         −
                                                         
                                                            β
                                                            h
                                                         
                                                         
                                                            w
                                                            i
                                                         
                                                         
                                                            w
                                                            j
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                w
                                                i
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∏
                                                   
                                                      n
                                                   
                                                   
                                                      M
                                                      i
                                                   
                                                
                                                
                                                   min
                                                   (
                                                   1
                                                   ,
                                                   |
                                                
                                                
                                                   s
                                                   
                                                      i
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   |
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                w
                                                j
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∏
                                                   
                                                      m
                                                   
                                                   
                                                      M
                                                      j
                                                   
                                                
                                                
                                                   min
                                                   (
                                                   1
                                                   ,
                                                   |
                                                
                                                
                                                   s
                                                   
                                                      j
                                                      ,
                                                      m
                                                   
                                                
                                                
                                                   |
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where (1) Mi
                            is the number of people who are observed simultaneously with the ith person in a field of view and (2) s
                           
                              i, n
                            denotes the score of the SVM that decides whether or not the ith and nth persons are in the same group: 0 ≤ min (1, s
                           
                              i, n
                           ) ≤ 1. αh
                            and βh
                            are weight variables. If wi
                            and wj
                            decrease, the score RGH
                            is not changed significantly.

A trajectory feature represents the relationship between the trajectories of nearby persons. Remember that such a feature is defined by a spatio-temporal feature, 
                              g
                           
                           
                              t
                            in (1), used in people grouping. To define a trajectory feature for each person of interest, we have the following difficulties:

                              
                                 •
                                 Since the number of total frames in a sequence, in which each pair is observed simultaneously, varies between pairs, the number of spatio-temporal features are also different between the pairs.

A sequence of spatio-temporal features is obtained for each pair in a group. Since different groups may have different number of in-group people, the number of obtained spatio-temporal features varies between the groups.

In addition, if the number of in-group people is wrong due to the failure of group detection, this failure may give a negative effect on comparison of spatio-temporal features between detected groups.

More essentially, only one person also composes its own group. It is impossible to compute the spatio-temporal features of one person.

The proposed method resolves the above difficulties to acquire the trajectory feature of each person by the following steps:

                              
                                 1.
                                 Instead of relying on group detection proposed in Section 6.1, for each person of interest (denoted by i), a person who has the highest rate (2) for in-group pair detection is found. This person is denoted by in
                                    . Then the spatio-temporal features between i and in
                                     is computed.

A normalized Bag-of-Words (BoW) feature is obtained in a pair of i and in
                                    . To obtain this BoW feature, in training, all spatio-temporal features extracted from training data, including “group” and “non-group” features, are clustered (e.g. by using K-means clustering) and then the mean vector of each cluster is computed. Spatio-temporal features extracted from i and in
                                     are expressed by a histogram (i.e. a BoW feature) whose bins are represented by the mean vectors computed in training.

If only i is observed during 
                                       T
                                    
                                    
                                       i
                                     (i.e., if in
                                     is not observed), i’s BoW feature is determined to be the mean of BoW features between all “non-group” pairs in training data.

The score RGT
                            of the above trajectory features (i.e., BoW features) is defined by the Gaussian distribution of the Bhattacharyya coefficient of the BoW features:

                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                   
                                                      G
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                =
                                                
                                                   g
                                                   
                                                      G
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   d
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   ;
                                                   0
                                                   ,
                                                   
                                                      α
                                                      t
                                                   
                                                   exp
                                                   
                                                      (
                                                      −
                                                      
                                                         β
                                                         t
                                                      
                                                      
                                                         w
                                                         
                                                            i
                                                            ,
                                                            
                                                               i
                                                               n
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            u
                                                            =
                                                            1
                                                         
                                                         
                                                            D
                                                            B
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            B
                                                            i
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         −
                                                         
                                                            B
                                                            j
                                                         
                                                         
                                                            (
                                                            u
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   
                                                      i
                                                      ,
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                
                                                =
                                                min
                                                
                                                   (
                                                   1
                                                   ,
                                                   
                                                      s
                                                      
                                                         i
                                                         ,
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where DB
                            and Bi
                           (u) denote the dimension of a BoW feature and the uth component of the BoW feature of ith person, respectively. αt
                            and βt
                            weight variables.

The score R for people re-identification is designed so that R is higher if all five scores (i.e. RC, RT, RGC, RGH
                        , and RGT
                        ) are greater. R is defined by the product of the five scores as follows:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             R
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             =
                                             
                                                R
                                                C
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                R
                                                T
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                R
                                                
                                                   G
                                                   C
                                                
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                R
                                                
                                                   G
                                                   H
                                                
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             
                                                R
                                                
                                                   G
                                                   T
                                                
                                             
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        R(i, j) is computed for any pair of ith and jth persons observed in different cameras. If the 
                           
                              j
                              ^
                           
                        th person has the highest score with the ith person, i is considered to be identified with 
                           
                              j
                              ^
                           
                        .

@&#EXPERIMENTS@&#

To evaluate the proposed methods, the PRID 2011 dataset [38] was used. This dataset consists of two image sequences captured in nearby locations. Sample frames of two image sequences are shown in Fig. 6
                     . As for annotation data, the 2D trajectory of every pedestrian (i.e. a rectangle enclosing the entire body of a pedestrian and its x and y image coordinates) is given; however, the original annotation data contains (1) trajectories only in such frames that each pedestrian was captured with no occlusion and (2) no group information. The trajectories of all pedestrians were manually completed, and group information (i.e. whether or not each pair of pedestrians are in a group) was also manually provided.

With the revision of the dataset described above, the details of the dataset are as follows:

                        
                           •
                           Camera a
                                 
                                    
                                       Number of frames: 92,825 (approximately 62 min).


                                       Number of pedestrians: 573 including 134 people who belong to groups with two or more people.


                                       Number of in-group pairs: 134.

Camera b

                                 
                                    
                                       Number of frames: 99,997 (approximately 67 min).


                                       Number of pedestrians: 884 including 180 people who belong to groups with two or more people.


                                       Number of in-group pairs: 177.

Relationship between two cameras

                                 
                                    
                                       Transition time: 65 s on average.


                                       Pedestrians observed in both cameras: 342.

For people grouping, the spatio-temporal features of a pair of pedestrians with their group annotations (i.e. whether they are in a group or not) were given as training data to the SVM.

To use the spatio-temporal features for the proposed group detection method, original image coordinates (i.e. x and y) in the dataset are not suitable. This is because the method implicitly assumes that undistorted planar coordinates are used (i.e. that the image plane is parallel to a ground plane), though the image plane of a surveillance camera is generally inclined with respect to the ground plane. To resolve this problem, the image coordinates of pedestrians were rectified by a homography between the image plane and the ground surface.

In addition to the rectification of image coordinates, the scales of image coordinates were normalized between different cameras. This scale normalization was executed so that the mean velocities (in pixels) of pedestrians were the same between cameras. Finally, training data for all cameras can be used to acquire a unified SVM, which can find groups observed in any cameras.

Results of group detection are shown in Table 1; results shown are the mean of 15 trials. For comparison, the previous method [15] was also evaluated. For each trial, all trajectories were divided into training and testing data with no duplicates; 10% of all trajectories were used for training.

The proposed spatio-temporal feature, 
                           g
                        
                        
                           t
                        , requires two parameters, Tr
                         and Tv
                        . To determine these parameters, true-positive and false-positive rates were evaluated among several sets of parameters with training data in each trial. Sample results from one trial are shown in Fig. 7
                        
                        . In each trial, the best set of two parameters were selected so that ((true-positive rate) – (false-positive rate)) was maximized. As enclosed by a circle in Fig. 7, several sets of parameters are close to each other around the best set of parameters. Since the results of people grouping with these parameters sets are similar to each other, the setting of two parameters, Tr
                         and Tv
                        , is not so sensitive.

Experimental results are shown in Table 1. These results show better performance of using the proposed method both in terms of true-positive and false-negative rates.

The more people in a group, the more difficult people grouping becomes. This is because if a group consists of three or more members, all in-group pairs in this group should be detected for complete detection of this group in order to obtain the group features of the members successfully. In the dataset, the numbers of in-group pairs in groups consisting of two members and three or more members are 159 and 41, respectively. The numbers of correctly-detected groups were 141 and 25 (i.e. 87% and 61% of all groups), respectively. Since the accuracy of group detection was lower in groups consisting of three or more members, important future work includes improving detection of a large group.

The following three tests were conducted for evaluating the proposed group detection and re-identification methods:

                           
                              1.
                              The proposed people re-identification method was evaluated with the ground truth of the groups of people (see Section 6.2.1).

The proposed people re-identification method was evaluated with people groups detected by the proposed group detection method (see Section 6.2.2).

The proposed people re-identification method was evaluated with people groups detected from trajectories obtained by a visual tracking method [32].

All 342 persons observed both in cameras a and b were used for re-identification evaluation. Re-identification scores, 
                           
                              R
                              (
                              i
                              ,
                              1
                              )
                              ,
                              R
                              (
                              i
                              ,
                              2
                              )
                              ,
                              …
                              ,
                              R
                              (
                              i
                              ,
                              884
                              )
                              ,
                           
                         were computed for pairs of the ith person, who was one of the 342 persons, observed in camera a and all 884 persons observed in camera b. To evaluate the re-identification scores, a cumulative match characteristic (CMC) curve is used.

Two parameters, 
                           
                              σ
                              
                                 G
                                 H
                              
                              2
                           
                         in Eq. (4) and a in Eq. (7), were 
                           
                              
                                 σ
                                 
                                    G
                                    H
                                 
                                 2
                              
                              =
                              0.222
                              ⋯
                           
                         and 
                           
                              a
                              =
                              1
                              ,
                           
                         which were determined empirically.

Scores ([5,7]) were computed with the ground truth of people groups. In this case, score (7) is essentially the same as score(6), so only score (6) was evaluated.


                           Fig. 8
                            shows results obtained by using the color feature and the proposed three group features. In the CMC curve, the vertical and horizontal axes indicate the identification rate (i.e. the percentage of people whose correct identification appear below each rank of matching score (13)) and the ranks, respectively. From our results, it is observed that the count and trajectory features increased the accuracy of re-identification, as is evident in the difference between “RC
                            and RCRGH
                           ” and “RC
                            and RCRGT
                           ”, respectively, in the figure. Further, the color feature of in-group people also contributed to an increase in accuracy, as is evident from the fact that RCRGCRGTRGH
                           .


                           Fig. 9
                            shows results obtained by using two previous features (i.e. color and transit-time features) and three group features. By comparing the left-hand graphs of Figs. 8 and 9, we note that the transit-time feature is very powerful. In the closeups (i.e. the right-hand graphs of Figs. 8 and 9), it can be also seen that (1) each of the three proposed group features increased the accuracy of re-identification and (2) the highest accuracy was acquired when all of the three proposed group features were applied.

In the results shown in Fig. 9, the numbers of people whose scores of the correct re-identification were ranked within the top ten were 243 and 178 people with and without the group features, respectively. Therefore, the accuracy of re-identification was increased by 
                              
                                 
                                    (
                                    
                                       243
                                       342
                                    
                                    −
                                    
                                       178
                                       342
                                    
                                    )
                                 
                                 ×
                                 100
                                 ≈
                                 19
                              
                            % when applying the group features. The numbers of correctly-identified people (i.e., the numbers of people whose scores of the correct re-identification were ranked in the top one) were 47 and 39 with and without the group features, respectively.

Experiments were conducted with people groups detected by the group detection method proposed in Section 4. The groups were detected from the ground truth of people trajectories.


                           Fig. 10
                            shows results obtained by using the color feature and three proposed group features. In the figure, results with scores (6) and (7) are shown. In Fig. 10, it can be seen that the proposed group features were effective in increasing re-identification accuracy. This effectiveness was, however, lower than that shown in Fig. 8. The drop in effectiveness was caused by errors in group detection. It can be also seen that the drop was suppressed by score (7) rather than score (6).


                           Fig. 11
                            shows results obtained by using two conventional features (i.e. color and transit-time features) and three group features. As with the results shown in Fig. 10, the proposed group features successfully improved the accuracy of re-identification.

In Fig. 11, the number of people whose scores of correct re-identification were ranked within the top ten were 239 and 140 people with and without the group features using score (7), respectively. Therefore, the accuracy of re-identification was increased by 
                              
                                 
                                    (
                                    
                                       239
                                       342
                                    
                                    −
                                    
                                       140
                                       342
                                    
                                    )
                                 
                                 ×
                                 100
                                 ≈
                                 18
                              
                            %.

A typical example of the effects of the group features is illustrated in Fig. 12
                           . Without the group features (i.e. Fig. 12 (a)), pedestrian P
                           
                              a, 1 observed in camera a was identified with P
                           
                              b, 2 by mistake. This mistake was caused by the change in illumination; more specifically, the clothing color of P
                           
                              b, 1 who should have been identified with P
                           
                              a, 1 became darker. With the proposed group features (i.e. Fig. 12 (b)), P
                           
                              a, 1 was identified correctly with P
                           
                              b, 1. The numbers of correctly-identified people with and without the group features were 44 and 39, respectively.

The quantitative results of our proposed method are compared with those of other re-identification methods (Table 2). While our proposed method is inferior to the others in the top-one ranking, it outperforms them in the top-ten ranking.

Our final experiments evaluated re-identification in real scenarios where people trajectories and groups were automatically detected. These trajectories were extracted by the method described in [32] after the regions of people were detected by a general human detector using HOG features and the SVM.


                           Figs. 13
                            and 14
                           
                            show results obtained by using the color feature and the three proposed group features (i.e. all features except the transit-time feature) and all features, respectively. The holistic properties of the results were similar to those presented in Figs. 10 and 11, respectively, i.e. that (1) the proposed group features were effective for increasing re-identification accuracy, and (2) score (7) yielded better results in contrast to score (6).

In Fig. 14, the number of people whose scores of correct re-identification were ranked within the top ten were 82 and 55 people with and without the group features using score (7), respectively. Therefore, the accuracy of re-identification was increased by 
                              
                                 
                                    (
                                    
                                       86
                                       342
                                    
                                    −
                                    
                                       55
                                       342
                                    
                                    )
                                 
                                 ×
                                 100
                                 ≈
                                 10
                              
                            %. The numbers of correctly-identified people with and without the group features were 4 and 2, respectively.

Note that the result of re-identification was significantly decreased (i.e. 
                              
                                 86
                                 342
                              
                           ) compared with the one using the ground truth of tracking trajectories (i.e. 
                              
                                 239
                                 342
                              
                           ), which is shown in Section 6.2.2. This decrease may be caused by the poor detection results obtained before people tracking and grouping. Fig. 15
                            shows the examples of the poor detection results. False-negative windows and drift of a detection window are shown in (a) and (b) of the figure, respectively. Compared with the drift, whose negative impact may be suppressed by smoothing tracking trajectories, false-negative windows are critical for all subsequent processes, including tracking, grouping, and re-identification. While human windows were detected with a simple human detector using the HOG and SVM in our experiments, a more powerful detector (e.g. part-based detector [41]) can detect human windows more precisely. Tracking can be also improved, for example, by recent online discriminative appearance learning [42]. Important future work includes detailed investigation into the relationship between the results of human tracking and our proposed people grouping method.

Results shown in this section have proven that re-identification accuracy was improved by the proposed method even with real tracking trajectories. This conclusion shows the usefulness of the proposed method in real-world applications.

This paper proposes methods (1) for detecting people groups by classifying their trajectories and (2) for achieving people re-identification across non-overlapping cameras by employing features obtained from detected groups.

For group detection, the proposed feature represents spatio-temporal relationships between a pair of pedestrians at each moment. The trajectories of the pair are classified as either a “group” or a “non-group”.

For people re-identification, three group features are extracted from the group associated with each individual person. One of the group features is based on the color distribution of in-group people, while the other two represent the relationship of in-group people’s trajectories and the number of in-group people and its reliability. Our experimental results demonstrated the improvement in people re-identification accuracy using a public dataset; the success rate of people re-identification was improved by 19%, 18%, and 10% with the ground-truth of people groups, detected people groups, and extracted people trajectories and groups, respectively.

In group detection, future work includes the further extension of the spatio-temporal features for improving robustness to noisy trajectories. Group features should be also improved. In particular, the color feature of in-group people should be improved by employing more discriminative color representations (e.g. [33,34]).

We also have other problems in re-identification. For example, for more complex environments with a number of routes among multiple cameras, route prediction using priors over exits and entrances among the cameras is useful as proposed in [13,31]. The effectiveness of global optimization for multi-object tracking has been also demonstrated in related work; within a field of view [32,43] and across cameras [13,44]. All of these tracking techniques should be integrated for more improvement.

@&#REFERENCES@&#

