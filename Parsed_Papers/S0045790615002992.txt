@&#MAIN-TITLE@&#Adaptive energy detector for spectrum sensing in cognitive radio networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Noise uncertainty in energy detection is counteracted by adapting detection threshold.


                        
                        
                           
                           Multiple receiver architecture is exploited for maximum likelihood estimation.


                        
                        
                           
                           Threshold adaptation allows maintaining a constant and low false-alarm rate.


                        
                        
                           
                           The probability of detection is improved in the low SNR regime without increasing sensing time.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spectrum sensing

Energy detection

Noise variance estimation

Noise uncertainty

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           Image, graphical abstract
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

The recent advances in spectrum accessing policies result in a more flexible and efficient use of the radio spectrum [1,2]. This in turn could open the possibility for the deployment of improved and emergent wireless and mobile applications, ranging from smart grid, public safety, and broadband cellular to medical applications [3]. The dynamic spectrum access (DSA) enabled by the cognitive radio (CR) technology would provide the technological solution for opportunistically accessing to the currently underutilized frequency bands [4]. In the DSA, a CR senses the licensed spectrum to find unoccupied frequency bands suitable for secondary use, and exploits the discovered spectrum in an interference-free manner such that the efficiency on the spectrum use is maximized. The key components of CR are the capability of sensing the radio spectrum to opportunely declare if a licensed band is vacant or if it is occupied by its incumbent. This would ascertain that the CR operation will not interfere with the licensees’ transmissions, and that the spectrum reuse opportunities present in time and space will be efficiently exploited [5].

Spectrum sensing is defined as the stage of observation and analysis of the signals contained in the spectrum to gain radio awareness. To the date, there have been proposed a number of spectrum sensing techniques, each of them capable of offering a degree of accuracy and complexity when detecting the presence of primary signals, i.e., the signals transmitted by the incumbents of the licensed bands. Pros and cons of the spectrum sensing techniques are discussed in many studies, for example [6,7]. The constrained time dedicated for spectrum sensing, multipath fading and time dispersion of the wireless channel, the highly dynamic radio environment and the limited information regarding the signals transmitted in the spectrum are, to name a few, the major concerns in the design of reliable spectrum sensing algorithms [8].

Energy detection (ED) is an appealing signal detection technique for spectrum sensing due to its low computational complexity and generic implementation, i.e., it does not require knowing the structure of the primary signal to make decisions regarding its presence. In the traditional approach for ED the energy is estimated and then compared against a detection threshold. The detection threshold is commonly set according to the expected noise floor. A fundamental issue with this approach stems from the fact that the noise in communications systems is the aggregation of random sources of power, including thermal noise, interference due to nearby unintended emissions or weak signals from transmitters located far away. Therefore, it is likely that the noise power changes randomly from a detection interval to another, particularly if the cognitive user changes continuously its radio environment, originating the so-called noise uncertainty problem. If the ED's detection threshold is not adjusted accordingly to the fluctuations in the noise power, then it is likely that its performance is reduced dramatically, giving place to a limit on the signal-to-noise ratio (SNR), known as SNR-wall, below of which signal detection becomes unreliable, or even impossible, regardless of the time the signal is observed [9].

Given that the decreased performance of the ED in the presence of noise uncertainty is due to the lack of correctness in the detection threshold, then a feasible approach is to adapt the detection threshold to the random fluctuations in the noise power [9]. This approach allows counteracting the negative effects of the noise uncertainty because the detection threshold changes as the noise power does. In this sense, in order to add robustness to the appealing ED technique, in this paper we propose an adaptive energy detector (AED) that includes a noise power estimation (NPE) stage with the aim of adapting the detection threshold to the noise power present at the time of spectrum sensing.

If we assume that spectrum sensing is carried out with the cooperation of multiple receivers, then it is possible to exploit the fact that when the signal received is composed by only noise samples the maximum likelihood (ML) estimate of the noise power can be derived by averaging the eigenvalues of the covariance matrix [10]. Furthermore, even if a primary signal is present in the received signal, it is possible to estimate the noise power to some exempt of accuracy, by averaging all but the largest of the eigenvalues. We consider this strategy for NPE and adapting the decision threshold to the noise power present at each sensing event. In this sense, the major contributions of this paper are the identification of a suitable strategy for NPE that works using the samples received for spectrum sensing even when the samples contain traces of a primary signal, and the integration of such a strategy in the formulation of the ED for addressing the noise uncertainty problem.

The rest of this paper is structured as follows: in Section 2, a summary of the most significant related works is presented. The system model along with the formulation of the spectrum sensing problem is presented in
Section 3. The theoretical formulation of ED is described in Section 4, here its performance metrics are derived and a brief discussion of the noise uncertainty is presented, also the formulation of the proposed adaptive energy detector is presented in this section. The results of the performance evaluation of the proposed detector are described and discussed in Section 5. Finally, Section 6 presents the concluding remarks of our research work.

@&#RELATED WORK@&#

ED has been the most considered signal detection technique for spectrum sensing in CR systems [11], and several works presenting improvements for the ED have been published, see e.g. [12,13], and [14]. However, only a few published works are focused on addressing the problem of the noise uncertainty. An initial attempt to deal with the noise uncertainty is presented in [15]. The authors in [15] derive a statistical model for modifying the detection threshold as a function of the error in the noise power estimate, with the aim to maintain an expected performance for the ED. However, the authors do not figure out how to estimate the noise power. In [16], the noise uncertainty is counteracted by adapting the detection threshold to the noise fluctuation by means of noise and signal power estimation. The presented algorithm performs better than the traditional approach for ED under noise uncertainty. However its performance is affected if the primary signal is dispersed over the entire bandwidth monitored, because the proposed algorithm will not be able to perform a reliable estimation of the noise power. This indicates that its performance is affected by the spectral shape of the primary signal making it efficient only for certain types of primary signals. In [17], the effects of using a noise power estimate for determining the detection threshold for ED are analyzed. The approach for estimating the noise power is to perform periodical noise calibration by making use of noise-only samples. Nevertheless, if the noise power changes before the next calibration period, then the difference between the expected and the actual noise power may affect the performance of the ED. In [18], a double detection threshold strategy is proposed and evaluated. The results show that the detector performance can be improved by adapting the decision thresholds to the uncertainty range. However, if the expected range of the noise uncertainty changes, the performance of the detector is affected. Therefore, its robustness is still compromised by the lack of knowledge. In [19], a cross-correlation technique is proposed for reducing the noise uncertainty with the aim of lowering the SNR-wall in ED. The authors conclude that their proposal effectively improves the detection speed and sensibility of the ED as long as the noise samples are uncorrelated. However, when the noise samples present correlation, the proposed algorithm fails at mitigating the uncertainty and therefore, the performance of ED is reduced.

There exist other signal detection techniques that overcome the problem of noise uncertainty without requiring primary signal information. The covariance-based detection (CBD) [20] is able to identify the presence of a primary signal by observation of the covariance matrix of the received data. Eigenvalue-based detection (EBD) [21] and generalized likelihood ratio-based detection (GLRD) [10] exploit the spatial diversity gained in multiple-receiver systems for detecting primary signals. Nevertheless, CDB fails in detecting the presence of primary signal when the signal samples are independent and identically distributed (i.i.d.) as is the case, for example, of orthogonal frequency division multiplexed (OFDM) signals, which are considered in most of the modern communication systems. The performance of the EBD and GLRD is upper-bounded in practical implementations by the limited time for signal detection and restricted amount of cooperating receivers. Moreover, if the amount of cooperating receivers and sensing time is not optimal, the performance of the EBD could not be sufficient for ensuring interference-free secondary use of the spectrum.

Unlike the related works [15–18], the noise power estimation considered in this work is applied each sensing period making use of the samples collected for spectrum sensing, and it is not affected by the spectral shape of the primary signal. It provides acceptable performance for correlated signals as long as the noise processes in the multiple receivers are independent, and it is not affected by the uncertainty interval because it adapts the detection threshold to the noise power present in each sensing epoch. On the other hand, compared to the multiple receivers techniques [21] and [10], the adaptive ED proposed in this work performs better for practical values of sensing time and amount of cooperating receivers.

We assume a sensing model composed by one single-antenna primary user (PU) transmitting at the carrier frequency fc
                      with a bandwidth B, and one secondary user (SU) receiver provided with multiple (M) antennas for spectrum sensing. A PU is an incumbent of a frequency band, meanwhile a SU is a low-priority un-licensed user equipped with a CR.

The continuous-time signal, xc
                     (t), received at each of the M antennas of the SU's receiver is sampled at a sampling rate fs
                      > 2B, where B corresponds to the bandwidth of the baseband signal. Thus, the discrete representation of the signal received at the i-th antenna is 
                        
                           
                              x
                              i
                           
                           
                              (
                              n
                              )
                           
                           =
                           
                              x
                              
                                 c
                                 ,
                                 i
                              
                           
                           
                              (
                              
                                 n
                                 
                                    T
                                    s
                                 
                              
                              )
                           
                        
                     , where 
                        
                           
                              T
                              s
                           
                           =
                           1
                           /
                           
                              f
                              s
                           
                        
                      is the sampling period and n is the sample index. The sensing process is carried out by collecting and processing N samples of the received signal. The system model considered in our formulations is depicted in Fig. 1.
                     
                  

The task of the spectrum sensor is to decide, based on the samples of the signal captured, the true state of a frequency band, i.e. to decide which one of the following hypotheses is true:

                        
                           (1)
                           
                              
                                 
                                    H
                                    0
                                 
                                 :
                                 
                                    x
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    η
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    H
                                    1
                                 
                                 :
                                 
                                    x
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    s
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 +
                                 
                                    η
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        
                     
                  

For i = 1, 2, … , M and n = 0, 1, … , N. ηi
                     (n) and si
                     (n) correspond to the noise and primary signal samples, respectively. si
                     (n) is modeled as [22]:

                        
                           (3)
                           
                              
                                 
                                    s
                                    i
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       0
                                    
                                    
                                       q
                                       i
                                    
                                 
                                 
                                    
                                       h
                                       i
                                    
                                    
                                       (
                                       l
                                       )
                                    
                                    
                                       s
                                       ˜
                                    
                                    
                                       (
                                       
                                          n
                                          −
                                          l
                                       
                                       )
                                    
                                 
                                 .
                              
                           
                        
                     
                     
                        
                           
                              s
                              ˜
                           
                           
                              (
                              n
                              )
                           
                        
                      represents the signal transmitted by the primary transmitter, hi
                     (n) models the response of the channel between primary transmitter and receiving antenna i, and qi
                      is the order of channel. We assume that the noise processes are zero-mean complex additive white Gaussian and independent at each receiving antenna. Also we assume equal variance 
                        
                           σ
                           η
                           2
                        
                      for the noise processes at each antenna. The hypothesis H
                     0 states that the samples received are composed only by noise, meanwhile the hypothesis H
                     1 states that the signal samples correspond to a primary signal plus noise.

Stacking the samples received at the M antennas, xi
                     (n), si
                     (n), and ηi
                     (n) can be represented in vector form as:

                        
                           (4)
                           
                              
                                 x
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             x
                                             1
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          ,
                                          ⋯
                                          ,
                                          
                                             x
                                             M
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 s
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             s
                                             1
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          ,
                                          ⋯
                                          ,
                                          
                                             s
                                             M
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       ]
                                    
                                    T
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    η
                                 
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             η
                                             1
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          ,
                                          ⋯
                                          ,
                                          
                                             η
                                             M
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       ]
                                    
                                    T
                                 
                                 .
                              
                           
                        
                     
                  

Superscript T stands for transpose. Therefore, Eqs. (1) and (2) turn into:

                        
                           (7)
                           
                              
                                 
                                    H
                                    0
                                 
                                 :
                                 
                                 x
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 η
                                 
                                    (
                                    n
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    H
                                    1
                                 
                                 :
                                 
                                 x
                                 
                                    (
                                    n
                                    )
                                 
                                 =
                                 s
                                 
                                    (
                                    n
                                    )
                                 
                                 +
                                 η
                                 
                                    (
                                    n
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

In order to decide if it is safe to access to the primary channel, the SU formulates a test statistic T(x) from the received samples x(n), and compares it against a detection threshold γ, i.e.:

                        
                           (9)
                           
                              
                                 T
                                 
                                    (
                                    x
                                    )
                                 
                                 
                                    
                                       
                                          
                                             H
                                             1
                                          
                                       
                                    
                                    
                                       
                                          >
                                       
                                    
                                    
                                       
                                          <
                                       
                                    
                                    
                                       
                                          
                                             H
                                             0
                                          
                                       
                                    
                                 
                                 γ
                                 .
                              
                           
                        
                     
                  

The performance of a spectrum detector can be quantified by its probability of detection, i.e., the probability of deciding that a signal is present when actually is present, PD
                      = Pr(T(x) > γ; H
                     1), or equivalently its probability of misdetection PM
                      = 1 – PD
                      = Pr(T(x) < γ; H
                     1), and its probability of false alarm, i.e., the probability of declaring the presence of a signal when it is actually absent, PFA
                      = Pr(T(x) > γ; H
                     0).

The test statistic for ED in a multiple antenna system is equivalent to the output of a square-law combiner (SLC) [23]. Thus, for M receiving antennas and N received signal samples, T(x) is computed as:

                           
                              (10)
                              
                                 
                                    T
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       1
                                       
                                          M
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          ∑
                                          
                                             n
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             x
                                             i
                                             2
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

According to the primary signal, noise and channel model described in the previous section, the test statistic T(x) for ED with multiple antennas is distributed as follows:

                           
                              (11)
                              
                                 
                                    T
                                    
                                       (
                                       x
                                       )
                                    
                                    ∼
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   χ
                                                   
                                                      2
                                                      N
                                                   
                                                   2
                                                
                                             
                                             
                                                
                                                   H
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      χ
                                                      
                                                         2
                                                         N
                                                      
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         2
                                                         ξ
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              χ
                              
                                 2
                                 N
                              
                              2
                           
                         and 
                           
                              
                                 χ
                                 
                                    2
                                    N
                                 
                                 2
                              
                              
                                 (
                                 
                                    2
                                    ξ
                                 
                                 )
                              
                           
                         are the central and non-central Chi-square distribution with 2N degrees of freedom and non-centrality parameter 2ξ. ξ corresponds to the SNR at the receiver defined as 
                           
                              ξ
                              =
                              
                                 σ
                                 s
                                 2
                              
                              /
                              
                                 σ
                                 η
                                 2
                              
                           
                        , with 
                           
                              σ
                              s
                              2
                           
                         corresponding to the power of the primary signal. Resorting to the central limit theorem, if N is large enough (for example N > 250 [24]), the distribution of T(x) can be approximated by the Gaussian distribution as follows:

                           
                              (12)
                              
                                 
                                    T
                                    
                                       (
                                       x
                                       )
                                    
                                    ∼
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   N
                                                   
                                                      (
                                                      
                                                         
                                                            σ
                                                            η
                                                            2
                                                         
                                                         ,
                                                         
                                                            
                                                               1
                                                               
                                                                  M
                                                                  N
                                                               
                                                            
                                                         
                                                         
                                                            σ
                                                            η
                                                            4
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   N
                                                   
                                                      (
                                                      
                                                         
                                                            σ
                                                            s
                                                            2
                                                         
                                                         +
                                                         
                                                            σ
                                                            η
                                                            2
                                                         
                                                         ,
                                                         
                                                            
                                                               1
                                                               
                                                                  M
                                                                  N
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        σ
                                                                        s
                                                                        2
                                                                     
                                                                     +
                                                                     
                                                                        σ
                                                                        η
                                                                        2
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   H
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Assuming a Gaussian channel between the PU's transmitter and the SU's receiver, the PD
                         and PFA
                         for the ED can be derived from the cumulative distribution function (CDF) of T(x) as:

                           
                              (13)
                              
                                 
                                    
                                       P
                                       D
                                    
                                    =
                                    Pr
                                    
                                       (
                                       
                                          T
                                          
                                             (
                                             x
                                             )
                                          
                                          >
                                          γ
                                          ;
                                          
                                          
                                             H
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       Φ
                                       
                                          H
                                          1
                                       
                                    
                                    
                                       (
                                       γ
                                       )
                                    
                                    =
                                    Q
                                    
                                       (
                                       
                                          
                                             γ
                                             −
                                             
                                                (
                                                
                                                   
                                                      σ
                                                      s
                                                      2
                                                   
                                                   +
                                                   
                                                      σ
                                                      η
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   
                                                      M
                                                      N
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               σ
                                                               s
                                                               2
                                                            
                                                            +
                                                            
                                                               σ
                                                               η
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       P
                                       
                                          F
                                          A
                                       
                                    
                                    =
                                    Pr
                                    
                                       (
                                       
                                          T
                                          
                                             (
                                             x
                                             )
                                          
                                          >
                                          γ
                                          ;
                                          
                                          
                                             H
                                             0
                                          
                                       
                                       )
                                    
                                    =
                                    1
                                    −
                                    
                                       Φ
                                       
                                          H
                                          0
                                       
                                    
                                    
                                       (
                                       γ
                                       )
                                    
                                    =
                                    Q
                                    
                                       (
                                       
                                          
                                             γ
                                             −
                                             
                                                σ
                                                η
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   
                                                      M
                                                      N
                                                   
                                                
                                                
                                                   σ
                                                   η
                                                   4
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where γ is the detection threshold, 
                           
                              
                                 Φ
                                 
                                    H
                                    0
                                 
                              
                              
                                 (
                                 γ
                                 )
                              
                           
                         and 
                           
                              
                                 Φ
                                 
                                    H
                                    1
                                 
                              
                              
                                 (
                                 γ
                                 )
                              
                           
                         correspond to the CDF of T(x) under H
                        0 and H
                        1 respectively, and Q( · ) stands for the Gaussian Q-function 
                           
                              Q
                              
                                 (
                                 x
                                 )
                              
                              =
                              1
                              /
                              
                                 
                                    2
                                    π
                                 
                              
                              
                                 ∫
                                 x
                                 ∞
                              
                              
                                 exp
                                 (
                                 
                                    −
                                    
                                       t
                                       2
                                    
                                    /
                                    2
                                 
                                 )
                                 d
                                 t
                              
                           
                        . Note that the PFA
                         does not depend on the power of the primary signal, thus it remains the same if a fading channel (Rayleigh, Nakagami-m) is considered. On the other hand, the PD
                         for fading channels can be easily derived by averaging it over the distribution of the primary signal power, which in turn depends on the channel response, see e.g. [23].

The test statistic formulated in (10) is optimal in a Neyman–Pearson sense [25]. According to the constant false alarm rate (CFAR) strategy [26], for a Neyman–Pearson detector the detection-threshold is set based only on the distribution of the test statistic under H
                        0. Therefore, from Eq. (14) the detection-threshold for ED is derived as:

                           
                              (15)
                              
                                 
                                    γ
                                    =
                                    
                                       σ
                                       η
                                       2
                                    
                                    
                                       (
                                       
                                          1
                                          +
                                          
                                             
                                                2
                                                
                                                   M
                                                   N
                                                
                                             
                                          
                                          
                                             Q
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                
                                                   F
                                                   A
                                                
                                             
                                             )
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

In the non-adaptive ED, the detection threshold γ is set using (15) based on an expected (and fixed) noise power 
                           
                              σ
                              η
                              2
                           
                        . This expected value can be estimated a priori, for example, using noise calibration methods [9], remaining unchanged until the next calibration period. However, if the noise power changes before the next calibration period, then the difference between the expected and the actual noise power may affect the performance of the ED. This is called the noise uncertainty problem and it is discussed in what follows.

If 
                           
                              σ
                              η
                              2
                           
                         is perfectly known to the SU and the sensing time is not limited, an energy detector can achieve any simultaneous PD
                         and PFA
                        , regardless of the SNR experimented at the secondary receiver. However, these assumptions hardly hold in practice. First, the noise in communications systems is randomly changing, particularly if the SU changes continuously its radio environment. Therefore, it is difficult to know the exact value of 
                           
                              σ
                              η
                              2
                           
                         at a particular time. And second, the time dedicated for spectrum sensing is constrained by the Quality of Service (QoS) required by upper layers in the design of the CR system [17].

Let us assume that the noise power varies within the interval 
                           
                              [
                              
                                 
                                    α
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    σ
                                    η
                                    2
                                 
                                 ,
                                 α
                                 
                                    σ
                                    η
                                    2
                                 
                              
                              ]
                           
                        , with 
                           
                              α
                              =
                              
                                 10
                                 ∧
                              
                              
                                 (
                                 
                                    ρ
                                    /
                                    10
                                 
                                 )
                              
                           
                        , where the variable ρ represents the noise uncertainty factor measured in dB [9]. If γ is determined assuming 
                           
                              
                                 α
                                 
                                    −
                                    1
                                 
                              
                              
                                 σ
                                 η
                                 2
                              
                           
                         as the expected value of the noise power, then all the sensing events with 
                           
                              
                                 σ
                                 
                                    η
                                    ,
                                    t
                                    r
                                    u
                                    e
                                 
                                 2
                              
                              >
                              
                                 α
                                 
                                    −
                                    1
                                 
                              
                              
                                 σ
                                 η
                                 2
                              
                           
                        , with 
                           
                              σ
                              
                                 η
                                 ,
                                 t
                                 r
                                 u
                                 e
                              
                              2
                           
                         being the true noise power, will result in a signal present decision (H
                        1 true) regardless of the true state of the PU. With this strategy for setting the detection threshold the rate of false alarms is increased as a function of the noise uncertainty, because the SU will solve as occupied the channel (even if it is not) with higher probability as the noise uncertainty increases. On the other hand, if γ is set with 
                           
                              α
                              
                                 σ
                                 η
                                 2
                              
                           
                         as the expected noise power, the PD
                         will decrease as the SNR decreases and the uncertainty increases. When the SNR is low (SNR ≪ 0 dB), the attenuated power of the primary signal does not represent a significant component in the received signal, therefore it could be not be enough to compensate the fluctuating noise power, thus the SU might declare as idle an occupied channel (declaring H
                        0 true) because the received power resulted lower than the detection threshold.

Define X as the matrix formed by the received samples at each antenna, i.e.

                           
                              X
                              =
                              [
                              
                                 
                                    
                                       
                                          x
                                          (
                                          1
                                          )
                                       
                                    
                                    
                                       
                                          x
                                          (
                                          2
                                          )
                                       
                                    
                                    
                                       …
                                    
                                    
                                       
                                          x
                                          (
                                          N
                                          )
                                       
                                    
                                 
                              
                              ]
                           
                        . The likelihood function of X under H
                        0 is denoted by [10]:

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             f
                                             
                                                (
                                                
                                                   X
                                                   ;
                                                   
                                                   
                                                      H
                                                      0
                                                   
                                                   ,
                                                   
                                                   
                                                      σ
                                                      η
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               π
                                                               
                                                                  σ
                                                                  η
                                                                  2
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      M
                                                   
                                                
                                                exp
                                                
                                                   (
                                                   
                                                      −
                                                      
                                                         1
                                                         
                                                            σ
                                                            η
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         H
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      x
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            π
                                                            
                                                               σ
                                                               η
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      M
                                                      L
                                                   
                                                
                                             
                                             exp
                                             
                                                (
                                                
                                                   −
                                                   
                                                      1
                                                      
                                                         σ
                                                         η
                                                         2
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         H
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      x
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            π
                                                            
                                                               σ
                                                               η
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      M
                                                      L
                                                   
                                                
                                             
                                             exp
                                             
                                                (
                                                
                                                   −
                                                   
                                                      
                                                         t
                                                         r
                                                         
                                                            (
                                                            
                                                               X
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  H
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         σ
                                                         η
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The operator H indicates transpose conjugate. The log-likelihood function of 
                           
                              f
                              (
                              
                                 X
                                 ;
                                 
                                 
                                    H
                                    0
                                 
                                 ,
                                 
                                 
                                    σ
                                    η
                                    2
                                 
                              
                              )
                           
                         is obtained from (16) as:

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                                0
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             ln
                                             
                                                (
                                                
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  π
                                                                  
                                                                     σ
                                                                     η
                                                                     2
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            M
                                                            L
                                                         
                                                      
                                                   
                                                   exp
                                                   
                                                      (
                                                      
                                                         −
                                                         
                                                            
                                                               t
                                                               r
                                                               
                                                                  (
                                                                  
                                                                     X
                                                                     
                                                                        
                                                                           X
                                                                        
                                                                        H
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               σ
                                                               η
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   t
                                                   r
                                                   
                                                      (
                                                      
                                                         X
                                                         
                                                            
                                                               X
                                                            
                                                            H
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   σ
                                                   η
                                                   2
                                                
                                             
                                             −
                                             M
                                             N
                                             ln
                                             
                                                (
                                                π
                                                )
                                             
                                             −
                                             M
                                             N
                                             ln
                                             
                                                (
                                                
                                                   σ
                                                   η
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The maximum likelihood estimate (MLE) of 
                           
                              σ
                              η
                              2
                           
                         is obtained from (17) as [27]:

                           
                              (18)
                              
                                 
                                    
                                       
                                          ∂
                                          
                                             (
                                             
                                                
                                                   L
                                                   0
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                       
                                          ∂
                                          
                                             σ
                                             η
                                             2
                                          
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        
                     

Solving Eq. (18) we have:

                           
                              (19)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                
                                                   t
                                                   r
                                                   
                                                      (
                                                      
                                                         X
                                                         
                                                            
                                                               X
                                                            
                                                            H
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            σ
                                                            η
                                                            2
                                                         
                                                         )
                                                      
                                                   
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   M
                                                   N
                                                
                                                
                                                   σ
                                                   η
                                                   2
                                                
                                             
                                             =
                                             0
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   σ
                                                   ˜
                                                
                                                η
                                                2
                                             
                                             =
                                             
                                                
                                                   t
                                                   r
                                                   
                                                      (
                                                      
                                                         X
                                                         
                                                            
                                                               X
                                                            
                                                            H
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   M
                                                   N
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Defining the sample covariance matrix as

                           
                              (20)
                              
                                 
                                    
                                       R
                                       X
                                    
                                    
                                       (
                                       N
                                       )
                                    
                                    =
                                    
                                       1
                                       N
                                    
                                    X
                                    
                                       
                                          X
                                       
                                       H
                                    
                                    ,
                                 
                              
                           
                        then the MLE of 
                           
                              σ
                              η
                              2
                           
                         calculated from the data matrix X under hypothesis H
                        0 is:

                           
                              (21)
                              
                                 
                                    
                                       
                                          σ
                                          ˜
                                       
                                       η
                                       2
                                    
                                    =
                                    
                                       
                                          t
                                          r
                                          
                                             (
                                             
                                                
                                                   R
                                                   X
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                       M
                                    
                                    .
                                 
                              
                           
                        
                     


                        Eq. (21) is valid for obtaining the MLE if, and only if, the samples in X correspond to noise-only samples. For the case of H
                        1, the presence of at least one primary signal changes the structure of the information contained in the sample covariance matrix RX
                        (N). Following a procedure similar to that for obtaining the MLE of 
                           
                              σ
                              η
                              2
                           
                         under H
                        0, the MLE of 
                           
                              σ
                              η
                              2
                           
                         under H
                        1 results:

                           
                              (22)
                              
                                 
                                    
                                       
                                          σ
                                          ˜
                                       
                                       η
                                       2
                                    
                                    =
                                    
                                       1
                                       
                                          M
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          t
                                          r
                                          
                                             (
                                             
                                                
                                                   R
                                                   X
                                                
                                                
                                                   (
                                                   N
                                                   )
                                                
                                             
                                             )
                                          
                                          −
                                          
                                             λ
                                             max
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The term λ
                        max corresponds to the largest of the eigenvalues associated with RX
                        (N). By using the property tr(A) = λ
                        1 + λ
                        2 + … + λ
                        M, where A is an M × M matrix and λm
                         is the m-th eigenvalue associated with A, the MLEs of 
                           
                              σ
                              η
                              2
                           
                         under both hypothesis can be expressed as:

                           
                              (23)
                              
                                 
                                    
                                       
                                          σ
                                          ˜
                                       
                                       
                                          η
                                          ,
                                          
                                             H
                                             0
                                          
                                       
                                       2
                                    
                                    =
                                    
                                       1
                                       M
                                    
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       λ
                                       m
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       
                                          σ
                                          ˜
                                       
                                       
                                          η
                                          ,
                                          
                                             H
                                             1
                                          
                                       
                                       2
                                    
                                    =
                                    
                                       1
                                       
                                          M
                                          −
                                          1
                                       
                                    
                                    
                                       ∑
                                       
                                          m
                                          =
                                          2
                                       
                                       M
                                    
                                    
                                       λ
                                       m
                                    
                                    .
                                 
                              
                           
                        
                     

It is not possible to know beforehand if the computed eigenvalues correspond to the characteristic roots of a data matrix composed by noise only samples or by the samples of a primary signal plus noise. In this sense, to avoid overestimating 
                           
                              σ
                              η
                              2
                           
                         we considered
Eq. (24) as the general method for estimating 
                           
                              
                                 σ
                                 ˜
                              
                              η
                              2
                           
                        . By substituting Eq. (24) into Eq. (15), the detection threshold for the AED becomes:

                           
                              (25)
                              
                                 
                                    γ
                                    
                                       (
                                       
                                          
                                             σ
                                             ^
                                          
                                          η
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             1
                                             
                                                M
                                                −
                                                1
                                             
                                          
                                          
                                             ∑
                                             
                                                i
                                                =
                                                2
                                             
                                             M
                                          
                                          
                                             
                                                λ
                                                ^
                                             
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       
                                          1
                                          +
                                          
                                             
                                                2
                                                
                                                   M
                                                   
                                                      N
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             Q
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                P
                                                
                                                   F
                                                   A
                                                
                                             
                                             )
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

Now, the detection threshold can be effectively adapted to the noise power variations, regardless of the signal, channel and noise power knowledge availability.
Fig. 2
                         shows the block diagram of the AED and the conventional, i.e. non-adaptive energy detector.

@&#PERFORMANCE EVALUATION@&#

In this section, the evaluation of the proposed AED is presented. The evaluation is carried out by means of computer simulation of a spectrum sensing system composed of one primary transmitter and one secondary receiver. The simulation parameters are given in
Table 1
                     . For obtaining the simulation curves, the sensing results were averaged over a total of 5000 realizations of the sensing process. At each realization independent signal and noise processes were generated. For obtaining the sensibility curves an attenuation factor is added to the received signal. This allows evaluating the performance of the detectors under several SNR conditions. In order to simulate the noise uncertainty, a random fluctuation in the noise power is generated at each realization of the sensing process. The random fluctuation in the noise power was generated according to a uniform probability distribution, as presented in [9]. Note that the nominal noise power considered in our evaluations is significantly greater than the thermic noise floor (−174 dBm/Hz). Nevertheless, in our analysis the evaluation parameter is the SNR, not the nominal noise power itself, thus this parameter can be arbitrary.

The main functionality of the proposed AED relies on the capability of adapting the detection threshold to the noise environment. For evidencing this, Figs. 3
                      and 4
                      show two plots each containing a sample of 20 sensing events. A sensing event is composed by a test statistic value (T(x), represented by the dashed line with round marker), an adaptive threshold value (γ
                     AED, represented by the solid line with cross marker), and a non-adaptive threshold value (γ
                     NAED, represented by the constant bold line with no marker). Of course, 20 sensing events are not sufficient for determining the actual detection or false alarm rate provided by the detectors. The results shown in Figs. 3 and 4 are presented with the sole purpose of observing how the NPE strategy helps for adapting the detection threshold according to the changes in the noise power.

For the results presented in Fig. 3A) it is assumed that the noise uncertainty is negligible, i.e. ρ = 0 dB, meanwhile for the results shown in Fig. 3B), the noise uncertainty is ρ = 2 dB. SNR = −20 dB, N = 1000 samples, and M = 2 receiving antennas are considered in both cases. Table 2
                      details the data results shown in Fig. 3. In the plots shown in Fig. 3 can be observed how the adaptive detection threshold is adjusted each sensing event according to the changes in the noise power. Furthermore, by analyzing the data results provided in Table 2, it can be noted that for the ρ = 2 dB case the misdetection rate accomplished by the AED is lower than that of the NAED. These preliminary results underpin the benefits of the adaptive threshold strategy proposed in this work, because it effectively reduces the misdetection rate in the presence of noise uncertainty and low SNR conditions, as compared to the non-adaptive threshold strategy.

For the results presented in Fig. 4 the number of receiving antennas is increased to M = 4, while the SNR and N are the same as in Fig. 3. Fig. 4A) corresponds to the ρ = 0 dB case, meanwhile Fig. 4B) corresponds to the ρ = 2 dB case. Table 3
                      summarizes the data results provided by Fig. 4. By analyzing the data results shown in Table 3, it is possible to infer that by increasing M, the rate of missed detections achieved by the AED is decreased even more, particularly for the ρ = 2 dB case. This because when M is increased, there are more eigenvalues for averaging, resulting in a reduction of the estimation error. Therefore, the accuracy of the detector is improved as a consequence.

The performance of the noise power estimation strategy is evaluated in terms of the mean square error (MSE). The evaluation results are shown in Fig. 5
                     . It is possible to observe that the estimation error decreases as M and N increase. This is the key reason behind the reduction of the misdetection rate observed in Fig. 4, compared to that of Fig. 3. However, by observing the decay of each MSE curve, it can be noted that when M is small, i.e., M = 2, the increase on N has little effect on the MSE. However, even for small N, i.e., N = 100, the increase on M has a significant improvement on the MSE. This is because the noise power estimation is carried out by averaging M – 1 eigenvalues, as M increases the average of the eigenvalues tends to 
                        
                           σ
                           
                              η
                              ,
                              t
                              r
                              u
                              e
                           
                           2
                        
                      when N increases. Nevertheless, for M = 2, there is only one eigenvalue used for noise power estimation, and for N ≪ ∞ the residual error caused by the difference between 
                        
                           σ
                           
                              η
                              ,
                              t
                              r
                              u
                              e
                           
                           2
                        
                      and the smallest eigenvalue is not negligible.


                     Fig. 6
                      shows the sensitivity curves for the AED considering different factors of noise uncertainty, M, and N. The sensitivity curve represents the PD
                      achieved by the detector as a function of the SNR, while the PFA
                      is constant. For the curves presented in Fig. 6, the number of receiving antennas considered are M = 2 and 8, and the number of signal samples are N = 100 and 1000 for each value of SNR evaluated. The detection threshold is determined according to a constant false alarm rate of 10% (PFA
                      = 0.1). It can be observed in Fig. 6 that the sensibility of the proposed detector is robust to the noise uncertainty because for each pair of M and N considered, the PD
                      achieved when the noise uncertainty is ρ = 2 dB is approximated to that achieved when ρ = 0 dB. From these result it is also possible to observe that the sensibility of the proposed detector is higher as the number of receiving antennas is increased. For example, if the target PD
                      is 0.9 and the number of samples is N = 1000, the AED with eight receiving antennas is capable of achieving the target PD
                      under SNR conditions 8 dB lower than the AED with two receiving antennas.

In order to compare the performance of the proposed detector with other similar detectors, the receiver operation characteristic (ROC) curves of the proposed detector, the MME detector, and the MET detector are shown in Fig. 7
                     . For this experiment, the detectors sense the spectrum using M = 2 receiving antennas and N = 1000 signal samples. SNR = −16 dB and ρ = 2 dB of noise uncertainty are considered at the time of signal detection. It can be observed that the PD
                      achieved by the proposed AED is higher than that of the MME and MET detectors, and it is also robust to the noise uncertainty.

Both, MME and MET, assume that the maximum eigenvalue converges to the Tracy–Widom distribution when M, N → ∞, thus the detection threshold is determined considering this probability distribution. However, if this condition (M, N → ∞) does not hold, then the distribution of the test statistic deviates from the expectation. In this sense, the reduced performance for MME and MET observed in Fig. 7 is caused by the values considered for M and N, which are far away from the assumption M, N → ∞. Therefore, given that the AED, the MME and the MET present similar implementation complexity, the AED presents better performance for limited values of M and N, constituting a better option for spectrum sensing for the operational conditions considered in this work.

The evaluation of the impact of the number of samples (N) and the number of receiving antennas (M) considered for spectrum sensing in the PD
                      achieved by the AED and the NAED is presented in Figs. 8
                      and 9
                     , respectively. By analyzing the results shown in Fig. 8, it is possible to observe that the “AED, ρ = 0 dB” PD
                      curve presents approximately the same behavior that the “AED, ρ = 2 dB” curve, proving that the AED is robust to the noise uncertainty. Furthermore, by comparing the “AED, ρ = 2 dB” and “NAED, ρ = 2 dB” curves, the AED significantly outperforms the NAED, particularly when N increases. The numerical analysis obtained from the results provided by the curves in Fig. 8 state that the maximal difference between the PD
                     ’s achieved by the AED and the NAED is for the “N = 1000 samples, ρ = 2” case, being 39.25% higher for the AED.


                     Fig. 9 shows the PD
                      obtained by the AED and the NAED when the number of receiving antennas is varied from M = 2 to 20, for a fixed N = 1000. As expected, for the ρ = 0 dB case, a significant improvement in the PD
                      is observed for both detectors as M increases. However, similarly to the results shown in Fig. 8, the “AED, ρ = 2 dB” curve outperforms the “NAED, ρ = 2 dB” curve, with the maximum PD
                     ’s difference being 49.05% for M = 6 receiving antennas. The results provided by Figs. 8 and 9 demonstrate that the NAED is not able to improve its performance when uncertainty is present in the noise power, even though the number of samples or the number of receiving antennas is increased, meanwhile the AED has two degrees of freedom to improve performance, either by increasing the number samples or the number of receiving antennas.

The performance metrics analyzed so far is focused on the detection capability of the AED and the NAED. However is equally important to investigate the detector's capability of correctly identify the spectrum holes when they are present, thus avoiding wasting spectrum reuse opportunities. In order to evaluate the extent the AED outperforms the NAED, considering a global evaluation approach, Fig. 10
                      shows the probability of error (Pe
                     ), which is defined as the overall weighted probability of making erroneous decisions, this is the sum of the PMD
                      weighted by the probability of occurrence of H
                     1 (because is under this hypothesis when misdetections occur) plus the PFA
                      weighted by the probability of occurrence of H
                     0 (because false alarms only occur when H
                     0 is true), i.e.,

                        
                           (26)
                           
                              
                                 
                                    P
                                    e
                                 
                                 =
                                 Pr
                                 
                                    (
                                    
                                       H
                                       0
                                    
                                    )
                                 
                                 
                                    P
                                    
                                       F
                                       A
                                    
                                 
                                 +
                                 Pr
                                 
                                    (
                                    
                                       H
                                       1
                                    
                                    )
                                 
                                 
                                    P
                                    
                                       M
                                       D
                                    
                                 
                                 .
                              
                           
                        
                     
                  

To obtain the Pe
                      in our simulation model, two independent trials have been carried out. First, the simulation model considers that a primary signal is always present. Therefore, this trial provides the rate of misdetections. Second, the simulation model considers that only a noise signal is present, providing the rate of false alarms. Since equal number of realizations was considered at each simulation trial (i.e. under H
                     0 and H
                     1) it can be assumed that Pr(H
                     0) = Pr(H
                     1) = 0.5, the Pe
                      is determined according to (26) as:

                        
                           (27)
                           
                              
                                 
                                    P
                                    e
                                 
                                 =
                                 0.5
                                 
                                    (
                                    
                                       
                                          ∑
                                          
                                             false
                                             
                                             alarms
                                          
                                       
                                       realizations
                                    
                                    )
                                 
                                 +
                                 0.5
                                 
                                    (
                                    
                                       
                                          ∑
                                          misdetections
                                       
                                       realizations
                                    
                                    )
                                 
                              
                           
                        
                     
                  

For obtaining the curves provided in Fig. 10, N = 1000 signal samples and M = 2 receiving antennas were considered during each spectrum sensing realization. For “H1 true” simulation trial, the SNR values considered are −10 and −20 dB, and the system was evaluated under different values of noise uncertainty. It can be observed in Fig. 10 that for the overall performance of the NAED decays as the noise uncertainty increases, while the overall performance of the AED remains constant regardless of the uncertainty present in the noise power. Therefore, considering an adaptive threshold strategy for energy detection increases the possibility of secondary use of the radio spectrum, as compared to the conventional threshold approach. This is because under noise uncertainty, it is less likely that the energy detector makes incorrect decisions, i.e. declaring false spectrum holes or omitting their existence. For the ρ = 0 dB, SNR = −20 dB case, the NAED achieves better performance than the AED, and this is because the noise power estimation stage introduces an error factor that slightly increases the global probability of error of the AED. However, as it has been pointed out in [28], uncertainty will always be present in the noise power. Therefore, a design requirement for the energy detector is to estimate the noise power present at the time of detection for adapting the detection threshold to overcome the negative effects of the noise uncertainty.

Another metric considered for evaluating the performance of a spectrum detector is the relationship between the number of samples and the minimum SNR value required for achieving a simultaneous PD
                      and PFA
                     , given some noise uncertainty conditions. This metric is called the SNR-wall curve of the detector. It is well known that for the conventional energy detector (NAED), the minimum SNR value required for achieving a desired PD
                      is higher as the noise uncertainty increases. Moreover, for ρ > 0 there exists some limit on the SNR beyond which the PD
                      objective cannot be accomplished without sacrificing the PFA
                     , no matter how many samples of the received signal are used for spectrum sensing. Fig. 11
                      shows the SNR-wall curves for the AED and the NAED for different noise uncertainty conditions. For the curves shown in Fig. 11, the pair PD
                      = 0.9, PFA
                      = 0.1 is considered as the target probabilities. It can be observed that for the NAED (solid lines), for each ρ > 0 there is a SNR value for which the number of samples required for achieving the PD
                      objective increases asymptotically, this SNR value is the SNR wall for the NAED. This means that for SNR values greater than the SNR wall, the PD
                      objective is not achieved, even though the number of samples is increased. On the other side, for the AED the PD
                      objective is achieved for every SNR value evaluated, provided that the sample number (N) is increased accordingly, even if ρ > 0. Therefore it can be stated that by adapting the detection threshold to the noise conditions it is possible to increase the detector's sensitivity by improving the SNR wall.

There exist several factors that could cause signal decorrelation. For example, the propagation mechanisms of the wireless medium, such as small scale fading, may cause phase change at the different receiving antennas causing loss of correlation in the signal received. However, an initial analysis derived empirically indicates that the performance of the proposed detector would not be affected due to signal decorrelation because the detector is formulated based on the energy detection principle. Furthermore, the noise power estimation is carried out considering only the M – 1 smallest eigenvalues, therefore, assuming that there is only one primary signal, the degree of correlation would be concentrated only in the largest eigenvalue, leaving the rest unaffected. However, stronger analytical arguments for this discussion will be derived in future works. For the sake of fairness, all the other detectors were evaluated under the same assumptions of primary signal, noise uncertainty and channel conditions.

The objective of our proposal is to improve the detection accuracy of the energy detector when it operates under noise uncertainty and low SNR conditions. This is, improving the probability of detection while the false alarm rate is maintained at a constant and low rate, even in the low SNR regime, and under the presence of noise uncertainty. This latter is accomplished by adapting the detection threshold of the energy detector to the changes in the noise power, thus alleviating the noise uncertainty problem. Threshold adaptation is carried out by means of noise power estimation.

The results provided show that the proposed adaptive energy detector presents better performance than the non-adaptive energy detector when uncertainty is present in the noise power, particularly under low SNR conditions. The proposed adaptive energy detector also performs better than two of the published eigenvalue-based detectors, maximum-to-minimum eigenvalue and maximum eigenvalue-to-trace detectors, when the number of cooperative receivers and signal samples is strictly restricted to small values.

Even though the results presented in this work demonstrate that the proposed adaptive energy detector overcomes the noise uncertainty problem, it is necessary to analyze its performance when signal decorrelation occurs, because the formulation of the noise power estimation strategy relies on the fact that the power of a correlated signal is concentrated in the maximum eigenvalue. However, if signal decorrelation occurs, it could affect the reliability of the noise power estimate, and therefore reduce the performance of the adaptive energy detector. Therefore as future work, we would like to investigate the degree of correlation required in the primary signal samples to achieve an expected detection performance, and to determine the requirements of the system necessary to attain such correlation degree.

@&#REFERENCES@&#

