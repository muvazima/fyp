@&#MAIN-TITLE@&#Path planning with obstacle avoidance by 
                  
                     
                        G
                     
                     
                        1
                     
                  
                PH quintic splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A two-step approach to design planar smooth collision-free paths is presented.


                        
                        
                           
                           The construction of piecewise linear paths with angle-based criteria is investigated.


                        
                        
                           
                           The smooth path is based on PH spline interpolation schemes with tension parameters.


                        
                        
                           
                           A selection of test cases demonstrates the quality of the new motion planning scheme.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Path planning

Obstacle avoidance

Spline

Pythagorean-hodograph curves

Tension parameters

@&#ABSTRACT@&#


               
               
                  We propose a two-step approach for the construction of planar smooth collision-free navigation paths. Obstacle avoidance techniques that rely on classical data structures are initially considered for the identification of piecewise linear paths having no intersection with the obstacles of a given scenario. Variations of the shortest piecewise linear path with angle-based criteria are proposed and discussed. In the second part of the scheme we rely on spline interpolation algorithms with tension parameters to provide a smooth planar control strategy. In particular, we consider the class of curves with Pythagorean structures, because they provide an exact computation of fundamental geometric quantities. A selection of test cases demonstrates the quality of the new motion planning scheme.
               
            

@&#INTRODUCTION@&#

The design of motion planning strategies plays a fundamental role in modern computer applications with focus on different kinds of simulation environments naturally related to robotics, as well as to scientific visualization and interactive navigation  [1,2]. The issue of finding an optimal trajectory for a given path should properly combine the geometric part of the motion, usually identified by a path planning scheme, with a suitable time law.

The path planning problem includes the identification of paths that do not intersect any obstacle. In order to avoid forbidden configurations related to a given scenario, several graph-like structures may be considered, see for example  [3] for a recent survey related to possible collision-free piecewise linear solutions. Using a standard graph search algorithm, a graph with non-negative edge weights can be exploited to compute the path with lowest total cost between any two vertices of the graph. In particular, the output of the algorithm may return an optimal path with respect to a distance (shortest path) criterion. In order to provide an optimal trade-off between the accuracy of the prescribed trajectory and the flexibility of interactive navigations, the information concerning the collision-free piecewise linear path may be subsequently combined with spline interpolation techniques that provide a smooth planar control strategy, see e.g.,  [4]. Previous attempts in this direction usually considered solutions related to classical spline methods  [5,6].

By considering interpolation schemes with tension control–see, e.g.,  [7,8] and the references therein–as a control tool on the shape of the interpolating curve, we present a two-step approach for smooth path planning with obstacle avoidance. In the first step, algorithms for the modification of the shortest piecewise linear path associated to the trapezoidal map and the visibility graph according to simple angle-based criteria are proposed and discussed. In the second step, we consider the class of curves with Pythagorean structures, because they usually provide paths with fair shape and always guarantee exact computation of fundamental geometric quantities like curvature and arc length  [9]. This can also facilitate the physical part of the motion which requires accurate arc length and curvature computations  [10].

The structure of the paper is as follows. Section  2 provides the preliminary material that introduces the problem setting and the two graph structures considered in the subsequent algorithms, namely the trapezoidal map and the visibility graph. The design of a piecewise linear collision-free path is addressed in Section  3. Different algorithms that rely on the information provided by the above mentioned data structures are presented and discussed. Section  4 provides a brief overview of Pythagorean-hodograph (PH) curves by focusing on 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      PH quintic Hermite spline interpolants with tension parameters. An asymptotic analysis that can be exploited for choosing the free parameters involved in the interpolation scheme is developed in Section  5. A final illustrative example in a non-trivial obstructed scenario is presented in Section  6. Finally, Section  7 concludes the paper.

The aim of path planning is to define a suitable collision-free path from an initial to a target position in a certain scenario that includes a set of obstacles. In robotics, the position of every point of the robot is usually defined as its configuration
                     q and depends on the specific robot model. The parameters needed to specify the robot configuration identify the degrees of freedom associated to the problem. All possible configurations define the configuration space 
                     
                        Q
                      ​(C-space) that can be divided in two subsets: 
                        
                           
                              Q
                           
                           
                              f
                              r
                              e
                              e
                           
                        
                     , the set of robot configurations free from collision with obstacles, and 
                        
                           
                              Q
                           
                           
                              o
                              b
                              s
                              t
                           
                        
                     , the obstacle configuration space given by the set of intersection configurations between the robot and any obstacle. Hence, a configuration q is just a point (or element) in the configuration space and the number of the degrees of freedom corresponds to the dimension of 
                        Q
                        [1].

Given a two- or three-dimensional rigid body and a certain scenario with a prescribed set of obstacles, we look for a smooth vector function 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                        :
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                        →
                        Q
                      so that 
                        
                           
                              
                                 r
                              
                              
                                 (
                                 0
                                 )
                              
                              =
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              
                                 r
                              
                              
                                 (
                                 1
                                 )
                              
                              =
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                              and
                              
                              
                                 r
                              
                              
                                 (
                                 t
                                 )
                              
                              ∈
                              
                                 
                                    Q
                                 
                                 
                                    f
                                    r
                                    e
                                    e
                                 
                              
                              
                              ∀
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                      correspond to the start and goal configuration, respectively. The desired path is the image in 
                        Q
                      of 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                     .

The path planning problem can be considered in a wide set of scenarios by taking into account different problem settings. In particular, we consider the simplest planar point robot problem where a circular robot of radius 
                        r
                      is moving within a certain scenario characterized by convex obstacles of polygonal shapes. Consequently, the configuration space is just obtained by augmenting the obstacle boundaries by their polygonal offset at distance 
                        r
                     . Then, after this preliminary offset computation, we can consider the robot as a moving point within a two-dimensional environment characterized by a known set of static obstacles with a fixed position. In this context, the robot follows an a priori identified path, constructed according to some off-line controller.

In order to identify a feasible path, certain navigability structures that contain information about the free configuration space are usually exploited. Several techniques to obtain different navigability structures are available. Among others, two approaches that provide alternative solutions based on suitable data structures to navigate 
                        
                           
                              Q
                           
                           
                              f
                              r
                              e
                              e
                           
                        
                      are the exact cell decomposition and roadmap methods. In the family of graphs that may be taken into account within these methods, see e.g.,  [1,11], we consider the trapezoidal map and the visibility graph.

The trapezoidal map (or trapezoidal/vertical decomposition) is a well-known example of exact cell decomposition. Given a polygonal environment, the first step is to define a bounding box that includes all obstacles. A trapezoidal map is conventionally obtained by drawing two vertical extensions (one going upwards and the other going downwards) from every vertex of the obstacles to the first intersection with an obstacle edge or to the bounding box. Once 
                        
                           
                              Q
                           
                           
                              f
                              r
                              e
                              e
                           
                        
                      is partitioned, the adjacency graph is defined by placing a node inside each trapezoid, e.g. its geometric centroid, and additional ones in the middle of the vertical extensions. An arc is then defined between two vertices of these two kinds of nodes associated to the same trapezoid. In order to construct the target path, 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                      are added to the graph by simply connecting them to the central vertices 
                        
                           
                              
                                 v
                              
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                           
                           
                              g
                           
                        
                      of the two corresponding trapezoids. Different graph search algorithms on the trapezoidal map identify admissible collision-free paths between 
                        
                           
                              
                                 v
                              
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                           
                           
                              g
                           
                        
                     . An example of trapezoidal map is shown in Fig. 1
                     (top).

The visibility graph is a widely known roadmap method in computational geometry. Given a set of polygonal obstacles in the plane, the nodes of the visibility graph correspond to the vertices of each polygon. An arc between two vertices belongs to the graph if the linear segment that connects these vertices does not intersect any obstacle. To complete the roadmap, the start and target positions are added to the set of graph nodes together with the corresponding arcs. The naive algorithm to compute the visibility graph has complexity 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 3
                              
                           
                           )
                        
                     , where 
                        n
                      is the number of nodes in the graph. By considering a suitable sweep approach with balanced search tree structures the complexity can be reduced to 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           log
                           n
                           )
                        
                        [11]. Fig. 1 (bottom) shows the visibility graph associated to a simple scenario. Other examples of roadmap methods include Voronoi diagrams and silhouette graphs.

In order to define a smooth path that does not intersect any obstacle, we consider two consecutive steps. In the first phase, we rely on one of the two data structures introduced in the previous section to define a suitable collision-free piecewise linear path. Subsequently, the smooth path is obtained by interpolating the vertices of the piecewise linear path previously computed, as described in Section  4.

Classical graph search algorithms can be used either on the trapezoidal map or the visibility graph to identify admissible paths that do not intersect any obstacles in the first step of the method. A standard choice relies on the Dijkstra’s algorithm that computes the shortest path between two vertices of a given graph  [12]. Note that the shortest path associated to the visibility graph is the absolute shortest path from the start to the goal position with respect to the considered scenario, see e.g.,  [11].

In order to obtain a final path defined by a curve without significant curvature peaks, the identification of suitable piecewise linear paths with a small angle between two adjacent segments is required in the first step of the method.
                        1
                     
                     
                        1
                        Not oriented convex angles measured in degrees are used in the first step of our method.
                      For this reason, we introduce three algorithms to define different variants of the shortest path algorithm. The first one is related to the trapezoidal map, while the remaining two are applied on the visibility graph.

For the first variant, we consider the trapezoidal decomposition defined on a given polygonal environment. As shown in Fig. 2
                     (top), the shortest path related to the graph defining the trapezoidal map may easily be characterized by several angle variations, even for relatively simple configurations. In order to identify a more suitable path, we delete a series of unnecessary vertices by applying several refinement steps to the initial shortest path. The procedure to define the modified trapezoidal map shortest path (MTMSP) is detailed in the Appendix, Algorithm 1. The result obtained with Algorithm 1 by considering the trapezoidal map related to scenario S1 of Fig. 1 is shown in Fig. 2(bottom).

The second algorithm relies on the visibility graph defined on a given polygonal environment. The path is initialized with the shortest path connecting the start to the goal positions, 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      and 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                     , see Fig. 3
                     (top) for an example. In order to control the angles on the path without increasing too much its length, we perform an iterative check on the angles between successive edges 
                        
                           
                              e
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              e
                           
                           
                              2
                           
                        
                      of the current path. By moving in the direction from 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      to 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                     , the vertices of the current path are processed. When an angle greater than a given threshold is found on a vertex 
                        C
                     , the edges connecting 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      to 
                        C
                     , as well as 
                        
                           
                              e
                           
                           
                              2
                           
                        
                     , are temporary removed from the list of edges of the visibility graph. The shortest path connecting 
                        C
                      to 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                      on the modified visibility graph is then computed, if possible. The current path is updated only if the angle with vertex in 
                        C
                      between 
                        
                           
                              e
                           
                           
                              1
                           
                        
                      and the first edge of the new path is smaller than the given threshold. Otherwise the path is not updated and the next vertex along the path is processed. Algorithm 2 in the Appendix introduces this procedure which defines the modified visibility graph shortest path (MVGSP). The result obtained with Algorithm 2 by considering the visibility graph related to scenario S1 is shown in Fig. 3(bottom).

By considering again the visibility graph, we may also apply a greedy approach to compute a path from 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      to 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                      that does not present angles of significative amplitude between adjacent edges. By starting from an initial segment, that can be for example the first edge along the shortest path, the path can be iteratively constructed by subsequently choosing the next edge in the visibility graph with the minimum angle that satisfies a certain threshold. If at a certain step, there are no edges adjacent to the current one satisfying the chosen threshold, the algorithm goes backward by looking for alternative solutions, if possible (this clearly depends on the given angle threshold). The procedure to define the greedy visibility graph path (GVGP) is detailed in the Appendix, Algorithm 3. The result obtained with Algorithm 3 by considering the visibility graph related to scenario S1 of Fig. 1 is shown on the bottom of Fig. 3. Note that the paths obtained with Algorithms 2 and 3 are coincident for this test case.

The comparison of shortest paths related to the trapezoidal map and to the visibility graph (TMSP and VGSP) for scenario S1, together with the modified version computed with Algorithms 1, 2, and 3 (MTMSP, MVGSP/GVGP) is presented in Table 1
                     . The number of points (
                        #
                      points) along the different paths as well as their lengths (length) are quite similar for the different solutions. The only exception is the shortest path on the trapezoidal map, which necessarily requires suitable modifications, see also Fig. 2. By also looking at the minimum, maximum and average angle (
                        
                           
                              α
                           
                           
                              
                                 min
                              
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              
                                 max
                              
                           
                        
                     , 
                        
                           
                              α
                           
                           
                              avg
                           
                        
                     ) along the paths, we can see how the modified versions are able to produce 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      paths with better shapes.

The piecewise linear admissible 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      path is used in the second step of the method to define an admissible smooth 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      path that also connects 
                        
                           
                              
                                 q
                              
                           
                           
                              s
                           
                        
                      to 
                        
                           
                              
                                 q
                              
                           
                           
                              g
                           
                        
                     . In order to guarantee a strong relation between 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              1
                           
                        
                     , we rely on interpolation schemes with tension control, see e.g.,  [7]. The smooth 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      path is then the image of a parametric curve 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                        ,
                        t
                        ∈
                        
                           [
                           0
                           
                           ,
                           
                           1
                           ]
                        
                     , interpolating the vertices 
                        
                           
                              
                                 p
                              
                           
                           
                              k
                           
                        
                     , 
                        k
                        =
                        0
                        ,
                        …
                        ,
                        n
                     , that define 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      and suitable tension parameters are used for ensuring that 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                      is sufficiently “close” to 
                        
                           
                              P
                           
                           
                              1
                           
                        
                     . This guarantees that the smooth interpolant also defines a collision-free path. In particular, we require that 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                      is a quintic spline curve such that 
                        
                           
                              
                                 r
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                              k
                              =
                              0
                              ,
                              …
                              ,
                              n
                              ,
                           
                        
                      where the interpolation parameters 
                        
                           
                              t
                           
                           
                              k
                           
                        
                        ,
                        k
                        =
                        0
                        ,
                        …
                        ,
                        n
                     , with 
                        0
                        =
                        
                           
                              t
                           
                           
                              0
                           
                        
                        <
                        ⋯
                        <
                        
                           
                              t
                           
                           
                              n
                           
                        
                        =
                        1
                     , also define the spline knots (for the experiments they have always been chosen using the standard chord length parameterization).

In addition, we require that, for all 
                        k
                        =
                        1
                        ,
                        …
                        ,
                        n
                     , the restriction 
                        
                           
                              
                                 r
                              
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                        =
                        
                           (
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           
                              (
                              t
                              )
                           
                           ,
                           
                              
                                 y
                              
                              
                                 k
                              
                           
                           
                              (
                              t
                              )
                           
                           )
                        
                      of 
                        
                           r
                        
                        
                           (
                           t
                           )
                        
                      to 
                        
                           [
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           
                           ,
                           
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           ]
                        
                      has a Pythagorean-hodograph (PH) structure  [9], namely 
                        
                           (1)
                           
                              
                                 
                                    
                                       |
                                       
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             k
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                       |
                                    
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                    2
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                    2
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                        
                      for some polynomial 
                        
                           
                              λ
                           
                           
                              k
                           
                        
                        
                           (
                           t
                           )
                        
                     . The Pythagorean condition (1) ensures: polynomial arc-length; rational unit tangent, normal unit vector, and signed curvature; rational offset curves; closed-form expression for the bending energy  [13]. According to the result of Kubota  [14] and following the complex notation introduced in  [15], the PH condition is equivalent to the requirement that the hodograph 
                        
                           
                              
                                 r
                              
                           
                           
                              k
                           
                           
                              ′
                           
                        
                        
                           (
                           τ
                           )
                        
                      can be expressed in terms of the square of the complex polynomial 
                        
                           
                              
                                 w
                              
                           
                           
                              k
                           
                        
                        
                           (
                           τ
                           )
                        
                        =
                        
                           
                              u
                           
                           
                              k
                           
                        
                        
                           (
                           τ
                           )
                        
                        +
                        i
                        
                        
                           
                              v
                           
                           
                              k
                           
                        
                        
                           (
                           τ
                           )
                        
                      as follows 
                        
                           
                              
                                 
                                    
                                       r
                                    
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 τ
                                 )
                              
                              =
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 τ
                                 )
                              
                              
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 τ
                                 )
                              
                              =
                              
                              
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                              
                                 (
                                 τ
                                 )
                              
                              
                                 [
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 −
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 +
                                 i
                                 
                                 2
                                 
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    τ
                                    )
                                 
                                 ]
                              
                              ,
                           
                        
                      where 
                        
                           
                              h
                           
                           
                              k
                           
                        
                        
                           (
                           τ
                           )
                        
                      is a real polynomial and 
                        τ
                        =
                        
                           (
                           t
                           −
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           )
                        
                        /
                        
                           (
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           )
                        
                     .

We summarize the local 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         interpolation scheme based on PH quintic splines with tension, originally introduced in  [8] and here adopted for our second step. This scheme is a variant of the 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         PH quintic Hermite interpolation scheme introduced in  [16], whose approximation power was studied in  [17].

We adopt the following local representation in Bézier form of the 
                           k
                        -th quintic spline segment 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 k
                              
                           
                         of 
                           
                              r
                           
                        ,
                           
                              (2)
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       k
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       5
                                    
                                 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                    
                                       5
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                          −
                                          
                                             
                                                t
                                             
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 t
                                 ∈
                                 
                                    [
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         for 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           n
                        , where 
                           
                              
                                 ℓ
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 b
                              
                              
                                 j
                              
                              
                                 5
                              
                           
                        , 
                           j
                           =
                           0
                           ,
                           …
                           ,
                           5
                        , are the Bernstein polynomials of degree five. Since 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 k
                              
                           
                         is required to have a PH structure, the Bézier control points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 k
                                 ,
                                 j
                              
                           
                           ,
                           j
                           =
                           0
                           ,
                           …
                           ,
                           5
                        , can be defined in terms of three complex numbers, 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    z
                                 
                              
                              
                                 k
                              
                           
                         and of the two assigned points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         (also interpreted as complex numbers), 
                           
                              
                                 (3)
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          0
                                       
                                    
                                    ,
                                    =
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          1
                                       
                                    
                                    =
                                    
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          5
                                       
                                    
                                    
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          2
                                       
                                    
                                    =
                                    
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          5
                                       
                                    
                                    
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             z
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          3
                                       
                                    
                                    =
                                    
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          4
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          5
                                       
                                    
                                    
                                    
                                       
                                          
                                             z
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          4
                                       
                                    
                                    =
                                    
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          5
                                       
                                    
                                    −
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          5
                                       
                                    
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          k
                                          ,
                                          5
                                       
                                    
                                    =
                                    
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          k
                                       
                                    
                                    .
                                 
                              
                           
                         This definition of the control points immediately ensures the required interpolation of 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         at 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                        , respectively. It also ensures that 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 k
                              
                              
                                 ′
                              
                           
                           
                              (
                              τ
                              )
                           
                           =
                           
                              
                                 
                                    w
                                 
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                              (
                              τ
                              )
                           
                        , where 
                           τ
                           =
                           
                              (
                              t
                              −
                              
                                 
                                    t
                                 
                                 
                                    k
                                    −
                                    1
                                 
                              
                              )
                           
                           /
                           
                              
                                 ℓ
                              
                              
                                 k
                              
                           
                         is the local parameter in 
                           
                              [
                              0
                              ,
                              
                              1
                              ]
                           
                        , and 
                           
                              
                                 
                                    w
                                 
                              
                              
                                 k
                              
                           
                           
                              (
                              τ
                              )
                           
                           =
                           
                              
                                 
                                    u
                                 
                              
                              
                                 k
                              
                           
                           
                              
                                 b
                              
                              
                                 0
                              
                              
                                 2
                              
                           
                           
                              (
                              τ
                              )
                           
                           +
                           
                              
                                 
                                    z
                                 
                              
                              
                                 k
                              
                           
                           
                              
                                 b
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              (
                              τ
                              )
                           
                           +
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                           
                           
                              
                                 b
                              
                              
                                 2
                              
                              
                                 2
                              
                           
                           
                              (
                              τ
                              )
                           
                        , if the following quadratic equation is fulfilled, 
                           
                              (4)
                              
                                 2
                                 
                                    
                                       
                                          z
                                       
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 3
                                 
                                    (
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                 
                                    
                                       
                                          z
                                       
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    (
                                    3
                                    
                                       (
                                       
                                          
                                             
                                                u
                                             
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             
                                                v
                                             
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          
                                             u
                                          
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          15
                                       
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    Δ
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    0
                                 
                                 .
                              
                           
                         In order to obtain a 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         Hermite PH spline interpolation scheme, the coefficients 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                           
                         are previously determined by imposing two additional end conditions on the hodograph, namely 
                           
                              (5)
                              
                                 
                                    
                                       d
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       d
                                       
                                          
                                             
                                                r
                                             
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       d
                                       t
                                    
                                 
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         Here 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                              
                           
                         are given unit vectors specifying the direction of the tangent to the curve at 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and at 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 k
                              
                           
                        , respectively, while 
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                         together with 
                           
                              
                                 σ
                              
                              
                                 k
                              
                           
                         are free positive parameters which are used to modify the shape of the 
                           k
                        -th PH quintic segment. In particular, the coefficients 
                           
                              
                                 c
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 d
                              
                              
                                 k
                              
                           
                         are selected following the strategy introduced in  [7, Section 8], while 
                           
                              
                                 σ
                              
                              
                                 k
                              
                           
                           ≤
                           1
                         is used as a tension parameter.

By using a local reference system with the 
                           x
                         axis aligned with the displacement 
                           Δ
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                           −
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                        , the unit tangents can be expressed in complex form as 
                           
                              (6)
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 =
                                 exp
                                 
                                    (
                                    i
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          −
                                          1
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 exp
                                 
                                    (
                                    i
                                    
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                       
                                          
                                             (
                                             k
                                             )
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 θ
                              
                              
                                 k
                                 −
                                 1
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           
                           
                              
                                 θ
                              
                              
                                 k
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ∈
                           
                              (
                              −
                              π
                              ,
                              
                              π
                              ]
                           
                        . Note that several approaches can be used for the definition of these unit tangents (see Remark 1) but most formulas ensure that for reasonable data 
                           
                              
                                 θ
                              
                              
                                 k
                                 −
                                 1
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ,
                           
                           
                              
                                 θ
                              
                              
                                 k
                              
                              
                                 
                                    (
                                    k
                                    )
                                 
                              
                           
                           ∈
                           
                              (
                              −
                              π
                              /
                              2
                              ,
                              
                              π
                              /
                              2
                              ]
                           
                         for every 
                           k
                        -th spline segment. In view of the derivative formula of Bézier curves, the two conditions in (5) correspond to 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 σ
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 σ
                              
                              
                                 k
                              
                              
                                 2
                              
                           
                           
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                              
                           
                        , and consequently 
                           
                              (7)
                              
                                 
                                    
                                       
                                          u
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                 exp
                                 
                                    (
                                    i
                                    
                                    
                                       
                                          α
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          v
                                       
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                 
                                 
                                 exp
                                 
                                    (
                                    i
                                    
                                    
                                       
                                          β
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where the angles 
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 β
                              
                              
                                 k
                              
                           
                         can assume two different values, 
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           ∈
                           
                              {
                              
                                 
                                    θ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              /
                              2
                              ,
                              
                              π
                              +
                              
                                 
                                    θ
                                 
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              /
                              2
                              }
                           
                         and 
                           
                              
                                 β
                              
                              
                                 k
                              
                           
                           ∈
                           
                              {
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              /
                              2
                              ,
                              π
                              +
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              /
                              2
                              }
                           
                        .

If 
                           
                              (
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       z
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is a solution of (4) and (7), 
                           
                              (
                              −
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              −
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              −
                              
                                 
                                    
                                       z
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         is also another solution that corresponds to the same control points in (3). This implies that there are only four distinct triples 
                           
                              (
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       v
                                    
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    
                                       z
                                    
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         solving both (4) and (7) which correspond to as many different 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 k
                              
                           
                         obtainable with this scheme  [16]. Thus, considering that the shapes of these four distinct alternatives can be very different and that the problem concerns each spline segment, an automatic strategy to select a reasonable 
                           
                              
                                 
                                    r
                                 
                              
                              
                                 k
                              
                           
                         is necessary. In particular, we choose 
                           
                              (8)
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       β
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         because this selection ensures that when 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                              
                              
                                 k
                              
                           
                         have a positive projection on 
                           Δ
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                        , this is also true for 
                           
                              
                                 
                                    u
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    v
                                 
                              
                              
                                 k
                              
                           
                        . In addition, the solution 
                           
                              
                                 
                                    z
                                 
                              
                              
                                 k
                              
                           
                         of (4) with maximal real part is chosen.


                        
                           Remark 1
                           For specifying the unit tangents 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                              , we have considered two different approaches. The first one (T1) corresponds to the definition introduced in  [7], namely 
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             +
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      k
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         k
                                                         −
                                                         1
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                
                                                |
                                             
                                          
                                       
                                       ,
                                    
                                 
                               for 
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 −
                                 1
                               and
                              
                                 2
                              
                              
                                 2
                                 Two additional “phantom” points are considered to properly define 
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             n
                                          
                                       
                                    .
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      1
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                +
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                |
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                T
                                             
                                          
                                          
                                             n
                                          
                                       
                                       =
                                       
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      n
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   n
                                                
                                             
                                             +
                                             
                                                |
                                                
                                                   
                                                      κ
                                                   
                                                   
                                                      n
                                                      −
                                                      1
                                                   
                                                
                                                |
                                             
                                             Δ
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                |
                                                
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                +
                                                
                                                   |
                                                   
                                                      
                                                         κ
                                                      
                                                      
                                                         n
                                                         −
                                                         1
                                                      
                                                   
                                                   |
                                                
                                                Δ
                                                
                                                   
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                
                                                |
                                             
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       κ
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 Δ
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       ,
                                       x
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       +
                                       1
                                       ,
                                       y
                                    
                                 
                                 −
                                 Δ
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       ,
                                       y
                                    
                                 
                                 
                                 Δ
                                 
                                    
                                       p
                                    
                                    
                                       k
                                       +
                                       1
                                       ,
                                       x
                                    
                                 
                              .

The second one (T2) is obtained by firstly using the algorithm described in  [18] to compute the 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               PH spline interpolant to the set of points 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       n
                                    
                                 
                               and then defining the 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 n
                               as its unit tangents at the knots. Note that, even if this method is more expensive, it often allows us to obtain smoother paths.

To ensure the property of obstacle avoidance to the final 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         path, we require that each spline segment belongs to a certain convex admissible region associated with the corresponding displacement. The admissible region is either a triangle, a trapezoid or a parallelogram included in 
                           
                              
                                 Q
                              
                              
                                 f
                                 r
                                 e
                                 e
                              
                           
                         with an edge coincident with the displacement. In order to identify a region of the free configuration space where the smooth 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         path can lie without intersecting any obstacle, the midpoint of the segment connecting 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is inserted as additional interpolation point with knot 
                           
                              (
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              +
                              
                                 
                                    t
                                 
                                 
                                    k
                                    +
                                    1
                                 
                              
                              )
                           
                           /
                           2
                        , whenever the polyline 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         suggests an inflection point along 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        .
                           3
                        
                        
                           3
                           If 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       k
                                    
                                 
                               is one of these additional points, the corresponding unit tangent required by the 
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                               interpolation scheme is defined by applying a small rotation to 
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                               to obtain the desired change of sign in the curvature.
                         Consequently, the number of spline segments can increase from 
                           n
                         to 
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                           ≥
                           n
                        .

For any edge 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         between 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           ,
                           
                           k
                           =
                           0
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 e
                              
                           
                           −
                           1
                        , we consider the extensions of 
                           
                              
                                 e
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        , starting from 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                        , respectively.
                           4
                        
                        
                           4
                           For the first and last edge the left and right extensions are defined as the half line orthogonal to the edge with origin in the first and last point of 
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                               respectively, see Fig. 4(top left).
                         If 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 −
                                 1
                              
                           
                        , and 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         are aligned, the left extension for 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         and the right one for 
                           
                              
                                 e
                              
                              
                                 k
                                 −
                                 1
                              
                           
                         are both defined as the straight line with origin in 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 k
                              
                           
                         orthogonal to 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                        , as shown in Fig. 4
                        . If the two extensions related to 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         intersect and generate with 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         a triangle included in 
                           
                              
                                 Q
                              
                              
                                 f
                                 r
                                 e
                                 e
                              
                           
                        , this triangle defines the admissible region associated with 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                        . Otherwise, the admissible region 
                           
                              
                                 R
                              
                              
                                 k
                              
                           
                         related to 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         is defined as the highest trapezoid or parallelogram included in 
                           
                              
                                 Q
                              
                              
                                 f
                                 r
                                 e
                                 e
                              
                           
                         with a basis coincident with 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         and the other two opposite edges on the extensions. The complete set of possible cases related to a certain segment is shown in Fig. 4. The three plots on the left of the figure show the triangular cases. However, the shape of the admissible region may be determined by the intersection (if any) of the lateral extensions with either the bounding box of the scenario or one (or more) obstacles (see the three plots on the right in Fig. 4). In this case, one edge of the convex polygon that determines the region is the segment parallel to 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         through the aforementioned intersection points with extrema at the intersections with the left and right extension.

The pictures on the left in Figs. 5–7
                        
                        
                         show in grey the admissible regions associated with the three polylines MTMP, VGSP, MVGSP/GVGP for the simple scenario S1 introduced in Fig. 1. The height 
                           
                              
                                 H
                              
                              
                                 k
                              
                           
                         of the admissible region related to 
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                         is then suitably taken into account to determine the value of the corresponding tension parameter 
                           
                              
                                 σ
                              
                              
                                 k
                              
                           
                        , see Section  5.

The results related to the final 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         paths produced by our approach for the simple scenario S1 are presented in Figs. 5–7and Table 2
                        . Fig. 5 shows the 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         paths obtained when 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         is the modified trapezoidal map shortest path (MTMSP) shown in Fig. 2(bottom). The paths corresponding to the T1 and T2 choice for the unit tangents are shown, see Remark 1. The corresponding total arc lengths are given in the first column of Table 2. The related curvature plots are also shown in Fig. 5. Note how the T2 choice is able to reduce the curvature extrema of the corresponding interpolant. Analogously, Figs. 6 and 7 shows the 
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                         paths obtained from the 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         paths generated with the VGSP and MVGSP/GVGP algorithms, previously shown in Fig. 3, with the T1 and T2 choice for the unit tangents, respectively. The corresponding total arc lengths are reported in the last two columns of Table 2. As in the previous case, the curvature plots of the paths obtained using T2 exhibit smaller variations with respect to those constructed using the T1 alternative—see the plots on the right of these two figures.

For comparison, Figs. 8–10
                        
                        
                         show the results obtained by considering the different piecewise linear solutions together with cubic 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                         splines according to the choice of T1 and T2 unit tangents. The values of the tension parameters are chosen as in the corresponding PH quintic solution related to the same piecewise linear path and shown in Figs. 5–7. We may note that PH splines exhibit a smaller curvature range, a benefit from the fairness point of view, in all test cases.

In this section we first introduce an asymptotic analysis of the expression of the local control polygon 
                        
                           
                              
                                 q
                              
                           
                           
                              k
                              ,
                              j
                           
                        
                        ,
                        j
                        =
                        0
                        ,
                        …
                        ,
                        5
                     , associated with the 
                        k
                     -th PH spline segment 
                        
                           
                              
                                 r
                              
                           
                           
                              k
                           
                        
                      defined in Section  4.1. The analysis, developed through a preliminary proposition followed by a main theorem, shows that, when the tension parameter 
                        
                           
                              σ
                           
                           
                              k
                           
                        
                      is small enough, 
                        
                           
                              
                                 r
                              
                           
                           
                              k
                           
                        
                      belongs to the corresponding convex admissible region 
                        
                           
                              R
                           
                           
                              k
                           
                        
                     , and consequently to the free configuration space. Subsequently, we introduce an automatic strategy based on this analysis for a suitable selection of the tension parameter 
                        
                           
                              σ
                           
                           
                              k
                           
                        
                     .

Since we are focusing on a generic PH spline segment, we omit in the following the 
                           k
                         subscript from the notation. Furthermore, by choosing the local coordinate system already used in (6) to represent the unit tangents, we can also assume without loss of generality 
                           
                              (9)
                              
                                 Δ
                                 
                                    p
                                 
                                 =
                                 m
                                 
                                 exp
                                 
                                    (
                                    i
                                    
                                    0
                                    )
                                 
                                 ,
                              
                           
                         where 
                           m
                           >
                           0
                         denotes the modulus of the displacement. Now from (7) we have that 
                           
                              (10)
                              
                                 
                                    u
                                 
                                 =
                                 σ
                                 
                                 c
                                 
                                 exp
                                 
                                    (
                                    i
                                    
                                    α
                                    )
                                 
                                 ,
                                 
                                 
                                    v
                                 
                                 =
                                 σ
                                 
                                 d
                                 
                                 exp
                                 
                                    (
                                    i
                                    
                                    β
                                    )
                                 
                                 ,
                              
                           
                         where 
                           c
                           ,
                           d
                         are fixed positive quantities and 
                           α
                         and 
                           β
                         are fixed angles in 
                           
                              (
                              −
                              π
                              /
                              2
                              ,
                              
                              π
                              /
                              2
                              ]
                           
                        , all not depending on 
                           σ
                         (see Section  4.1). The other complex quantity which is necessary to define the control polygon is 
                           
                              z
                           
                         and it is defined as the solution with maximal real part of the quadratic equation given in (4). The following proposition gives the Taylor expansion of 
                           γ
                           =
                           γ
                           
                              (
                              σ
                              )
                           
                         and 
                           ϕ
                           =
                           ϕ
                           
                              (
                              σ
                              )
                           
                        , where 
                           
                              (11)
                              
                                 
                                    z
                                 
                                 =
                                 γ
                                 exp
                                 
                                    (
                                    i
                                    
                                    ϕ
                                    )
                                 
                                 ,
                              
                           
                         with 
                           γ
                           ∈
                           R
                         and 
                           ϕ
                           ∈
                           
                              (
                              −
                              π
                              /
                              2
                              ,
                              
                              π
                              /
                              2
                              ]
                           
                        .


                        
                           Proposition 1
                           
                              The angle 
                              
                                 ϕ
                                 =
                                 ϕ
                                 
                                    (
                                    σ
                                    )
                                 
                               
                              and the scalar 
                              
                                 γ
                                 =
                                 γ
                                 
                                    (
                                    σ
                                    )
                                 
                               
                              defining the polar form of 
                              
                                 
                                    z
                                 
                               
                              as in   (11)   have the following Taylor expansions
                              
                                 
                                    (12)
                                    
                                       ϕ
                                       
                                          (
                                          σ
                                          )
                                       
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       σ
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             f
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                              and
                              
                                 
                                    (13)
                                    
                                       γ
                                       
                                          (
                                          σ
                                          )
                                       
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       σ
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where
                              
                                 
                                    (14)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                0
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                −
                                                
                                                   
                                                      3
                                                      b
                                                   
                                                   
                                                      
                                                         
                                                            8
                                                            q
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      q
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      
                                                         
                                                            8
                                                            q
                                                         
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      4
                                                   
                                                
                                                a
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      3
                                                      b
                                                   
                                                
                                                ,
                                                
                                                
                                                   if   
                                                b
                                                ≠
                                                0
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              with
                              
                                 
                                    (15)
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   a
                                                   =
                                                   c
                                                   cos
                                                   α
                                                   +
                                                   d
                                                   cos
                                                   β
                                                   ,
                                                
                                             
                                             
                                                
                                                   b
                                                   =
                                                   c
                                                   sin
                                                   α
                                                   +
                                                   d
                                                   sin
                                                   β
                                                   ,
                                                
                                             
                                             
                                                
                                                   p
                                                   =
                                                   3
                                                   
                                                      (
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      sin
                                                      2
                                                      α
                                                      +
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      sin
                                                      2
                                                      β
                                                      )
                                                   
                                                   +
                                                   c
                                                   d
                                                   sin
                                                   
                                                      (
                                                      α
                                                      +
                                                      β
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   q
                                                   =
                                                   
                                                      
                                                         15
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   m
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           The complex Eq. (4) can be rewritten as the following (nonlinear) system in the real unknowns 
                                 γ
                               and 
                                 ϕ
                              , defined by two scalar equations that correspond to the real and the imaginary part of (4), 
                                 
                                    (16)
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   γ
                                                   +
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                   γ
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                               where 
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                2
                                                cos
                                                2
                                                ϕ
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      Re
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      +
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   cos
                                                   ϕ
                                                   −
                                                   
                                                      Im
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      +
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   sin
                                                   ϕ
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                3
                                                
                                                σ
                                                
                                                   [
                                                   a
                                                   cos
                                                   ϕ
                                                   −
                                                   b
                                                   sin
                                                   ϕ
                                                   ]
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   (
                                                   3
                                                   
                                                      Re
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Re
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         15
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   m
                                                   )
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                e
                                                −
                                                q
                                                ,
                                             
                                          
                                       
                                    
                                 
                               with 
                                 e
                                 =
                                 3
                                 
                                    (
                                    
                                       
                                          c
                                       
                                       
                                          2
                                       
                                    
                                    cos
                                    2
                                    α
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          2
                                       
                                    
                                    cos
                                    2
                                    β
                                    )
                                 
                                 +
                                 c
                                 d
                                 cos
                                 
                                    (
                                    α
                                    +
                                    β
                                    )
                                 
                              , and 
                                 
                                    (18)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                2
                                                sin
                                                2
                                                ϕ
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      Im
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      +
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   cos
                                                   ϕ
                                                   +
                                                   
                                                      Re
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      +
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   sin
                                                   ϕ
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                3
                                                
                                                σ
                                                
                                                   [
                                                   b
                                                   cos
                                                   ϕ
                                                   +
                                                   a
                                                   sin
                                                   ϕ
                                                   ]
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   (
                                                   3
                                                   
                                                      Im
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               v
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   
                                                      Im
                                                   
                                                   
                                                   
                                                   
                                                      (
                                                      
                                                         u
                                                      
                                                      
                                                         v
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                p
                                                .
                                             
                                          
                                       
                                    
                                 
                               Note that, when 
                                 σ
                               vanishes, we have 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                               and 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 −
                                 q
                              . From the second equation in (16), we deduce that 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                               must vanish, namely 
                                 ϕ
                                 =
                                 0
                               or 
                                 ϕ
                                 =
                                 π
                                 /
                                 2
                              . However, in order to get a real value for 
                                 γ
                               from the first equation in (16), only 
                                 ϕ
                                 =
                                 0
                               is acceptable which implies that 
                                 
                                    
                                       f
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                               in (12). In addition, since we select the solution of (4) with maximal real part, we have 
                                 
                                    (19)
                                    
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       γ
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               with 
                                 q
                               defined as in (15). In order to compute the other Taylor coefficients in (12), we use the resultant method  [19] from which we derive that 
                                 γ
                               is a real solution of the system in (16) if and only if the Sylvester matrix 
                                 
                                    
                                       A
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                    
                                 
                               is singular and in such case it can be expressed as follows, 
                                 
                                    (20)
                                    
                                       γ
                                       
                                          (
                                          σ
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Hence, we have to require that 
                                 det
                                 
                                    (
                                    A
                                    )
                                 
                               vanishes, that is 
                                 
                                    (21)
                                    
                                       0
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       
                                       +
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ]
                                       
                                       .
                                    
                                 
                               Now, from the Taylor expansion of 
                                 ϕ
                                 
                                    (
                                    σ
                                    )
                                 
                               in (12) we have 
                                 
                                    (22)
                                    
                                       
                                          
                                             
                                                sin
                                                ϕ
                                                =
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                σ
                                                
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                cos
                                                ϕ
                                                =
                                                
                                                1
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                sin
                                                2
                                                ϕ
                                                =
                                                
                                                2
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                σ
                                                
                                                +
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                cos
                                                2
                                                ϕ
                                                =
                                                
                                                1
                                                −
                                                2
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                               From (17) and (18), we can then obtain the following expansions for 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                              ,
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                2
                                                −
                                                4
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                3
                                                a
                                                
                                                σ
                                                −
                                                3
                                                b
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                e
                                                −
                                                
                                                q
                                                ,
                                             
                                          
                                       
                                    
                                 
                               and 
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                              ,
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                4
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                σ
                                                
                                                +
                                                2
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                3
                                                b
                                                
                                                σ
                                                +
                                                3
                                                a
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                O
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                p
                                                ,
                                             
                                          
                                       
                                    
                                 
                               respectively. Thus, with some computation, we can rewrite the equation in (21) as follows, 
                                 
                                    
                                       2
                                       q
                                       
                                          (
                                          −
                                          9
                                          
                                             
                                                b
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          8
                                          q
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       16
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       q
                                       
                                       
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                2
                                             
                                          
                                          q
                                          +
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                          
                                          p
                                          )
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                               which implies that 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                               in (12) are defined as in (14), unless for the sign uncertainty in the 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               formula. By using (24) to compute the first order expansion for 
                                 γ
                                 =
                                 γ
                                 
                                    (
                                    σ
                                    )
                                 
                               defined in (20), when 
                                 b
                                 ≠
                                 0
                               we get 
                                 
                                    (25)
                                    
                                       γ
                                       
                                          (
                                          σ
                                          )
                                       
                                       =
                                       −
                                       
                                          
                                             2
                                             q
                                          
                                          
                                             3
                                             b
                                          
                                       
                                       
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          (
                                          
                                             
                                                2
                                                a
                                                q
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                3
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      2
                                                   
                                                
                                                q
                                                +
                                                p
                                             
                                             
                                                3
                                                b
                                             
                                          
                                          )
                                       
                                       
                                       σ
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                               Note that this confirms that the sign of 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               has to be fixed as in (14), since we already know that 
                                 γ
                                 
                                    (
                                    0
                                    )
                                 
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              . Furthermore, by replacing the selected expressions of 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                               in (25), we get the expression of 
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                               reported in (14) when 
                                 b
                                 ≠
                                 0
                              .■


                        
                           Theorem 1
                           
                              If both the unit tangents 
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 k
                                 −
                                 1
                                 ,
                                 k
                               
                              can be expressed as a linear combination of 
                              
                                 Δ
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       j
                                    
                                 
                               
                              and 
                              
                                 Δ
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       j
                                       +
                                       1
                                    
                                 
                               
                              with nonnegative coefficients,
                              
                                 5
                              
                              
                                 5
                                 For the first and last segments we assume that two suitable phantom points are fixed to define 
                                       Δ
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             0
                                          
                                       
                                     and 
                                       Δ
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    .
                              
                              when the tension parameter 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                 
                               
                              is small enough, the PH spline segment 
                              
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       k
                                    
                                 
                               
                              belongs to the corresponding convex admissible region 
                              
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                               
                              and, consequently, to the free configuration space.
                           


                        
                           Proof
                           Since 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       k
                                       ,
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       k
                                       −
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       k
                                       ,
                                       5
                                    
                                 
                                 =
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       k
                                    
                                 
                              , being 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                               the convex admissible region defined as specified in the previous section, we need to check that for a sufficiently small value of 
                                 
                                    
                                       σ
                                    
                                    
                                       k
                                    
                                 
                               all the other control points 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       k
                                       ,
                                       j
                                    
                                 
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 4
                               belong to 
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                               (in view of the convex hull property of Bézier curves, this also implies 
                                 
                                    
                                       
                                          r
                                       
                                    
                                    
                                       k
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       k
                                    
                                 
                              ). We again omit the 
                                 k
                               subscript from the notation and we consider the local coordinate system already used in (6) to represent the unit tangents. This also implies, without loss of generality, that 
                                 Δ
                                 
                                    p
                                 
                               can be assumed as in (9).

By using (10), (11) and the expansions in (12)–(14) and (22), from (3) the following expressions of the control polygon legs can be derived, 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             5
                                          
                                       
                                       
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       
                                       exp
                                       
                                          (
                                          i
                                          
                                          2
                                          α
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             5
                                          
                                       
                                       
                                       c
                                       
                                       σ
                                       
                                          [
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             cos
                                             α
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cos
                                                α
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                sin
                                                α
                                                )
                                             
                                             
                                             σ
                                             )
                                          
                                          
                                          +
                                          i
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             sin
                                             α
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                sin
                                                α
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                cos
                                                α
                                                )
                                             
                                             
                                             σ
                                             )
                                          
                                          ]
                                       
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             5
                                          
                                       
                                       
                                       d
                                       
                                       σ
                                       
                                          [
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             cos
                                             β
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                cos
                                                β
                                                −
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                sin
                                                β
                                                )
                                             
                                             
                                             σ
                                             )
                                          
                                          
                                          −
                                          i
                                          
                                          
                                             (
                                             
                                                
                                                   g
                                                
                                                
                                                   0
                                                
                                             
                                             sin
                                             β
                                             
                                             +
                                             
                                                (
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      1
                                                   
                                                
                                                sin
                                                β
                                                +
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                cos
                                                β
                                                )
                                             
                                             
                                             σ
                                             )
                                          
                                          
                                          ]
                                       
                                       +
                                       O
                                       
                                          (
                                          
                                             
                                                σ
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          (
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                5
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                4
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             5
                                          
                                       
                                       
                                       
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       
                                       exp
                                       
                                          (
                                          i
                                          
                                          2
                                          β
                                          )
                                       
                                       ,
                                    
                                 
                               which immediately imply that 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 Δ
                                 
                                    p
                                 
                                 +
                                 O
                                 
                                    (
                                    σ
                                    )
                                 
                              . Considering that 
                                 exp
                                 
                                    (
                                    i
                                    
                                    2
                                    α
                                    )
                                 
                               and 
                                 exp
                                 
                                    (
                                    i
                                    
                                    2
                                    β
                                    )
                                 
                               are aligned with the left and right unit tangents, respectively, and taking into account the definition of the convex admissible region 
                                 R
                              , thanks to the hypothesis on the unit tangents orientation, from the first and last of these relations we can derive that for 
                                 σ
                               sufficiently small both 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       1
                                    
                                 
                               and 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       4
                                    
                                 
                               belong to 
                                 R
                              . On the other hand, the leading term of 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               and of 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          4
                                       
                                    
                                    −
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               are oriented as 
                                 exp
                                 
                                    (
                                    i
                                    
                                    α
                                    )
                                 
                               and 
                                 exp
                                 
                                    (
                                    i
                                    
                                    β
                                    )
                                 
                              , respectively. From the choice for 
                                 α
                               and 
                                 β
                               fixed in (8), since 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 =
                                 Δ
                                 
                                    p
                                 
                                 +
                                 O
                                 
                                    (
                                    σ
                                    )
                                 
                              , we can obtain that also 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       3
                                    
                                 
                               belong to 
                                 R
                               when 
                                 σ
                               is sufficiently small.■

Let us now derive a reasonable automatic selection for 
                           
                              
                                 σ
                              
                              
                                 k
                              
                           
                         using the previous analysis. As in the previous subsection, for brevity we omit the subscript 
                           k
                        . According to (3), 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 4
                              
                           
                           −
                           
                              
                                 
                                    q
                                 
                              
                              
                                 3
                              
                           
                        , for a fixed value of 
                           σ
                         are aligned with 
                           exp
                           
                              (
                              i
                              
                              
                                 (
                                 α
                                 +
                                 ϕ
                                 )
                              
                              )
                           
                         and with 
                           exp
                           
                              (
                              i
                              
                              
                                 (
                                 β
                                 +
                                 ϕ
                                 )
                              
                              )
                           
                        , respectively. Thus, in order to control these orientations, when 
                           b
                         is not zero, we first require that 
                           
                              
                                 σ
                                 ≤
                                 min
                                 
                                    {
                                    
                                       
                                          σ
                                       
                                       
                                          L
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          R
                                       
                                    
                                    }
                                 
                              
                           
                         where 
                           
                              
                                 σ
                              
                              
                                 L
                              
                           
                           =
                           
                              |
                              α
                              |
                           
                           /
                           
                              |
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              |
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 R
                              
                           
                           =
                           
                              |
                              β
                              |
                           
                           /
                           
                              |
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                              |
                           
                        . This requires that the absolute value of the first order expansion of 
                           ϕ
                           
                              (
                              σ
                              )
                           
                         is less or equal to both 
                           
                              |
                              α
                              |
                           
                         and 
                           
                              |
                              β
                              |
                           
                        . In this way 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 2
                              
                           
                           −
                           
                              
                                 
                                    q
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 4
                              
                           
                           −
                           
                              
                                 
                                    q
                                 
                              
                              
                                 3
                              
                           
                         have intermediate orientations between the left unit tangent and 
                           Δ
                           
                              p
                           
                         and between 
                           Δ
                           
                              p
                           
                         and the right one, respectively.

Furthermore, in order to keep the control polygon inside the convex admissible region 
                           R
                        , we determine another upper bound for 
                           σ
                         aimed to control the distances 
                           
                              
                                 D
                              
                              
                                 j
                              
                           
                         of all the control points 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           …
                           ,
                           4
                         from 
                           Δ
                           
                              p
                           
                        . In particular, we determine a bound for 
                           σ
                         which guarantees that the second order Taylor expansions of such distances from 
                           Δ
                           
                              p
                           
                         are less or equal than the height 
                           H
                         of 
                           R
                         (see the previous section). Considering that in the adopted local reference system the distances of the inner control points from the displacement are simply given by the absolute values of their imaginary parts, we have that 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    |
                                    sin
                                    2
                                    α
                                    |
                                 
                                 ,
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 σ
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 c
                                 
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    sin
                                    α
                                    +
                                    
                                    
                                       (
                                       c
                                       
                                       sin
                                       2
                                       α
                                       
                                       
                                       +
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       sin
                                       α
                                       +
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       
                                       cos
                                       α
                                       )
                                    
                                    
                                    σ
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 ,
                                 
                                    
                                       D
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 σ
                                 
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 d
                                 
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    sin
                                    β
                                    +
                                    
                                    
                                       (
                                       d
                                       
                                       sin
                                       2
                                       β
                                       
                                       
                                       +
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       sin
                                       β
                                       +
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       
                                       
                                          
                                             f
                                          
                                          
                                             1
                                          
                                       
                                       
                                       cos
                                       β
                                       )
                                    
                                    
                                    σ
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    |
                                 
                                 ,
                                 
                                    
                                       D
                                    
                                    
                                       4
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    |
                                    sin
                                    2
                                    β
                                    |
                                 
                                 .
                              
                           
                         In order to further simplify the analysis, by denoting with 
                           E
                           
                              (
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           ,
                           
                           i
                           =
                           2
                           ,
                           3
                        , the expressions of 
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                           ,
                           i
                           =
                           2
                           ,
                           3
                        , without the rest, the following inequalities can easily be obtained, 
                           
                              
                                 E
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ≤
                                 σ
                                 
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          21
                                       
                                    
                                    
                                    +
                                    σ
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             22
                                          
                                       
                                       +
                                       
                                          
                                             Q
                                          
                                          
                                             23
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                                 E
                                 
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ≤
                                 σ
                                 
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          31
                                       
                                    
                                    
                                    +
                                    σ
                                    
                                    
                                       (
                                       
                                          
                                             Q
                                          
                                          
                                             32
                                          
                                       
                                       +
                                       
                                          
                                             Q
                                          
                                          
                                             33
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 ,
                              
                           
                         where, 
                           
                              
                                 
                                    
                                       Q
                                    
                                    
                                       21
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 c
                                 
                                 
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 
                                    |
                                    sin
                                    α
                                    |
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       22
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    |
                                    sin
                                    2
                                    α
                                    |
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       23
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 c
                                 
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    sin
                                    α
                                    +
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    
                                    cos
                                    α
                                    |
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       31
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 d
                                 
                                 
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 
                                    |
                                    sin
                                    β
                                    |
                                 
                                 ,
                                 
                                    
                                       Q
                                    
                                    
                                       32
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 
                                    |
                                    sin
                                    2
                                    β
                                    |
                                 
                                 ,
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       33
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       5
                                    
                                 
                                 
                                 d
                                 
                                 
                                    |
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                    
                                    sin
                                    β
                                    +
                                    
                                       
                                          g
                                       
                                       
                                          0
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          1
                                       
                                    
                                    
                                    cos
                                    β
                                    |
                                 
                                 .
                              
                           
                         Relating for brevity just to 
                           E
                           
                              (
                              
                                 
                                    D
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , when 
                           b
                         is not zero, we first require that 
                           σ
                           
                           
                              
                                 Q
                              
                              
                                 22
                              
                           
                           ≤
                           
                              
                                 Q
                              
                              
                                 21
                              
                           
                           /
                           2
                         and 
                           σ
                           
                           
                              
                                 Q
                              
                              
                                 23
                              
                           
                           ≤
                           
                              
                                 Q
                              
                              
                                 21
                              
                           
                           /
                           2
                         and then that 
                           σ
                           
                           
                              
                                 Q
                              
                              
                                 21
                              
                           
                           ≤
                           H
                           /
                           2
                        , that is 
                           σ
                           ≤
                           min
                           
                              {
                              
                                 
                                    σ
                                 
                                 
                                    L
                                    1
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    L
                                    2
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    L
                                    3
                                 
                              
                              }
                           
                        , with 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       L
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       4
                                       c
                                       
                                          |
                                          cos
                                          α
                                          |
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       L
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       
                                          |
                                          sin
                                          α
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          
                                             
                                                g
                                             
                                             
                                                1
                                             
                                          
                                          sin
                                          α
                                          +
                                          
                                             
                                                g
                                             
                                             
                                                0
                                             
                                          
                                          
                                          
                                             
                                                f
                                             
                                             
                                                1
                                             
                                          
                                          
                                          cos
                                          α
                                          |
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       L
                                       3
                                    
                                 
                                 =
                                 
                                    
                                       5
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 
                                    
                                       H
                                    
                                    
                                       2
                                       c
                                       
                                          
                                             g
                                          
                                          
                                             0
                                          
                                       
                                       
                                          |
                                          sin
                                          α
                                          |
                                       
                                    
                                 
                                 .
                              
                           
                         Note that any 
                           
                              
                                 σ
                              
                              
                                 L
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , has to be set to one if the corresponding denominator vanishes. Summarizing, when 
                           b
                         is not zero, we require 
                           
                              (26)
                              
                                 σ
                                 ≤
                                 min
                                 
                                    {
                                    1
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          L
                                       
                                    
                                    ,
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          R
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          L
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          L
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          L
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          R
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          R
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          σ
                                       
                                       
                                          R
                                          3
                                       
                                    
                                    }
                                 
                                 ,
                              
                           
                         where the thresholds 
                           
                              
                                 σ
                              
                              
                                 R
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , are defined analogously to 
                           
                              
                                 σ
                              
                              
                                 L
                                 j
                              
                           
                           ,
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        , just replacing 
                           β
                         and 
                           d
                         with 
                           α
                         and 
                           c
                        , respectively. In the special case 
                           b
                           =
                           0
                         we have to consider only the first order term of the distances because we are not able to derive 
                           
                              
                                 g
                              
                              
                                 1
                              
                           
                        . In this case, we just consider 
                           σ
                           ≤
                           min
                           
                              {
                              1
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    L
                                    3
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    R
                                    3
                                 
                              
                              }
                           
                        .

In our numerical experiments, the use of an upper bound according to the previous analysis for selecting 
                           σ
                         in each spline segment has always ensured the identification of a control polygon of reasonable shape included in the corresponding admissible region.

In this section the results obtained with our approach for the complex scenario S2 shown in Fig. 11
                      are discussed. For brevity, we report only the results obtained using the visibility graph. Note, however, that in this case they are always better than those based on the trapezoidal map decomposition.

The comparison of the 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      visibility graph shortest path (VGSP) with the modified versions computed with Algorithm 2 (MVGSP) and 3 (GVGP) is presented in Fig. 11 and Table 3
                     . Note that the GVGP algorithm has been applied with an “ad hoc” choice of the starting edge to emphasize the possibility of alternative admissible solutions. The number of points (
                        #
                      points) along the different 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      paths as well as their lengths are quite similar for the three solutions. On the other hand, we may note that the two piecewise linear paths MVGSP and GVGP exhibit smaller maximum, and average angle variations (
                        
                           
                              α
                           
                           
                              
                                 min
                              
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              
                                 max
                              
                           
                        
                        ,
                        
                           
                              α
                           
                           
                              avg
                           
                        
                     ) with respect to the shortest path (VGSP).


                     Figs. 12 and 13
                     
                      shows the corresponding 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      paths and curvature plots obtained by considering T1 and T2 tangents, respectively, while Table 4
                      gives the associated total arc lengths. As expected, the shortest 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      path is the one related to the VGSP. On the other hand, by introducing an additional interpolation point along the path and, consequently, slightly increasing the total arc length, the solution based on MVGSP is able to reduce the curvature pick in the last by one spline segment. The 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      path related to the GVGP offers a smooth alternative solution which is remarkably different.

For comparison, Figs. 14 and 15
                     
                      show the result obtained by considering the different piecewise linear solutions together with cubic 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      splines according to the choice of T1 and T2 unit tangents, respectively. The values of the tension parameters are chosen as in the corresponding PH quintic solution related to same piecewise linear path and shown in Figs. 12 and 13. We note that also for this second scenario PH splines exhibit a smaller curvature range in all test cases.

We proposed a two-step approach for the design of planar smooth path planning schemes with obstacle avoidance by 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      PH quintic splines. First, algorithms for the construction of piecewise linear 
                        
                           
                              P
                           
                           
                              1
                           
                        
                      paths that do not intersect any obstacle are discussed and compared. Subsequently, the set of vertices defining these paths are considered as input values for the 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      PH spline interpolation scheme with tension parameters that produces the final smooth 
                        
                           
                              P
                           
                           
                              2
                           
                        
                      paths. The asymptotic analysis of the local quintic control polygon associated with any spline segment and developed in terms of the corresponding tension parameter provides an automatic strategy for its selection. The usage in the second step of an interpolation scheme based on PH splines allows us to take full advantage of the key properties of PH curves (fair shapes, polynomial arc length, 
                        …
                     ). We believe that the ambition of suitably combining the shape control capabilities provided by spline interpolation or approximation schemes with obstacle avoidance techniques is a fundamental step towards the possibility of enriching the current planning algorithms with more flexible and accurate paradigms.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by MIUR under the “Futuro in Ricerca” project DREAMS (RBFR13FBI3) and by the Gruppo Nazionale per il Calcolo Scientifico (GNCS) of the Istituto Nazionale di Alta Matematica (INdAM).

The algorithms discussed in Section  3 are presented here. In the description of these algorithms, the routine for the shortest path computation is indicated as


                     SP (nodes, edges, start, goal)

and returns the list of nodes of the shortest path between the node start and goal of the graph represented in terms of the input variables nodes and edges.

The procedure to define the modified trapezoidal map shortest path (MTMSP) is detailed Algorithm 1. Together with the procedure for the shortest path computation, three additional subroutines are considered in Algorithm 1 (line 4–6) and detailed below. 
                        
                           •
                           
                              VisibilityCheck (shortest, obstacles): performs an iterative visibility check on shortest. If two non-consecutive nodes can be connected with a segment that does not intersect any obstacle in obstacles, the nodes between them are deleted from the resulting modified shortest path.


                              CollinearCheck (modTMSP, obstacles, maxDist): performs an iterative check of collinearity on modTMSP. Given three nodes 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                               along the path, if 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               lies on the segment 
                                 s
                               that connects 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                               to 
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                               or the distance between 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 s
                               is less than maxDist and 
                                 s
                                 ∈
                                 
                                    
                                       Q
                                    
                                    
                                       f
                                       r
                                       e
                                       e
                                    
                                 
                              , then 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               can be removed from modTMSP.


                              ClusterCheck (nodeList, obstacles, cluDist): performs an iterative proximity check on modTMSP. Given three consecutive nodes 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                              , if the distance between 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               is less then cluDist and the segment connecting 
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                               to 
                                 
                                    
                                       n
                                    
                                    
                                       3
                                    
                                 
                               is free from obstacle collisions with respect to obstacles, then 
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                               is deleted from modTMSP.


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

Algorithm 2 introduces this procedure which defines the modified visibility graph shortest path (MVGSP), while the procedure to define the greedy visibility graph path (GVGP) is detailed in Algorithm 3.
                        6
                     
                     
                        6
                        Note that the input variable visited has to be initialized with two nodes: 
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    s
                                 
                              
                            and one of its adjacent node in the visibility graph.
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

