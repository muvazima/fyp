@&#MAIN-TITLE@&#Affective interaction recognition using spatio-temporal features and context

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A hierarchical representation structure for interaction recognition is introduced.


                        
                        
                           
                           We adopt hierarchical coding models to encode low-level features.


                        
                        
                           
                           A segmental clustering method is applied to extract the mid-level features.


                        
                        
                           
                           Contextual information is incorporated with motion features by extracting the interactive contours.


                        
                        
                           
                           We demonstrate empirical results on three datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Interaction recognition

Affective computing

Spatio-temporal feature

Primary visual cortex

Context

@&#ABSTRACT@&#


               
               
                  This paper focuses on recognizing the human interaction relative to human emotion, and addresses the problem of interaction features representation. We propose a two-layer feature description structure that exploits the representation of spatio-temporal motion features and context features hierarchically. On the lower layer, the local features for motion and interactive context are extracted respectively. We first characterize the local spatio-temporal trajectories as the motion features. Instead of hand-crafted features, a new hierarchical spatio-temporal trajectory coding model is presented to learn and represent the local spatio-temporal trajectories. To further exploit the spatial and temporal relationships in the interactive activities, we then propose an interactive context descriptor, which extracts the local interactive contours from frames. These contours implicitly incorporate the contextual spatial and temporal information. On the higher layer, semi-global features are represented based on the local features encoded on the lower layer. And a spatio-temporal segment clustering method is designed for features extraction on this layer. This method takes the spatial relationship and temporal order of local features into account and creates the mid-level motion features and mid-level context features. Experiments on three challenging action datasets in video, including HMDB51, Hollywood2 and UT-Interaction, are conducted. The results demonstrate the efficacy of the proposed structure, and validate the effectiveness of the proposed context descriptor.
               
            

@&#INTRODUCTION@&#

Expression of emotion is part of actions in human interaction [1]. Due to the complexity of the body and lack of formal model for body expressions, the features are difficult to extract [2]. Recently, the majority of affective computing research mainly focuses on facial expressions or speech to make computer understand human emotions. However, it has been demonstrated that body expression plays an important role in emotion understanding as well. In psychology, it is also proved that body expression is as valuable as facial expression to emotion analysis [3]. A psychological research demonstrates the importance of body expressions, like body motion, posture, gestures and actions in human interaction [11]. The importance of body expressions is reflected in two aspects. On the one hand, the changes in body posture reflect changes in affective state [30]. Ekman and Friesen [19,63] propose that postural changes due to affective state endow a person with the ability to cope with the experienced affective state. On the other hand, bodily configuration and orientation are significantly affected by individuals attitude toward his interactive partner [31]. Therefore, some research [4–6] present that using body expression to analyze emotional states will be able to enhance the analysis of emotion. Body postures can help us discriminate not only the emotion, especially the emotion of fear, but also the cause of emotion and the action tendency that will be carried out [7]. The emotional states can be discerned by body expressions much better over long distances, whereas facial features are difficult or unreliable to be used to recognize the emotion at the same distance [8]. In addition, a lot of social emotions are frequently expressed by interactions. For example, loving and congratulating can be easily discriminated by body expressions, such as kissing or clapping, during interaction [7,9,10]. And in the affective interaction, most of the emotional actions are expressed through upper body, such as the head, arms and torso. For example, shaking hands in interaction can express greeting; The emotions to comfort another distressed person can be expressed by hugging, such as a parent giving a hug with a crying child or someone giving a hug with his friend who is troubled with something; Clapping can transmit the information of congratulation or admiration to someone; And striking, which is an open act of aggression by hitting someone, is associated with anger. Motivated by the above analysis, we focus on recognizing the interactive activities associated with emotion from videos in real life, such as hugging, kissing, etc. The illustration for these interactive activities is shown in Fig. 1
                     . Therefore, in this paper, we mainly study on the six types of interactions related to complicated emotions. These interactions are mainly selected in specified scenes. The illustration of emotions, corresponding interactions and scenes is demonstrated in Table 1
                     .

In order to study on the understanding of complicated emotions, we lay emphasis on the action recognition. Action recognition in video is one of the most challenging problems in computer vision [44–47]. Specifically, video representation remains to be an important issue in action recognition. Recently, various approaches have been proposed and achieved great progresses. Inspired by the spatio-temporal nature of actions in video, many works exploit local spatio-temporal feature descriptors combining with Bag-of-Words methods [12–14,22] for action recognition in video. Such approaches are effective and robust to viewpoint and scale changes in unconstrained scenarios for simple actions, and have achieved promising performance. However, they largely ignore the spatial and temporal order of the action among the local spatio-temporal features. In order to solve this problem, in this paper we propose a novel feature representation structure for interaction recognition. In this structure, the spatial and temporal relationships are introduced into action representation, and two layers are used to represent the interaction on the low-level and mid-level respectively. On the first layer, a low-level representation is built using a new hierarchical coding model for the local features. The second layer is built on top of the first layer. On this layer, the mid-level representation in spatial and temporal order are exploited through a Spatio-Temporal Segment Clustering method.

From another aspect, deep architectures for automatic features learning greatly inspire researchers to explore this direction for their promising results in action recognition [49–52]. Similar to deep learning architectures, a lot of biological models are proposed to infer high-level features from the lower-level, so as to learn features automatically. They have been proved to be effective with not so deep structures, and improvement has also been observed in these models for object recognition [36]. Inspired by these works, we propose a biological-motivated Hierarchical Sptio-Temporal Trajectory Coding Model to represent the low-level spatio-temporal motion features in our structure with lower computation costing but higher discrimination of local features. This spatio-temporal motion feature coding method is exploited by extending from a contour coding model for natural images. We advance this model to the spatial and temporal scales, and use it to represent the local motions extracted from actions. And these local motions can be further described as local trajectories. Finally, all these local trajectories make up the whole interaction.

Recently, context information becomes significant for action recognition. For example, identifying the objects involved in the context of an activity can improve the performance of recognition [27]. In the same way, as for the human interaction, the actions of each person related in space and time in interaction rarely occur independently and can be exploited as the context for each other as well. Take “hugging” and “clapping” for instance. The arm movements can be detected from each person respectively in the interactions. However, recognizing from anyone independently cannot help us to understand the interactive activity definitely. Thus, it is not enough to recognize the activities without the context, especially the interactions. On this direction, the role of objects can serve as the context for learning to improve the performance in some approaches [53–55]. Although these approaches have achieved good performance, most of them tend to be complicated and time consuming, because they have to do the preprocessing such as segmentation or distance extraction, etc. This makes us to consider the problem of designing a simple but effective context description method. In this paper we incorporate the context information into the spatio-temporal action features to improve the classification performance. Rather than modeling context information in videos respectively, we extract interactive contours from action sequence as the context, which includes a lot of information. Although the context properties are not extracted respectively as the previous methods, such as the changing relative distance or the concurrent posture states between persons, etc., the interactive contours implicitly incorporate these context properties. Furthermore, we use the spatial hierarchical contour coding model to represent the interactive contours discriminatively, and combine it with spatio-temporal motion features for further classification.

To summarize, the main contributions of this paper are described as follows: (1) By extending the local spatio-temporal feature descriptor for simple action recognition, a hierarchical representation structure on video for interaction recognition is proposed, to incorporate the spatial and temporal orders of local motions into feature representation on two layers. (2) To represent the low-level spatio-temporal features more discriminatively with lower computation cost, a Hierarchical Spatio-Temporal Trajectory Coding Model is exploited. (3) Additionally, we further augment the motion features with contextual features in our structure. Specifically, the interactive contours are used to depict the context, since they implicitly incorporate the interactive context cues, such as persons’ relative distance or movements.

The remainder of this paper is organized as follows: Section 2 presents the related work of the current literature. Section 3 describes the two-layer representation structure, including the local feature coding method and context descriptor. The experiments are explained in Section 4. The conclusion and future work are provided in Section 5.

@&#RELATED WORK@&#

The recent studies on automatic emotion understanding begin to pay more attention on body expression. Most works describe the features of body expressions or actions by quantities or qualities. Glowinski et al. [15] recognized twelve emotion states by extracting features from movements of head and hands. They extracted velocity, energy and spatial expansion from hands, and extracted symmetry, forward and backward inclination from head. In order to reduce dimensions of feature set, they extracted features from upper body, attempting to represent emotion states minimally by postures. Bernhardt and Robinson [16] detected four basic emotions from the body movements produced by naturally connected action sequence, which is one of the most common forms of body motions in everyday scenario and has not been explored in the past. Besides, Roether et al. [17] investigated that there existed emotion specific spatiotemporal motor primitives that characterized human gait. They used acted motion-captured walking patterns, and showed that perception of emotions was based on specific changes of joint angle amplitudes with respect to neutral walking. Additionally, Atkinson et al. [18] determined that form and motion information has distinct contributions to the understanding of emotions from body gestures. Specifically, they demonstrated that motion signals were sufficient for recognizing basic emotions. Roether et al. [17] extracted average flexion angles as form information, and extracted a low-dimensional parameterization of spatio-temporal structure of joint trajectories as movement features, so as to discriminate four basic emotions. In [20], a computational model is proposed to analyze human postures and body motions to detect engagement of children who were playing chess with an iCat robot that acts as a game companion. The posture was described by the body lean angle, contraction, etc.; and the movement features were characterized by variations of the silhouette shape and position. However, most of the studies focus on simple emotions. Few works take into account of the complicated emotion understanding, such as emotions expressed in human interaction. This is what we will research on.

In action recognition, local spatio-temporal features are widely used. These features have been shown effective performance in human action recognition [14,21,22]. To describe the spatio-temporal features, Dollar et al. [14] developed a number of descriptors to characterize the cuboids of spatio-temporally windowed data surrounding a feature point, and the cuboids extracted from a number of sample behaviors from a given domain were clustered to form a dictionary of cuboid prototypes. William et al. [21] presented a dense set of scale-invariant features, which can be localized both in spatio-temporal domain and over both scales simultaneously, using a detector by approximating 3D convolutions. Laptev et al. [22] characterized the local motions and appearances by histograms of spatial gradient and optic flow accumulated in spatial-temporal neighborhoods of detected interest points. Different from the above studies utilizing hand-designed visual features, recent works tended to learn features directly from datasets. They [23–25] demonstrated that learning-based feature extraction methods were more effective than hand-designed visual methods, because of the discovery of unexpected features. Le et al. [23] proposed an unsupervised learning technique to learn invariant spatio-temporal features directly using independent subspace analysis. Taylor et al. [24] presented a convolutional model, which learned latent representations from image sequences, to extract motion-sensitive features from pairs of successive images. Tanaya and Rabab [25] investigated dictionary learning frameworks to learn sparse representations, which were more compact and richer for the video sequences compared to the existing methods. They constructed an overcomplete dictionary using a set of spatio-temporal descriptors, and each descriptor was represented by a linear combination of a small number of dictionary elements. The studies mentioned above achieved great performance in action representation. However, for long-range motion and interactive persons, the local spatio-temporal features have some limitations, since they only describe the local information and discard the locational and temporal information.

Recently, deep learning models are exploited in action recognition with remarkable results [49–52]. Baccouche et al. [49] proposed a deep model without using any prior knowledge to classify human actions. Considering the temporal evolution of the learned spatio-temporal features, they extended the Conv-Nets to 3D to learn spatio-temporal features, and trained a recurrent neural network model to classify the whole sequence. In [52], the whole sample sequence was considered in the deep model, and the description was extracted in a frame-by-frame manner. This model was built upon the Hierarchical Temporal Memory notion, and the unsupervised on-line feature learning was realized. Meanwhile, visual processing in cortex begin to be classically modeled as a hierarchy of increasingly sophisticated representations, naturally extending the model of simple to complex cells. Specifically, these biological models have been proposed for object recognition. Motivated by a quantitative model of visual cortex, Serre et al. [61] proposed a feature learning architecture to extract object features by combining position- and scale-tolerant edge-detectors over neighboring positions and multiple orientations. Ranzato et al. [62] presented a biological model for learning a hierarchy of sparse feature detectors that were invariant to small shifts and distortions, and yielded good performances with alleviation of the over-parameterization problems. Therefore, in our work, we adopt the biological architecture to represent the local features in our proposed structure.

Furthermore, the context feature is also introduced in our study. For the limitations of spatio-temporal features, context information is considered to be effective. Psychologists have also shown that context information plays an important role in recognition for human vision [26]. Marszalek and Laptev [27] exploited the context of natural dynamic scenes for human action recognition in video and developed a joint framework for action and scene recognition. Wang et al. [28] proposed a representation that captured contextual interactions between interest points, based on the density of all features observed in each interest point’s multiscale spatio-temporal contextual domain. In [29], the authors exploited a set of mid-level components and the interdependencies of the activity components by introducing a spatio-temporal context kernel, which not only captured local properties of features but also incorporated their spatio and temporal context information.

In this section, we discuss the proposed representation structure for spatio-temporal motion features and context, as illustrated in Fig. 2. This structure is composed of two main layers: (i) on the first layer, local spatio-temporal cuboids are extracted based on the spatio-temporal interest points, and represented as local trajectories by the proposed Hierarchical Spatio-Temporal Trajectory Coding Model. Furthermore, the interactive contour features are extracted for context information on this layer as well. (ii) On the second layer, motivated by the importance of spatial and temporal order for local features in the interaction recognition, we adopt a Spatio-Temporal Segment Clustering method, by which the local features are clustered into different segments in temporal and spatial domain respectively. In this way, this method defines the mid-level features as histograms from these segments. Then we will elaborate our approach in the following sections. Sections 3.1 and 3.2 mainly describe the local feature representation on the first layer, including local spatio-temporal motion feature description and local interactive context description. The second-layer construction will be depicted in Section 3.3.

To represent the local spatio-temporal motion features for a video clip on the first layer, we follow two common steps, which are local spatio-temporal feature extraction and feature coding. For the feature extraction, the spatio-temporal interest points [14] are first detected, and then the cuboid containing the spatio-temporal windowed pixels at each interest point is extracted. These cuboids characterize the visual cues, such as appearance and motion. Thus, they are regarded as local spatio-temporal trajectories in our method. To create the cuboid descriptor, instead of devising hand-designed feature coding methods, we learn the spatio-temporal trajectory dictionary in spatio-temporal domains by a Hierarchical Spatio-Temporal Trajectory Coding Model (HSTTCM), which is exploited by extending a biological-motivated contour coding method. Based on the spatio-temporal trajectory dictionary the cuboids can be encoded. This coding model will be described in the following.

Our proposed model HSTTCM is constructed based on the brain mechanisms, to represent local spatio-temporal features for action recognition.

Primary Visual Cortex (V1), which is one part of neocortex, takes charge of receiving visual input from retina. Hubel and Weisel [34,35] have demonstrated that the simple and complex cells in primary visual cortex responded strongly to bars of different orientations, and moving in given directions, etc. However, simple cells have small receptive fields with strong phase dependence, whereas complex cells have larger receptive fields and no phase dependence. Then they proposed a model in which simple cells with neighboring receptive fields fed into the same complex cell, thereby endowing that complex cell with a phase-invariant response.

Thereby, a lot of extended hierarchical models for simple cells and complex cells are proposed. Riesenhuber and Poggio [36] explored a hierarchical model consistent with physiological data from inferotemporal cortex that accounts for this complex visual task, to implement object recognition. Meanwhile, Olshausen and Field [32] showed the way that the classical receptive fields of simple cells in V
                           1 can be understood in sparse coding, in which the observed data Xj
                            was modeled as a weighted sum of the coefficient si
                           :

                              
                                 (1)
                                 
                                    
                                       
                                          X
                                          j
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          a
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          s
                                          i
                                       
                                       +
                                       
                                          n
                                          j
                                       
                                    
                                 
                              
                           where aji
                            is the weights for the coefficient si
                           , and nj
                            is the Gaussian noise. This can be also expressed as vector form,

                              
                                 (2)
                                 
                                    
                                       X
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          a
                                          i
                                       
                                       
                                          s
                                          i
                                       
                                       +
                                       n
                                    
                                 
                              
                           
                        

Therefore, each data pattern X can be approximately expressed as the linear combination of basis patterns 
                              
                                 a
                                 i
                              
                           . The coefficient si
                           , which differs from each data pattern 
                              
                                 X
                                 ,
                              
                            is mutually independent and exhibits sparseness. Thus, any input pattern 
                              X
                            can be described by only a few active units si
                           , and the data can be represented by the basis patterns 
                              
                                 a
                                 i
                              
                           .

Then the sparse coding model in Eq. 2 is shown to be represented as a neural network. In this network, the data 
                              
                                 X
                                 ,
                              
                            which represents the activities in input layer, is the linear function of the activities of the coefficient si
                            in the higher layer [39]. Based on the observed input X, the network optimizes the representation of si
                           , which will be most likely to have generated the input 
                              X
                            in all the coefficients, and the prior probability of si
                            will be sparse. Ultimately, through learning weights 
                              
                                 
                                    a
                                    i
                                 
                                 ,
                              
                            the network will find a maximal sparse configuration of si
                            which is an approximate generation of 
                              
                                 X
                                 ,
                              
                           .

Based on this model, many researchers studied the sparse coding on natural images and trained the network on patches from the natural images [32–34]. They represented the pixel values from images as the elements of 
                              
                                 X
                                 ,
                              
                            and used Gabor functions to represent the basis pattern 
                              
                                 
                                    a
                                    i
                                 
                                 ,
                              
                            which resembles the simple cell receptive field. Then the corresponding si
                            will be interpreted as the activations of cells.

According to the work by Olshausen and Field [32], Bell and Sejnowski [33] and van Hateren and van der [37] , Hoyer and Hyverinen [38] extended the framework by considering how the responses of complex cells could be sparsely represented by a higher-order neural layer, which leads to contour coding and end-stopped receptive fields. In this model, contour integration can be interpreted as top-down inference.

To encode the local spatio-temporal motion features from videos along both the spatial and temporal domains, we extend the contour coding method [38] which is built only in spatial domain. By our method, the motion features in cuboids will be sparsely encoded by local spatial-temporal trajectory basis.

In [38], the complex cell response was constructed by a widely used energy model [39–41], which detected spatially localized oriented Fourier energy in static images. To model a hierarchical trajectory coding for local spatial-temporal motion features, we extend the response of complex cell in [38], and define it as

                              
                                 (3)
                                 
                                    
                                       
                                          C
                                          
                                             
                                                {
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   ,
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   )
                                                
                                                }
                                             
                                             ,
                                             θ
                                          
                                       
                                       =
                                       R
                                       
                                          v
                                          1
                                       
                                       +
                                       R
                                       
                                          v
                                          2
                                       
                                    
                                 
                              
                           where Rv
                           1 and Rv
                           2 represent responses of simple cell for spatio-temporal trajectories from video sequences. They are described by even-symmetric and odd-symmetric Gabor filters respectively, centered on (x
                           
                              t, c
                           , y
                           
                              t, c
                           ) with orientation θ at time t. The representation is shown in Eq. 4 as follow.

                              
                                 (4)
                                 
                                    
                                       
                                          
                                             
                                                R
                                                
                                                   v
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               e
                                                               ,
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               θ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            )
                                                         
                                                         I
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            ,
                                                            t
                                                            )
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                ;
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                       
                                       
                                          
                                             
                                                R
                                                
                                                   v
                                                   2
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               o
                                                               ,
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               θ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            )
                                                         
                                                         I
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            ,
                                                            t
                                                            )
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 G
                                 
                                    e
                                    ,
                                    
                                       x
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                    ,
                                    
                                       y
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                 
                              
                            and 
                              
                                 G
                                 
                                    o
                                    ,
                                    
                                       x
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                    ,
                                    
                                       y
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                 
                              
                            are Gabor filters centered on (x
                           
                              t, c
                           , y
                           
                              t, c
                           ). In this part, we still use the 2D Gabor filter as the receptive field. They can be represented as follow,

                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                G
                                                
                                                   e
                                                   ,
                                                   
                                                      x
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   ,
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   γ
                                                   
                                                      2
                                                      π
                                                      
                                                         σ
                                                         
                                                            x
                                                            
                                                               t
                                                               ,
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         σ
                                                         
                                                            y
                                                            
                                                               t
                                                               ,
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                                e
                                                x
                                                p
                                                
                                                   (
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ¯
                                                            
                                                            2
                                                         
                                                         
                                                            2
                                                            
                                                               σ
                                                               
                                                                  
                                                                     x
                                                                     
                                                                        t
                                                                        ,
                                                                        c
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               γ
                                                               2
                                                            
                                                            
                                                               
                                                                  
                                                                     y
                                                                     t
                                                                  
                                                                  ¯
                                                               
                                                               2
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               σ
                                                               
                                                                  
                                                                     y
                                                                     
                                                                        t
                                                                        ,
                                                                        c
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ·
                                                cos
                                                (
                                                2
                                                π
                                                ω
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                         ¯
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      t
                                                   
                                                   )
                                                
                                                +
                                                φ
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                G
                                                
                                                   o
                                                   ,
                                                   
                                                      x
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   ,
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   γ
                                                   
                                                      2
                                                      π
                                                      
                                                         σ
                                                         
                                                            x
                                                            
                                                               t
                                                               ,
                                                               c
                                                            
                                                         
                                                      
                                                      
                                                         σ
                                                         
                                                            y
                                                            
                                                               t
                                                               ,
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                
                                                e
                                                x
                                                p
                                                
                                                   (
                                                   −
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               x
                                                               ¯
                                                            
                                                            
                                                               t
                                                            
                                                            2
                                                         
                                                         
                                                            2
                                                            
                                                               σ
                                                               
                                                                  
                                                                     x
                                                                     
                                                                        t
                                                                        ,
                                                                        c
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               γ
                                                               2
                                                            
                                                            
                                                               
                                                                  y
                                                                  ¯
                                                               
                                                               
                                                                  t
                                                               
                                                               2
                                                            
                                                         
                                                         
                                                            2
                                                            
                                                               σ
                                                               
                                                                  
                                                                     y
                                                                     
                                                                        t
                                                                        ,
                                                                        c
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ·
                                                sin
                                                (
                                                2
                                                π
                                                ω
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                         ¯
                                                      
                                                      t
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      t
                                                   
                                                   )
                                                
                                                +
                                                φ
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                   ¯
                                                
                                                t
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   −
                                                   
                                                      x
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   )
                                                
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      y
                                                      t
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   )
                                                
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                t
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                −
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                   
                                                   −
                                                   
                                                      x
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   )
                                                
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   (
                                                   
                                                      y
                                                      t
                                                   
                                                   −
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         c
                                                      
                                                   
                                                   )
                                                
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where γ is the spatial aspect ratio that indicates the ellipticity of the Gaussian envelope factor in the spatial domain. 
                              
                                 (
                                 
                                    σ
                                    
                                       x
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                 
                                 ,
                                 
                                    σ
                                    
                                       y
                                       
                                          t
                                          ,
                                          c
                                       
                                    
                                 
                                 )
                              
                            represents the standard deviation of this Gaussian factor and determines the size of the receptive field. ω is the spatial frequency. θ ∈ [0, 2π) is defined as the preferred direction of motion and spatial orientation of the filter. The phase offset 
                              
                                 φ
                                 ∈
                                 (
                                 −
                                 π
                                 ,
                                 π
                                 ]
                              
                            is defined to represent the symmetry of the filter in the spatial domain with respect to its moving center 
                              
                                 (
                                 
                                    
                                       x
                                       ¯
                                    
                                    t
                                 
                                 ,
                                 
                                    
                                       y
                                       ¯
                                    
                                    t
                                 
                                 )
                              
                           . In this model, we set 
                              
                                 φ
                                 =
                                 0
                              
                            to make it symmetric. The change in intensities of excitatory and inhibitory lobes of the receptive filed with time is modeled by the simple cortex responses in spatial dimension.

Therefore, the complex cell responses can be described as

                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   {
                                                   
                                                      (
                                                      
                                                         x
                                                         
                                                            t
                                                            ,
                                                            c
                                                         
                                                      
                                                      ,
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            c
                                                         
                                                      
                                                      )
                                                   
                                                   }
                                                   ,
                                                   θ
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               e
                                                               ,
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               θ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            )
                                                         
                                                         I
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            ,
                                                            t
                                                            )
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                +
                                                
                                                   ∑
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               
                                                                  x
                                                                  t
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            G
                                                            
                                                               o
                                                               ,
                                                               
                                                                  x
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               
                                                                  y
                                                                  
                                                                     t
                                                                     ,
                                                                     c
                                                                  
                                                               
                                                               ,
                                                               θ
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            )
                                                         
                                                         I
                                                         
                                                            (
                                                            
                                                               x
                                                               t
                                                            
                                                            ,
                                                            
                                                               y
                                                               t
                                                            
                                                            ,
                                                            t
                                                            )
                                                         
                                                      
                                                      2
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where I(xt, yt, t) is the cuboid from video sequence.

Based on the response model for spatial-temporal trajectories, the linear sparse coding model is trained by minimizing the joint log-posterior of the latent variables and model parameters as

                              
                                 (7)
                                 
                                    
                                       C
                                       
                                          (
                                          A
                                          ,
                                          
                                             
                                                s
                                             
                                             
                                                (
                                                n
                                                )
                                                ,
                                                n
                                                =
                                                1
                                                …
                                                N
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          ∑
                                          n
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   ∥
                                                
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      −
                                                      A
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   ∥
                                                
                                             
                                             2
                                          
                                          +
                                          λ
                                          
                                             ∑
                                             i
                                          
                                          
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           where A is a matrix, which contains the columns ai. X
                           (n) represents the nth
                            data, and s
                           (n) is the vector that contains the latent variables si
                           
                           (n) of the nth data. The linear activation penalty term λ∑
                              i
                           
                           si
                           
                           (n) assumes the latent variables to be exponentially distributed, while the quadratic term 
                              
                                 
                                    
                                       ∥
                                    
                                    
                                       
                                          X
                                       
                                       
                                          
                                             (
                                             n
                                             )
                                          
                                          −
                                          A
                                          
                                             
                                                s
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                    
                                    
                                       ∥
                                    
                                 
                                 2
                              
                            comes from the Gaussian prior on the noise. The constant λ, tradeoff between representation error and sparseness, is obtained from the noise level assumed in the model. The Eq. (7) aims at minimizing by standard gradient descent with respect to the s
                           (n) in the short run and with respect to A under a long timescale.

The noise is reduced by finding the most likely latent variable configuration, for a given data vector X, by minimizing 
                              
                                 
                                    
                                       ∥
                                       X
                                       −
                                       A
                                       s
                                       ∥
                                    
                                    2
                                 
                                 +
                                 λ
                                 
                                    ∑
                                    i
                                 
                                 
                                    s
                                    i
                                 
                              
                            with respect to S. The denoised data vector is represented as As.

In our proposed model, the basis patterns are parameterized by seven variables, which are location (xt, yt, t), length and width in spatial domain, time scale in temporal domain, and orientation theta. At the given orientation and the specified position, the Gaussian clusters of activity of complex cells approximate the patterns, which have standard deviations, such as length/2, width/2. The summed squared difference between basis patterns and parameterized patterns is minimized by the chosen parameters.

The context information has been considered to be important for activity recognition. Take the activities in Fig. 3
                         for instance, each independent person in the interaction has similar motions, such as stretching the arms. However, representing the activity as the continuous actions in temporal domain and taking each other as the interactive context, we can discriminate between these two activities. In addition, there also exist other contextual properties, such as spatial and temporal informative cues, and causal relationships. For example, the spatial relationship of persons in shaking hands is different from hugging. In order to characterize these context properties, we find that the interactive contours show the differences between human interactions in these properties, such as the activities in Fig. 4
                        . The contours of these activities incorporate the interactive spatial relationship and changes. Inspired by this concept, we extract the interactive contour components and represent them as context features, which implicitly incorporate the interactive context informative cues. The following section will describe the details.

In the context description, we follow the contour coding method [38] to encode the interactive contours as the context features. We first divide the contour regions into patches on spatial scale, and use them to construct a contour dictionary as follow.

According to the contour coding method [38], the response of complex cell C is calculated by a pair of quadrature Gabor filters, which can be described as

                           
                              (8)
                              
                                 
                                    
                                       C
                                       
                                          
                                             x
                                             c
                                          
                                          ,
                                          
                                             y
                                             c
                                          
                                          ,
                                          θ
                                       
                                    
                                    =
                                    
                                       R
                                       1
                                    
                                    +
                                    
                                       R
                                       2
                                    
                                 
                              
                           
                        where R
                        1 and R
                        2 are responses of simple cell. One is described by even-symmetric Gabor filters, and the other is described by odd-symmetric Gabor filters. (xc, yc
                        ) is the center of Gabor filters with the orientation θ. The Gabor filters are represented as follow,

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             R
                                             1
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         e
                                                         ,
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         
                                                            y
                                                            c
                                                         
                                                         ,
                                                         θ
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   I
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                                2
                                             
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                    
                                    
                                       
                                          
                                             R
                                             2
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      x
                                                      ,
                                                      y
                                                   
                                                
                                                
                                                   G
                                                   
                                                      o
                                                      ,
                                                      
                                                         x
                                                         c
                                                      
                                                      ,
                                                      
                                                         y
                                                         c
                                                      
                                                      ,
                                                      θ
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                I
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        where I(x, y) is the image patch. The 
                           
                              G
                              
                                 e
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    y
                                    c
                                 
                                 ,
                                 θ
                              
                           
                         is the even symmetric Gabor filter and 
                           
                              G
                              
                                 o
                                 ,
                                 
                                    x
                                    c
                                 
                                 ,
                                 
                                    y
                                    c
                                 
                                 ,
                                 θ
                              
                           
                         is the odd symmetric Gabor filter, centered on (xc, yc
                        ) with orientation θ. Thereby, the responses from the complex cell can be described as

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             C
                                             
                                                
                                                   x
                                                   c
                                                
                                                ,
                                                
                                                   y
                                                   c
                                                
                                                ,
                                                θ
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         e
                                                         ,
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         
                                                            y
                                                            c
                                                         
                                                         ,
                                                         θ
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   I
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                   
                                                   
                                                      G
                                                      
                                                         o
                                                         ,
                                                         
                                                            x
                                                            c
                                                         
                                                         ,
                                                         
                                                            y
                                                            c
                                                         
                                                         ,
                                                         θ
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   I
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For the description of interactive contours, the analysis is restricted to a single spatial scale, and 4 differently oriented cells at each location are placed on a rectangular 6-by-6 grid. After sampling a large number of activation patterns, a contour coding model is trained.

Follow this contour coding method, the contour dictionary is constructed. The responses to part of image patch samples are shown in Fig. 5.


                        Fig. 5 illustrates the behavior of complex cells in our model by showing their responses to a few image patches. The analysis here is restricted to a single spatial scale, and the cells are placed on a rectangular 6-by-6 grid with 4 differently oriented cells at each location. In this figure, the ellipses show the orientation and approximate extent of the individual complex cells. The brightness of ellipses indicates the different response
                        
                         strengths. Fig. 5(a) describes the patches from the set of extracted scene images; Fig. 5(b) is the visualization of responses of the complex cells in contour coding model to the patches in (a). From this figure, we can find that the simulated complex cells can accurately estimate the contour of image patches, including the location and the orientation. For example, the concatenation of ellipses in Fig. 5(b) indicates the contour of its corresponding patch.

Based on the learned dictionary, the contour patches can be represented by the basis patterns. Thus, the interactive context is characterized as a set of contour patches which have been encoded.

Based on the local feature description on the first layer in our representation structure, we model a higher-level description, so as to incorporate the temporal and spatial order into the feature representation. The motivation is that the difference between two interactions not only depends on the local features in the video sequence, but also depends on the temporal and spatial order of these local features. Taking the local spatio-temporal features in Fig. 6 for example, the activity in the above volume is considered to be the same as the one in the below volume by the descriptor in Cuboids [14]. However, the semantics of these two activities are different, since their temporal orders are different. When we segment the volume, such as the volumes in the right one in Fig. 6, the two activities can be discriminated effectively. Similarly, the spatial orders affecting on the activities understanding are in the same way. For this reason, we propose the Spatio-Temporal Segment Clustering (STSC) method, to characterize the difference of spatial and temporal order between interactive activities.

In our representation structure, we use the STSC method to represent mid-level spatio-temporal motion features and interactive context features respectively.

We assume the video sequence as V with f frames. Instead of extracting spatio-temporal features from the whole video sequence V, we divide the sequence V into segments along both temporal and spatial domain. Specifically, we keep the number of segments the same for different length of clips, so as to make the feature vectors have the same length. These segments will be represented as mid-level spatio-temporal features. First, the video sequence is divided into p segments in temporal order, and V is represented as 
                              
                                 [
                                 
                                    V
                                    1
                                 
                                 ,
                                 
                                    V
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    V
                                    p
                                 
                                 ]
                              
                           . Each temporal segment 
                              
                                 
                                    V
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                              
                            includes 
                              
                                 N
                                 =
                                 f
                                 /
                                 p
                              
                            frames. Further, each segment 
                              
                                 
                                    V
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                              
                            is divided into upper and bottom subsegments in spatial order, which are indicated as V
                           
                              i1 and V
                           
                              i2 respectively. In each subsegment 
                              
                                 
                                    V
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                              
                            in V, we then extract spatio-temporal cuboids [14]. The examples of extracted cuboids are shown in Fig. 7. In each subsegment Vij
                           , after encoding the cuboids by Hierarchical Spatio-Temporal Trajectory Coding Model (HSTTCM) on the lower layer of our representation structure, the cuboids are clustered by the k-means algorithm and a histogram for each subsegment is created for the mid-level features. The final spatio-temporal motion features for interaction are represented as the concatenation of these histograms. In this way, the
                            spatial and temporal orders are incorporated into spatio-temporal motion features.

As for the mid-level context feature description, we also follow the video segmentation strategy in temporal described in Section 3.3.1. For the video clip V with f frames represented as the sequence 
                              
                                 [
                                 
                                    V
                                    1
                                 
                                 ,
                                 
                                    V
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    V
                                    p
                                 
                                 ]
                                 ,
                              
                            we sample m, m < f frames from each segment 
                              
                                 
                                    V
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 p
                                 ,
                              
                            and extract interactive contours from these frames. These contours will include both of persons acting in the interaction. We first adopt an inexact ALM method [48] to do the foreground extraction, which can regard the interacting persons as low-rank structure within the video data. Thus, a set of context features is represented as 
                              
                                 s
                                 F
                                 =
                                 [
                                 s
                                 
                                    I
                                    1
                                 
                                 ,
                                 s
                                 
                                    I
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 s
                                 
                                    I
                                    p
                                 
                                 ]
                                 ,
                              
                            in which 
                              
                                 s
                                 
                                    I
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                              
                            is the set of frames in each temporal segment. For spatial order, we further divide each temporal segment 
                              
                                 s
                                 
                                    I
                                    i
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                              
                            into two subsegments, which are denoted as 
                              
                                 s
                                 
                                    I
                                    
                                       i
                                       j
                                    
                                 
                                 ,
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 p
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                              
                           .

After encoding the interactive contour patches by the contour coding method [38] on the first layer of our structure, the cluster prototypes for coding each subsegment sIij
                            in the video clip V are used. Although this method is simple, but is very powerful and maintaining its richness. Thus, the sIij
                            is depicted as a histogram of the contour types for the mid-level context features, and the context features sF will be represented as the concatenation of each subsegment.

@&#EXPERIMENTS@&#

To validate the performance of our representation structure, we carry out our experiments on three standard video datasets in action recognition, which are HMDB51 [42], Hollywood2 [56] and UT-Interaction [57]. The first two datasets are more challenging, because they have more complex cluttered backgrounds and context. In our experiment, firstly we take the interaction sequence as one volume, and extract the spatio-temporal cuboids from this volume. The average length of videos for the experiment is 3 seconds with resolution 176 × 112, and frame rate 30 fps. We set the cuboid scales (σx, σy, σt
                     ) as (12, 12, 8). This means that each cuboid consists of 8 frames, and each frame patch is 12 × 12. By the proposed model of HSTTCM for spatio-temporal trajectory coding, we obtain the trajectory basis patterns, which are used to represent spatio-temporal features in each video sequence. Furthermore, the context features are extracted as well, and incorporated with the spatio-temporal features. Finally, the spatio-temporal motion features and context features are combined, then we train a LSSVM [43] to classify the interactive activities from video clips. Supposing vector aF represents the spatio-temporal motion features extracted from video clips after coding by HSTTCM, and sF represents the context feature corresponding to the interaction, we concatenate the two vectors into the final one, which is defined as 
                        
                           F
                           =
                           [
                           a
                           F
                           s
                           F
                           ]
                        
                     . This vector F will be used as the ultimate feature for each video sequence to be learned by the LSSVM.

In this section, the results on these datasets are compared with the previous methods respectively. Furthermore, we give detailed analysis and discussion on the effectiveness of the proposed representation structure, the discriminative performance of the hierarchical spatio-temporal trajectory coding methods, and the recognition improvement by the context features.

The HMDB51 dataset [42] contains 6766 video clips in total and 51 action classes. We choose six action types which are clapping, hugging, shaking hands, waving hands, hitting and kissing. All these action types are related to affective interaction. About 240 clips, including six action classes, are selected for our experiments. We compute the 4-fold leave-one-out cross validation for each interaction, and the performance is evaluated by average precision as [42].

Using the model HSTTCM to represent the spatio-temporal motion features, we achieve a good performance on the interaction classification. In order to show the performance of our model HSTTCM for spatio-temporal motion feature representation, we compare the results to other conventional common spatio-temporal feature descriptors. The results are shown in Table 2 based on HMDB51 dataset.

From Table 2, the results show that the visual cortex based trajectory coding method HSTTCM outperforms the other descriptors on the six interactive activities related to emotions. Specifically, three of the interactions, including “Clapping”, “Hitting” and “Waving” are improved greatly. However, among the mentioned methods in Table 2, the recognition precision of Hugging is always the lowest. Thus, we further analyze the interactions and show out the confusion matrix, which is demonstrated in Table 3.

From Table 3, we observed that the main errors are
                           
                           
                            made on the confusion between “Hugging” and “Clapping”. From the video clips, we analyzed that there are two reasons that affect the discriminations between those two interactions. For one reason, the interactions have the characteristics of spatial and temporal order. Taking the interaction as one volume and extracting the local motions as features in this volume from different interactions, there exist a lot of similar action cuboids between those two interactions. Instead, taking the interaction as a sequence of segments divided from the action volume, more spatial and temporal information can be incorporated into the feature extraction and representation. For this purpose, first the proposed Spatio-Temporal Segment Clustering (STSC) method is used to extract the mid-level spatio-temporal features. We set 
                              
                                 p
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 6
                                 ,
                              
                            which denotes that the video clip will be divided into 1 segments, 2 segments and 6 segments respectively in temporal order. The best performance is obtained when 
                              
                                 p
                                 =
                                 6
                              
                           . Then, each temporal segment is further divided into 2 subsegments respectively in spatial order. The compared performances are shown in Table 4. For another reason, the interactive context also plays a great importance in the classification among the interactions. Although the “Hugging” and “Clapping” have similar motion cuboids in the whole video clip, they have different interactive context. Therefore, it is necessary to incorporate the interactive context features into the representation. We will detail the experiments and evaluation for this part in the next section.


                           Table 4 shows that the recognition accuracy has been improved through the Spatio-Temporal Segment Clustering (STSC) method. Exceptionally, the recognition of “Hugging” is still 0, which is not improved. Thus, the Spatio-Temporal Segment Clustering (STSC) method is effective on recognizing most of the interactions, but not effective on “Hugging”.

Furthermore, intuitively the feature dimensions affect the quality of action description. In order to evaluate effectiveness of feature dimensions on recognition, we do the experiments with different feature dimensions. The experimental results suggest that the recognition accuracy depends on the feature dimension. Part of the results are shown in the second column of Table 5. aD is the feature dimension to represent spatio-temporal motion in this table. These results are the best three performances by three different dimensions, and the best one is achieved when 
                              
                                 a
                                 D
                                 =
                                 240
                              
                           .

Considering the importance of context in action recognition, we incorporate the context information into the interaction description. Firstly, we prepare to subtract background from video. Then, using the Spatio-Temporal Segment Clustering method, the video sequences are divided into 8 segments in temporal order, and 2 subsegments in spatial order in each temporal segment. From each of the subtracted frames, we further exact 500 patches of 12 pixels randomly and create the contour dictionary using Hierarchical Contour Coding model [38]. For the context parameter settings of cluster prototypes we conduct a series of experiments on different number of clusters to obtain the best parameter setting.

In experiments, we also conduct the evaluations on different spatio-temporal motion feature dimensions. Differently, the features for classification are the integration of action and context, and the context dimension is defined as 
                              
                                 c
                                 D
                                 =
                                 80
                              
                           . Part of the recognition performances are demonstrated in Table 5 as well. Compared to the performance of action features only, the recognition rate shows the improvement by additional context information. From this table, the best result is obtained when 
                              
                                 a
                                 D
                                 =
                                 280
                              
                           .

In addition, in order to validate the effectiveness of context feature dimensions on recognition, we further do the experiment with different context feature dimensions, and obtain the best result when 
                              
                                 c
                                 D
                                 =
                                 120
                              
                           . This is shown in Table 6.

In this table, cD is the feature dimension for context representation. From this table, we find that the recognition rate is improved as the dimension increases. The best performance can be exceeded to 0.617. The confusion matrix of the best performance is shown in Table 7.

Compared to the recognition by action features based method, Table 7 shows that the recognition accuracy of each interaction is improved. Specifically, the recognition accuracy of “Hugging” achieves 0.4 , which outperforms the experimental result on spatio-temporal motion features only. Therefore, we conclude that the context information using interactive contours plays a significant role in the interaction recognition.

To summarize, firstly, in this experiment, our proposed Hierarchical Spatio-Temporal Trajectory Coding Model (HSTTCM) significantly outperforms the conventional sparse coding method and common feature descriptors. In Table 2, our model shows more than 20% improvement over a representative sparse coding method [25]. Secondly, the spatial and temporal order of motions in interaction has important effects on the interaction recognition. From the experiment results, which is shown in Table 3, we notice that the splitting the video sequence can further improve the recognition rate. Finally, considering the importance of context for action recognition, we conduct the experiments by introducing the interactive contours as context features. The results verify that the context features using interactive contours can further improve the recognition rate of interaction, especially the “Hugging” and “Shaking hands”.

Furthermore, our method is implemented in MATLAB. All experiments are run on a desktop PC with a 2.6 GHz Intel i7 CPU and 4 GB RAM. The performance for each step of the proposed scheme in terms of processing time(s) is shown in Table 8
                           .

The Hollywood2 dataset is collected from 69 realistic movies. It contains 1707 videos and 12 action classes, which are divided into 33 training movies and 36 testing movies. We select four interactive activity types in experiment, which are fighting, hand shaking, hugging and kissing. These activity classes are related with the affective interaction. The results are evaluated by the average precision over the four classes.

We follow the same experimental settings as that in Section 4.1. With these settings, we achieve 67.5% average accuracy of recognition with spatio-temporal motion features and context features. Our results are compared to several conventional common feature descriptors shown in Table 9
                        , and the confusion matrix for Hollywood2 dataset is illustrated in Table 10
                        .

From this table, we can observe that two interactions, which are “fighting” and “shaking hands”, still have good performances of recognition. The main errors are confused between “hugging” and “kissing”, which are very difficult to classify even for human beings.

The UT-Interaction dataset contains 120 videos (720 × 480, 30 fps) and 6 interaction classes, which are acted by two people interacting with each other in two scenes Set1 and Set2. Each interaction class has 20 video clips. Despite uncluttered static background and simplicity of the actions, this dataset is relatively difficult, because some categories in this dataset are too similar, such as “punching” and “pushing”. In our experiments, we use 10-fold leave-one-out cross validation as the scheme in [57] to evaluate the performance.

On the UT-Interaction dataset, we achieve 84.0% mean accuracy performance with spatio-temporal motion features only and 92.3% with both spatio-temporal motion features and context features. Our method is further compared with the previous literatures, and the results in our work show the state-of-art performance, which is illustrated in Table 11
                        .

@&#CONCLUSION@&#

In this work, we present a Hierarchical Feature Representation Structure for affective interaction recognition. This two-layer structure can represent the interactive features effectively based on the local feature and mid-level feature descriptions. The Hierarchical Sptio-Temporal Trajectory Coding Model (HSTTCM) used in local feature description describes the local spatio-temporal motion features effectively. The Spatio-Temporal Segment Clustering method further exploits the spatial and temporal order of motions for interaction in the mid-level feature description. In addition, the interactive context, which is explored and incorporated into the interaction features in the structure, shows excellent performance. Experimental results show that the proposed Hierarchical Sptio-Temporal Trajectory Coding Model represents the interactive activities effectively than other hand-crafted descriptors and conventional sparse coding methods. Furthermore, according to the experiments, it is also demonstrated that interaction context is essential for accurate classification of behavior and significantly improves the performance of interaction recognition. In the future, we will extend the classes of emotional actions and research on the recognition of more behaviors related to emotions, and integrate more information which affects the recognition, such as facial expression, scene context and same form with distinct temporal movement, etc. Based on the study of emotional behaviors combining with different context information, we will further study on the recognition and analysis of individuals intention.

@&#ACKNOWLEDGMENTS@&#

This work was partially supported by the National Natural Science Foundation of China (no. 61304262), Tianjin Research Program of Application Foundation and Advanced Technology (no. 15JCQNJC00900) and the Doctor Foundation of Tianjin Normal University (no. 52XB1410).

@&#REFERENCES@&#

