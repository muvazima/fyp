@&#MAIN-TITLE@&#Two-stage network constrained robust unit commitment problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Provide one of the first studies on network constrained robust unit commitment.


                        
                        
                           
                           Introduce a two-dimensional uncertainty set to describe the uncertain parameters.


                        
                        
                           
                           Develop an exact and a bilinear heuristic approaches to solve the problem.


                        
                        
                           
                           Cost savings obtained as compared to the traditional approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Unit commitment

Transmission capacity limits

Mixed integer programming

Optimization under uncertainty

@&#ABSTRACT@&#


               
               
                  For a current deregulated power system, a large amount of operating reserve is often required to maintain the reliability of the power system using traditional approaches. In this paper, we propose a two-stage robust optimization model to address the network constrained unit commitment problem under uncertainty. In our approach, uncertain problem parameters are assumed to be within a given uncertainty set. We study cases with and without transmission capacity and ramp-rate limits (The latter case was described in Zhang and Guan (2009), for which the analysis part is included in Section 3 in this paper). We also analyze solution schemes to solve each problem that include an exact solution approach and an efficient heuristic approach that provides tight lower and upper bounds for the general network constrained robust unit commitment problem. The final computational experiments on an IEEE 118-bus system verify the effectiveness of our approaches, as compared to the nominal model without considering the uncertainty.
               
            

@&#INTRODUCTION@&#

For a current deregulated power system, the demands on a power system are highly uncertain (e.g., see Mazer, 2007) due to weather, demand response program, and other conditions. This brings great challenges in grid management and generation scheduling to power system operators. To address this uncertainty, most electric power markets in US execute reliability unit commitment runs after the closure of the day-ahead market, and ensure enough generation capacity for the next operating day (e.g., see Whittle et al., 2006). Stochastic programming approaches have been shown efficient to solve unit commitment problems under uncertainty. For instance, a multistage stochastic programming formulation and Lagrangian solution techniques were developed early in Takriti and Birge (2000). This approach was further studied considering incorporating fuel constraints and electricity spot prices (Takriti et al., 2000). Other relevant Lagrangian decomposition literature includes (Carpentier et al., 1996; Dentcheva and Römisch, 1997; Gollmer et al., 2000). Recently, the stochastic programming approach for unit commitment was applied to solve hydro-electric unit commitment subject to uncertain demand (Philpott et al., 2000), to generate supply curves in electric power markets (Philpott and Schultz, 2006), to serve as a decision aid for scheduling and hedging in the wholesale electric power markets (Sen et al., 2006), to help a power generation company take part in an electricity spot market (Cerisola et al., 2009), to help provide self-commitment of one generating unit under the deregulated market (Valenzuela and Mazumdar, 2003), and to estimate the potential contribution of demand flexibility in replacing operating reserves (Papavasiliou and Oren, 2010). Other recent related unit commitment studies include developing a real options approach to address short-term generation asset valuation (Tseng and Barz, 2002), evaluating the value of rolling-horizon policies for risk-averse hydro-thermal planning (Guigues and Sagastizábal, 2012), deriving an optimal scheduling policy for a hydro thermal power generation system (Oliveira et al., 1993), studying efficient algorithms for combined heat and power systems under the deregulated electricity market (Rong and Lahdelma, 2007; Rong et al., 2008), and deriving a floating-point genetic algorithm to solve the unit commitment problem (Dang and Li, 2007).

Besides the traditional two-stage and multi-stage stochastic programming approaches with the objective of minimizing the total expected cost, risk averse objectives, such as Conditional Value-at-Risk (CVaR) (Jabr, 2005), and chance constraints (Wang et al., 2012) are also introduced in power industry to control risk and ensure the feasibility. To solve the stochastic optimization problems, scenarios are usually generated based on the forecasted demand distributions. This usually leads to a large scale deterministic equivalent formulation and accordingly decomposition algorithms are developed to achieve tractable computation (Papavasiliou and Oren, 2010; Takriti and Birge, 2000). In this research, we emphasize risk rather than cost, because reliability has very high priority for system operators, which is also the reason to introduce reliability unit commitment runs. Thus, we propose a two-stage robust optimization approach (Ben-Tal and Nemirovski, 1998; El Ghaoui and Lebret, 1997; Bertsimas and Sim, 2003) to address uncertainty. Instead of providing a detailed description of the probability distributions, the uncertain parameters are assumed to be within a polyhedral uncertainty set (cf. Bertsimas and Sim, 2003; Bienstock and Özbay, 2008; Yao et al., 2009). Our proposed robust optimization approach can serve as a complement of the stochastic programming approaches, as well as the current reliability unit commitment run practice.

In our approach, we provide unit commitment decisions in the first stage with the objective of minimizing the system-wide power generation costs including the unit commitment cost and dispatch cost under the worst-case scenarios. Our initial study on the two-stage robust unit commitment problem is described in Zhang and Guan (2009), for which the analysis part is included in Section 3 in this paper. Besides, for the single-stage robust optimization approach, the readers are referred to the initial studies on solving the contingency-constrained unit commitment with n–K security criterion described in Street et al. (2011) and on solving the optimal bidding strategy problem described in Baringo and Conejo (2011). Related two-stage robust optimization approaches include (Zhao and Zeng, 2012; Bertsimas et al., 2013; Jiang et al., 2012). In Zhao and Zeng (2012), a two-stage robust optimization model with one-dimensional demand uncertainty set (along time horizon) is proposed to solve an aggregated model without considering transmission constraints. In Bertsimas et al. (2013), a two-stage robust optimization model also with one-dimensional demand uncertainty set (along different buses for a given time unit) is introduced, and a heuristic separation approach is studied to test a real instance. In Jiang et al. (2012), a special case of this work is studied, in which a different one-dimensional cardinality uncertainty set is provided and a heuristic approach is developed to solve the problem with the consideration of pumped storage hydro. Besides the initial study for the two-stage robust unit commitment problem, as compared to the related two-stage robust optimization approaches (i.e., Zhao and Zeng, 2012; Bertsimas et al., 2013; Jiang et al., 2012), our additional contributions can be summarized as follows:
                        
                           •
                           We introduce a two-dimensional uncertainty set to describe the uncertain problem parameters. That is, we allow the uncertainty correlations among different buses and among different time periods, as compared to the one-dimensional uncertainty sets studied in related works.

We develop an exact and a bilinear heuristic separation approaches to solve the robust unit commitment problem. Our bilinear separation approach can generate tight lower and upper bounds for the optimal objective value, and is computationally efficient as demonstrated in the computational experiments on an IEEE 118-bus system.

We analyze the insights of the problem by studying a simplified version of the problem. The properties of the objective value functions are analyzed. In addition, the separation problem is shown NP-hard, which indicates the problem is hard to solve in general. Meanwhile, our computational results show that this simplified model provides a very tight lower bound for the problem.

We introduce a Benders’ decomposition framework that includes both feasibility and optimality cuts. The feasibility cuts in the Benders’ decomposition framework help address important feasibility issues for the real-time market. Our computational results indicate that the proposed approach will generate significant cost savings, under the worst-case scenarios, as compared to the traditional nominal model.

The remaining part of this paper is organized as follows. Section 2 describes the mathematical formulation for the general network constrained robust unit commitment problem. In addition, we show that the spinning reserve constraints are not necessary for the robust optimization model. Section 3 develops a solution approach and explores insights for a simplified version of the network constrained robust unit commitment problem. In Section 4, we explore the solution schemes to solve the general network constrained robust unit commitment problem. Section 5 reports the extensive computational results. Finally, Section 6 concludes our study.

For a T-period network constrained unit commitment problem, we let 
                        
                           E
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           M
                           }
                        
                      and 
                        
                           N
                           =
                           {
                           1
                           ,
                           n
                           ,
                           …
                           ,
                           N
                           }
                        
                      represent the sets of buses and generators, and 
                        
                           A
                        
                      represent the set of transmission lines linking two buses. For each bus 
                        
                           m
                           ∈
                           E
                        
                     , we let 
                        
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                        
                      be the set of generators in this bus. Accordingly, for each generator 
                        
                           i
                           ∈
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                        
                     , we let 
                        
                           
                              
                                 S
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      represent the start-up (shut-down) cost, 
                        
                           
                              
                                 G
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          H
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      represent the minimum-up (minimum-down) time, 
                        
                           
                              
                                 L
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      represent the minimum (maximum) output of electricity if the generator is on, 
                        
                           
                              
                                 V
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      represent the ramp-up (ramp-down) rate limit, and 
                        
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       ‾
                                    
                                 
                              
                              
                                 i
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      represent the start-up (shut-down) ramp rate limit. For each transmission line 
                        
                           (
                           i
                           ,
                           j
                           )
                           ∈
                           A
                        
                     , we let C
                     
                        ij
                      represent the capacity of the transmission line, and 
                        
                           
                              
                                 K
                              
                              
                                 ij
                              
                              
                                 m
                              
                           
                        
                      represent the line flow distribution factor for the transmission line, due to the net injection at bus m, 
                        
                           ∀
                           m
                           ∈
                           E
                        
                     . To describe the uncertainty set, we let 
                        
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ‾
                                    
                                 
                              
                              
                                 mt
                              
                           
                           ,
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                        
                     , and 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                        
                      represent the nominal demand, the lower and upper bounds of the demand at bus m in time period t. In addtion, we let 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 r
                              
                           
                           ≔
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           -
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                        
                     .

For our two-stage network constrained robust unit commitment problem, in the first stage we provide the unit commitment decisions 
                        
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          it
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          u
                                       
                                       
                                          it
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          it
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                        
                      for each generator that include: 1) if generator i at bus m is on or not in time period t (i.e., 
                        
                           
                              
                                 y
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           1
                        
                      if yes; 
                        
                           
                              
                                 y
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           0
                        
                      o.w.), 2) if generator i at bus m is started up or not in time period t (i.e., 
                        
                           
                              
                                 u
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           1
                        
                      if yes; 
                        
                           
                              
                                 u
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           0
                        
                      o.w.), and 3) if generator i at bus m is shut down or not in time period t (i.e., 
                        
                           
                              
                                 v
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           1
                        
                      if yes; 
                        
                           
                              
                                 v
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           =
                           0
                        
                      o.w.). In the second stage, we let random parameter d
                     
                        mt
                      represent the demand at bus m in time period t, and decision variable 
                        
                           
                              
                                 x
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                        
                      represent the amount of electricity generated by generator i at bus m in time period t. In addition, we approximate the non-decreasing convex fuel cost 
                        
                           
                              
                                 f
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          it
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                           =
                           
                              
                                 c
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 b
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           
                              
                                 x
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           +
                           
                              
                                 a
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                        
                      by a P-piece piecewise linear function 
                        
                           
                              
                                 f
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          it
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                           ⩾
                           
                              
                                 α
                              
                              
                                 it
                              
                              
                                 mp
                              
                           
                           
                              
                                 y
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           +
                           
                              
                                 β
                              
                              
                                 it
                              
                              
                                 mp
                              
                           
                           
                              
                                 x
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                           ,
                           
                           ∀
                           m
                           ∈
                           E
                           ,
                           ∀
                           i
                           ∈
                           
                              
                                 N
                              
                              
                                 m
                              
                           
                           ,
                           1
                           ⩽
                           p
                           ⩽
                           P
                        
                     . Then the two-stage network constrained robust unit commitment problem can be described as follows:
                        
                           (1)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                R
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   y
                                                   ,
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   ϑ
                                                   )
                                                   ∈
                                                   X
                                                   (
                                                   y
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ϑ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                ik
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          0
                                          ,
                                          1
                                          ⩽
                                          k
                                          -
                                          (
                                          t
                                          -
                                          1
                                          )
                                          ⩽
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                ik
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          1
                                          ,
                                          1
                                          ⩽
                                          k
                                          -
                                          (
                                          t
                                          -
                                          1
                                          )
                                          ⩽
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              (
                              NC
                              -
                              RUC
                              )
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    i
                                    (
                                    t
                                    -
                                    1
                                    )
                                 
                                 
                                    m
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ⩽
                              0
                              ,
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                                 
                                    y
                                 
                                 
                                    i
                                    (
                                    t
                                    -
                                    1
                                    )
                                 
                                 
                                    m
                                 
                              
                              -
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              -
                              
                                 
                                    v
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ⩽
                              0
                              ,
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    U
                                 
                                 
                                    i
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ⩾
                              (
                              1
                              +
                              R
                              %
                              )
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           
                              
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                              ,
                           
                        
                     where 
                        
                           X
                           (
                           y
                           ,
                           d
                           )
                           =
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                       (
                                       x
                                       ,
                                       ϑ
                                       )
                                       :
                                       
                                          
                                             L
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ⩽
                                       
                                          
                                             x
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ⩽
                                       
                                          
                                             U
                                          
                                          
                                             i
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                       ∀
                                       m
                                       ∈
                                       E
                                       ,
                                       
                                       ∀
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                       ∀
                                       t
                                       ∈
                                       T
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                x
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          (
                                          1
                                          +
                                          
                                             
                                                y
                                             
                                             
                                                i
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (10)
                           
                              -
                              
                                 
                                    C
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    K
                                 
                                 
                                    ij
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                n
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             nt
                                          
                                          
                                             m
                                          
                                       
                                       -
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                              ⩽
                              
                                 
                                    C
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              ,
                              
                              ∀
                              t
                              ∈
                              T
                           
                        
                     
                     
                        
                           (11)
                           
                              
                              
                                 
                                    
                                       
                                          
                                             ϑ
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ⩾
                                       
                                          
                                             α
                                          
                                          
                                             it
                                          
                                          
                                             mp
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             β
                                          
                                          
                                             it
                                          
                                          
                                             mp
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                       ∀
                                       m
                                       ∈
                                       E
                                       ,
                                       
                                       ∀
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                       ∀
                                       p
                                       ∈
                                       P
                                       ,
                                       
                                       ∀
                                       t
                                       ∈
                                       T
                                    
                                 
                              
                           
                        
                     and 
                        
                           D
                        
                      is a given uncertainty set that defines the range for the demands to be flexible:
                        
                           (12)
                           
                              D
                              =
                              
                                 
                                    
                                       d
                                       :
                                       
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⩽
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       ⩽
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                       ∀
                                       m
                                       ∈
                                       E
                                       ,
                                       
                                       ∀
                                       t
                                       ,
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                       ∀
                                       t
                                       ,
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     In (12), π
                     
                        mt
                      represents the weight for the demand in bus m at time t, 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      is the given upper bound of the total weighted demand for time period t, and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                      is the given upper bound of the total weighted demand for the planning horizon. Without loss of generality, we assume 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           ,
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                     , and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                      are integers. For this uncertainty set (12), the budgets are imposed on the total weighted demand among all buses at each time period (i.e., 
                        
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           ⩽
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                           ,
                           ∀
                           t
                        
                     ) as well as on the total weighted demand over all time periods (i.e., 
                        
                           
                              
                                 ∑
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           ⩽
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                     ). Thus, this proposed uncertainty set is two-dimensional (including both temporal and spatial elements), which is more general as compared to the related works which are one-dimensional. Also, as compared to the related models imposing budget constraints on total absolute variations of demand from the nominal value, e.g., 
                        
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           |
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           -
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ‾
                                    
                                 
                              
                              
                                 mt
                              
                           
                           |
                           /
                           (
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 μ
                              
                           
                           -
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                           )
                           ⩽
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                     , in this paper, we bound the total weighted demand from above. The parameters 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                     , and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                      can be easily obtained from historical data. For instance, we can set 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                        
                      and 
                        
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                        
                      equal to the .05 and .95-quantiles of the demand forecast, respectively, and we can similarly obtain the values of 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                     . For example, if π
                     
                        mt
                     
                     =1 for each m and t, we can set 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      equal to the .90-quantile of the total demand forecast in time period t, and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                        
                      equal to the .90-quantile of the total demand forecast in the whole planning horizon.

Our objective is to minimize the total cost, including start-up, shut-down, and fuel costs, under the worst-case scenario. Constraints (1) describe the minimum-up time required for generator i once it is started up. Accordingly, constraints (2) describe the minimum-down time required for generator i once it is shut down. Constraints (3) and (4) indicate the start-up and shut-down operations for each generator i. Constraints (5) describe the spinning reserve requirement for the power system in each period t, where R% represents the spinning reserve percentage. Constraints (6) describe the upper and lower bounds of power output of generator i if it is on in period t. Constraints (7) and (8) describe the ramp-up/ramp-down and start-up/shut-down ramp rate limit restrictions. Note here that in this paper, ramping constraints combine ramp-rate limit restriction when a generator is on and first-hour (last-hour) generation amount restriction as described in Guan et al. (1992). Constraints (9) ensure the power system flow balance. Finally, we follow the work in Wang et al. (1995) to describe the transmission capacity limits in constraints (10), which is the lossless linearized DC approximation of AC power flow governed by Kirchhoff’s laws.

Before discussing the solution approaches, we observe that spinning reserve constraints (5) are not necessary for the robust optimization formulation when 
                        
                           D
                        
                      is set properly. First, we call a solution (y,
                     u,
                     v) first-stage feasible to (NC-RUC) without constraints (5), if (y,
                     u,
                     v) satisfies constraints (1)–(4) and for any 
                        
                           d
                           ∈
                           D
                        
                     , there exists at least one second-stage solution (x,
                     ϑ) that satisfies constraints (6)–(11). Then, we have
                        Proposition 1
                        
                           Any first-stage feasible solution (y,u,v) to (NC-RUC) without constraints 
                           
                              (5)
                            
                           automatically satisfies spinning reserve constraints 
                           
                              (5)
                           
                           , when the uncertainty set 
                           
                              
                                 D
                              
                            
                           satisfies the following conditions: (i) 
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       mt
                                    
                                    
                                       u
                                    
                                 
                                 ⩾
                                 (
                                 1
                                 +
                                 R
                                 %
                                 )
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       mt
                                    
                                 
                                 ,
                                 ∀
                                 m
                                 ,
                                 t
                              
                           
                           , (ii) 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       mt
                                    
                                 
                                 (
                                 1
                                 +
                                 R
                                 %
                                 )
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       mt
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 ∀
                                 t
                              
                           
                           , and (iii)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                s
                                                =
                                                1
                                             
                                          
                                          
                                             
                                                s
                                                ≠
                                                t
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       ms
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       ms
                                    
                                    
                                       ℓ
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       mt
                                    
                                 
                                 (
                                 1
                                 +
                                 R
                                 %
                                 )
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       mt
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                              
                           
                           .
                        

Prove by contradiction. We assume the conclusion is not true. That is, there exists a first-stage feasible solution 
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                            to (NC-RUC) without (5) and with 
                              
                                 D
                              
                            satisfying the conditions, while 
                              
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            does not satisfy constraints (5) for a particular period τ, i.e.,
                              
                                 (13)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          τ
                                       
                                       
                                          m
                                       
                                    
                                    <
                                    (
                                    1
                                    +
                                    R
                                    %
                                    )
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          m
                                          τ
                                       
                                    
                                    .
                                 
                              
                           On the other hand, since 
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                            is first-stage feasible, for each 
                              
                                 d
                                 ∈
                                 D
                              
                           , there should exist at least a second-stage solution 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 d
                                 )
                                 ,
                                 
                                    
                                       ϑ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 d
                                 )
                                 )
                              
                            satisfying constraints (6)–(11). Corresponding to constraints (9) for time period τ, we have
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          τ
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    d
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          m
                                          τ
                                       
                                    
                                    ,
                                    
                                    ∀
                                    d
                                    ∈
                                    D
                                    .
                                 
                              
                           Now we pick a 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                                 ∈
                                 D
                              
                            such that
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          mt
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      R
                                                      %
                                                      )
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  ‾
                                                               
                                                            
                                                         
                                                         
                                                            mt
                                                         
                                                      
                                                      ,
                                                      
                                                      if
                                                      
                                                      t
                                                      =
                                                      τ
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            mt
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                      ,
                                                      
                                                      o
                                                      .
                                                      w
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    m
                                    ∈
                                    E
                                    .
                                 
                              
                           Note here that the above 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            satisfies all inequalities in (12) in view of conditions (i), (ii) and (iii), which verifies that 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            is in 
                              
                                 D
                              
                           . Following the definition of 
                              
                                 
                                    
                                       d
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           , we have 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       m
                                       τ
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                                 (
                                 1
                                 +
                                 R
                                 %
                                 )
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             ‾
                                          
                                       
                                    
                                    
                                       m
                                       τ
                                    
                                 
                              
                           . Then, based on (14) and (6), we have
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    (
                                    1
                                    +
                                    R
                                    %
                                    )
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          m
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          τ
                                       
                                       
                                          m
                                       
                                    
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          i
                                          τ
                                       
                                       
                                          m
                                       
                                    
                                    ,
                                 
                              
                           which contradicts with (13). Therefore, the original conclusion holds. □.

We first consider the case in which transmission capacity and ramp-rate limits are relaxed. This is the robust optimization version of the simplified unit commitment problem. It will help us (i) to understand the insights of the basic problem structure, and (ii) to obtain a lower bound for the general network constrained robust unit commitment problem. Also, as we will see in this section, the second-stage problem of this relaxation model is time-decomposable and so can be efficiently solved. In Section 5, we find that this relaxation can provide a very tight lower bound for the general robust unit commitment model.

In this case, for notation brevity, we omit the index m in the formulation. To illustrate the main results, we assume the fuel cost is linear (e.g., 
                        
                           
                              
                                 f
                              
                              
                                 it
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 it
                              
                           
                           )
                           =
                           
                              
                                 α
                              
                              
                                 it
                              
                           
                           +
                           
                              
                                 β
                              
                              
                                 it
                              
                           
                           
                              
                                 x
                              
                              
                                 it
                              
                           
                           ,
                           ∀
                           i
                           ∈
                           N
                        
                     ). Note that our conclusion for the multiple-piece approximation case also holds. In addition, for analysis completeness, we introduce z
                     
                        t
                      and w
                     
                        t
                      to represent the generation curtailment and load shedding amount of electricity at time period t, and accordingly, let P
                     
                        t
                      and R
                     
                        t
                      represent the unit generation curtailment and load shedding cost. Without loss of generality, we assume
                        
                           (15)
                           
                              -
                              
                                 
                                    P
                                 
                                 
                                    t
                                 
                              
                              <
                              0
                              <
                              
                                 
                                    β
                                 
                                 
                                    1
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    2
                                    t
                                 
                              
                              ⩽
                              …
                              ⩽
                              
                                 
                                    β
                                 
                                 
                                    Nt
                                 
                              
                              <
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              ∀
                              t
                              .
                           
                        
                     The corresponding robust optimization model can be simplified as follows:
                        
                           (16)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   y
                                                   ,
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   N
                                                
                                             
                                          
                                          (
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   z
                                                   ,
                                                   w
                                                   )
                                                   ∈
                                                   X
                                                   (
                                                   y
                                                   ,
                                                   d
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            N
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          RUC
                                          )
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                          Constraints
                                          
                                             (1)–(4)
                                          
                                          
                                          without
                                          
                                          index
                                          
                                          m
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           X
                           (
                           y
                           ,
                           d
                           )
                           =
                           {
                           (
                           x
                           ,
                           z
                           ,
                           w
                           )
                           :
                           
                              
                                 L
                              
                              
                                 i
                              
                           
                           
                              
                                 y
                              
                              
                                 it
                              
                           
                           ⩽
                           
                              
                                 x
                              
                              
                                 it
                              
                           
                           ⩽
                           
                              
                                 U
                              
                              
                                 i
                              
                           
                           
                              
                                 y
                              
                              
                                 it
                              
                           
                           ,
                           
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 N
                              
                           
                           
                              
                                 x
                              
                              
                                 it
                              
                           
                           +
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           -
                           
                              
                                 z
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           ,
                           
                           
                              
                                 x
                              
                              
                                 it
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 t
                              
                           
                           ⩾
                           0
                           ,
                           i
                           ∈
                           N
                           ,
                           
                           ∀
                           t
                           }
                        
                     
                     
                        
                           (17)
                           
                              and
                              
                              D
                              =
                              
                                 
                                    
                                       d
                                       :
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             t
                                          
                                          
                                             ℓ
                                          
                                       
                                       ⩽
                                       
                                          
                                             d
                                          
                                          
                                             t
                                          
                                       
                                       ⩽
                                       
                                          
                                             D
                                          
                                          
                                             t
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                       ∀
                                       t
                                    
                                 
                              
                           
                        
                     with 
                        
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 ℓ
                              
                           
                        
                      and 
                        
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                      representing the lower and upper bounds for the demand in time period t, where parameters 
                        
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 D
                              
                              
                                 t
                              
                              
                                 u
                              
                           
                        
                     , π
                     
                        t
                     , and π
                     0 are integers.

To solve (RUC), we first analyze the optimal value function g
                     
                        t
                     (y
                     
                        t
                     , d
                     
                        t
                     ) for the subproblem in the second stage once the first stage decision variable (y,
                     u,
                     v) is fixed. In this case, (RUC) is decomposed into T subproblems. Corresponding to each time period t, we have
                        
                           (18)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          =
                                          
                                             min
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                R
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                P
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          ⩽
                                          
                                             
                                                x
                                             
                                             
                                                it
                                             
                                          
                                          ⩽
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          ,
                                          
                                          i
                                          ∈
                                          N
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       N
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                              
                              +
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    d
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           
                              
                              
                              
                                 
                                    x
                                 
                                 
                                    it
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              0
                              ,
                              
                              i
                              ∈
                              N
                              .
                           
                        
                     In the optimal solution for the subproblem corresponding to each time period t, we have 
                        
                           
                              
                                 z
                              
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       N
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                 
                                 -
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 w
                              
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       N
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                 
                                 )
                              
                              
                                 +
                              
                           
                        
                     , where x
                     +
                     =max{x,0}.
                        Proposition 2
                        
                           The value function g
                           
                              t
                           
                           (y
                           
                              t
                           
                           ,
                           
                           d
                           
                              t
                           
                           ) is piecewise linear and convex in d
                           
                              t
                           
                           . In addition, it can be described in closed form as shown in 
                           
                              (20), (21)
                           
                           , and 
                           
                              (22)
                           
                           .
                        

From constraints (18) and (19), based on the cost relationship shown in (15), we can observe:
                              
                                 •
                                 If 
                                       
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ⩽
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    , then in the optimal solution, each generator generates at its lower bound and the generation curtailment amount is 
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                       
                                    . The total cost is
                                       
                                          (20)
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   t
                                                   0
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   it
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             +
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   φ
                                                
                                                
                                                   t
                                                   0
                                                
                                             
                                             (
                                             y
                                             )
                                             -
                                             
                                                
                                                   P
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                    where 
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                t
                                                0
                                             
                                          
                                          (
                                          y
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                P
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    .

If 
                                       
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ⩾
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    , then in the optimal solution, each generator generates at its upper bound. The load shedding amount is 
                                       
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    . The total cost is
                                       
                                          (21)
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   t
                                                   (
                                                   N
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   it
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             +
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               N
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   φ
                                                
                                                
                                                   t
                                                   (
                                                   N
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             (
                                             y
                                             )
                                             +
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                    where 
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                t
                                                (
                                                N
                                                +
                                                1
                                                )
                                             
                                          
                                          (
                                          y
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          -
                                          
                                             
                                                R
                                             
                                             
                                                t
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    .

For the general case, assuming 
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         θ
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         θ
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         θ
                                                         +
                                                         1
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         θ
                                                      
                                                   
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    , θ
                                    =1,…,
                                    N, the total cost is
                                       
                                          (22)
                                          
                                             
                                                
                                                   g
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   t
                                                   θ
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      θ
                                                      +
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   it
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      θ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   β
                                                
                                                
                                                   it
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   θ
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      θ
                                                      +
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      θ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   U
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   φ
                                                
                                                
                                                   t
                                                   θ
                                                
                                             
                                             (
                                             y
                                             )
                                             +
                                             
                                                
                                                   β
                                                
                                                
                                                   θ
                                                   t
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                          
                                       
                                    where 
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                t
                                                θ
                                             
                                          
                                          (
                                          y
                                          )
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                                +
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          -
                                          
                                             
                                                β
                                             
                                             
                                                θ
                                                t
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                                +
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          -
                                          
                                             
                                                β
                                             
                                             
                                                θ
                                                t
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    .

From (20), (21), and (22), we can observe that ϕ
                           
                              tθ
                           (d
                           
                              t
                           ), θ
                           =0,…,
                           N
                           +1, is a linear function of d
                           
                              t
                           . Based on (15) and 
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                       θ
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                                +
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                       (
                                       θ
                                       +
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                                +
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       θ
                                       +
                                       1
                                    
                                    
                                       N
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       it
                                    
                                 
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       θ
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       it
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       it
                                    
                                 
                              
                           , we have that the value function g
                           
                              t
                           (y
                           
                              t
                           ,
                           d
                           
                              t
                           ) is piecewise linear and convex in d
                           
                              t
                           . Therefore, the conclusion holds. □

Since the value function g
                           
                              t
                           (y
                           
                              t
                           ,
                           d
                           
                              t
                           ) is piecewise linear and convex, the following corollary holds. □


                           The value function 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       0
                                       ,
                                       …
                                       ,
                                       N
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                           , where θ
                           
                              t
                            
                           represents the value of θ at time period t as shown in 
                           
                              (20), (21)
                           
                           , and 
                           
                              (22)
                           
                           .
                        

Based on the conclusion obtained in Proposition 2 and Corollary 1, RUC) can be reformulated as
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   y
                                                   ,
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                g
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                          
                                          )
                                          +
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   d
                                                   ∈
                                                   D
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            =
                                                            0
                                                            ,
                                                            …
                                                            ,
                                                            N
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         t
                                                         
                                                            
                                                               θ
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          Constraints
                                          
                                          (
                                          16
                                          )
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                          i
                                          ∈
                                          N
                                          ,
                                          
                                          ∀
                                          t
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Now we can introduce a new continuous decision variable μ for the second stage as follows:
                        
                           (23)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   y
                                                   ,
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          (
                                          
                                             
                                                α
                                             
                                             
                                                it
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                S
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                          
                                          )
                                          +
                                          μ
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          μ
                                          ⩾
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   0
                                                   ,
                                                   …
                                                   ,
                                                   N
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                          
                                             
                                                ϕ
                                             
                                             
                                                t
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          
                                          for
                                          
                                          all
                                          
                                          d
                                          ∈
                                          D
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              Constraints
                              
                              (
                              16
                              )
                              
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    it
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    it
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                              i
                              ∈
                              N
                              ,
                              
                              ∀
                              t
                              ,
                              μ
                              ∈
                              R
                              .
                           
                        
                     In the optimal solution, for a given (y,
                     u,
                     v), since 
                        
                           
                              
                                 ϕ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 ϕ
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           )
                        
                      are mutually independent, we have
                        
                           (24)
                           
                              μ
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   θ
                                                
                                                
                                                   t
                                                
                                             
                                             }
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             {
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             +
                                             1
                                             }
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          
                                             ϕ
                                          
                                          
                                             t
                                             
                                                
                                                   θ
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       :
                                       d
                                       ∈
                                       D
                                    
                                 
                              
                              .
                           
                        
                     Note here that for a given θ
                     
                        t
                     , the dual of (24) can be described as follows:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             min
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ζ
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                t
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          (
                                          y
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          Dual
                                          )
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                π
                                             
                                             
                                                t
                                             
                                          
                                          ζ
                                          +
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                ϑ
                                             
                                             
                                                t
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          ,
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          ζ
                                          ,
                                          η
                                          ,
                                          ρ
                                          ⩾
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 ϑ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        
                      is the coefficient of d
                     
                        t
                      in function 
                        
                           
                              
                                 ϕ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           )
                        
                     . That is, 
                        
                           
                              
                                 ϑ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           =
                           -
                           
                              
                                 P
                              
                              
                                 t
                              
                           
                        
                      if θ
                     
                        t
                     
                     =0, 
                        
                           
                              
                                 ϑ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 t
                              
                           
                        
                      if θ
                     
                        t
                     
                     =
                     N
                     +1, and 
                        
                           
                              
                                 ϑ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           =
                           
                              
                                 β
                              
                              
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                                 t
                              
                           
                        
                      if 1⩽
                     θ
                     
                        t
                     
                     ⩽ 
                     N. We also notice that 
                        
                           
                              
                                 φ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           (
                           y
                           )
                        
                      is a constant number here for the dual problem once t, θ
                     
                        t
                      and y are given.

Therefore, the problem can be solved using the Benders’ decomposition algorithm (the framework is similar to the one described in Section 4). For instance, we do not need to consider constraints (23) in our initial first-stage master problem. When θ
                     
                        t
                      for each t is given, we can add the dual constraints, which are linear, to the first-stage master problem. In the remaining part of this section, we analyze the following separation problem with the uncertainty set (17) given.


                     Separation Problem (SP): Given a solution (y,u,v,μ), does there exist (θ
                     1,…,θ
                     
                        T
                     ) and 
                        
                           d
                           ∈
                           D
                        
                     , such that 
                        
                           μ
                           <
                           
                              
                                 ∑
                              
                              
                                 t
                                 =
                                 1
                              
                              
                                 T
                              
                           
                           
                              
                                 ϕ
                              
                              
                                 t
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           (
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           )
                        
                     ?
                        Theorem 1
                        
                           The separation problem (SP) is NP-hard under the budget uncertainty set 
                           
                              
                                 D
                              
                            
                           as described in 
                           
                              (17)
                           
                           .
                        

We prove the claim by reducing a 0–1 knapsack problem to (SP). Given an instance of a 0–1 knapsack problem (e.g., 
                              
                                 max
                                 {
                                 cx
                                 :
                                 ux
                                 ⩽
                                 b
                                 ,
                                 x
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       T
                                    
                                 
                                 ,
                                 b
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       +
                                    
                                 
                                 }
                              
                           ), we construct a separation problem (SP) as follows:

There are T time periods and 2T generators. At each time period t, only two generators 2t
                           −1 and 2t are turned on. Assume that the minimum-up and minimum-down times for both generators are one time period. In addition, the maximum outputs of generators 2t
                           −1 and 2t are u
                           
                              t
                           
                           −1 and 1(with minimum outputs to be zeros for both), and the corresponding unit production costs are 0 and c
                           
                              t
                           , respectively. The budget uncertainty set is 
                              
                                 D
                                 =
                                 
                                    
                                       
                                          d
                                          :
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ⩽
                                          b
                                          ,
                                          0
                                          ⩽
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          ⩽
                                          
                                             
                                                u
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          b
                                          ∈
                                          
                                             
                                                Z
                                             
                                             
                                                +
                                             
                                          
                                       
                                    
                                 
                              
                           .

From the above constructed separation problem (SP), we can observe that for each time period, we use generator 2t
                           −1 to satisfy the demand if d
                           
                              t
                           
                           ⩽
                           u
                           
                              t
                           
                           −1, because the unit production cost is zero. If d
                           
                              t
                           
                           =
                           u
                           
                              t
                           , then we have to use generator 2t to produce one unit at the cost c
                           
                              t
                           . Therefore, it can be observed that there exists an optimal (SP) solution d
                           ∗, such that for any t, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                              
                            is either 0 or u
                           
                              t
                           . It is equivalent to the knapsack solution with the same objective value. Therefore, the separation problem with uncertainty set 
                              
                                 D
                              
                            is NP-hard. □

Since the separation problem under the budget uncertainty set is closely related to the knapsack problem, we propose a dynamic programming algorithm to solve it. Given a first stage solution y, we will determine the extreme scenario d which gives the most violated constraint, or determine that the current solution is feasible. The algorithm is based on the following observation.
                        Observation 1
                        For any extreme scenario 
                              
                                 d
                                 ∈
                                 D
                              
                           , there exists a time period t, such that for any t′≠
                           t, 
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 or
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       u
                                    
                                 
                              
                           .

This observation is obtained by the convexity of function g
                     
                        t
                     (y
                     
                        t
                     , d
                     
                        t
                     ) and the extreme points of uncertainty set 
                        
                           D
                        
                     . Moreover, we can derive the following lemma for the extreme scenario d.
                        Lemma 1
                        
                           For any extreme scenario 
                           
                              
                                 d
                                 ∈
                                 D
                              
                            
                           with respect to the first stage solution (y,
                           
                           μ), if 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          ,
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                                +
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    
                                 
                              
                            
                           for some θ, then d corresponds to the optimal solution of the following knapsack problem
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        D
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                     
                                                                        u
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               g
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        y
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        D
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      SPN
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                                )
                                                
                                                s
                                                .
                                                t
                                                .
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         J
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                                ∈
                                                {
                                                0
                                                ,
                                                1
                                                }
                                                ,
                                                j
                                                ∈
                                                J
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where J
                           ={j:β
                           
                              θt
                           /π
                           
                              t
                           
                           ⩽
                           R
                           
                              j
                           /π
                           
                              j
                           ,
                           j
                           ≠
                           t}, 
                              
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 -
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ≠
                                       t
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                 
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                θ
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                          +
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                θ
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                          
                                       
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       t
                                       θ
                                    
                                 
                              
                            is the indicator of d
                           
                              j
                            (i.e., 
                              
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       t
                                       θ
                                    
                                 
                                 =
                                 0
                              
                            if 
                              
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       t
                                       θ
                                    
                                 
                                 =
                                 1
                              
                            if 
                              
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       u
                                    
                                 
                              
                           ).

From the definition of J, if j
                           ∉
                           J and j
                           ≠
                           t, then we can observe that 
                              
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       ℓ
                                    
                                 
                              
                            in the extreme scenario. If not, then 
                              
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       u
                                    
                                 
                              
                            based on Observation 1. Then, decreasing d
                           
                              j
                            by a small δ/π
                           
                              j
                           
                           >0 while increasing d
                           
                              t
                            by δ/π
                           
                              t
                            will increase the second stage cost by δ (β
                           
                              θt
                           /π
                           
                              t
                           
                           −
                           R
                           
                              j
                           /π
                           
                              j
                           ), which contradicts with the claim that d is the extreme scenario. Thus, the optimal objective value 
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                       θ
                                    
                                    
                                       ∗
                                    
                                 
                              
                            for (SPN
                           
                              tθ
                           ) corresponds to the worst second-stage cost increment by picking periods j in which 
                              
                                 
                                    
                                       d
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       j
                                    
                                    
                                       u
                                    
                                 
                              
                           . □

Note here that the similar analysis can be applied for the cases in which 
                        
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          t
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          it
                                       
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 d
                              
                              
                                 t
                              
                           
                           ∈
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          it
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          t
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        
                     . Thus, we only need to consider T(N
                     +2) knapsack problems to solve (SP), because there are T(N
                     +2) combinations of t and θ. The dynamic programming algorithm for the knapsack problem can be adopted directly to solve each (SPN
                     
                        tθ
                     ).

Now we consider obtaining the extreme demand d after solving the T(N
                     +2) knapsack problems. For each combination of t and θ, let the optimal solution of (SPN
                     
                        tθ
                     ) be (s
                     
                        tθ
                     )∗ with the corresponding optimal objective value 
                        
                           
                              
                                 z
                              
                              
                                 t
                                 θ
                              
                              
                                 ∗
                              
                           
                        
                     , and 
                        
                           
                              
                                 λ
                              
                              
                                 t
                                 θ
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    -
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          J
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   j
                                                
                                                
                                                   u
                                                
                                             
                                             -
                                             
                                                
                                                   D
                                                
                                                
                                                   j
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                      θ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                           
                           /
                           
                              
                                 π
                              
                              
                                 t
                              
                           
                        
                     .

If λ
                     
                        tθ
                     
                     ⩽ (U
                     
                        θ
                     
                     −
                     L
                     
                        θ
                     )y
                     
                        θt
                     , let 
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                                 θ
                              
                           
                           =
                           
                              
                                 z
                              
                              
                                 t
                                 θ
                              
                              
                                 ∗
                              
                           
                        
                      and (t,θ) be a candidate to generate the extreme demand d. Otherwise, let 
                        
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                                 θ
                              
                           
                           =
                           0
                        
                     , which implies that in the extreme scenario, d
                     
                        t
                      is not in the θth interval. Let 
                        
                           (
                           
                              
                                 t
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ∗
                              
                           
                           )
                           =
                           arg
                           
                              
                                 max
                              
                              
                                 t
                                 ∈
                                 T
                                 ,
                                 θ
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 N
                                 ,
                                 N
                                 +
                                 1
                              
                           
                           {
                           
                              
                                 
                                    
                                       z
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 t
                                 θ
                              
                           
                           }
                        
                     .

Then, based on (SPN
                     
                        tθ
                     ), we can observe if 
                        
                           μ
                           ⩾
                           
                              
                                 z
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       ∗
                                    
                                 
                              
                              
                                 ∗
                              
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 t
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           
                              
                                 g
                              
                              
                                 t
                              
                           
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          t
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                           
                           +
                           
                              
                                 g
                              
                              
                                 
                                    
                                       t
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          
                                             
                                                θ
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          L
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          
                                             
                                                it
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          U
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          y
                                       
                                       
                                          
                                             
                                                it
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     , the solution is feasible. Otherwise, we can construct the extreme demand d as follows:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                                
                                                   N
                                                
                                             
                                          
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      it
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                
                                                   
                                                      it
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                D
                                             
                                             
                                                t
                                             
                                             
                                                ℓ
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          ,
                                          t
                                          
                                          ≠
                                          
                                          
                                             
                                                t
                                             
                                             
                                                ∗
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Based on the fact that the knapsack problem can be solved in 
                        
                           O
                           (
                           T
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 0
                              
                           
                           )
                        
                      time (Toth, 1980), we have that
                        Proposition 3
                        
                           The separation problem (SP) can be solved in pseudo-polynomial time 
                           
                              
                                 O
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             π
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       0
                                    
                                 
                                 N
                                 )
                              
                           
                           .
                        

In this section, we develop solution methods to solve the general two-stage network constrained robust unit commitment problem (NC-RUC). We develop solution approaches that can provide exact and near-optimal solutions, respectively. Given a first-stage decision variable y, let ω(y) represent the optimal value function for the second-stage problem of (NC-RUC). By dualizing the constraints in 
                        
                           X
                           (
                           y
                           ,
                           d
                           )
                        
                     , we have
                        
                           (25)
                           
                              ω
                              (
                              y
                              )
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       γ
                                       ,
                                       η
                                       ,
                                       τ
                                       ,
                                       ρ
                                       ,
                                       d
                                       ,
                                       ξ
                                       ,
                                       ζ
                                    
                                 
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      m
                                                      +
                                                   
                                                
                                                -
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      m
                                                      -
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             η
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              f
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             ξ
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                       ,
                                       
                                          
                                             ζ
                                          
                                          
                                             it
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             ij
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             τ
                                          
                                          
                                             ij
                                             ,
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       -
                                       
                                          
                                             K
                                          
                                          
                                             ij
                                          
                                          
                                             m
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             τ
                                          
                                          
                                             ij
                                             ,
                                             t
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                       ∈
                                       A
                                    
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             τ
                                          
                                          
                                             ij
                                             ,
                                             t
                                          
                                          
                                             +
                                          
                                       
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             ij
                                             ,
                                             t
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                1
                                             
                                             
                                                M
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                p
                                                =
                                                1
                                             
                                             
                                                P
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      m
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      mp
                                                   
                                                
                                                
                                                   
                                                      ρ
                                                   
                                                   
                                                      it
                                                   
                                                   
                                                      mp
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (26)
                           
                              
                                 
                                    
                                    
                                       
                                          (
                                          SUB
                                          )
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                +
                                             
                                          
                                          -
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                -
                                             
                                          
                                          +
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                i
                                                (
                                                t
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          +
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ζ
                                             
                                             
                                                i
                                                (
                                                t
                                                +
                                                1
                                                )
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         mp
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         mp
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          0
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          ∀
                                          t
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (27)
                           
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       =
                                       1
                                    
                                    
                                       P
                                    
                                 
                              
                              
                                 
                                    ρ
                                 
                                 
                                    it
                                 
                                 
                                    mp
                                 
                              
                              =
                              1
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                              ∀
                              t
                           
                        
                     
                     
                        
                           (28)
                           
                              
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              ⩽
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              ⩽
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              t
                           
                        
                     
                     
                        
                           (29)
                           
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              ∀
                              t
                           
                        
                     
                     
                        
                           (30)
                           
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                +
                                             
                                          
                                          ,
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                -
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                             
                                             
                                                ij
                                                ,
                                                t
                                             
                                             
                                                +
                                             
                                          
                                          ,
                                          
                                             
                                                τ
                                             
                                             
                                                ij
                                                ,
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                ρ
                                             
                                             
                                                it
                                             
                                             
                                                mp
                                             
                                          
                                          ⩾
                                          0
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          p
                                          ∈
                                          P
                                          ,
                                          ∀
                                          (
                                          i
                                          ,
                                          j
                                          )
                                          ∈
                                          A
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          where
                                          
                                          f
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                          -
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     and the decision variables 
                        
                           
                              
                                 γ
                              
                              
                                 it
                              
                              
                                 m
                                 ±
                              
                           
                           ,
                           
                              
                                 ξ
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                        
                     , 
                        
                           
                              
                                 ζ
                              
                              
                                 it
                              
                              
                                 m
                              
                           
                        
                     , η
                     
                        t
                     , 
                        
                           
                              
                                 τ
                              
                              
                                 ij
                                 ,
                                 t
                              
                              
                                 ±
                              
                           
                        
                      and 
                        
                           
                              
                                 ρ
                              
                              
                                 it
                              
                              
                                 mp
                              
                           
                        
                      are the dual variables for constraints (6)–(11). We observe that (SUB) is a bilinear program with products of (η,
                     τ) and d in the objective function, and thus NP-hard under general data settings (e.g., 
                        
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           >
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                     ).

In this section, we develop optimality and feasibility cuts and provide separation schemes embedded in a Benders’ decomposition framework to solve (NC-RUC). For the Benders’ decomposition framework, we can solve the following master program iteratively by adding new constraints to cut off infeasible or non-optimal solutions:
                        
                           (32)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                M
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   min
                                                
                                                
                                                   y
                                                   ,
                                                   u
                                                   ,
                                                   v
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          ω
                                          (
                                          y
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          Master
                                          )
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                it
                                             
                                             
                                                ms
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ⩽
                                          
                                             
                                                κ
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                          s
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          S
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (33)
                           
                              
                              
                              ω
                              (
                              y
                              )
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    it
                                 
                                 
                                    mr
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ⩾
                              
                                 
                                    
                                       
                                          κ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                              r
                              =
                              1
                              ,
                              …
                              ,
                              R
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          (
                                          1
                                          )
                                          –
                                          (
                                          4
                                          )
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where constraints (32) represent the selected feasibility cuts added to the master problem, while constraints (33) represent the optimality cuts.


                        Optimality cuts: From (SUB), we observe that for a given first-stage decision variable y,
                           
                              (34)
                              
                                 ω
                                 (
                                 y
                                 )
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                mt
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          f
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         mt
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         ij
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         mt
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                C
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   p
                                                   =
                                                   1
                                                
                                                
                                                   P
                                                
                                             
                                          
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                it
                                             
                                             
                                                mp
                                             
                                          
                                          
                                             
                                                ρ
                                             
                                             
                                                it
                                             
                                             
                                                mp
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        for any feasible (γ,
                        η,
                        τ,
                        ξ,
                        ζ,
                        ρ,
                        d). Thus, cut (34) is valid for (Master).


                        Feasibility cuts: To check the feasibility of given y, we apply the Benders’ method as described in Nemhauser and Wolsey (1988) and formulate the following feasibility checking program (FEA) by adding slacks in the second-stage problem of (NC-RUC):
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   f
                                                
                                             
                                             (
                                             y
                                             )
                                             =
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      p
                                                      ,
                                                      q
                                                      ,
                                                      r
                                                      ,
                                                      s
                                                      ⩾
                                                      0
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     +
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     -
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     +
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     q
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     -
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               ∈
                                                               A
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ij
                                                                     ,
                                                                     t
                                                                  
                                                                  
                                                                     +
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     ij
                                                                     ,
                                                                     t
                                                                  
                                                                  
                                                                     -
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             
                                                
                                                   L
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             ⩽
                                             
                                                
                                                   x
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   +
                                                
                                             
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             E
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                            +
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   p
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   -
                                                
                                             
                                             ⩽
                                             
                                                
                                                   U
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                             ∀
                                             m
                                             ∈
                                             E
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                            -
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   (
                                                   t
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   q
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   +
                                                
                                             
                                             ⩽
                                             
                                                
                                                   
                                                      2
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            (
                                                            t
                                                            -
                                                            1
                                                            )
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         V
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            (
                                                            t
                                                            -
                                                            1
                                                            )
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   V
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             ∀
                                             m
                                             ∈
                                             E
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                   (
                                                   t
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   q
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   -
                                                
                                             
                                             ⩽
                                             
                                                
                                                   
                                                      2
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            (
                                                            t
                                                            -
                                                            1
                                                            )
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            i
                                                            (
                                                            t
                                                            -
                                                            1
                                                            )
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   i
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             ∀
                                             m
                                             ∈
                                             E
                                             ,
                                             
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ∈
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   mt
                                                
                                             
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             (
                                             
                                                
                                                   η
                                                
                                                
                                                   t
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             -
                                             
                                                
                                                   C
                                                
                                                
                                                   ij
                                                
                                             
                                             ⩽
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                             
                                                
                                                   K
                                                
                                                
                                                   ij
                                                
                                                
                                                   m
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               n
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            nt
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            mt
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   s
                                                
                                                
                                                   ij
                                                   ,
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             ,
                                             
                                             ∀
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               n
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            nt
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            mt
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   s
                                                
                                                
                                                   ij
                                                   ,
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             ⩽
                                             
                                                
                                                   C
                                                
                                                
                                                   ij
                                                
                                             
                                             ,
                                             
                                             ∀
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             ,
                                             
                                             ∀
                                             t
                                             ∈
                                             T
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    ±
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    ±
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    t
                                 
                                 
                                    ±
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    ij
                                    ,
                                    t
                                 
                                 
                                    ±
                                 
                              
                           
                         represent the slacks, and 
                           
                              
                                 
                                    γ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    ±
                                 
                              
                           
                        , 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    ζ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                           
                        , η
                        
                           t
                         and 
                           
                              
                                 
                                    τ
                                 
                                 
                                    ij
                                    ,
                                    t
                                 
                                 
                                    ±
                                 
                              
                           
                         are the dual variables associated with the corresponding constraints. It is clear that if ω
                        
                           f
                        (y)=0, then y is feasible for the given d. Otherwise, if ω
                        
                           f
                        (y)>0, we can take the dual of (FEA) and generate a feasibility cut in the following form
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                L
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                +
                                             
                                          
                                          -
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                γ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                                -
                                             
                                          
                                          +
                                          f
                                          (
                                          
                                             
                                                y
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          ,
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          )
                                          )
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                mt
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     m
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     M
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  mt
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     m
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     M
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  K
                                                               
                                                               
                                                                  ij
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  mt
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  ij
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 0
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    γ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    ±
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    ζ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                           
                        , η
                        
                           t
                         and 
                           
                              
                                 
                                    τ
                                 
                                 
                                    ij
                                    ,
                                    t
                                 
                                 
                                    ±
                                 
                              
                           
                         are the elements in the dual optimal solution to (FEA) and d
                        
                           mt
                         is given for solving (FEA). We can then add the cut to (Master) to cut off the infeasible y.


                        Exact separation approach: To obtain an exact separation, we need to solve the subproblem (SUB) into optimality. In the following, we show how we can solve the bilinear subproblem by solving a mixed-integer linear program. First, we can observe that the optimal solution for (NC-RUC) satisfies the following condition.
                           Proposition 4
                           
                              There exists an optimal solution (γ
                              ∗
                              ,
                              
                              η
                              ∗
                              ,
                              
                              τ
                              ∗
                              ,
                              
                              ξ
                              ∗
                              ,
                              
                              ζ
                              ∗
                              ,
                              
                              ρ
                              ∗
                              ,
                              
                              d
                              ∗
                              ) to (SUB) that satisfies the following condition: For each time period t, 
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          mt
                                       
                                       
                                          ∗
                                       
                                    
                                    =
                                    
                                       
                                          D
                                       
                                       
                                          mt
                                       
                                       
                                          u
                                       
                                    
                                 
                               
                              or 
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          mt
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                              , except at most one bus in which 
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          mt
                                       
                                       
                                          ∗
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   mt
                                                
                                                
                                                   ℓ
                                                
                                             
                                             ,
                                             
                                                
                                                   D
                                                
                                                
                                                   mt
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                    
                                 
                               
                              to make the constraint 
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          mt
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          mt
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                 
                               
                              tight, or to make the constraint 
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          mt
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          mt
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                 
                               
                              tight.
                           

We note that (SUB) maximizes a bilinear function over a polyhedron, where the linear constraints of (γ,
                              η,
                              τ,
                              ξ,
                              ζ,
                              ρ) and those of d are disjoint. Hence, there exists an optimal solution (γ
                              ∗,
                              η
                              ∗,
                              τ
                              ∗,
                              ξ
                              ∗,
                              ζ
                              ∗,
                              ρ
                              ∗,
                              d
                              ∗) to (SUB) such that d
                              ∗ is an extreme point of the polyhedron represented by the constraints of d, i.e., 
                                 
                                    D
                                 
                              . If this is not the case, we can fix (γ
                              ∗,
                              η
                              ∗,
                              τ
                              ∗,
                              ξ
                              ∗,
                              ζ
                              ∗,
                              ρ
                              ∗) and solve (SUB), which, after optimized, gives us an extreme point d
                              ∗ of 
                                 
                                    D
                                 
                              . Besides, based on the problem structure, it is easy to check that d
                              ∗ is an extreme point of 
                                 
                                    D
                                 
                               if and only if d
                              ∗ satisfies the condition in the above claim. □

Based on Proposition 4, as an extreme point, the demand in each bus at each time period will make: (1) lower or upper bound constraint tight, or (2) inequalities (29) tight, or (3) inequality (30) tight. Then, we let binary decision variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              =
                              1
                           
                         representing that 
                           
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                                 
                                    ∗
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                           
                        , binary decision variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    f
                                 
                              
                              =
                              1
                           
                         if 
                           
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                         and it makes the corresponding inequality (29) tight, and binary decision variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              =
                              1
                           
                         if 
                           
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                         and it makes the corresponding inequality (30) tight. In addition, we let binary decision variable z
                        
                           t
                        
                        =1 if the corresponding inequality (29) is tight. We can observe the following constraints hold:
                           
                              (35)
                              
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       f
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 E
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        
                        
                           
                              (36)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       f
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       g
                                    
                                 
                                 ⩽
                                 1
                                 ,
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       f
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       mt
                                    
                                    
                                       g
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 m
                                 ∈
                                 E
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                              
                           
                        where (35) indicates that the demand in each bus at each time period will play at most one role, (36) indicates that, at each time period t, at most one bus in which the demand plays the role to make the corresponding inequality (29) tight, and at most one bus at a particular time period in which the demand plays the role to make (30) tight. To avoid duplicated calculation, (37) indicates that if the demand for a bus in time period t is used to make (30) tight, then no bus in time period t will be considered to make (29) tight. Then, we can observe the following proposition holds.
                           Proposition 5
                           
                              The exact separation for (NC-RUC) exists by reformulating the bilinear subproblem shown in 
                              
                                 (25)
                               
                              as a mixed-integer linear program, and obtaining the optimal solution of the corresponding reformulation.
                           

The detailed proof and the reformulation process are described in Appendix A. □


                        Heuristic separation approach: It is challenging to use the exact separation approach to solve large size instances, due to a large amount of integer decision variables. To solve large-scale problems, we propose a heuristic approach that can solve the problem quickly. We first write down the following two linear programs, generated by fixing γ, η, τ, ρ, ξ, ζ and d in (SUB), respectively.
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      γ
                                                      ,
                                                      η
                                                      ,
                                                      τ
                                                      ,
                                                      ρ
                                                      ,
                                                      ξ
                                                      ,
                                                      ζ
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                            +
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            U
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            γ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                            -
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            mt
                                                         
                                                      
                                                      
                                                         
                                                            η
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      A
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        m
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        M
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     mt
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        m
                                                                        =
                                                                        1
                                                                     
                                                                     
                                                                        M
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     d
                                                                  
                                                                  
                                                                     mt
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   SUB
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                             
                                                
                                                   
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               p
                                                               =
                                                               1
                                                            
                                                            
                                                               P
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     α
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     mp
                                                                  
                                                               
                                                               
                                                                  
                                                                     ρ
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     mp
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      f
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     ξ
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     ζ
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             (
                                             26
                                             )
                                             
                                             and
                                             
                                             (
                                             27
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   γ
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   +
                                                
                                             
                                             ,
                                             
                                                
                                                   γ
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                   -
                                                
                                             
                                             ,
                                             
                                                
                                                   τ
                                                
                                                
                                                   ij
                                                   ,
                                                   t
                                                
                                                
                                                   +
                                                
                                             
                                             ,
                                             
                                                
                                                   τ
                                                
                                                
                                                   ij
                                                   ,
                                                   t
                                                
                                                
                                                   -
                                                
                                             
                                             ,
                                             
                                                
                                                   ξ
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                                
                                                   ζ
                                                
                                                
                                                   it
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             
                                                
                                                   ρ
                                                
                                                
                                                   it
                                                
                                                
                                                   mp
                                                
                                             
                                             ⩾
                                             0
                                             
                                             ∀
                                             m
                                             ∈
                                             E
                                             ,
                                             ∀
                                             i
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   m
                                                
                                             
                                             ,
                                             ∀
                                             p
                                             ,
                                             ∀
                                             (
                                             i
                                             ,
                                             j
                                             )
                                             ∈
                                             A
                                             ,
                                             ∀
                                             t
                                             ;
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      d
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     η
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        (
                                                                        i
                                                                        ,
                                                                        j
                                                                        )
                                                                        ∈
                                                                        A
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     K
                                                                  
                                                                  
                                                                     ij
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              τ
                                                                           
                                                                           
                                                                              ij
                                                                              ,
                                                                              t
                                                                           
                                                                           
                                                                              +
                                                                           
                                                                        
                                                                        -
                                                                        
                                                                           
                                                                              τ
                                                                           
                                                                           
                                                                              ij
                                                                              ,
                                                                              t
                                                                           
                                                                           
                                                                              -
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                         
                                                         
                                                            mt
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     L
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     γ
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     +
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     U
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                               
                                                                  
                                                                     γ
                                                                  
                                                                  
                                                                     it
                                                                  
                                                                  
                                                                     m
                                                                     -
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   SUB
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             
                                             
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               (
                                                               i
                                                               ,
                                                               j
                                                               )
                                                               ∈
                                                               A
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            -
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            ij
                                                            ,
                                                            t
                                                         
                                                         
                                                            +
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               p
                                                               =
                                                               1
                                                            
                                                            
                                                               P
                                                            
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            mp
                                                         
                                                      
                                                      
                                                         
                                                            ρ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            mp
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               m
                                                               =
                                                               1
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               ∈
                                                               
                                                                  
                                                                     N
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      f
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            it
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                             
                                             (
                                             28
                                             )
                                             –
                                             (
                                             30
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        In our heuristic approach, we follow the alternating method described in Konno (1976). We fix one set of variables and optimize the other set. Then we alternate until the objective value converges. For instance, this bilinear heuristic to generate an optimality cut for a given feasible solution y and ω(y) to (Master) can be described as follows:
                           
                              
                                 Step 1:
                              
                              Pick an extreme point d of 
                                    
                                       D
                                    
                                 ;

Solve (SUB1), and store the optimal objective value ω
                                 1(y,d);

Solve (SUB2), and store the optimal objective value ω
                                 2(y,
                                 γ,
                                 η,
                                 τ,
                                 ρ,
                                 ξ,
                                 ζ);

If ω
                                 2(y,
                                 γ,
                                 η,
                                 τ,
                                 ρ,
                                 ξ,
                                 ζ)>
                                 ω
                                 1(y,
                                 d), go to Step 2, otherwise go to Step 5;

If ω
                                 2(y,
                                 γ,
                                 η,
                                 τ,
                                 ρ,
                                 ξ,ζ)>
                                 ω(y), generate the corresponding optimality cut (34), and add the cut to (Master).

The similar approach can be applied to get feasible cuts. This approach is experimentally shown to converge to optimality for a bilinear program with a small optimality gap (less than 0.05%) (Ahmed and Guan, 2005).

In this subsection, we construct lower and upper bounds of the optimal objective value of (NC-RUC), i.e., z
                        R. In the separation scheme, we track these bounds to estimate the solution quality. First, it is easy to observe that if we fix d to be any point in 
                           
                              D
                           
                         and solve the corresponding deterministic model (denote the corresponding objective value as z
                        UC), then z
                        UC
                        ⩽
                        z
                        R, providing a lower bound for z
                        R. Besides, our heuristic separation approach can provide a lower bound.
                           Proposition 6
                           
                              The objective value obtained by our heuristic separation approach provides a lower bound for the optimal objective value of (NC-RUC).
                           

The conclusion immediately follows from the fact that heuristic separation approach cannot guarantee to obtain an optimal solution for the subproblem. □

Second, we can obtain a statistical upper bound U by fixing the first-stage decision and conducting Monte Carlo simulation for the second-stage problem of (NC-RUC). Suppose that we have obtained a first-stage decision 
                           
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                           
                        . To obtain U, we first fix 
                           
                              y
                              =
                              
                                 
                                    y
                                 
                                 
                                    ¯
                                 
                              
                           
                         in (NC-RUC), and then generate random large size demands to evaluate the performance of the robust optimal solution and record the corresponding cost. Finally, we assign the largest cost to U.
                           Proposition 7
                           
                              Given a feasible solution to (NC-RUC), the statistical upper bound U converges to an upper bound of z
                              
                                 R
                               
                              almost surely and exponentially fast.
                           

We let H(d) be the optimal objective value for (SUB1) corresponding to a given 
                                 
                                    d
                                    ∈
                                    D
                                 
                               and 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               be the given feasible first-stage solution to (NC-RUC). It can be observed from established duality theory that H(d) is a continuous (convex) function of d. Let 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ∗
                                       
                                    
                                    ∈
                                    D
                                 
                               represent the maximal point, i.e., 
                                 
                                    H
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          d
                                          ∈
                                          D
                                       
                                    
                                    H
                                    (
                                    d
                                    )
                                 
                              , and suppose that we are sampling from the region 
                                 
                                    D
                                 
                               according to a continuous probability distribution P with a positive density function on 
                                 
                                    D
                                 
                               (e.g., P can be a truncated normal distribution on 
                                 
                                    D
                                 
                              ).

For any ∊
                              >0, we define δ
                              =
                              P(H(d)>
                              H(d
                              ∗)−
                              ∊). Since H(d) is continuous, the constant δ
                              >0. Now suppose that we take a series of independent samples {d
                              
                                 n
                              :n
                              ⩾1}, and let 
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                 
                               represent the largest objective value obtained from the first N samples, i.e., 
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          n
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              . Then
                                 
                                    
                                       P
                                       (
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             N
                                          
                                       
                                       >
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       -
                                       ∊
                                       )
                                       =
                                       1
                                       -
                                       P
                                       (
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             N
                                          
                                       
                                       ⩽
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       -
                                       ∊
                                       )
                                       =
                                       1
                                       -
                                       P
                                       (
                                       
                                          
                                             
                                                max
                                             
                                             
                                                n
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                N
                                             
                                          
                                       
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       ⩽
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       -
                                       ∊
                                       )
                                       =
                                       1
                                       -
                                       
                                          
                                             Π
                                          
                                          
                                             n
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                          
                                       
                                       P
                                       (
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             n
                                          
                                       
                                       )
                                       ⩽
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       -
                                       ∊
                                       )
                                       =
                                       1
                                       -
                                       
                                          
                                             (
                                             1
                                             -
                                             δ
                                             )
                                          
                                          
                                             N
                                          
                                       
                                       .
                                    
                                 
                              Hence, 
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                 
                               converges exponentially fast to H(d
                              ∗) in terms of probability. Furthermore, since
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                N
                                                =
                                                1
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       P
                                       (
                                       |
                                       
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             N
                                          
                                       
                                       -
                                       H
                                       (
                                       
                                          
                                             d
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                       |
                                       >
                                       ∊
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                N
                                                =
                                                1
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             (
                                             1
                                             -
                                             δ
                                             )
                                          
                                          
                                             N
                                          
                                       
                                       <
                                       ∞
                                       ,
                                    
                                 
                              the conclusion that 
                                 
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                 
                               converges to H(d
                              ∗) almost surely follows from Borel-Cantelli theorem. Now suppose that we denote 
                                 
                                    c
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                 
                               as the unit commitment cost associated with the first-stage problem of (NC-RUC), then 
                                 
                                    c
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    +
                                    H
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                    ⩾
                                    
                                       
                                          z
                                       
                                       
                                          R
                                       
                                    
                                 
                               since 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                               is a feasible solution to (NC-RUC). In other words, 
                                 
                                    c
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    +
                                    H
                                    (
                                    
                                       
                                          d
                                       
                                       
                                          ∗
                                       
                                    
                                    )
                                 
                               is an upper bound of the optimal objective value of (NC-RUC). Therefore, by assigning 
                                 
                                    c
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ‾
                                             
                                          
                                       
                                       
                                          N
                                       
                                    
                                 
                               to U, we have proved that the statistical upper bound U converges to an upper bound of z
                              R almost surely and exponentially fast. □

We present numerical experiments of the proposed algorithms in Sections 3 and 4. First, we conduct both the exact and heuristic separation approaches to solve (NC-RUC) on a small power grid. We compare the two approaches in terms of optimality and computational time on varying parameter settings, whose results are reported and analyzed in Section 5.1. Second, we conduct both nominal and robust optimization approaches on a large power grid, namely an IEEE 118-bus system, and compare the nominal and robust optimal solutions in terms of the worst-case performance, whose results are reported and analyzed in Section 5.2. All the experiments were implemented using CPLEX 12.1, at Intel Quad Core 2.40GHz with 8GB memory.

In this subsection, we report and analyze the computational results on a small power grid containing 16 buses, 10 generators and 20 transmission lines. This power grid is a sub-network of the IEEE 118-bus system, and we conduct both exact and heuristic separation approaches to solve (NC-RUC) on this power grid with a time horizon T
                        =24h. In this experiment, we relax the ramp-rate limit constraints and the overall budget constraint in the uncertainty set definition. In this relaxation, we can decompose the second-stage problem of (NC-RUC) into several subprograms in which each corresponds to a specific time period, and therefore significantly increase the computational efficiency. For the uncertainty set definition, we let 
                           
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              =
                              0.9
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              ,
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              =
                              (
                              1
                              +
                           
                        UB%
                           
                              )
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                           
                        , π
                        
                           mt
                        
                        =1, and 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              =
                              (
                              1
                              +
                           
                        Budget
                           
                              %
                              )
                              
                                 
                                    ∑
                                 
                                 
                                    m
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                           
                        . We allow UB% and Budget% to vary from 0% to 20% in this experiment. Note that when Budget%>UB%, the restriction of the total demand is actually relaxed, and thus the computational results are the same as the case Budget%=UB%. Besides, since the demand changes as time goes by within 24h, we assume that for each bus m its nominal demand 
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                           
                         changes in accordance with the trend shown in Fig. 1
                        , which is given by the statistics from a US deregulated energy market. In addition, in the experiment, we use a four-piece piecewise linear approximation for the convex fuel cost function.

The computational results on the small power grid are summarized in Table 1
                        , where the Benders’ decomposition algorithm based on exact and heuristic approaches are compared in terms of optimal objective value and computational time. We observe that our bilinear approach converges to optimality with a small gap (less than 0.05% in all the settings) in a reasonable and much shorter time than the exact separation approach does. Theoretically, with the size of power grid increasing, the computational complexity of the exact separation approach grows exponentially. Hence, it can become computationally intractable for us to employ it in larger power grids. On the other hand, our bilinear separation approach is stable in computational complexity with a power grid of increasing size, and we can use the lower and upper bounds discussed in Section 4.3 to verify its solution quality. This observation motivates us to implement the heuristic separation approach on the IEEE 118-bus system discussed in Section 5.2.

In this subsection, we report and analyze the computational results on the IEEE 118-bus system. This power grid is based on a U.S. midwest power grid, and contains 118 buses, 33 generators and 186 transmission lines. The data set describing this power system is available online at http://www.ee.washington.edu/research/pstca/. We follow the uncertainty set definition in Section 5.1, and additionally we define that the overall budget amount 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              =
                              (
                              1
                              +
                              Overall
                              %
                              )
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   ‾
                                                
                                             
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                           
                        , the ramp-up and ramp-down rate limits are 50% of the maximum electricity output of each generator i at each bus m, and the nominal demand follows the pattern illustrated in Fig. 1. Please note that this pattern is used only for numerical testing purposes, and system operators can adjust this pattern according to their circumstances (e.g., weather condition, season, type of day, etc.).

The computational results on the IEEE 118-bus system are summarized in Tables 2,3
                        
                        . In this experiment, we have accomplished two groups of sensitivity analyses to see the impact of uncertainty set variation on the worst-case performance of robust and nominal optimal solutions. First, we adjust UB% and Budget% simultaneously (and fix Overall%=18%), and display the computational results in Table 2. Second, we adjust Overall% and Budget% simultaneously (and fix UB%=20%), and display the corresponding results in Table 3. For each combination, the robust optimal solution is obtained by applying the proposed bilinear approach, and the nominal optimal solution is obtained by solving the nominal model with R%=max{10%,min{UB%,Budget%}}, which makes R% in the nominal model at levels commensurate with the corresponding uncertainty sets in the robust model. In Tables 2,3, we provide the following lower and upper bounds:
                           
                              (1)
                              Lower bound L
                                 1 is obtained by relaxing the transmission capacity and ramp-rate limits (i.e., solving RUC), in which case we can employ the algorithm presented in Section 3.

Lower bound L
                                 2 is obtained by using our bilinear heuristic separation approach to solve (NC-RUC).

Upper bound U is obtained by using Monte Carlo simulation discussed in Section 4.3. In the experiment, the random demand at each bus m in time period t is generated from a truncated normal distribution with mean 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      u
                                                   
                                                
                                                +
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       /
                                       2
                                    
                                  and standard deviation 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      u
                                                   
                                                
                                                -
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       /
                                       4
                                    
                                  in the interval 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                 . Additionally, the size of samples is 200,000.

Upper bound WC represents the worst-case value, obtained by solving (NC-RUC) with the first-stage decision fixed to be the optimal solution of the nominal problem. In other words, we first solve the deterministic model with demands chosen to be their nominal values, and then solve (NC-RUC) with its first-stage decision fixed at the nominal optimal solution. Thus, WC estimates how the nominal optimal solution performs under the worst-case scenario. In the experiments we found that the nominal optimal solutions are infeasible to (NC-RUC) for all the instances except those with UB%⩽5%. This observation indicates that it would be risky to make unit commitment decisions based only on the nominal demand information. To compare the performance between these solutions, we introduce a linear penalty cost function for any unsatisfied demands or transmission capacity/ramp-rate limit violations. The unit penalty cost ϱ
                                 
                                    t
                                  is set 20% higher than the sum of the maximal unit fuel cost and the maximal start-up cost, i.e.,
                                    
                                       (38)
                                       
                                          
                                             
                                                ϱ
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          1.2
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                            ,
                                                            2
                                                            ,
                                                            …
                                                            ,
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                            ,
                                                            2
                                                            ,
                                                            …
                                                            ,
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            max
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         mP
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          ∀
                                          t
                                          ∈
                                          T
                                          .
                                       
                                    
                                 Note here that this value is also used for R
                                 
                                    t
                                  and P
                                 
                                    t
                                  to calculate L
                                 1.

Correspondingly, we calculate the following gaps based on the lower and upper bounds:
                           
                              (1)
                              TC Gap=(L
                                 2
                                 −
                                 L
                                 1)/L
                                 1
                                 ×100%. It estimates the difference between the objective value of the simplified unit commitment problem without considering the transmission capacity and ramp-rate limit constraints (i.e., the case studied in Section 3) and the one of the general network constrained robust unit commitment problem (NC-RUC) (i.e., the case studied in Section 4).

Opt. Gap=(U
                                 −
                                 L
                                 2)/L
                                 2
                                 ×100%. It estimates the optimality gap of our bilinear heuristic approach.

WC Gap=(WC
                                 −
                                 U)/U
                                 ×100%. It estimates the difference between the performance of the robust optimal solution and the nominal optimal solution, when the linear penalty cost function is introduced in calculating WC.

From Table 2, we first observe that statistically our bilinear heuristic approach provides feasible solutions for all the instances with UB%∈[5,20]. We can observe from the table that the optimality gap of our bilinear heuristic approach is less than 0.2% for all the instances. Meanwhile, we can observe that the computational time for the algorithm is less than 300s for any instance. This result shows that our bilinear heuristic approach can provide a solution that is very close to the optimal solution, within a short time. Accordingly, it is sufficient to apply our bilinear heuristic approach to solve large size problems, in order to obtain near-optimal solutions.

Then, from the WC Gap information, we can observe that when the demand fluctuation is very restrictive (e.g., UB%⩽5% and Budget%⩽5%), the WC Gap is small; and with UB% and Budget% increasing, the WC gap grows fast. Note that the nominal optimal solutions are infeasible for most of the instances, and we have introduced a linear penalty cost function, with the unit penalty cost ϱ defined in (38), to make up for any unsatisfied demand, transmission line overload, or ramp-rate limit violation. In this sense, the WC gaps measure the relative infeasibility of the nominal optimal solution in different scenarios. In view of that, we can claim that (1) the spinning reserve constraints deal well with demand fluctuation when it is restrictive and fail afterwards, and (2) the extent of infeasibility (and hence the corresponding making up costs) of the nominal optimal solution grows fast as demand fluctuation increases.

Third, we can observe from Table 2 that the TC Gaps are smaller than 4% for all the instances. It indicates that we can utilize the solution approach for (RUC) described in Section 3 to provide a good approximation on the total cost for the general network constrained robust unit commitment problem.

Finally, our computational results indicate that as the demand fluctuation increases, the corresponding objective value increases accordingly. For instance, the objective value increases by around 19.83% as the uncertainty set changes from UB%=5% and Budget%=2% (the corresponding objective value is $1,244,451) to UB%=20% and Budget%=20% (the corresponding objective value is $1,491,255).

From Table 3, we first observe that our algorithm provides tight lower and upper bounds in a reasonable amount of time, with Opt. Gaps within 0.3% under all the settings.

Second, we see that WC Gaps are considerable in all the instances, indicating that the nominal optimal solutions are highly infeasible.

Third, by comparing the trends of WC values along rows and columns in Table 3, we can observe that both a growing Budget% and a growing Overall% play important roles in making the nominal optimal solution infeasible. From the definition of the polyhedral uncertainty set used in this experiment, we know that Budget% (or 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                           
                        ) defines the demand budget within each single period to control demand fluctuation at different locations in a given time unit, while Overall% (or 
                           
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                           
                        ) defines the overall budget throughout all the periods to control demand fluctuation among different time periods. If Budget% is very large, then Overall% plays a more important role (e.g., the WC values in the last row in Table 3); and if Overall% is very large, then Budget% plays a more important role (e.g., the WC values in the last column Table 3). Otherwise, both play important roles (e.g., the WC values in the other rows and columns). With the introduction of demand-responsive pricing schemes, the demand fluctuation boosts in power grids; and the robust methods are hence getting more and more meaningful and valuable.

@&#CONCLUSION@&#

In this paper, we provided one of the first studies on the robust unit commitment problem. In our approach, we addressed the case in which the demand at each bus in each operating hour may be uncertain. Instead of assuming the probability distribution of the uncertainties, they are described by a given polyhedral uncertainty set. We developed efficient solution approaches to solve the problem. Our computational results indicated that the robust optimization approach can provide a better solution as compared to the nominal model, in terms of total cost under the worst-case scenarios. More importantly, our proposed approach can keep the power grid more reliable than the traditional nominal model approach. In general, this approach can provide system operators an alternative approach to address demand uncertainty. Finally, as a byproduct, our approach addressed a set of budget constraints to describe an uncertainty set, instead of just a single budget constraint in parallel studies. Our linearization technique gives insights of this general polyhedral uncertainty set, and our approach provides one of the first studies on deriving an exact separation approach for this type of uncertainty sets.

@&#ACKNOWLEDGEMENTS@&#

The authors thank the editor and three referees for the nice suggestions to help improve the quality of this paper.

We reformulate the subproblem to be a mixed-integer linear program in the following way. We first can write down the subproblem as follows:
                        
                           (39)
                           
                              
                                 
                                    
                                    
                                       
                                          ω
                                          (
                                          y
                                          )
                                          =
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   γ
                                                   ,
                                                   η
                                                   ,
                                                   τ
                                                   ,
                                                   ρ
                                                   ,
                                                   d
                                                   ,
                                                   ξ
                                                   ,
                                                   ζ
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                         +
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                         -
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   f
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         mt
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               η
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         mt
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ij
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  +
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  τ
                                                               
                                                               
                                                                  ij
                                                                  ,
                                                                  t
                                                               
                                                               
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  mp
                                                               
                                                            
                                                            
                                                               
                                                                  ρ
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  mp
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          (
                                          26
                                          )
                                          ,
                                          (
                                          27
                                          )
                                          ,(35)–(37)
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                          
                                          =
                                          
                                             
                                                η
                                             
                                             
                                                t
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                ij
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                τ
                                             
                                             
                                                ij
                                                ,
                                                t
                                             
                                             
                                                +
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   A
                                                
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                ij
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                τ
                                             
                                             
                                                ij
                                                ,
                                                t
                                             
                                             
                                                -
                                             
                                          
                                          ,
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (40)
                           
                              
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    nt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             nt
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              ,
                              
                              ∀
                              m
                              ,
                              n
                              ∈
                              E
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (41)
                           
                              
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    nt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             nt
                                          
                                          
                                             f
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              ,
                              
                              ∀
                              m
                              ,
                              n
                              ∈
                              E
                              ,
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (42)
                           
                              
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              -
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    nt
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             nt
                                          
                                          
                                             g
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                              ,
                              
                              ∀
                              m
                              ,
                              n
                              ∈
                              E
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (43)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                nt
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                nt
                                             
                                             
                                                ℓ
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   n
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                             
                                                π
                                             
                                             
                                                nt
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                nt
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                nt
                                             
                                             
                                                u
                                             
                                          
                                          ⩽
                                          
                                             
                                                π
                                             
                                             
                                                mt
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                mt
                                             
                                             
                                                r
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         mt
                                                      
                                                      
                                                         f
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (44)
                           
                              (
                              
                                 
                                    SUB
                                 
                                 
                                    R
                                 
                              
                              )
                              
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    nt
                                 
                                 
                                    ℓ
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    nt
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    nt
                                 
                                 
                                    u
                                 
                              
                              ⩾
                              0
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (45)
                           
                              
                              
                              0
                              ⩽
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    r
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              )
                              ,
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (46)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         nt
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         nt
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            n
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         nt
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         nt
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         nt
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         mt
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          m
                                          ∈
                                          E
                                          ,
                                          
                                          ∀
                                          t
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (47)
                           
                              
                              
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              )
                              ⩽
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (48)
                           
                              
                              
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (49)
                           
                              
                              
                              
                                 
                                    
                                       
                                          π
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    r
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              -
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (50)
                           
                              
                              
                              
                                 
                                    γ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    +
                                 
                              
                              ,
                              
                                 
                                    γ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                    -
                                 
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    ζ
                                 
                                 
                                    it
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    ij
                                    ,
                                    t
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    ij
                                    ,
                                    t
                                 
                                 
                                    -
                                 
                              
                              ,
                              
                                 
                                    ρ
                                 
                                 
                                    it
                                 
                                 
                                    mp
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              ,
                           
                        
                     
                     
                        
                           (51)
                           
                              
                              
                              ∀
                              m
                              ∈
                              E
                              ,
                              
                              ∀
                              i
                              ∈
                              
                                 
                                    N
                                 
                                 
                                    m
                                 
                              
                              ,
                              ∀
                              p
                              ∈
                              P
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              A
                              ,
                              
                              ∀
                              t
                              ,
                           
                        
                     
                     
                        
                           (52)
                           
                              
                                 
                                    
                                    
                                       
                                          where
                                          
                                          f
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ξ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                          -
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ‾
                                                   
                                                
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          -
                                          
                                             
                                                ζ
                                             
                                             
                                                it
                                             
                                             
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                         (
                                                         t
                                                         -
                                                         1
                                                         )
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                             
                                                m
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Constraints (40)–(42) ensure that if the weighted cost coefficient of d
                     
                        mt
                      (i.e., 
                        
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 mt
                              
                           
                           /
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                        
                     ) is larger than that of d
                     
                        nt
                     , then 
                        
                           
                              
                                 z
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           ⩾
                           
                              
                                 z
                              
                              
                                 nt
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 z
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           ⩾
                           
                              
                                 z
                              
                              
                                 nt
                              
                              
                                 g
                              
                           
                        
                     , and 
                        
                           
                              
                                 z
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                           ⩾
                           
                              
                                 z
                              
                              
                                 nt
                              
                              
                                 f
                              
                           
                        
                     . Constraints (43) and (44) ensure a demand d
                     
                        mt
                      in the interval 
                        
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          mt
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          mt
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        
                      if 
                        
                           
                              
                                 z
                              
                              
                                 mt
                              
                              
                                 f
                              
                           
                           =
                           1
                        
                     . Note that here it is allowed this demand 
                        
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           =
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                        
                      or 
                        
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           =
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                        
                     , and constraint (29) is automatically satisfied. Similarly, constraints (45) and (46) ensure a demand d
                     
                        mt
                      in the interval 
                        
                           
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          mt
                                       
                                       
                                          ℓ
                                       
                                    
                                    ,
                                    min
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   mt
                                                
                                                
                                                   u
                                                
                                             
                                             ,
                                             
                                                
                                                   D
                                                
                                                
                                                   mt
                                                
                                                
                                                   ℓ
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           π
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     n
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     M
                                                                  
                                                               
                                                               
                                                                  
                                                                     π
                                                                  
                                                                  
                                                                     nt
                                                                  
                                                               
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     nt
                                                                  
                                                                  
                                                                     ℓ
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     n
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     M
                                                                  
                                                               
                                                               
                                                                  
                                                                     π
                                                                  
                                                                  
                                                                     nt
                                                                  
                                                               
                                                               
                                                                  
                                                                     D
                                                                  
                                                                  
                                                                     nt
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     nt
                                                                  
                                                                  
                                                                     u
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   π
                                                
                                                
                                                   mt
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      to make constraint (30) automatically satisfied. Constraints (47)–(49) indicate that 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                           
                        
                      if z
                     
                        t
                     
                     =1 and 
                        
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 ℓ
                              
                           
                           +
                           
                              
                                 ∑
                              
                              
                                 m
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 π
                              
                              
                                 mt
                              
                           
                           
                              
                                 D
                              
                              
                                 mt
                              
                              
                                 r
                              
                           
                           
                              
                                 z
                              
                              
                                 mt
                              
                              
                                 u
                              
                           
                        
                      otherwise. In the following part, we show how we linearize the bilinear term 
                        
                           
                              
                                 d
                              
                              
                                 mt
                              
                           
                           
                              
                                 
                                    
                                       η
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 mt
                              
                           
                        
                      in the objective function in (SUBR). First, we can write
                        
                           
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    r
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    f
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      nt
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      nt
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      nt
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      nt
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      nt
                                                   
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   π
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             0
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                   
                                                
                                                +
                                                (
                                                1
                                                -
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      s
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           n
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           M
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        D
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                                  +
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           n
                                                                           =
                                                                           1
                                                                        
                                                                        
                                                                           M
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        D
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        z
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                     
                                                                        u
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              .
                           
                        
                     
                     
                        
                           (53)
                           
                              Then
                              ,
                              
                              we
                              
                              have
                              
                              
                                 
                                    d
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    mt
                                 
                                 
                                    ℓ
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                           
                        
                     
                     
                        
                           (54)
                           
                              +
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             mt
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             mt
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             f
                                          
                                       
                                       
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             mt
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     π
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  M
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               nt
                                                            
                                                         
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               nt
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      g
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            η
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      mt
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     π
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         /
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               mt
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  s
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  n
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  M
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        π
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        D
                                                                     
                                                                     
                                                                        ns
                                                                     
                                                                     
                                                                        ℓ
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               mt
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (55)
                           
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    nt
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    f
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    nt
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ns
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ns
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                /
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      mt
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (56)
                           
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ns
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    ns
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ns
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ns
                                 
                                 
                                    u
                                 
                              
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    ns
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ns
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              .
                           
                        
                     Constraints (54)–(56) can be linearized as follows:
                        
                           (57)
                           
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      u
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      mt
                                                   
                                                   
                                                      f
                                                   
                                                
                                                (
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      nt
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      nt
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                /
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      mt
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ns
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ns
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (58)
                           
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnt
                                 
                                 
                                    uf
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    nt
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    nt
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mst
                                 
                                 
                                    g
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            π
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      s
                                                   
                                                
                                                /
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      mt
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         n
                                                         =
                                                         1
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                   
                                                   
                                                      ns
                                                   
                                                
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ns
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             π
                                          
                                          
                                             mt
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (59)
                           
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnst
                                 
                                 
                                    ug
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    ns
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ns
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       M
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnsst
                                 
                                 
                                    ug
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    ns
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    ns
                                 
                                 
                                    r
                                 
                              
                              /
                              
                                 
                                    π
                                 
                                 
                                    mt
                                 
                              
                           
                        
                     
                     
                        
                           (60)
                           
                              s
                              .
                              t
                              .
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       1
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    u
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (61)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                             
                                                f
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          (
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                mt
                                             
                                             
                                                f
                                             
                                          
                                          )
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                             
                                                f
                                             
                                          
                                          ⩽
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                mt
                                             
                                             
                                                f
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                             
                                                g
                                             
                                          
                                          ⩽
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          (
                                          1
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                mt
                                             
                                             
                                                g
                                             
                                          
                                          )
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                             
                                                g
                                             
                                          
                                          ⩽
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                mt
                                             
                                             
                                                g
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (62)
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnt
                                 
                                 
                                    uf
                                 
                              
                              ⩽
                              -
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       2
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             f
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             nt
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnt
                                 
                                 
                                    uf
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    f
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnt
                                 
                                 
                                    uf
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    nt
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                              ∀
                              n
                              ,
                           
                        
                     
                     
                        
                           (63)
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mst
                                 
                                 
                                    g
                                 
                              
                              ⩽
                              -
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       2
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             g
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             s
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mst
                                 
                                 
                                    g
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mst
                                 
                                 
                                    g
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                              ∀
                              s
                              ,
                           
                        
                     
                     
                        
                           (64)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mnst
                                             
                                             
                                                ug
                                             
                                          
                                          ⩽
                                          -
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                mt
                                             
                                          
                                          +
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   -
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         mt
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         ns
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mnst
                                             
                                             
                                                ug
                                             
                                          
                                          ⩽
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ns
                                             
                                             
                                                u
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                mnst
                                             
                                             
                                                ug
                                             
                                          
                                          ⩽
                                          
                                             
                                                M
                                             
                                             
                                                ‾
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                mt
                                             
                                             
                                                g
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          ∀
                                          s
                                          ,
                                          
                                          ∀
                                          n
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (65)
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnsst
                                 
                                 
                                    ug
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          η
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    mt
                                 
                              
                              +
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    
                                       3
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             mt
                                          
                                          
                                             g
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             s
                                          
                                       
                                       -
                                       
                                          
                                             z
                                          
                                          
                                             ns
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                              ,
                              
                              ∀
                              s
                              ,
                              ∀
                              n
                              ,
                           
                        
                     
                     
                        
                           (66)
                           
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnsst
                                 
                                 
                                    ug
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ns
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnsst
                                 
                                 
                                    ug
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    mt
                                 
                                 
                                    g
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    mnsst
                                 
                                 
                                    ug
                                 
                              
                              ⩽
                              
                                 
                                    M
                                 
                                 
                                    ‾
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                              ∀
                              s
                              ,
                              
                              ∀
                              n
                              .
                           
                        
                     Therefore, the final subproblem in the form of mixed-integer linear problem is
                        
                           
                              
                                 
                                    
                                    
                                       
                                          ω
                                          (
                                          y
                                          )
                                          =
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   γ
                                                   ,
                                                   η
                                                   ,
                                                   τ
                                                   ,
                                                   ρ
                                                   ,
                                                   d
                                                   ,
                                                   ξ
                                                   ,
                                                   ζ
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                   =
                                                   1
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                                  +
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  U
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            
                                                               
                                                                  γ
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                                  -
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   f
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  y
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ξ
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  ζ
                                                               
                                                               
                                                                  it
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          (
                                          (
                                          53
                                          )
                                          +
                                          (
                                          57
                                          )
                                          +
                                          (
                                          58
                                          )
                                          +
                                          (
                                          59
                                          )
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          (
                                          
                                             
                                                SUB
                                             
                                             
                                                M
                                             
                                          
                                          )
                                          
                                          
                                             
                                                
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            (
                                                            i
                                                            ,
                                                            j
                                                            )
                                                            ∈
                                                            A
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         τ
                                                      
                                                      
                                                         ij
                                                         ,
                                                         t
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            p
                                                            =
                                                            1
                                                         
                                                         
                                                            P
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         mp
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         it
                                                      
                                                      
                                                         mp
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          (
                                          26
                                          )
                                          ,
                                          (
                                          27
                                          )
                                          ,(35)–(37), (39)–(52), (60)–(66).
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

