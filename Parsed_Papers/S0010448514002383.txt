@&#MAIN-TITLE@&#Automatic shape adaptation for parametric solid models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Automatic shape adaptation is achieved based on corresponding faces and dimensions.


                        
                        
                           
                           A new method of determining corresponding faces is put forward.


                        
                        
                           
                           An algorithm to identify corresponding dimensions by constraint graph is proposed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Automatic shape adaptation

Shape frame

Corresponding face

Dimension promotion

@&#ABSTRACT@&#


               
               
                  Adaptation, as is well known, plays a fundamental role in Case-Based Design. However, after decades of efforts, automatic adaptation approach is still rare. In common design works, the first thing one will usually do is choosing a start-up model (a candidate model) of moderate complexity based on a simple query model possessing primary design constraints. To enable the candidate model to smartly adapt its shape to that of the query model according to the embedded constraints, a novel automatic shape adaptation approach is proposed in this paper. First, to determine the corresponding faces between two non-preregistered models as relevant elements, a shape frame concept and its quantitative descriptor are defined. Second, to unify the representation of seemingly different but inherently consistent dimensions, a promotion method is adopted. Third, based on the corresponding faces and the promoted dimension representation, the corresponding dimensions between the two parametric solid models are identified. Finally, the parametric information is smoothly transferred from the query model to the candidate model as design constraints, and the shape of the candidate model is automatically adapted to the query model. Besides that, a prototype system is also implemented to verify the effectiveness of the automatic shape adaptation approach.
               
            

@&#INTRODUCTION@&#

It is well known that designers use their experience of design along with combinations and/or adaptations of previous cases or parts of cases in creating a new design  [1]. Watson et al.  [2] term this as Case-Based Design (CBD). Along with the computer-aided design (CAD) systems joining modern industries, a vast number of design cases are generated and stored in the internet or enterprise repositories. These cases always contain plenty of embedded knowledge worthy of utilization. Subsequently, CBD has got more and more attention in the past few decades  [2], while the advancement of CBD approaches makes it easier and faster to produce impressive and innovative designs in a widespread field  [3,4].

CBD mainly consists of two processes: retrieving a suitable case and adapting it to satisfy new design requirements  [2,4–6]. Modern retrieval technologies  [7–23], capable of automatically searching out the cases similar to a user input query from a huge case library, are extensively used and well studied. On the other hand, adaptation is essential for CBD since no two design problems are ever identical. According to the researches mentioned in  [11,24], only a small part of products requires completely new designs, while more parts of them are obtained through an adaptation of the existing cases. However, manual adaptation process is usually tedious in some design tasks, especially during routine design. To free the designers from these unnecessary burdens and improve the efficiency of CBD, it is very important and necessary making the case adaptation automatic.

Unfortunately, although the importance of automatic case adaptation in CBD is obvious, the automatic adaptation approach is rare  [2,3,5,25–30]. While some good works referred in  [3,4,31,32] show that case adaptation falls broadly into two categories: adaptation in conceptual design, and adaptation in shape (geometric) design. Despite of focusing on different design categories, two major common challenges have to be overcome in order to achieve automatic adaptation:
                        
                           (a)
                           
                              How to automatically identify which design elements in the retrieved case are relevant to new design requirements.


                              How to automatically transfer the new design requirements to the retrieved case via their relevant design elements.

It should be pointed out that, up to now, these two challenges are still the obstacles of achieving automatic case adaptation  [3]. On one hand, the automatic case adaptation for concepts, ranging from engineering to architecture to software design, shows much more feasible and prospective when the prerequisite of knowledge around domain area can be captured sufficiently and represented properly  [3,4]. However, satisfying the above prerequisite is domain dependent and is not a trivial work  [33,34]. On the other hand, the automatic case adaptation for geomantic shapes seems much more difficult without the aid of semantic information support (and/or domain specification), such as (a) the works of shape deformation  [35–38] (establishing a meaningful correspondence between two shapes is often difficult and semantically dependent  [39]), and (b) the works of shape optimization  [6,40–44] (domain specifications are required, such as materials, and pressures). So, when the semantic information support or domain specification is absent, shape adaptation is often carried out by humans instead of using the existing works  [3].

Although a general automatic shape adaptation (geometric adaptation) is difficult and the related works are rare, it plays an important role in modern product design, such as the designs related to product shape optimization and structure optimization  [42,44–47]. Modern product design usually contains distinct design phases, such as preliminary design, conceptual design, geometric modeling, and so on. Furthermore, product design is an iterative design process among the distinct design phases, and the specifications of the required function of a product get more refined only as the design process moves toward its goal  [4,34]. Accordingly, the geometric shape of a product usually needs modification at each iterative step since the function of a product is often represented by its geometric shape (especially in mechanical engineering). Thus, in order to reduce the burden of manual geometric modification at each iterative step, automatic shape adaptation is necessary and very important.

In this paper, we propose an automatic shape adaptation approach to enable one parametric solid model to smartly adapt its shape to that of the other one according to the embedded constraints. Because the embedded constraints in each parametric solid model are usually adopted by designers to represent their new design requirements (intent), transferring shape according to the embedded constraints is actually transferring design intent [48,49]. As we know, with the aid of embedded constrains, each parametric solid model can update its shape elements (faces, edges, and vertices) in a predicted manner after any dimension constraint modification. Apparently, an effective and direct method to transfer shape between two parametric solid models is to establish relationships between their embedded dimension constraints. However, without semantic information support, it is a difficult issue to establish relationships between two models’ embedded dimension constraints automatically since the parametric way for a parametric solid model can be very flexible (different parametric ways lead to different constraint configurations).

Our approach is presented with a view to overcome the above mentioned issue in feature-based parametric design. The inputs of the approach are two parametric solid models without having been pre-registered: a query model and a candidate model. The query model, indicating the gross new shape design requirements through its roughly B-rep shape and its dimension constraints, is a simple parametric solid model. The candidate model is a parametric solid model searched from a parametric solid model library according to the query model, whose overall shape is similar to that of the query model but having more details. According to the two challenges for automatic shape adaptation (i.e. how to automatically identify which design elements are corresponding (relevant) between the two given models’ shapes, and how to automatically transfer the shape of the query model to the candidate model via their corresponding (relevant) design elements), our solution consists of the following parts: (1) we select face as the shape relevant design element, and in spite of the absence of semantic support, a novel method is presented to determine the corresponding shape frames and corresponding faces between the two models automatically; (2) we adopt a promotion method that makes face as the intermediate element that relates each embedded dimension to its model’s shape; (3) based on 3D dimension constraint graphs and corresponding faces, we identify all corresponding dimensions and corresponding dimension chains between the corresponding shape frames effectively; (4) we establish the dimension relationships among the corresponding dimensions and corresponding dimension chains to make the candidate model adapt its shape to that of the query model.

The rest of the paper is organized as follows. In Section  2, we give a brief review of the related works. In Section  3, some concepts and an overview of our approach is provided. Section  4 gives a detailed process of determining corresponding faces and corresponding shape frames. In Section  5, a dimension promotion method is adopted to identify corresponding dimensions and corresponding dimension chains between the two given models based on the result of Section  4. Afterward, the dimension relationship between the two given models is established. Section  6 introduces the implementation details of the prototype system and shows some experiments and their efficiencies. Finally, we discuss our approach in Section  7, and present the conclusion of the paper and our further works in Section  8.

@&#RELATED WORKS@&#

Nowadays, there are few works dedicated to the automatic shape adaptation. Therefore, the works that we have surveyed are mainly relevant to the general case adaptation. According to different design levels, the existing works related to the first challenge (i.e. how to automatically establish correspondences between a source case and a target problem or between two cases) can be divided into two types: conceptual correspondence research and geometric correspondence research.


                     Conceptual correspondence research: Establishing a conceptual correspondence, between a library case and an input target problem (or new requirements), is often performed in the process of case retrieval based on a set of specific metrics. Meaningful labels are early used to index and retrieve cases or case features. Besides, the similarity between two labels measures the degree of the correspondence between the two cases (or two case features) that correspond to the two labels respectively. Kolodner  [50,51] presents an algorithm for knowledge-based memory reorganization, which can decide which case (or case features) is corresponding to the new inputs with the aid of previous knowledge. In analogy-based design area, Falkenhainer et al.  [52] build a structure mapping (corresponding) engine to explore the computational aspects of the structure-mapping theory proposed in Gentner  [53]. The mechanism of structure-mapping mentioned above is essentially independent of task, domain, or the context knowledge. In computer-aided functional synthesis area, after classifying each case under a specific component name according to its function, potential design solutions based upon previously known cases can be presented  [13,54,55], since each new requirement corresponds to a specific function component. However, the identified relevant conceptual design elements are often yet to provide direct correspondence between the geometric design elements of the two cases, and which is the focus of this work.


                     Geometric correspondence research: The design requirements are usually represented as shapes in CBDs focusing on geomantic design. Then, a geometric correspondence identification in geometric design is to identify a shape correspondence between two models. Lots of model retrieval approaches have been proposed in the past decades, such as (a) the approaches that get the candidate models by inputting a query model  [11,17,21–23,56,57], and (b) the works that discover the candidate model by deforming a template model (such as the work presented by Ovsjanikov et al.  [58]). Usually, model retrieval approaches can determine whether two models’ shapes are similar or not on globally or partially, but they are difficult to obtain more matching details especially when the two models have different resolutions  [9,59]. Shape correspondence, being a fundamental problem for 3D surface shape retrieving in the computer graphics communities  [39], is mainly related to discrete shapes represented by triangle meshes, contours or point sets. Geometric correspondence establishment can be carried out by identifying portions of the shapes that are geometrically similar. Sumner et al.  [35] build the correspondence between the source and target triangles models using an iterated closest point algorithm with regularization, aided by user selecting marker points. Hu et al.  [60] describe a shape with a set of salient features extracted from surfaces that are represented by triangle meshes, and achieve both global and partial shape correspondence with these salient feature points. Establishing geometric correspondence can also be processed by identifying portions of the shapes that serve the same function. Kaick et al.  [61] use prior knowledge to establish a correspondence between shapes based on similar functions while ignoring significant differences in geometry or even topology. According to whether the approach explores the whole solution space in search for a better correspondence result, the recent geometric correspondence approaches can be divided into global search approaches and local search approaches. For example, Zhang et al.  [36] present a global feature correspondence search approach by leveraging the power of the state-of-the-art mesh deformation techniques and relying on a combinatorial tree traversal for correspondence search. While the most prominent example of the local search type is the ICP algorithm  [62], which replaces the computation of correspondences among the feature points of two models with the computation of alignment transformations between them. Ovsjanikov et al.  [63] present an approach that works well to establish shape correspondences amongst near-isometrically deformed shapes. Generally speaking, establishing a meaningful correspondence between two discrete shapes is often difficult since it often requires an understanding of the structures of the two shapes respectively (at both the local and global levels)  [10,39,60,64–66]. Shape matching is a character of reverse engineering that the geometric elements (such as surface) in the physical model should have corresponding geometric elements in its re-designed digital model. For example, Goyal et al.  [67] present a re-design 3D modeling approach toward locally and globally shape-aware. Using the re-design approaches to establish shape correspondences between two solid models require the two models having similar resolutions while having been normalized and registered (aligned). Our approach aims to determine face correspondences between two non-preregistered B-rep models with different resolutions automatically, so the recent state-of-the-art approaches for shape correspondence are not suitable here.

Regarding the second challenge (i.e. how to automatically transfer the new design requirements to the retrieved case via their relevant design elements), the related works are as follows.

Watson et al.  [2] describe a survey of adaptation in CBD where they summarize that adaption in design can be carried out in four types of approaches: human intervention, knowledge-based adaptation, case-combination adaptation and combinations of the above approaches. In addition, Kolodner  [68] classifies the knowledge-based adaptation approaches into four categories: substitution approaches, transformation approaches, special purpose approaches and derivational replay approaches. Especially, most of the current case-based design works focus on concept design, where the knowledge capture and its representation  [34] are the preconditions for an effective adaptation in product design  [33]. Goel et al.  [4] present a review of many researches on development of case-based reasoning in design and their corresponding case-based design systems. Pearce et al.  [69] present a CBD approach, which is an intelligent case browsing system and aims at providing architects with a design library for the conceptual architectural design of office buildings. After selecting a candidate case with the above approach, users have to make the adaptation themselves. Maher et al.  [41] present a CBD approach focusing on case transformation and regarding case adaptation as a constraint satisfaction problem, where a candidate case provides a starting point for a new design problem and constraints that are used to revise the case for consistency with the new context. Hua et al.  [6] describe a prototype design system called case adaptation by dimensionality reasoning (CADRE), which uses dimensional and topological adaptation based on production rules and shape grammars. Hunt  [29] presents an evolutionary adaptation approach for structural engineering design which extends the basic framework of CBR to include an evolutionary approach to adaptation. This is the adaptation approach that integrates case combination and knowledge-based adaptation to solve design problems. Perera et al.  [30]propose an interactive prototype CBD system NIRMANI which aims at automating design either fully or partially. Adaptation in NIRMANI is carried out in two phases: (1) using an index elaboration and index revision mechanism to refine the design problem specification, and (2) converting the problem specification into a solution through a case modification and combination process based on a set of heuristic rules and domain knowledge. Bose et al.  [40] present a case-based design system for the solution of mechanism design problems which can be solved by using four-bar linkages. Some modern 3D cad systems have provided a similar adaptation mechanism in geometric design stage  [70], where a part is set to be under-constrained, based on domain knowledge, and then the automatic shape adaptation of the part can be carried out in an assembly circumstance based on its mating relationships determined by human intervention. Vong et al.  [71] employ case-based reasoning (CBR) to adapt an existing and effective ECU setup to fit another similar class of engine. The adaptation procedure is done through a more sophisticated step called case-based adaptation which can interactively learn the expert adaptation knowledge. In a word, whatever adaptation approach is used, extensive domain specific knowledge is required as mentioned by Raphael et al.  [25], such that case adaptation is often carried out by humans  [3].

In engineering field, the shape optimization  [32,72] is similar as the shape adaptation in some aspects. In the shape optimization, values of the shape variables have to be determined which result in an optimal value of a target parameter. Perez et al. [42] present the implementation of a particle swarm optimization algorithm suitable for constraint structural optimization tasks. Recently, Yildiz  [44] proposes a hybrid optimization approach based on differential evolution algorithm for solving structural design, accompanied with two design problems: a welded beam design problem and the optimal design of a vehicle component. Meanwhile, there are also many approaches for topological structure optimization. Allaire et al.  [45] and Xia et al.  [46] present topology optimization approaches based on the level-set approach. Richardson et al.  [43] address single and multi-objective topology optimization of truss-like structures using genetic algorithms and present an approach based on kinematic stability repair to improve the performance of the genetic algorithms. Wang et al.  [47] present a material perturbation approach (MPM) using a fixed mesh for stress sensitivity analysis and shape optimization. Although the adapted shape can be obtained by optimizing the parameters of an existing and successful design, the parameters (including the goal function) used in an optimization approach are domain-related (such as materials, and pressures), furthermore, shape optimization approaches are often designed for assemblies not for a single part.

In computer graphics field, recently, the main idea of the state-of-the-art approaches on shape deformation is that the shape of a given model will be deformed according to some correspondences (built online or predefined) between a source model (or reference model) and a target model (or reference model). Sumner et al.  [35] present a deformation approach that transfers the induced deformation from a source model to a target model through a correspondence map. Brouet et al.  [38] present a fully automatic approach that transfers a garment from a source wearer to a target wearer while retaining the garment’s specific patterns as much as possible. Meng et al.  [73] present an approach to control the shape of a cloth during the automatic resizing. Lee et al.  [74] propose an automatic virtual garment transfer system for human models with various shapes and poses, focusing on the realistic fitting result while preserving the original garment size. Besides, there are also some state-of-the-art approaches (such as the structure-aware shape processing approaches  [75]) that try to do shape deformation for each model according to its own inner constraints. Kraevoy et al.  [76] present a non-homogeneous resizing approach that resizes each model respecting to the model’s vulnerability map, and creates new models that preserve the structures and features of the original ones. Gal et al.  [77] introduce iWIRES to do structure-preserving shape deformation for the man-made models. Zheng et al.  [78] introduce component-wise controllers to do structure-aware shape deformation. Bokeloh et al.  [79] present a high-level shape editing approach by extracting all possibly linear patterns and their relationships from a model (each pattern is represented by a small number of variables). Although the above structure-aware shape processing approaches analyze and process shapes at a high level, it is still a challenging task presently to extract the high-level information (such as semantic local shapes and their relations) from discrete models  [75,80].


                        Face layout: The face layout is defined as the relative positions and relative orientations among the faces belonging to the same face set. The face layout describes the rotation invariant characters of a face set.


                        Shape frame: Given a face set 
                           
                              FS
                           
                         of a solid model, if the overall shape of the model can be characterized by the surface shapes of the faces in 
                           
                              FS
                           
                         and/or the face layout of 
                           
                              FS
                           
                        , then 
                           
                              FS
                           
                         is defined as a shape frame of the solid model. For example, the face set 
                           
                              {
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              |
                              1
                              ≤
                              i
                              ≤
                              9
                              }
                           
                         in Fig. 1
                         forms a shape frame of model 
                           A
                        .

Usually, in view that the query model in this work is very simple, the shape frame of the query model is considered consisting of all the faces of the query model and is denoted by 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . Additionally, in terms of a query model and its 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        , the shape frame of the candidate model is obtained; such shape frame is called the corresponding shape frame of 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . Considering that the overall shape of the candidate model is similar to that of the query model, in this work we assume that 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         and its corresponding shape frame have the same count of faces. Fig. 1 shows a pair of corresponding shape frames respectively belonging to model 
                           A
                         and model 
                           B
                        .


                        Directed surface judgment: The directed surface judgment as a Boolean property is attached to a face in this work. Such property indicates whether the face contains a directed surface (whose normal always points to the outside of body) or not.


                        Corresponding face: Let 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 Q
                              
                           
                         in the query model and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 Q
                              
                           
                         in the candidate model be a pair of corresponding shape frames. If a pair of the faces respectively belonging to 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 Q
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 Q
                              
                           
                         has the same surface type and directed surface judgment, as well as similar relative orientations and relative positions (relative to other faces in their own face sets), then such pair of the faces can be defined as a pair of corresponding faces. For example, face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                         in Fig. 1 comprise a pair of corresponding faces.


                        Corresponding edge: Let 
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         in the query model and 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         in the candidate model be a pair of edges; 
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         is shared by face 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         while 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         is shared by face 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                        . If 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         corresponds to 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                         while 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         corresponds to 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                        , or 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         corresponds to 
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                         while 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         corresponds to 
                           
                              
                                 f
                              
                              
                                 i
                              
                           
                        , then such pair of edges is defined as a pair of corresponding edges. For example, in Fig. 1, face 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 6
                              
                           
                         respectively correspond to face 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 6
                              
                           
                        ; edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         is shared by 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 6
                              
                           
                        ; edge 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         is shared by 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 6
                              
                           
                        . Thus, edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 e
                              
                              
                                 1
                              
                           
                         comprise a pair of corresponding edges.


                        Corresponding axis: Let 
                           
                              
                                 F
                              
                              
                                 Q
                              
                           
                         in the query model and 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         in the candidate model be a pair of corresponding faces. If 
                           
                              
                                 F
                              
                              
                                 Q
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         are quadratic faces containing only one axis respectively, then their axes are called corresponding axes. For example, in Fig. 1, 
                           
                              
                                 F
                              
                              
                                 4
                              
                           
                           _
                           A
                         and 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                           _
                           A
                         are the axes of face 
                           
                              
                                 F
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                         respectively. Because face 
                           
                              
                                 F
                              
                              
                                 4
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                         are corresponding faces, 
                           
                              
                                 F
                              
                              
                                 4
                              
                           
                           _
                           A
                         and 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                           _
                           A
                         comprise a pair of corresponding axes.

To establish dimension relationships between two parametric solid models, we adopt a dimension promotion method (see Section  5) to promote each dimension to be defined on/between entity(s) constrained by that dimension. Here each entity can be an edge, an axis of a quadratic face or a face.


                        Constrained entity: The constrained entity is an entity (not a sketch element) which is constrained by a promoted dimension. According to our dimension promotion mechanism (see Section  5), a constrained entity can be a face, an edge or an axis of a quadratic face in this work. Accordingly, each pair of corresponding faces, corresponding edges, or corresponding axes is also a pair of corresponding constrained entities.


                        Corresponding dimension: Let 
                           D
                         and 
                           d
                         be two dimensions with the same dimension type (distance or angle) belonging to the query model and the candidate model respectively, they are called corresponding dimensions of each other if the constrained entities constrained by them are corresponding constrained entities. For example, in Fig. 1, 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         constrains the relative position between face 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                        , and 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                         constrains the relative position between face 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                         and face 
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                        . Since 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                         correspond to 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                         respectively, 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         is the corresponding dimension of 
                           
                              
                                 d
                              
                              
                                 1
                              
                           
                        . Similarly, 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                         are the two radiuses of the two faces’ surfaces respectively, and face 
                           
                              
                                 F
                              
                              
                                 4
                              
                           
                         corresponds to face 
                           
                              
                                 f
                              
                              
                                 4
                              
                           
                        . Thus, 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                         comprise a pair of the corresponding dimensions.


                        Corresponding dimension chain: Let 
                           D
                         be a dimension in the query model, if there is a dimension chain in the candidate model whose first constrained entity and last constrained entity (i.e. the two constrained entities are constrained by the dimension chain) are the corresponding constrained entities of those constrained by 
                           D
                        , the dimension chain is defined as the corresponding dimension chain of 
                           D
                        . For example, in Fig. 1, 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         constrains the relative position between face 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 9
                              
                           
                         in model 
                           A
                        . Meanwhile, 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 9
                              
                           
                         correspond to 
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                         respectively. Since there is no corresponding dimension for 
                           D
                         but having the only one dimension chain (
                           
                              
                                 d
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                        ) that constrains the relative position between face 
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                         and face 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                        . Thus, 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         corresponds to the dimension chain (
                           
                              
                                 d
                              
                              
                                 2
                                 ,
                              
                           
                           
                              
                                 d
                              
                              
                                 3
                              
                           
                        ).

In order to effectively improve the reuse of parametric solid models in Case-Based Design, we propose an automatic approach for shape adaptation of parametric solid models. The inputs of the approach are two parametric solid models: a query model and a candidate model. The query model, used to indicate the new shape design requirements through its boundary representation and its dimension constraints, is a simple parametric solid model created by the designer. The candidate model is a parametric solid model searched from a parametric solid model library according to the query model, whose overall shape is similar to that of the query model but having more details. The goal of our approach is to automatically adapt the shape of the candidate model to that of the query model, making the candidate model more suitable for reuse. To properly reduce the complexity, at present, we hypothesize that the two input models are composed of plane faces and/or quadratic faces.

Regarding the first challenge for automatic shape adaptation, i.e. how to effectively determine the corresponding faces between the query model and the candidate model, we solve it using a global method. We determine the corresponding shape frames between the two models first, and then determine the corresponding faces based on the corresponding shape frames. By mainly adopting face layout as the descriptor of a set of faces, our method does not require that the query model and the candidate model are pre-registered (or pre-aligned).

For example, in Fig. 2
                        , after determining corresponding shape frames, the faces with the same color (except gray), belonging to the two given models 
                           A
                         and 
                           B
                         respectively, are determined as the corresponding faces. Although the relative sizes of face 11 and 17′ are vastly different, they are corresponding faces since both of them intrinsically constrain the shapes of their own model in the same direction.

As for the second challenge for automatic shape adaptation, i.e. how to automatically transfer the shape of the query model to the candidate model, considering that the shape of the query model is determined by its 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         and dimension constraints, we first identify all the corresponding dimensions and corresponding dimension chains between 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         and its corresponding shape frame based on their corresponding faces (other corresponding constrained entities can be deduced by corresponding faces according to their definitions) and the 3D dimension constraint graphs of the query model and the candidate model, then make the corresponding dimensions and corresponding dimension chains have the same values as those of their counterparts to achieve the automatic shape transfer from the query model to the candidate model.

For example, in Fig. 2, after establishing the dimension relationship between the radiuses of face 11 and 
                           1
                           
                              
                                 7
                              
                              
                                 ′
                              
                           
                           
                              (
                              r
                              =
                              R
                              )
                           
                        , the gross radiuses of the candidate model and the query model are the same.


                        Fig. 2 shows the systematic overview of the approach which consists of the following three parts: 
                           
                              (1)
                              Determination of the corresponding shape frames and corresponding faces between the query model and the candidate model;

Establishment of dimension relationship between 
                                    
                                       
                                          
                                             SF
                                          
                                       
                                       
                                          
                                             Q
                                          
                                       
                                    
                                  and its corresponding shape frame;

Update of the candidate model. In this step, the candidate model is updated by making the corresponding dimensions and dimension chains have the same values as those of their counterparts in the query model.

In view that the third part of our approach is simple, we just describe the part 1 and part 2 in detail below.

According to our knowledge, there is no existing method that can determine face correspondences between two non-preregistered B-rep models automatically and accurately, as a result, a similarity comparison method is used to achieve above targets in this work. Since each shape frame is a face set, for the sake of generality, we first adopt a face set descriptor to describe the rotation invariant characters of each face set. Next, we propose a face sets distance measurement to evaluate the similarities among face sets by comparing their descriptors. Afterward, based on the face sets distance measurement and according to 
                        
                           
                              
                                 SF
                              
                           
                           
                              
                                 Q
                              
                           
                        
                     , we apply a heuristic filtering process to determine a face set (being a shape frame of the candidate model and having the greatest similarity with 
                        
                           
                              
                                 SF
                              
                           
                           
                              
                                 Q
                              
                           
                        
                     ) as the corresponding shape frame of 
                        
                           
                              
                                 SF
                              
                           
                           
                              
                                 Q
                              
                           
                        
                     . Subsequently, the preliminary corresponding faces between the two models are determined. Finally, corresponding faces between the two models are completed based on the feature information of the two models, respectively.

As the two given models have different resolutions  [9,59], the faces in a shape frame of the candidate model may not always be adjacent to each other. Therefore, the approaches (such as graphs, shape distributions, etc. presented in  [7,17,19,81]) frequently used to describe a geometric model are not suitable to describe an arbitrary face set here. Consequently, to facilitate face sets similarity assessment and inspired by  [11], we adopt a quantitative descriptor composed of three matrixes (shape matrix, relative orientation matrix and relative position matrix) to describe the rotation invariant characters of a face set.

The shape matrix, describing the rotation invariant characters of each face in a face set 
                           
                              FS
                           
                        , is a 
                           2
                           ×
                           M
                         matrix where 
                           M
                         is the face count of 
                           
                              FS
                           
                        . The value in position 
                           
                              [
                              1
                              ,
                              i
                              ]
                           
                         integrating with the value in position 
                           
                              [
                              2
                              ,
                              i
                              ]
                           
                         describes the rotation invariant characters of the 
                           i
                        th face. The relative orientation matrix, describing the relative orientations between each pair of faces in 
                           
                              FS
                           
                        , is an 
                           M
                           ×
                           M
                         matrix. The value in position 
                           
                              [
                              i
                              ,
                              j
                              ]
                           
                         is the relative orientation value between the 
                           i
                        th face and the 
                           j
                        th face. Meanwhile, the relative position matrix, describing the relative positions between each pair of faces in 
                           
                              FS
                           
                        , is also an 
                           M
                           ×
                           M
                         matrix. The value in position 
                           
                              [
                              i
                              ,
                              j
                              ]
                           
                         is the value that represents the distance from the 
                           i
                        th face to the 
                           j
                        th one semantically. For example, the shape matrix (Fig. 3
                        (a)) and the relative orientation matrix (Fig. 3(b)) integrating with the relative position matrix (Fig. 3(c)) comprise the descriptor of the ordered face set 
                           
                              {
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    8
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    9
                                 
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    10
                                 
                              
                              }
                           
                        .

Since each matrix is order-related and each face set should be corresponding to a unique descriptor, each face set descriptor is uniquely given accompanied with a face permutation in this work, i.e. different face permutations correspond to different face set descriptors for the same face set. In this case, each face set descriptor in this work is actually the descriptor of an ordered face set.

The directed surface judgment and surface type are used to describe the rotation invariant characters of each face. Especially, the surface type property of a face is set to 0, 1, 2, 3 or 4 when that face is a plane, cylinder, cone, sphere or any other kind respectively. The directed surface judgment of a face is set to 1 or 0 when the surface containing that face is a directed surface or not respectively. Such rule is applied to each kind of face in this work. Fig. 3(a) shows the constructed shape matrix for the ordered face set 
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       8
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       9
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       10
                                    
                                 
                                 }
                              
                           .

In this paper we use angle to measure the relative orientation between two faces. However, it is not enough to unambiguously describe the relative orientation between two faces only depending on their intersection angle. For example, in Fig. 3, the intersection angle between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            and face 
                              
                                 
                                    F
                                 
                                 
                                    8
                                 
                              
                            is 90° which is equal to the intersection angle between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            and face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           , while the relative orientations between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            & face 
                              
                                 
                                    F
                                 
                                 
                                    8
                                 
                              
                            and between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            & face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            are totally different. As a result, to properly describe the relative orientation between two faces by using angle, we not only include the intersection angle between the two faces, but also consider the concavity and convexity of their intersection. For example, in Fig. 3 the face intersection angle between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            and face 
                              
                                 
                                    F
                                 
                                 
                                    8
                                 
                              
                            is 90°, after considering the intersection convexity, the angle describing the relative orientation between face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            and face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            becomes 270°. To calculate the intersection angle between two faces, we adopt the methods described in  [82]. Fig. 3(b) shows the constructed relative orientation matrix for the ordered face set 
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       8
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       9
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       10
                                    
                                 
                                 }
                              
                           .

As any two faces in a shape frame are not always parallel to each other, thus, we adopt a signed face distance to assess the relative position from one face to the other uniformly. The formulized definition of signed face distance from face 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            to face 
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                            is as follows function (4.1): 
                              
                                 (4.1)
                                 
                                    
                                       
                                          Signed Face Distance
                                       
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                F
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      sign
                                                   
                                                   ∗
                                                   E
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cp
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         vp
                                                      
                                                      _
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ;
                                                   
                                                   S
                                                   =
                                                   
                                                      Dot
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cp
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         vp
                                                      
                                                      _
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               NF
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                   if  
                                                   
                                                      
                                                         F
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                     is a plane face
                                                
                                             
                                             
                                                
                                                   
                                                      sign
                                                   
                                                   ∗
                                                   E
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cp
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ,
                                                      
                                                         vp
                                                      
                                                      _
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ;
                                                   
                                                   S
                                                   =
                                                   
                                                      Dot
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               cp
                                                            
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      −
                                                      
                                                         vp
                                                      
                                                      _
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               CF
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                   else .
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       If  
                                       S
                                       <
                                       0
                                       ,
                                       
                                       
                                          sign
                                       
                                       =
                                       −
                                       1
                                       ,
                                       
                                       else  
                                       
                                          sign
                                       
                                       =
                                       1
                                       ;
                                       
                                       E
                                         is the Euclidean distance .
                                    
                                 
                              
                           
                        

Here, 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                            represent two faces; surface 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            containing face 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           ; 
                              
                                 
                                    
                                       cp
                                    
                                 
                                 
                                    j
                                 
                              
                            is the geometric center of 
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                           . If 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            is a plane face, then 
                              
                                 vp
                              
                              _
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            is the vertical projection point of 
                              
                                 
                                    
                                       cp
                                    
                                 
                                 
                                    j
                                 
                              
                            onto 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       NF
                                    
                                 
                                 
                                    i
                                 
                              
                            is the normal of 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            on 
                              
                                 vp
                              
                              _
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           . If 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            is a quadratic face having one axis (such as cylinder face), then 
                              
                                 vp
                              
                              _
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            is the vertical projection point of 
                              
                                 
                                    
                                       cp
                                    
                                 
                                 
                                    j
                                 
                              
                            onto that axis, otherwise, 
                              
                                 vp
                              
                              _
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            is the geometric center of 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           . If 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            is a quadratic face, then we multiply the normal of 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            on fip (fip is the first intersection point between 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                            and the ray starting from 
                              
                                 
                                    
                                       cp
                                    
                                 
                                 
                                    j
                                 
                              
                            while passing through 
                              
                                 vp
                              
                              _
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           ) by 
                              
                                 dc
                              
                            (
                              
                                 dc
                              
                            is a direction coefficient: if the directed surface judgment of 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                                is
                              =
                              1
                           , then 
                              
                                 dc
                              
                              =
                              1
                           , otherwise, 
                              
                                 dc
                              
                              =
                              −
                              1
                           ) to get the vector 
                              
                                 
                                    
                                       CF
                                    
                                 
                                 
                                    i
                                 
                              
                           . If 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            is a plane face, then 
                              S
                            is the dot product between vector 
                              
                                 (
                                 
                                    
                                       
                                          cp
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    vp
                                 
                                 _
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       NF
                                    
                                 
                                 
                                    i
                                 
                              
                           , otherwise, 
                              S
                            is the dot product between vector 
                              
                                 (
                                 
                                    
                                       
                                          cp
                                       
                                    
                                    
                                       j
                                    
                                 
                                 −
                                 
                                    vp
                                 
                                 _
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       CF
                                    
                                 
                                 
                                    i
                                 
                              
                           .

Especially, each signed face distance not only represents the distance between two faces geometrically but also reflects their spatial position relationship semantically. As shown in Fig. 4
                           , aided with the methods described in  [82], the signed face distances from face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            to other ones can be calculated (shown in Fig. 4(a)). Because the geometric center of 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            is behind 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            in Fig. 4(a), thus 
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              =
                              −
                              31
                           . Distinctively, 
                              
                                 
                                    D
                                 
                                 
                                    9
                                 
                              
                              =
                              37
                            since the geometric center of 
                              
                                 
                                    F
                                 
                                 
                                    9
                                 
                              
                            is in front of 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                           .

Since the query model and the candidate model have different sizes, it is natural to normalize each signed face distance before carrying out meaningful comparisons among the relative positions of the faces respectively belonging to the two models. After calculating all the signed face distances from one face 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            to the other faces belonging to the same model, we do the normalization as follows: 
                              
                                 (1)
                                 
                                    Classifying all the signed face distances into two groups based on their signs;


                                    Normalizing each signed face distance in its own group while keeping its sign.

Especially, normalizing signed face distances group by group while preserving their signs can keep two faces’ semantically relative positions. After normalizing, each signed face distance 
                              ∈
                              
                                 [
                                 −
                                 1
                                 ,
                                 0
                                 )
                              
                              ∪
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . For example, in Fig. 4(b), the signed face distance from face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            to 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            becomes 
                              
                                 
                                    D
                                 
                                 
                                    1
                                 
                              
                              /
                              
                                 |
                                 
                                    
                                       D
                                    
                                    
                                       7
                                    
                                 
                                 |
                              
                              =
                              −
                              0.5
                           , since 
                              
                                 
                                    D
                                 
                                 
                                    7
                                 
                              
                            possesses the longest absolute value among all the negative signed face distances originating from 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                           . On the other hand, the signed face distance from face 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            to 
                              
                                 
                                    F
                                 
                                 
                                    9
                                 
                              
                            becomes 
                              
                                 
                                    D
                                 
                                 
                                    9
                                 
                              
                              /
                              
                                 |
                                 
                                    
                                       D
                                    
                                    
                                       9
                                    
                                 
                                 |
                              
                              =
                              1
                           , since 
                              
                                 
                                    D
                                 
                                 
                                    9
                                 
                              
                            possesses the longest absolute value among all the positive signed face distance originating from 
                              
                                 
                                    F
                                 
                                 
                                    5
                                 
                              
                            as well.

When all of the signed face distances in a model are calculated, the relative position matrix for an ordered face set can be easily constructed. Fig. 3(c) shows the constructed relative position matrix for the ordered face set 
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       8
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       9
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       10
                                    
                                 
                                 }
                              
                           .

After constructing the ordered face set descriptors for two ordered face sets, the similarity between them can be measured by comparing their corresponding matrixes. To this end, we define the following distance measurement to assess the similarity between two ordered face sets:


                        Ordered face sets distance: Let us assume 
                           
                              
                                 
                                    SM
                                 
                              
                              
                                 1
                              
                           
                         & 
                           
                              
                                 
                                    SM
                                 
                              
                              
                                 2
                              
                           
                         (two shape matrixes), 
                           
                              
                                 
                                    OM
                                 
                              
                              
                                 1
                              
                           
                         & 
                           
                              
                                 
                                    OM
                                 
                              
                              
                                 2
                              
                           
                         (two relative orientation matrixes) and 
                           
                              
                                 
                                    PM
                                 
                              
                              
                                 1
                              
                           
                         & 
                           
                              
                                 
                                    PM
                                 
                              
                              
                                 2
                              
                           
                         (two relative position matrixes) respectively constructed for two ordered face sets 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         & 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        . The face counts of the two face sets are equal to 
                           K
                        . Then, 
                           
                              
                                 (4.2)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             shape
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                +
                                                ∞
                                                ,
                                                
                                                
                                                   
                                                      
                                                         SM
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   i
                                                   )
                                                
                                                ≠
                                                
                                                   
                                                      
                                                         SM
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   ,
                                                   i
                                                   )
                                                
                                                and
                                                /
                                                or
                                                
                                                
                                                   
                                                      
                                                         FSM
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   i
                                                   )
                                                
                                                ≠
                                                
                                                   
                                                      
                                                         FSM
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   2
                                                   ,
                                                   i
                                                   )
                                                
                                                ,
                                                
                                                i
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                K
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                                
                                                else
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (4.3)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             OM
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       |
                                       
                                          
                                             
                                                OM
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                OM
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       |
                                    
                                 
                              
                              
                                 (4.4)
                                 
                                    
                                       
                                          d
                                       
                                       
                                          
                                             PM
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       |
                                       
                                          
                                             
                                                PM
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                PM
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       |
                                    
                                 
                              
                              
                                 (4.5)
                                 
                                    d
                                    
                                       (
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          d
                                       
                                       
                                          
                                             shape
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FS
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          
                                             OM
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FL
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FL
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          
                                             PM
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                FL
                                             
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                FL
                                             
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     


                        
                           
                              
                                 d
                              
                              
                                 
                                    shape
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         denotes the shape distance between 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        . Especially, when two faces, at the same permutation place respectively belonging to 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        , have different surface types and/or different directed surface judgments, we assign 
                           +
                           ∞
                         to 
                           
                              
                                 d
                              
                              
                                 
                                    shape
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        . 
                           
                              
                                 d
                              
                              
                                 
                                    PM
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         and 
                           
                              
                                 d
                              
                              
                                 
                                    OM
                                 
                              
                           
                           
                              (
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         respectively denote the relative position distance (between 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        ) and the relative orientation distance (between 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        ). 
                           d
                           
                              (
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       FS
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         denotes the ordered face sets distance between 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 
                                    FS
                                 
                              
                              
                                 2
                              
                           
                        . Obviously, the smaller the ordered face sets distance between two ordered face sets, the greater the similarity between them.

According to the definition of corresponding shape frame, determining the corresponding shape frame of the candidate model (corresponding to 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        ) is to find the shape frame 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         (in the candidate model) that is the most similar to 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . Besides, based on the method adopted to assess the similarity between two ordered face sets, the 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         should have a special face permutation matching along with that in 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . In other words, to find the corresponding shape frame of the candidate model (corresponding to 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        ) is to find the ordered 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         (a shape frame accompanied with a face permutation is called an ordered shape frame) that has the minimum ordered face sets distance to the ordered
                        
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         (the face permutation of 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         is random). To this end, a natural way is to employ an exhaustive combination search for the target ordered shape frame (having the same face count as 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        ) from the candidate model. Note that this naive brute-force search method is aimless and has a factorial time complexity. Furthermore, there is no pre-existing solution for identifying shape frames from the candidate model based on the query model according to our review of literature.

Regarding the above problems, we first apply a heuristic filtering process (Fig. 5
                        ) (based on the definition of ordered face sets distance) to find out all the possible ordered shape frames of the candidate model (from all of its ordered face sets) according to the ordered 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . We then calculate the ordered face sets distances between the ordered 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         and each found possible ordered shape frame. Finally, the possible ordered shape frame 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         owning the minimum ordered face sets distance is determined as the corresponding shape frame of 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                        . Meanwhile, according to the definition of corresponding faces and the definition of ordered face sets distance, each pair of corresponding faces is just the pair of faces respectively belonging to the ordered 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    C
                                 
                              
                           
                         and the ordered 
                           
                              
                                 
                                    SF
                                 
                              
                              
                                 
                                    Q
                                 
                              
                           
                         at the same permutation place.

Based on the definition of ordered face sets distance, an ordered face set, to be a possible ordered shape frame of the candidate model according to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                           , should have small distances to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                            respectively in aspects of each face’s rotation invariant characters and face layout. According to the above sense, by composing of shape filtering, relative orientation filtering and relative position filtering, we design the heuristic filtering process (shown in Fig. 5) to find out all the possible ordered shape frames of the candidate model (from all the ordered face sets of the candidate model) according to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                           .

According to function (4.2), an ordered face set, to be a possible ordered shape frame of the candidate model according to the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              , should have the same shape matrix as the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              . In this work, a shape filtering, as the first step of our heuristic filtering process (Fig. 5), is carried out to preliminarily find out all the possible ordered shape frames of the candidate model according to the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              . Then, an “ordered face set matrix” is used to save all the possible ordered shape frames. For example, in Fig. 6
                              , there are totally 103783680 possible ordered shape frames of model 
                                 B
                               according to the ordered shape frame 
                                 
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          8
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          9
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          10
                                       
                                    
                                    }
                                 
                              .

According to function (4.3), an ordered face set, to be a possible ordered shape frame of the candidate model according to the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              , should have a small distance from its own relative orientation matrix to that of the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              . Here, if the distance is larger than 
                                 ξ
                                 
                                 
                                    (
                                    ξ
                                    =
                                    5
                                    °
                                    )
                                 
                              , then the ordered face set is not a possible ordered shape frame and eliminated from the ordered face set matrix directly. In this work, a relative orientation filtering, as the second step of our heuristic filtering process (Fig. 5), is carried out to further filtering out possible ordered shape frames from the ordered face set matrix.

For example, the first relative orientation matrix (Fig. 7
                              (b)) is constructed for the possible ordered shape frame 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          16
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          17
                                       
                                    
                                    }
                                 
                               (Fig. 7(a)). The relative orientation matrix (Fig. 7(c)) is constructed for the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          8
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          9
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          10
                                       
                                    
                                    }
                                 
                              . Since the distance between the two values in the [1, 2] positions respectively belonging to the above is 270°, which is larger than 
                                 ξ
                              . Thus, 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                               is eliminated from the matrix 1 (Fig. 7(a)), and the ordered face set matrix 2 (Fig. 7(d)) is the output of this filtering step.

According to function (4.4), an ordered face set, to be a possible ordered shape frame of the candidate model according to the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              , should have a small distance from its own relative position matrix to that of the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              . Here, if the distance is larger than 
                                 δ
                                 
                                 
                                    (
                                    δ
                                    =
                                    0.1
                                    )
                                 
                              , then the ordered face set is not deemed as a possible ordered shape frame and eliminated from the ordered face set matrix directly. In this work, a relative position filtering, as the third step of our heuristic filtering process (Fig. 5), is carried out to further filtering out possible ordered shape frames from the ordered face set matrix.

For example, the first relative position matrix (Fig. 8
                              (b)) is constructed for the possible ordered shape frame 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          8
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          10
                                       
                                    
                                    }
                                 
                               (Fig. 8(a)). The relative position matrix (Fig. 8(c)) is constructed for the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          5
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          6
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          7
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          8
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          9
                                       
                                    
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          10
                                       
                                    
                                    }
                                 
                              . Since the distance between the two values in the [1, 10] positions respectively belonging to the above matrixes is 0.8, which is larger than 
                                 δ
                              . Thus, 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          T
                                       
                                    
                                 
                               is eliminated from the matrix 2 (Fig. 8(a)), and the ordered face set matrix 3 (Fig. 8(d)) is the output of this filtering step.

After the shape filtering and relative orientation filtering, any possible ordered shape frame in the ordered face set matrix has the following character: the 
                                 i
                              th face in that possible ordered shape frame has the same face rotation invariant characters as the 
                                 i
                              th face in the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              , and the two faces have similar relative orientations relative to other faces in their own ordered face sets (
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 K
                                 ,
                                 K
                               is the face count of 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              ). The relative position filtering, according to the ordered 
                                 
                                    
                                       
                                          SF
                                       
                                    
                                    
                                       
                                          Q
                                       
                                    
                                 
                              , will eliminate all the possible ordered shape frames from the ordered face set matrix when they do not characterize the overall shape of the candidate model. Such case will be right if we consider that the overall shape of the candidate model is similar to that of the query model.

After the above heuristic filtering process, based on the function (4.5), the possible ordered shape frame 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                            in the ordered face set matrix, owning the greatest similarity with the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                           , can be easily found (
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                            is just the corresponding shape frame of 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                           ). Meanwhile, according to the definition of corresponding faces and the definition of ordered face sets distance, each pair of corresponding faces is just the pair of faces respectively belonging to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                            and the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                            at the same permutation place.

For example, before heuristic filtering, there are 103783680 possible ordered shape frames in model 
                              B
                            according to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                              
                                 {
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       5
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       8
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       9
                                    
                                 
                                 ,
                                 
                                    
                                       F
                                    
                                    
                                       10
                                    
                                 
                                 }
                              
                            (Fig. 6). After heuristic filtering, the count of possible ordered shape frames is reduced to 96 (Fig. 8(d)). Finally, the ordered shape frame 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                              
                                 {
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       15
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       7
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       11
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       14
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       8
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       16
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       17
                                    
                                 
                                 }
                              
                            is determined as the corresponding shape frame of 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                           . Meanwhile, the faces in the same permutation place respectively belonging to the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       Q
                                    
                                 
                              
                            and the ordered 
                              
                                 
                                    
                                       SF
                                    
                                 
                                 
                                    
                                       C
                                    
                                 
                              
                           , with the same color (except gray) in Fig. 5, are determined as the corresponding faces between the query model and the candidate model.

Although some faces in the candidate model have no corresponding faces in the query model based on the method mentioned in the above sections, they will also change along with the shape adaptation. Here, for the convenience of dimension relationship establishment in the following sections, if two faces in the candidate model belong to the same feature and share the same surface, then we entitle them to have the same corresponding face(s) in the query model. For example, in Fig. 2, face 7 and face 
                              
                                 
                                    7
                                 
                                 
                                    ′
                                 
                              
                            can be determined as a pair of corresponding faces in the above sections. As the cylinder faces 
                              
                                 
                                    7
                                 
                                 
                                    ′
                                 
                              
                           , 
                              
                                 
                                    8
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                            and 
                              1
                              
                                 
                                    5
                                 
                                 
                                    ′
                                 
                              
                            belong to the same feature and share the same cylinder surface, then each of them is corresponding to face 7. Similarly, if two faces in the query model belong to the same feature and share the same surface, then we entitle them to have the same corresponding face(s) in the candidate model. For example, because the cylinder faces 7 and 9 belong to the same feature and share the same cylinder surface, both face 7 and face 9 are corresponding to the faces 
                              
                                 
                                    7
                                 
                                 
                                    ′
                                 
                              
                           , 
                              
                                 
                                    8
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    0
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           , 
                              1
                              
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                            and 
                              1
                              
                                 
                                    5
                                 
                                 
                                    ′
                                 
                              
                           .

In the first place, the natural way to transfer the query model’s shape to the candidate model is to establish dimension relationships (algebraic relations) between each pair of corresponding dimensions & between each dimension and its corresponding dimension chain. Next, we make the corresponding dimensions and corresponding dimension chains in the candidate model have the same values as those of their counterparts in the query model. However, identifying the corresponding dimensions and dimension chains among the two models is not a trivial work since the parametric way for a parametric solid model can be very flexible.

To solve the above issue, firstly, we adopt a promotion method to promote each dimension in a model to be defined on/between its constrained entity(s) (edge, axis of a quadratic face and face) since dimensions mainly exist in 2D sketches and features, such as the promotion examples related to dimension 
                        
                           
                              D
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              R
                           
                           
                              1
                           
                        
                      in Fig. 9
                     . Then, we identify corresponding dimensions and the corresponding dimension chains between the two given models based on their corresponding faces (since corresponding edges and corresponding axes among the two models can be deduced from corresponding faces easily according to their definition (Section  3)).

Generally speaking, the mainstream CAD systems for constructing a parametric solid model adopt attaching new features to the previous features  [83,84]. Furthermore, the extrusion features (each of them is formed by sweeping the 2D sketch profile along the direction perpendicular to the sketch plane containing the profile) and revolution features (each of them is constructed by revolving a 2D sketch profile about an axis by a position angle)  [83] are the most common and fundamental features in current CAD systems. Thus, we hypothesize that the query model and the candidate model are constructed mainly by using extrusion features and/or revolution features.

Without losing generality, we consider two types of dimension constraints on a 2D sketch: distance dimension and angle dimension. Especially, each distance dimension is defined between two sketch points, between sketch point & sketch line or between two sketch lines; and each angle dimension is defined between two sketch lines while using interior angle as its value. We do not consider dimensions among curves since such sketch elements can be positioned with respect to each other by specifying constraints between their reference sketch points or sketch lines  [48].

As we know, each sketch point and each sketch segment (line or curve), after sweeping, correspond to an edge (or axis) and a face respectively. For example, in Fig. 10
                        (a) and (b), sketch point 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                         corresponds to edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         (swept from 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                        ); sketch point 
                           
                              
                                 
                                    cp
                                 
                              
                              
                                 1
                              
                           
                         corresponds to the axis 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                           _
                           A
                         (swept from 
                           
                              
                                 
                                    cp
                                 
                              
                              
                                 1
                              
                           
                        ); sketch line 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                         corresponds to face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         (swept from 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                        ). Because each edge is always deemed as the intersection of two faces in a manifold model, we adopt 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         to represent an edge 
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         (face 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         are respectively swept from two segments that make a point 
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                         as their intersection point corresponding to edge 
                           
                              
                                 E
                              
                              
                                 i
                              
                           
                         after sweeping). For example, edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         is represented as 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                        .

Because each sketch element (point, line or curve) corresponds to an entity (edge, axis or face) after sweeping, a dimension constraining on/between a sketch element(s) (by being defined on/between it/them) is actually constraining the distance or angle on/between the entity(s) corresponding to that sketch element(s). Accordingly, promoting each dimension in a parametric solid model is to find the entity(s) constrained by that dimension. Table 1
                         shows the method of dimension promotion for each type of dimension.

For example, in Fig. 10(b), 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         constrains the distance between 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                         & 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 6
                              
                           
                        . Edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 6
                              
                           
                         are respectively swept from 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 6
                              
                           
                        . Meanwhile, 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         (face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         are swept from 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 6
                              
                           
                         and 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 3
                              
                           
                         respectively). Thus, the distance between edge 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 6
                              
                           
                         is constrained by 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                        . So, we promote 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                         to be defined between 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 6
                              
                           
                        . Similarly, 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         is promoted to be defined between 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                         (
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                         is swept from the arc 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 3
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 4
                              
                           
                        ) while 
                           
                              
                                 D
                              
                              
                                 5
                              
                           
                         is promoted to be defined between 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                         (swept from sketch line 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 5
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 6
                              
                           
                        ). Because center-point 
                           
                              
                                 
                                    cp
                                 
                              
                              
                                 1
                              
                           
                         of sketch arc 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 3
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 4
                              
                           
                         is swept to the axis 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                           _
                           A
                         of face 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                        , thus, 
                           
                              
                                 D
                              
                              
                                 3
                              
                           
                         is promoted to be defined between 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                           _
                           A
                         and 
                           
                              
                                 F
                              
                              
                                 5
                              
                           
                        .

Since changing the value of 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                        , as the radius of sketch arc 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 3
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 4
                              
                           
                        , is changing the radius of the cylinder face 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                        , thus, we promote 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                         to be defined on 
                           
                              
                                 F
                              
                              
                                 3
                              
                           
                        . Changing the value of 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         is changing the angle between sketch line 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 1
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 2
                              
                           
                           
                              
                                 
                                    sp
                                 
                              
                              
                                 3
                              
                           
                        , which also affect the relative angle between face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                        , thus, 
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                         is promoted to be defined between 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                        . For the extrusion dimension 
                           
                              
                                 D
                              
                              
                                 6
                              
                           
                        , in Fig. 10, constrains the distance between face 
                           
                              
                                 F
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                         (respectively corresponding to the starting face and the end face of model SM). So, we promote 
                           
                              
                                 D
                              
                              
                                 6
                              
                           
                         to be defined between 
                           
                              
                                 F
                              
                              
                                 8
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 7
                              
                           
                        .

Especially, using two faces’ intersection to represent an edge (explicit or implicit), not only keeps a consistent definition form for all promoted dimensions, but also explicitly reflects the intrinsically geometric constraint among faces. For example, in Fig. 10(c), edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                         disappear from model SM after adding a fillet feature. However, the distance between the implicit edge 
                           
                              
                                 E
                              
                              
                                 1
                              
                           
                         (represented as 
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                        ) and the implicit edge 
                           
                              
                                 E
                              
                              
                                 2
                              
                           
                         (represented as line 
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                        ) is still constrained by 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                        .

After promoting all the dimensions in a parametric solid model to be defined on/between constrained entity(s), a 3D dimension constraint graph
                        
                           
                              3DDCG
                           
                           =
                           
                              (
                              V
                              ,
                              E
                              )
                           
                         is adopted to uniformly represent them. 
                           V
                         is the node set in the graph. Each node represents a constrained entity(s). We make each dimension that constrains the shape of the surface containing a face 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                         as a property of the node representing a constrained entity(s) that belongs to 
                           
                              
                                 F
                              
                              
                                 i
                              
                           
                        . For example, as shown in Fig. 11
                        (c), the node 
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                         represents face 
                           
                              
                                 f
                              
                              
                                 3
                              
                           
                        ; node 
                           
                              
                                 f
                              
                              
                                 11
                              
                           
                           _
                           A
                         represents the axis of face 
                           
                              
                                 f
                              
                              
                                 11
                              
                           
                        ; node 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                           ∩
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                         represents the edge between face 
                           
                              
                                 f
                              
                              
                                 5
                              
                           
                         & 
                           
                              
                                 f
                              
                              
                                 7
                              
                           
                        , and the radius of 
                           
                              
                                 f
                              
                              
                                 10
                              
                           
                         is set as the property of node 
                           
                              
                                 f
                              
                              
                                 10
                              
                           
                           _
                           A
                         since 
                           
                              
                                 f
                              
                              
                                 10
                              
                           
                           _
                           A
                         is the axis of 
                           
                              
                                 f
                              
                              
                                 10
                              
                           
                        . 
                           E
                         is the graph edge set in the graph. Each graph edge represents a dimension.

Additionally, since any two constrained entities, belonging to the same feature and sharing the same geometric element (surface, line or axis), always have the same distances and orientations relative to other geometric elements in the same model. So, the constrained entities satisfying the above conditions are represented by the same graph node. For example, in Fig. 11(a), both face 
                           
                              
                                 f
                              
                              
                                 12
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 13
                              
                           
                         belong to extrusion1 feature and share the same plane surface according to the feature design tree (Fig. 11(b)). Because face 
                           
                              
                                 f
                              
                              
                                 12
                              
                           
                         is referred to the promoted dimension 
                           
                              
                                 B
                              
                              
                                 6
                              
                           
                         (Fig. 11(a) and (c)), 
                           
                              
                                 f
                              
                              
                                 12
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 13
                              
                           
                         are represented by the same node 
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    12
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    13
                                 
                              
                              }
                           
                        . Similarly, both the axis 
                           
                              
                                 f
                              
                              
                                 14
                              
                           
                           _
                           A
                         of face 
                           
                              
                                 f
                              
                              
                                 14
                              
                           
                         and the axis 
                           
                              
                                 f
                              
                              
                                 15
                              
                           
                           _
                           A
                         of 
                           
                              
                                 f
                              
                              
                                 15
                              
                           
                         belong to thruhole2 feature and share the same axis. Because 
                           
                              
                                 B
                              
                              
                                 7
                              
                           
                         is promoted to be defined between 
                           
                              
                                 f
                              
                              
                                 14
                              
                           
                           _
                           A
                         and face 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                        , we use node 
                           
                              {
                              
                                 
                                    f
                                 
                                 
                                    14
                                 
                              
                              _
                              A
                              ,
                              
                                 
                                    f
                                 
                                 
                                    15
                                 
                              
                              _
                              A
                              }
                           
                         to represent the constrained entity 
                           
                              
                                 f
                              
                              
                                 14
                              
                           
                           _
                           A
                         and 
                           
                              
                                 f
                              
                              
                                 15
                              
                           
                           _
                           A
                        .

Furthermore, using 3DDCG to represent all promoted dimensions belonging to a parametric solid model, not only reflects the direct dimension constraints between two constrained entities, but also indicates the indirect dimension constraints between two constrained entities which are connected by a sequence of dimensions (each pair of the adjacent dimensions in that sequence is connected by the same constrained entity). For example, in Fig. 11(a), although there is no dimension that constrains the distance between face 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 8
                              
                           
                        , a dimension path (dimension chain) (
                           
                              
                                 B
                              
                              
                                 4
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 B
                              
                              
                                 2
                              
                           
                        ) can be found between node 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 8
                              
                           
                         in Fig. 11(c). We can see that the relative distance between face 
                           
                              
                                 f
                              
                              
                                 9
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 8
                              
                           
                         is controlled by that path.

After building the two 3D dimension constraint graphs 
                           
                              
                                 
                                    FDG
                                 
                              
                              
                                 Q
                              
                           
                         and 
                           
                              
                                 
                                    FDG
                                 
                              
                              
                                 C
                              
                           
                         respectively for the query model and the candidate model, based on their corresponding faces, we can identify their corresponding dimensions and corresponding dimension chains conveniently.

Obviously, according to the dimension promotion method, given two corresponding faces 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           , it is easy to establish corresponding dimension relationships among the dimensions respectively constraining the surface shape of 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            and the surface shape of 
                              
                                 
                                    f
                                 
                                 
                                    i
                                 
                              
                           . For example, in Fig. 12
                           (c) and (d), 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                            as the dimension that constrains the radius of the surface containing face 
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                            is promoted to be defined on face 
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                           . Similarly, 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                            as the dimension that constrains the radius of the surface containing face 
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                            is promoted to be defined on face 
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                           . Because face 
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                            corresponds to face 
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                           , 
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                            are corresponding dimensions.

Given two dimensions 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                           , as two graph edges connecting two pairs of nodes (
                              
                                 
                                    
                                       QN
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       QN
                                    
                                 
                                 
                                    j
                                 
                              
                           ) and (
                              
                                 
                                    
                                       CN
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       CN
                                    
                                 
                                 
                                    j
                                 
                              
                           ) which respectively belong to 
                              
                                 
                                    
                                       FDG
                                    
                                 
                                 
                                    Q
                                 
                              
                            and 
                              
                                 
                                    
                                       FDG
                                    
                                 
                                 
                                    C
                                 
                              
                           , if the two pairs of nodes contain the characters that follow into one of the 6 cases (shown in Table 2
                           ) while 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                            have the same dimension type (distance or angle), then 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                            are corresponding dimensions:

For example, in Fig. 12(c) and (d), 
                              
                                 
                                    D
                                 
                                 
                                    6
                                 
                              
                            is promoted to be defined between the axis of face 
                              
                                 
                                    F
                                 
                                 
                                    6
                                 
                              
                            and the axis of face 
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                           , and 
                              
                                 
                                    B
                                 
                                 
                                    5
                                 
                              
                            is promoted to be defined between the axis of face 
                              
                                 
                                    f
                                 
                                 
                                    10
                                 
                              
                            and the axis of face 
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                           ; meanwhile 
                              
                                 
                                    f
                                 
                                 
                                    10
                                 
                              
                             &  
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                            respectively correspond to 
                              
                                 
                                    F
                                 
                                 
                                    6
                                 
                              
                             &  
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                           , thus 
                              
                                 
                                    f
                                 
                                 
                                    10
                                 
                              
                              _
                              A
                             &  
                              
                                 
                                    f
                                 
                                 
                                    11
                                 
                              
                              _
                              A
                            respectively correspond to 
                              
                                 
                                    F
                                 
                                 
                                    6
                                 
                              
                              _
                              A
                             &  
                              
                                 
                                    F
                                 
                                 
                                    7
                                 
                              
                              _
                              A
                            according to the definition of corresponding axis. Finally, based on Table 2(2) and the definition of corresponding dimension, 
                              
                                 
                                    D
                                 
                                 
                                    6
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    5
                                 
                              
                            are corresponding dimensions.

Given two pairs of graph nodes (
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    j
                                 
                              
                           ) and (
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    i
                                 
                              
                           , 
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    j
                                 
                              
                           ) respectively belonging to 
                              
                                 
                                    
                                       FDG
                                    
                                 
                                 
                                    Q
                                 
                              
                            and 
                              
                                 
                                    
                                       FDG
                                    
                                 
                                 
                                    C
                                 
                              
                           , and dimension 
                              D
                            as the graph edge connects 
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    j
                                 
                              
                           , we have to identify the corresponding dimension chain in the candidate model corresponding to 
                              D
                            when the following conditions are satisfied: (1) the two pairs of graph nodes contain the characters that follow into one of the 6 cases listed in Table 2; (2) there is no graph edge (having the same dimension type as 
                              D
                           ) connecting 
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    i
                                 
                              
                            & 
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    j
                                 
                              
                            directly. In other words, in the above situation, we have to find a dimension chain constraining the constrained entities represented by node 
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       CCE
                                    
                                 
                                 
                                    j
                                 
                              
                            respectively and having the same effect as 
                              D
                            does on the constrained entities represented by node 
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       QCE
                                    
                                 
                                 
                                    j
                                 
                              
                            respectively. Such case has been mentioned in Section  5.2 that the dimension chain (
                              
                                 
                                    B
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                           ) constrains the distance between face 
                              
                                 
                                    f
                                 
                                 
                                    9
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    8
                                 
                              
                           . With the help of 3D dimension constraint graph, to identify the corresponding dimension chain in the candidate model is to find a dimension path from 
                              
                                 
                                    
                                       FDG
                                    
                                 
                                 
                                    C
                                 
                              
                           .

Adopting depth-first search method  [85] accompanied with the requirement of no graph edge repeating, as we can see that more than one dimension path, starting from any node 
                                 i
                               while ending with any node 
                                 j
                              , may be found from 
                                 
                                    
                                       
                                          FDG
                                       
                                    
                                    
                                       C
                                    
                                 
                              . For example, in Fig. 13
                              (b), (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                 
                              ) and (
                                 
                                    
                                       A
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       A
                                    
                                    
                                       4
                                    
                                 
                              ) are the two none graph edge repeated dimension paths starting from node 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               while ending with node 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                              . To find the optimal dimension path from 
                                 
                                    
                                       
                                          FDG
                                       
                                    
                                    
                                       C
                                    
                                 
                               that corresponds to 
                                 D
                              , we combine the following searching priorities (Table 3
                              ) into the depth-first searching method.


                              Optimal dimension path: After embedding the priorities (Table 3) into the depth-first searching method, the first found dimension path, connecting the two nodes 
                                 
                                    
                                       
                                          CCE
                                       
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       
                                          CCE
                                       
                                    
                                    
                                       j
                                    
                                 
                              , is deemed as the optimal dimension path (corresponding dimension chain) for 
                                 D
                              .

Here, the searching priorities are designed according to the common automatic dimensioning mechanism, adopted by some mainstream CAD systems (such as SolidWorks), which automatically defines each distance dimension on a sketch from between two paralleled lines, to between one line and one point, to between two points in a descending priority for facilitating machining and measuring. Since each line will be swept to a face while each point is swept to an edge or an axis, thus each graph node representing a face(s) has a higher priority than each graph node representing an axis or an edge in each searching step. Furthermore, as edges and faces usually describe the shape of a solid model, while an axis is often used to determine the position of an embedded feature (such as the hole in Fig. 13(b)), thus each graph node representing an edge(s) has a higher priority than each graph node representing an axis in each searching step.

Moreover, because each angle dimension and each distance dimension are usually considered to respectively control the relative orientation and the relative distance between two constrained entities  [86,87], we assume that all the dimensions in an optimal dimension path should have the same type (distance or angle).

For example, in Fig. 13(a) and (b), if 
                                 D
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       1
                                    
                                 
                              , then the optimal dimension path searching process starts from node 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                               firstly, then the next searching node is 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 ∩
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                               according to Table 3 since it has a higher priority than node 
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                                 _
                                 A
                               (the axis of face 
                                 
                                    
                                       f
                                    
                                    
                                       6
                                    
                                 
                              ). After that the next node is 
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 ∩
                                 
                                    
                                       f
                                    
                                    
                                       4
                                    
                                 
                              , and the searching process ends with node 
                                 
                                    
                                       f
                                    
                                    
                                       5
                                    
                                 
                              . Finally, the optimal dimension path (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                 
                              ) is found. Similarly, in Fig. 12, the dimension path (
                                 
                                    
                                       B
                                    
                                    
                                       4
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                              ) will be identified as the optimal dimension path when 
                                 D
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       4
                                    
                                 
                              .

However, if there is no corresponding dimension or corresponding dimension chain in the candidate model that corresponds to 
                                 D
                              , we have to modify the parametric way of the candidate model manually to support automatic shape adaptation at present.

After identifying the corresponding dimension 
                           B
                         or corresponding dimension chain 
                           
                              BC
                           
                         in the candidate model for a given dimension 
                           D
                         in the query model, the establishment of dimension relationship between them is given as follows.

If dimension 
                              B
                            has no parametric constraint with any other dimension in the candidate model, then we establish the relationship between them as 
                              B
                              =
                              D
                           ; otherwise, use the method of imposing constraints sequentially  [48] to recalculate all the dimensions that have parametric constraints with 
                              B
                            while ensuring 
                              B
                              =
                              D
                           . For example, in Fig. 12(c) and (d), two corresponding dimensions 
                              
                                 
                                    D
                                 
                                 
                                    6
                                 
                              
                            and 
                              
                                 
                                    B
                                 
                                 
                                    5
                                 
                              
                            representing with dark brown graph edges have a relationship as 
                              
                                 
                                    B
                                 
                                 
                                    5
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    6
                                 
                              
                           .

Let 
                              
                                 BC
                              
                              =
                              
                                 (
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 )
                              
                            be the dimension chain that constrains the relative distance or the relative orientation between two constrained entities 
                              
                                 
                                    N
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    N
                                 
                                 
                                    j
                                 
                              
                            in the candidate model. Furthermore, 
                              
                                 BC
                              
                            corresponds to 
                              D
                            which is a dimension belonging to the query model. Then, according to the parametric constraints in the candidate model, two different methods are adopted to establish dimension relationships between 
                              D
                            and each dimension in 
                              
                                 BC
                              
                           : 
                              
                                 (1)
                                 If 
                                       D
                                     is a distance dimension, 
                                       
                                          (1.1)
                                          If each dimension in 
                                                
                                                   BC
                                                
                                              has no parametric constraint with other dimensions in the candidate model, then 
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   /
                                                   m
                                                   _
                                                   d
                                                   )
                                                
                                                ∗
                                                D
                                              where 
                                                m
                                                _
                                                d
                                              is the sum value of all dimensions in 
                                                
                                                   BC
                                                
                                             . For example, in Fig. 12(c) and (d), (
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      3
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                             ) is the corresponding dimension chain of dimension 
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      4
                                                   
                                                
                                              representing with blue graph edges. Meanwhile, 
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      3
                                                   
                                                
                                              and 
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                              have no parametric constraint with other dimensions in the candidate model. Thus, 
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      4
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   /
                                                   m
                                                   _
                                                   d
                                                   )
                                                
                                                ∗
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      4
                                                   
                                                
                                                ,
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      3
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   /
                                                   m
                                                   _
                                                   d
                                                   )
                                                
                                                ∗
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      4
                                                   
                                                
                                              and 
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   m
                                                   _
                                                   d
                                                   )
                                                
                                                ∗
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      4
                                                   
                                                
                                             .

Else, we take a global solution recalculation by adding the constraint (the distance between 
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      i
                                                   
                                                
                                              and 
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      j
                                                   
                                                
                                              is equal to the value of 
                                                D
                                             ) to the global parametric constraints equations of the candidate model.

Else if 
                                       D
                                     is an angle dimension, then we take a global solution recalculation by adding the constraint (the angle between 
                                       
                                          
                                             N
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             N
                                          
                                          
                                             j
                                          
                                       
                                     is equal to the value of 
                                       D
                                    ) to the global parametric constraints equations of the candidate model.

After establishing the relationships among the dimensions of two models, the parametric information transfers from the query model to the candidate model. Then, the candidate model updates its shape by updating each dimension with the new incoming value, and the process of automatic shape adaptation is finished. For example, in Fig. 12(e), the shape of candidate model 
                              B
                            in Fig. 12(e) is the result of adapting its shape in Fig. 12(b) to the query model in Fig. 12(a).

The proposed automatic shape adaptation approach has been implemented in OSAD prototype. The UI module (Fig. 14
                     ) is developed by using Microsoft Visual C# 2008 and built as a plug-in of SolidWorks 2009 to interact with designers  [88]; the matrix calculations (Matlab C++ Math Library  [89]) and shape frame similarity assessment module are developed by using Microsoft Visual C++ 2008 and built as a win32 library which is invoked by the UI module during the process of the most similar shape frame identification in the candidate model.

Our approach is relatively independent on 3D model retrieval approaches. For identifying dimension chains conveniently and feasibly in this work, we choose to build an assistant tool to take the following work: transforming each distance dimension to be defined from between two paralleled lines, to between one line and one point, to between two points in a descending priority. This is designed according to the common automatic dimensioning mechanism adopted by some mainstream CAD systems (such as SolidWorks).

Here, we provide seven additional pairs of models to demonstrate the efficiency and the main process of our automatic shape adaptation.

In each case of 1 & 2 & 3, in Fig. 15
                        , both of the query model and the candidate model have simple shapes. When the corresponding faces between the two models are determined, the colored faces (except the gray ones) in the candidate model comprise a roughly overall shape of the model itself. After automatically transferring the shape of the query model to the candidate model, the changes (in the candidate model) occur in the corresponding faces and their adjacent faces.

In case 4 & 5 of Fig. 15, each query model contains more detailed shape design requirements than the query model in case 1, and has a close shape complexity to its corresponding candidate model. When the corresponding faces between each query model and its corresponding candidate model are determined, the colored faces (except the gray ones) in each candidate model comprise a compactly overall shape of the model itself. After automatically shape transferring, the shape of each candidate model is updated according to its corresponding query model.

Although this shape adaption approach is developed mainly for mechanical models, our approach can also be applied to parametric solid models of other fields (such as furniture models, and building models) when the models are designed conforming to our assumptions described in Section  7. In case 6 & 7 of Fig. 16
                        , we illustrate automatic shape adaptation for the man-made models (each of them should be designed as a parametric part): one lantern and one chair.

Using our OSAD prototype, the efficiencies of the above 7 cases of automatic shape adaptation, shown in Table 4
                        , are run on a laptop computer with an Intel Core 2 Duo CPU 2.10 GHz, 2 GB RAM and Windows 7 Operating System.

@&#DISCUSSION@&#

Compared with the state-of-the-art approaches on geometric adaptation, our approach has several advantages and is more suitable for engineering applications. Here, we conduct the comparisons (Table 5
                     ) between the state-of-the-art approaches on geometric adaptation and our approach according to the following items: (1) what is the input(s); (2) whether the target shape can be driven by overall size (such as global height, and global width); (3) whether the shape adaptation process needs using domain-specific knowledge; (4) whether the shape adaptation is a preserving constraints   [75] adaptation; (5) what about the adaptation means; (6) what about the application field(s) and (7) whether the result shape needs achieving engineering accuracy.

@&#LIMITATIONS@&#

Although our approach can effectively adapt the shape of the candidate model to that of the input primary model (query model), there still exists some assumptions described as follows. 
                           
                              (1)
                              The two input models are composed of plane faces and/or quadratic faces. The free-form surfaces currently have not yet considered since they are usually not related to dimension constraints directly.

The input parametric solid models are constructed mainly by extrusion features and revolution features since they are the most common and fundamental features in current CAD systems.

The corresponding faces have the same surface type and the same directed surface judgment, guaranteeing the correspondence between two corresponding faces is accurate.

The shape frames of two input models have similar face layouts. Under this assumption, the corresponding faces can be effectively determined. In Fig. 17
                                 , there is no shape frame in the candidate model that has the similar face layout to that of the query model since the faces (contained in the red area) respectively belonging to the two models have different relative orientations based on the function (4.3). Thus, the corresponding faces determination between the two models is failed.

Two corresponding pairs of constrained entities respectively belonging to the two given models have corresponding dimensions or corresponding dimension chains. This assumption is used to ensure that dimension-driven adaptation can be achieved  [48,90,91].


                        Fig. 18
                         shows a failed example of establishing all dimension relationships between the two given models. Because the horizontal positions of the axes of face 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         and face 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         are respectively constrained by distance dimension 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         and the geometric constraint (point–line coincident: sketch circle center 
                           
                              cp
                           
                         and the sketch symmetry red dash line), there is no corresponding dimension or corresponding dimension chain that corresponds to 
                           
                              
                                 D
                              
                              
                                 2
                              
                           
                         in the candidate model (face 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         corresponds to face 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         and face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         corresponds to face 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                        ). Thus, after shape transferring, the axes of the corresponding faces 
                           
                              
                                 F
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 f
                              
                              
                                 2
                              
                           
                         have different positions respectively relative to face 
                           
                              
                                 F
                              
                              
                                 1
                              
                           
                         and face 
                           
                              
                                 f
                              
                              
                                 1
                              
                           
                         while all of the other corresponding faces respectively belonging to the two given models have the same face layouts.

In addition, our approach also has the following limitation: The establishment of corresponding shape frames is inefficient currently (such as the examples shown in Table 4) while this approach focuses on the geometric adaptation for mechanical engineering application and the face correspondence should be precise.

Although the automatic shape adaptation is essential and important for Case-Based Design, presently, there is no effective solution that achieves automatic shape adaptation. In this paper, according to the requirements of case-based geometric design, we have proposed an approach to achieve automatic shape adaptation for parametric solid models. Our approach has the following contributions and characteristics: 
                        
                           (1)
                           The proposed approach can effectively achieve the automatic and high quality shape adaptation of a candidate parametric solid model to its corresponding query model based on the corresponding faces and corresponding dimensions between the two models.

A new method for determining the corresponding faces between two shape-similar solid models is put forward. By adopting the concept of shape frame and its quantitative descriptor, the method can automatically and accurately determine the corresponding faces between the two solid models in a global way without needing to pre-register (or pre-align) the two models.

An algorithm for identifying the dimension correspondence between two parametric solid models is set forward. Based on the dimension promotion method, 3D dimension constraint graph and corresponding faces, the algorithm can effectively identify the corresponding dimensions and corresponding dimension chains between two parametric solid models, which enable the automatic and accurate dimension driven shape adaptation.

Considering that the automatic shape adaptation is a well-recognized challenging problem, we choose to solve the problem step by step. There are several works that could be conducted to make our approach more general in the future according to the limitations described in Section  7. For example, (a) to further study heuristic filtering methods to make the process of determining corresponding faces and corresponding shape frames more efficiently, (b) to remove the assumption that each dimension in the query model should have a corresponding dimension (or a corresponding dimension chain) in the candidate model since it is too strong to satisfy for some cases, and so on. Although our approach mainly focuses on the parametric solid models that are deemed as rigid, it will be a very interesting work to extend our research to large non-rigid deformable models.

@&#ACKNOWLEDGMENT@&#

The authors are very grateful to the financial support from NSF of China (61173125 and 61472111).

@&#REFERENCES@&#

