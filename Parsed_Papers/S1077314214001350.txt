@&#MAIN-TITLE@&#Unitary torus model for conical mirror based catadioptric system

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a new model for conical mirror based catadioptric systems.


                        
                        
                           
                           Definition of the unitary torus to model this non-central system.


                        
                        
                           
                           Definition of the conical fundamental matrix.


                        
                        
                           
                           Motion computation across two views from the conical fundamental matrix.


                        
                        
                           
                           The proposal is illustrated with simulations and real experiments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Imaging geometry

Omnidirectional camera

Non-central catadioptric system

Epipolar geometry

@&#ABSTRACT@&#


               
               
                  Catadioptric systems consist of the combination of lenses and mirrors. From them, central panoramic systems stand out because they provide a unique effective viewpoint, leading to the well-known unifying theory for central catadioptric systems. This paper considers catadioptric systems consisting of a conical mirror and a perspective camera. Although a system with conical mirror does not possess a single projection point, it has some advantages as the cone is a very simple shape to produce, it has higher resolution in the peripheral, and adds less optical distortion to the images. The contributions of this work are the model of this non-central system by means of projective mappings from a torus to a plane, the procedure to calibrate this system, and the definition of the conical fundamental matrix with a role similar to that of perspective cameras. Additionally, a procedure to compute the relative motion between two views from the conical fundamental matrix is presented. The proposal is illustrated with simulations and real experiments.
               
            

@&#INTRODUCTION@&#

Vision systems stand out from other types of sensors because they provide very rich information and because of their versatility and low cost. For the last years, the use of omnidirectional cameras has been growing because they provide a panoramic view from a single image. A main class of cameras are the catadioptric systems, consisting of the combination of lenses and mirrors. Single viewpoint is a desirable property of a camera system, and the complete class of central catadioptric sensors with one mirror and lens are treated in [1]. A unifying theory for all central catadioptric systems was proposed in [2] and extended in [3]. In these works, the image formation model is developed by defining the well-known unified sphere model. Usual central catadioptric cameras are built combining a hyperbolic mirror with a perspective camera placed on one of the foci, or a parabolic mirror with an orthographic camera. Although having a single viewpoint is a desirable requirement in design, other features may be considered depending on the application.

This paper considers catadioptric systems using a conical mirror and a perspective camera. Three example images taken with a conventional camera, a camera system with hyperbolic mirror, and the conical mirror can be compared in Fig. 1
                     . These images have been taken in the same environment, a square outdoors, to illustrate their different features. The best quality but narrowest field of view is given by the conventional camera. The hyper-catadioptric camera captures the camera itself and shows good quality around the camera system, while the rest of the environment is concentrated in the border of the image with low resolution. In this case, part of the border is filled with the sky. On the other hand, the conical mirror based camera system does not capture the sky or the bottom part of the camera system and shows good resolution for the rest of the scene (i.e. the part of the scene between the sky and the floor around the camera system). For the same hardware, different setups lead to quite different image results (For instance: camera zoom, camera-mirror distance…).

In general, the advantages and disadvantages of each different system have to be evaluated depending on the application considered. In particular, some of the advantages of conical mirror based cameras compared to usual catadioptric systems are that the cone is a very simple shape to produce, it has higher resolution in the peripheral and adds less optical distortion to the images [4]. Another advantage compared to paracatadioptric systems is that a perspective camera is used instead of an expensive and complex orthographic camera. The use of conical mirror results in a non-central camera system, which is easier to produce with respect to the central catadioptric model because the latter requires precise alignment of the optical center. Actually, when the viewpoint of the perspective camera coincides with the vertex of the conical mirror, a central camera system is obtained [1]. This particular case has been studied in [4,5] showing its feasibility but reducing the configuration possibilities. Thus, despite non-centrality, the versatility of the conical mirror setup is a desirable property as shown for example in the single mirror stereo arrangement proposed in [6]. The field of view of the conical mirror system is smaller in general but more flexible. In fact, the smaller vertical field of view can be seen as an advantage because it provides higher angular resolution with the same number of pixels. For example, the camera is out of its field of view and it is not projected in the image plane (so part of the image is not wasted imaging the sensor itself) [7]. Application examples using a conical mirror based system was presented in [8], providing a method for mobile robot navigation that avoids collisions with objects, and in [9], where conical mirrors are studied as radial imaging systems to recover the 3D structure of an object.

Alternatively to catadioptric systems, panoramic images may also be captured by sensor-line cameras through rotation [10]. In the case in which the optical center follows a circular path with the line sensor parallel to the rotating axis, a panoramic image can be captured on a cylindrical surface. This case resembles the image formation model of the conical mirror based camera because its viewpoint is also a circular locus. The main benefit of these sensor-line cameras is the high resolution of recorded image data, whereas some disadvantages are the mechanical complexity of the rotating system and, since the acquisition of lines may require some time, moving objects in the recorded scene will appear geometrically distorted.

As said, the conical mirror and camera system is non-central, and the contribution of this work is the projection model for this system. This is achieved by extending the concept of unitary sphere model to the unitary torus model and taking into account that the viewpoint of this system lies on a circular locus. Different methods have been proposed in the literature for the calibration of central catadioptric systems [11], for example by using line images [12] or point images from planar grids [13,14], and also for hybrid central cameras [15]. Methods to calibrate generalized cameras have been formulated capturing both central and non-central cameras in a unified framework [16,17]. Additionally, non-central systems with revolution symmetry can be studied as axial cameras since all the light rays pass through the axis of the symmetry [18]. Regarding non-central systems based on conical mirror, a method to calibrate the omnidirectional conical-based sensor named SYCLOP was presented in [19]. In that work, the different transformations between the world object, the conical mirror, and image plane were developed to calibrate the system by using a two-plane calibration pattern. Here, we propose a procedure for calibrating the conical mirror system by using the proposed unitary torus model.

The estimation problem of the epipolar geometry using omnidirectional vision has been studied for central cameras [20,21] or approximately central cameras [22]. In [23], the existence of a general 15×15 fundamental matrix for all central catadioptric cameras is shown. Multi-view geometry is investigated in [24] considering a highly general imaging model using Plücker coordinates for central or non-central camera types. The epipolar geometry has been investigated for linear pushbroom cameras [25], for crossed-slits projection [26], and for circular panoramas [27]. In this work the epipolar geometry of a non-central catadioptric system based on a conical mirror is considered, and the conical fundamental matrix is defined with a role similar to the fundamental matrix of perspective cameras. The procedure to estimate the conical fundamental matrix from point correspondences is presented. As application, camera motion across two views can be obtained from this fundamental matrix.

The contributions of this work are the model of the non-central system by means of projective mappings from a torus to a plane, the procedure to calibrate this system, and the definition of the conical fundamental matrix (
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                     ) with a role similar to that of perspective cameras. Additionally, a procedure to compute the relative motion between two views from the conical fundamental matrix is presented. The model has the advantage of computational simplicity to deal with the imaging theory of the conical mirror. The computation of model parameters and the determination of the relative camera placement of two or more cameras is also easier. This paper extends the work presented in [28] with more details on the model and the conical fundamental matrix, adding also a procedure for the catadioptric camera calibration. The previous paper was illustrated with simulations whereas the present work is also tested with the real catadioptric system.

These contributions are novel regarding the state of the art given that most of the literature on the topic of conical mirror based camera systems focuses on modeling particular cases (e.g. like the projection of radial straight lines), and only a few works study the whole general system. Contrary to the procedure used so far with cameras based on conical mirror, where the camera system is calibrated by using the laws of reflection for describing the system projection (e.g. [19]), the unitary torus allows calibrating a simple model encapsulating the projection geometry. Additionally, further analysis into the multiple view geometry of this camera system involved with general motions has not been fully considered yet. With the proposed torus model, the camera system can be modeled with projections from the torus to the image plane. An advantage is that thanks to this unitary torus model, the multiple view geometry is formulated directly with point correspondences on the torus, rather than with correspondences between associated camera rays in 3D, as proposed for example in [24] for general cameras. This proposed formulation of the physical model leads us to the definition of the epipolar curves and the conical fundamental matrix, which can be easily computed from point correspondences on the torus. In this sense, the model we propose brings similar advantages to the non-central conical mirror based camera system than the sphere model to central systems. In this context, another advantage of the torus model is that the motion parameters can be easily extracted from the conical fundamental matrix.

The paper is organized as follows. Section 2 proposes the camera model with a conical mirror and the procedure to calibrate this catadioptric system. The conical fundamental matrix is derived in Section 3. Section 4 presents the method to compute the relative motion between two views from the conical fundamental matrix. Simulations and real experiments are provided in Section 5 to demonstrate the proposal.

We describe the geometry of the imaging system and define the catadioptric camera model using the conical mirror. The different parameters and coordinate systems involved are depicted in Fig. 2
                     . The vertex of the conical mirror is 
                        
                           
                              
                                 O
                              
                              
                                 m
                              
                           
                        
                     , and 
                        
                           
                              
                                 O
                              
                              
                                 c
                              
                           
                        
                      is the center of the perspective camera. The conical mirror and the camera are vertically aligned with respect to the symmetry axis. The angle at the vertex of the cone is 2τ and the focal length of the camera is f. The distance from the mirror vertex to the camera center is 
                        
                           
                              
                                 f
                              
                              
                                 m
                              
                           
                        
                     . The origin of the coordinate system is the vertex of the cone with the z-axis aligned with the camera optical axis. It is known that the viewpoint of this camera system lies on a circular locus of radius 
                        
                           
                              
                                 f
                              
                              
                                 x
                              
                           
                        
                      vertically translated 
                        
                           
                              
                                 f
                              
                              
                                 z
                              
                           
                        
                      with respect to the vertex of the cone [1], where
                        
                           (1)
                           
                              
                                 
                                    f
                                 
                                 
                                    x
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                              
                              sin
                              (
                              2
                              τ
                              )
                              ,
                              
                              and
                              
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                              
                              cos
                              (
                              2
                              τ
                              )
                              .
                           
                        
                     The parameter α is also defined as
                        
                           (2)
                           
                              (
                              α
                              +
                              τ
                              )
                              =
                              π
                              /
                              2
                              .
                           
                        
                     
                  

Let us consider a world point 
                           
                              p
                           
                         with coordinates 
                           
                              
                                 
                                    (
                                    X
                                    ,
                                    Y
                                    ,
                                    Z
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         in a general reference system with origin 
                           
                              
                                 
                                    O
                                 
                                 
                                    m
                                 
                              
                           
                         and z-axis aligned with the camera optical axis. For the subsequent development, it is interesting to align the x-axis of the reference with the vertical projection of the world point. This can be done by rotating the reference 
                           
                              φ
                              =
                              arctan
                              2
                              (
                              Y
                              ,
                              X
                              )
                           
                         around the z-axis in such a way the new coordinates 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    y
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    z
                                 
                              
                              )
                           
                         of 
                           
                              p
                           
                         are obtained as
                           
                              (3)
                              
                                 
                                    
                                       p
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             Y
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       p
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       p
                                    
                                    
                                       z
                                    
                                 
                                 =
                                 Z
                                 .
                              
                           
                        This step can be performed with each world point in order to obtain its particular coordinate system with origin 
                           
                              
                                 
                                    O
                                 
                                 
                                    m
                                 
                              
                           
                         as depicted in Fig. 2. Notice that, in this reference system, 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                           
                         is the radial coordinate of the world point. Now, the center of projection of a particular world point is named 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                        . Thus, the point 
                           
                              p
                           
                         is projected through 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                         intersecting the mirror surface in 
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                           
                        . The equation of the ray from 
                           
                              p
                           
                         to 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                         is given by
                           
                              (4)
                              
                                 
                                    
                                       z
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             z
                                          
                                       
                                    
                                    
                                       x
                                       -
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             z
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             z
                                          
                                       
                                    
                                    
                                       
                                          
                                             f
                                          
                                          
                                             x
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             x
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        On the other hand, the equation of the mirror surface is
                           
                              (5)
                              
                                 z
                                 
                                 ±
                                 
                                 x
                                 
                                 /
                                 
                                 tan
                                 τ
                                 =
                                 0
                                 .
                              
                           
                        The coordinates 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    m
                                 
                              
                              )
                           
                         of the point 
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                           
                         are the solution of (4) and (5). Next, the mirror point 
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                           
                         is projected through the optical center of the camera 
                           
                              
                                 
                                    O
                                 
                                 
                                    c
                                 
                              
                           
                        . The equation of the ray is
                           
                              (6)
                              
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 z
                                 )
                                 /
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 x
                                 )
                                 -
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 /
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        Finally, the intersection of this ray with the image plane yields
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       m
                                    
                                 
                                 (
                                 f
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 /
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       m
                                    
                                 
                                 )
                                 ,
                              
                           
                        which is a radial coordinate that determines, together with φ, the image projection 
                           
                              
                                 
                                    p
                                 
                                 
                                    c
                                 
                              
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                              ,
                              φ
                              )
                           
                        .

The unitary torus model is inspired on the idea of the unified sphere model for central cameras presented in [2,3]. In central cameras, a section of the unitary sphere along the symmetry axis gives a unitary circle. In our case, the revolution of the unitary circle in each viewpoint across the circular locus yields a torus. Firstly, we define the coordinate system 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         with origin 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                         and z-axis aligned with the segment 
                           
                              
                                 
                                    
                                       
                                          O
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          O
                                       
                                       
                                          c
                                       
                                    
                                 
                                 
                                    ‾
                                 
                              
                           
                         as shown in Fig. 2. In the following, the superindex t denotes that the value is referred to the 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                         coordinate system. The distance d can also be computed using
                           
                              (8)
                              
                                 d
                                 =
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             t
                                          
                                       
                                       
                                          
                                             O
                                          
                                          
                                             c
                                          
                                       
                                    
                                    
                                       ‾
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   m
                                                
                                             
                                             -
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 
                                 sin
                                 τ
                                 .
                              
                           
                        The general equation of the torus particularized to the unitary torus is defined as
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       z
                                       -
                                       
                                          
                                             f
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 1
                                 ,
                              
                           
                        where the center of the tube is the circle of radius 
                           
                              
                                 
                                    f
                                 
                                 
                                    x
                                 
                              
                           
                         (i.e. the circular locus on which the viewpoint of the camera system lies) and the radius of the tube is the unit. The section of the torus is represented in Fig. 2 with two symmetric circles. The point on the mirror 
                           
                              
                                 
                                    p
                                 
                                 
                                    m
                                 
                              
                           
                         in the coordinate system with origin in 
                           
                              
                                 
                                    O
                                 
                                 
                                    t
                                 
                              
                           
                         is given by 
                           
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    m
                                 
                              
                              
                              /
                              cos
                              τ
                           
                         and 
                           
                              
                                 
                                    z
                                 
                                 
                                    m
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                           
                        , where
                           
                              (10)
                              
                                 
                                    
                                       f
                                    
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       x
                                    
                                 
                                 
                                 cos
                                 α
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       z
                                    
                                 
                                 sin
                                 α
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 cos
                                 τ
                                 ,
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       f
                                    
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       x
                                    
                                 
                                 
                                 sin
                                 α
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       z
                                    
                                 
                                 cos
                                 α
                                 =
                                 -
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 sin
                                 τ
                                 .
                              
                           
                        The point on the unitary torus can be obtained normalizing the point coordinates and projecting to the image plane 
                           
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                                 
                                    t
                                 
                              
                              =
                              f
                              
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                                 
                                    t
                                 
                              
                              /
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                           
                        , which is the projection of the world point up to a rotation of the reference system. Finally, the image point can be obtained as
                           
                              (12)
                              
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       f
                                       tan
                                       α
                                    
                                    
                                       1
                                       -
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       /
                                       f
                                       )
                                       
                                       tan
                                       α
                                    
                                 
                                 ,
                              
                           
                        which gives an equivalent result as in (7). This procedure can be carried out inversely to reproject any image point to the unitary torus. Then, given the coordinates 
                           
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                           
                         and φ of a point in the image, it can be reprojected onto the torus following these steps:
                           
                              1.
                              Coordinate transformation:
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                c
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                -
                                                f
                                                tan
                                                α
                                             
                                             
                                                1
                                                +
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      c
                                                   
                                                
                                                /
                                                f
                                                )
                                                
                                                tan
                                                α
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Reprojection to the unitary torus obtaining the 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             t
                                          
                                          
                                             t
                                          
                                       
                                    
                                  with coordinates 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      t
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                  in the reference system at 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             t
                                          
                                       
                                       :
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       λ
                                       
                                          
                                             x
                                          
                                          
                                             c
                                          
                                          
                                             t
                                          
                                       
                                       /
                                       f
                                    
                                 , and 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       λ
                                    
                                  with
                                    
                                       
                                          λ
                                          =
                                          1
                                          /
                                          
                                             
                                                1
                                                +
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  c
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            /
                                                            f
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Coordinate transformation:
                                    
                                       
                                          
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                      cos
                                                      α
                                                      -
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      sin
                                                      α
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                      sin
                                                      α
                                                      +
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      cos
                                                      α
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

These previous steps can be written in compact form with the following expression:
                           
                              (13)
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             c
                                          
                                       
                                       cos
                                       (
                                       2
                                       α
                                       )
                                       -
                                       f
                                       sin
                                       (
                                       2
                                       α
                                       )
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   x
                                                
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       z
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       -
                                       f
                                    
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   x
                                                
                                                
                                                   c
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        The result is a point 
                           
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                           
                         projected onto the torus 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    t
                                 
                              
                              ,
                              φ
                              )
                           
                        , playing a similar role as the point in the unitary sphere for central cameras. The practical implications of this unified representation of the presented model based on the unitary torus are very useful for the application and use of computer vision techniques using conical mirrors.

The analogies of the sphere and torus models are illustrated in Fig. 3
                         with an example of a hypercatadioptric camera system modeled with the unitary sphere and a conical mirror based system with the torus model. The geometry of the imaging systems is shown with the projection of world points from a squared pattern in the image plane. The projection of the points on the sphere and the torus is shown as well as the resultant projection in the image plane for each case. A summary of the equations to transform the image coordinates to the sphere and torus, 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    s
                                 
                              
                              ,
                              φ
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              φ
                              )
                           
                         respectively, is also provided. The coordinate transformation for the torus model requires the use of (13) and (14). Regarding the unitary sphere model, (
                           
                              x
                              ,
                              y
                           
                        ) are the generalized coordinates calibrated from the image points with 
                           
                              K
                           
                        , where 
                           
                              K
                           
                         is a matrix containing the conventional intrinsic parameters of the camera coupled with mirror parameters and ξ is a mirror parameter [2,3]. In order to be compared to the imaging geometry of the illustrated catadioptric system, we also provide in Fig. 3 an example of a sensor-line camera with the sensor parallel to the rotating axis. In this case, the panoramic image can be modeled with a cylinder and each image point, with vertical coordinate 
                           
                              
                                 
                                    x
                                 
                                 
                                    c
                                 
                              
                           
                        , can be represented in the cylinder with coordinates (
                           
                              
                                 
                                    x
                                 
                                 
                                    cl
                                 
                              
                           
                        , 
                           
                              
                                 
                                    z
                                 
                                 
                                    cl
                                 
                              
                           
                        ). The radius of the cylinder is denoted with 
                           
                              
                                 
                                    R
                                 
                                 
                                    cl
                                 
                              
                           
                         and the distance of the line sensor to the cylinder axis is 
                           
                              
                                 
                                    R
                                 
                                 
                                    c
                                 
                              
                           
                        . Although the resulting image can be of great quality, the complexity of this kind of system is highly increased when used in dynamic scenes or moving platforms.

One of the advantages of the sphere model is that it allows working directly on the unitary sphere coordinates. This is also the case of the torus model. Then, working directly on the unitary torus brings advantages like the definition of the two-view geometry, from which motion parameters can be extracted, and the robustness in the automatic estimation of the epipolar geometry, as well as the automatic detection of point correspondences and the removal of outliers and false matches using the epipolar relationship. Note also that the use of the torus model does not bring additional complexity when working with conical mirrors than when working with the associated camera rays in 3D used so far. In fact, we believe that the main advantage of using the torus model with conical mirrors is that this model allows working with this non-central system similarly to using the sphere model with central systems.

In the following, we give an easy procedure to calibrate the camera system which may turn out more difficult without the model. The unifying model we have presented allows us to study the invariances and geometry of the projection through the conical fundamental matrix. Additionally, we show the similar behavior of the epipolar curves in the torus and the epipolar lines in conventional cameras.

One important problem for any vision system is related with its calibration. We present here a simple procedure to calibrate the conical mirror based catadioptric system by using the unitary torus model. We show that the calibration can then be carried out with low computational cost.

The first step consists in estimating the focal length of the camera f. This parameter has been depicted in Fig. 2. Notice that in the following procedure we assume square pixels of the sensor. Let us consider three equidistant points in a straight line parallel to the vertical axis of the catadioptric system (i.e. projected as a radial line in the image). The coordinates of these points in the space are denoted with 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         with 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                        . The projections of these points in the unitary torus are given by the coordinates 
                           
                              
                                 
                                    p
                                 
                                 
                                    ti
                                 
                              
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    ti
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    ti
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . Similarly, the coordinates of the projection of these three points in the image are denoted by 
                           
                              
                                 
                                    p
                                 
                                 
                                    ci
                                 
                              
                              =
                              (
                              
                                 
                                    x
                                 
                                 
                                    ci
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . Given that the three points are equidistant, we can write the following equation:
                           
                              (15)
                              
                                 2
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       Z
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       Z
                                    
                                    
                                       3
                                    
                                 
                                 .
                              
                           
                        This relation can be translated to the unitary torus yielding
                           
                              (16)
                              
                                 2
                                 
                                 
                                    
                                       z
                                    
                                    
                                       t
                                       2
                                    
                                 
                                 /
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       z
                                    
                                    
                                       t
                                       1
                                    
                                 
                                 /
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       t
                                       3
                                    
                                 
                                 /
                                 
                                    
                                       x
                                    
                                    
                                       t
                                       3
                                    
                                 
                                 .
                              
                           
                        Then, by using (13) and (14) in the previous expression and solving for f, we obtain the following equation
                           
                              (17)
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 )
                                 cos
                                 (
                                 2
                                 α
                                 )
                                 
                                 f
                                 -
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       1
                                    
                                 
                                 -
                                 2
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       c
                                       3
                                    
                                 
                                 )
                                 sin
                                 (
                                 2
                                 α
                                 )
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        Discarding the null solution 
                           
                              (
                              f
                              =
                              0
                              )
                           
                         we obtain the following solution:
                           
                              (18)
                              
                                 f
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             2
                                          
                                       
                                       -
                                       2
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             3
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             3
                                          
                                       
                                       )
                                       cos
                                       (
                                       2
                                       α
                                       )
                                    
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             1
                                          
                                       
                                       -
                                       2
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             c
                                             3
                                          
                                       
                                       )
                                       sin
                                       (
                                       2
                                       α
                                       )
                                    
                                 
                                 .
                              
                           
                        Thus, the focal length f can be computed from the coordinates of three equidistant radial points and the parameter α, which can be obtained from (2) by using the value of τ, the representative parameter of the mirror. Notice that the three equidistant points do not need to be vertically aligned to the system axis. Actually, it is enough if they belong to any vertical plane produced by the system axis (i.e. the line in which the three points lie and the system axis form a plane). This constraint can be guaranteed by checking if the three equidistant points lie on a radial line.

Next, the procedure to estimate parameter 
                           
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                           
                         is described. Regarding the dimensions of the conical mirror, let us denote D the diameter of the base of the cone and h the height. Let us also denote the diameter of the conical mirror projected in the image plane as 
                           
                              
                                 
                                    D
                                 
                                 
                                    c
                                 
                              
                           
                        . Taking into account similarity of triangles, from Fig. 2 the following expression can be deduced
                           
                              (19)
                              
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 f
                                 
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 -
                                 h
                                 .
                              
                           
                        In this expression that gives the value of 
                           
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                           
                        , the dimensions D and h are known from the conical mirror geometry, 
                           
                              
                                 
                                    D
                                 
                                 
                                    c
                                 
                              
                           
                         is measured directly on the image in pixels and f has been computed using (18). When performing the calibration, it is convenient to ensure that different triplets of used points are distributed around the camera system covering the whole image plane, checking also that they hold the radial condition.

The results provided by this procedure can be used directly or, if more accurate calibration is required, can be used for the initialization of the intrinsic parameters in an additional refining process. Then, we could also take into account factors such as misalignment or camera lens distortion leading to a minimization problem by using, for instance, planar calibration grids. However, we show in the experimental section that enough accuracy can be obtained using the calibration procedure presented without additional computations.

The epipolar geometry represents the relative geometry between two views of a scene. The fundamental matrix is the algebraic representation of this epipolar geometry and it is used to formulate the epipolar constraint for image correspondences. It is independent of the scene structure and only depends on the relative configuration of the cameras and their intrinsic parameters [29]. In this section, a novel conical fundamental matrix (
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                     ) is introduced using the torus model, with a role similar to the fundamental matrix for perspective cameras.

Let us suppose that the camera matrices of two views are 
                           
                              P
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                           
                         with the origin of the global reference at the second camera. Representing the points of the world and the points on the unitary torus by homogeneous coordinates, the projection can be represented as
                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 P
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         t
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    (
                                    X
                                    ,
                                    Y
                                    ,
                                    Z
                                    ,
                                    1
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         is a world point and 
                           
                              {
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              1
                              )
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       1
                                    
                                 
                              
                              }
                           
                         are two corresponding points on the unitary torus. Notice that the points have been normalized by the third coordinate 
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             z
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        . The camera matrices are represented by 3×4 matrices defined as
                           
                              (21)
                              
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         c
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         c
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 .
                              
                           
                        The rotation and translation of the first camera with respect to the origin are given by
                           
                              (23)
                              
                                 R
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 T
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Without loss of generality we have assumed that the second camera is in the origin, and thus 
                           
                              
                                 
                                    R
                                 
                                 
                                    ′
                                 
                              
                              =
                              I
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    ′
                                 
                              
                              =
                              0
                           
                        . Finally, the part related with the projection on the unitary torus is defined for both cameras as
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               cos
                                                               φ
                                                            
                                                            
                                                               sin
                                                               φ
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               -
                                                               sin
                                                               φ
                                                            
                                                            
                                                               cos
                                                               φ
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   c
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               cos
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               sin
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               -
                                                               sin
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               cos
                                                               
                                                                  
                                                                     φ
                                                                  
                                                                  
                                                                     ′
                                                                  
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       T
                                    
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where φ has been previously defined and 
                           
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                           
                         is analogous, but including the motion of the first camera. The projection Eq. (20) can be written in a different form as
                           
                              (25)
                              
                                 
                                    
                                       
                                    
                                 
                              
                           
                        We name 
                           
                              A
                           
                         the 6×6 previous matrix, and Eq. (25) must hold for any point of the scene and therefore, 
                           
                              det
                              (
                              A
                              )
                              =
                              0
                           
                        . Developing the determinant of 
                           
                              A
                           
                         and rearranging terms, it can be proved that there exists a 5×5 matrix 
                           
                              
                                 
                                    F
                                 
                                 
                                    c
                                 
                              
                           
                         that we call the conical fundamental matrix satisfying
                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      cos
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      sin
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      cos
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      sin
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                 
                                    
                                       F
                                    
                                    
                                       c
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   cos
                                                   φ
                                                
                                             
                                             
                                                
                                                   sin
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   sin
                                                   φ
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        The entries of 
                           
                              
                                 
                                    F
                                 
                                 
                                    c
                                 
                              
                           
                         only depend on the two camera matrices 
                           
                              (
                              P
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . Notice also that the lifted coordinates of the image point correspondences on the unitary torus do not depend on the coordinates 
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                        . This is because of the axial symmetry of the catadioptric camera system and the selected coordinate reference system defined for the imaging model.

Then, the expression of the conical fundamental matrix is
                           
                              (27)
                              
                                 
                                    
                                       F
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         14
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         15
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         24
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         25
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         31
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         32
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         33
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         34
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         35
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         41
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         42
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         43
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         44
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         45
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         51
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         52
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         53
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         54
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         55
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where its entries are given by
                           
                              (28)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   13
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   14
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   15
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   23
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   24
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   25
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   31
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   32
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   33
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   34
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   31
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   35
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   41
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   42
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   43
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   44
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   32
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   45
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   51
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   52
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   53
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   54
                                                
                                             
                                             =
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   z
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   z
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   33
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   55
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   13
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   23
                                                
                                             
                                             
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The conical fundamental matrix can be computed from a set of point correspondences, without knowledge of the relative camera positions by solving a linear system of equations and using the constraint (26). The lifted coordinates are obtained from the normalized points of the unitary torus: 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              ,
                              1
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       1
                                    
                                 
                              
                           
                        . Each point correspondence gives an equation. Given that 
                           
                              
                                 
                                    F
                                 
                                 
                                    c
                                 
                              
                           
                         is defined by 21 unknown entries, a set of 20 point correspondences allows to determine 
                           
                              
                                 
                                    F
                                 
                                 
                                    c
                                 
                              
                           
                         up to a scale factor by solving a linear system of equations. In general, more than the minimum set of correspondences are available, and the system may be solved using singular value decomposition. In the presence of image noise or mismatches, a robust method like RANSAC [30] can be used for the estimation of 
                           
                              
                                 
                                    F
                                 
                                 
                                    c
                                 
                              
                           
                        .

Notice that, since the conical mirror catadioptric system can be seen as a general camera [24], the motion between two views can be computed using the minimum number of 6 image correspondences [31] by back-projecting corresponding pixels to 3D and using the coplanarity constraints of the corresponding light rays without using the conical fundamental matrix. Although our proposed method is over-parameterized, it additionally provides the conical fundamental matrix that improves the geometric coherence of the result. Besides the outlier removal, the advantage on minimal samples in RANSAC is due to efficiency considerations [32]. Moreover, the use of minimal samples implies noisy model hypotheses in practice. Therefore, although robustness to outliers may be reduced with an over-parameterized approach, and they need to be handled properly, robustness to noise is improved. In addition, our proposal is an efficient linear solution with low computational cost.

The epipolar geometry for perspective cameras involves the epipoles, defined as the intersection point of the baseline with the image plane, and the epipolar lines, which are straight lines defined as the intersection of the plane containing the baseline with the image plane [29]. However, these geometric entities do not represent the corresponding conical mirror and camera system constraints. Let us consider the lifted coordinates of a point correspondence in two views satisfying the constraint (26). Fixing a point in the first view, all the possible matched points are obtained as
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       c
                                    
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   cos
                                                   φ
                                                
                                             
                                             
                                                
                                                   sin
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   cos
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   sin
                                                   φ
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    (
                                    a
                                    ,
                                    b
                                    ,
                                    c
                                    ,
                                    d
                                    ,
                                    e
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                         determines the epipolar curve. The corresponding point in the second camera system lies on the epipolar curve, therefore
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      cos
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      sin
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      cos
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            t
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      sin
                                                      
                                                         
                                                            φ
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                             
                                             
                                                
                                                   b
                                                
                                             
                                             
                                                
                                                   c
                                                
                                             
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   e
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        This previous equation plays a similar role for the epipolar curve than the epipolar line of perspective cameras. The form of the epipolar curves defined by (30) is illustrated with an example in Fig. 4
                        , and they are depicted on the unitary torus using Diedric projections. Note that the projection from the first view into the second view gives two solutions for the epipolar curves given that each ray intersects the torus in two different points.

The relative motion between two perspective cameras can be computed from the decomposition of the fundamental matrix as summarized in [29]. With the same goal, a procedure for the motion extraction given the conical fundamental matrix 
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                      
                     (27) is presented. Firstly, the rotation matrix (
                        
                           R
                           =
                           
                              
                                 r
                              
                              
                                 ij
                              
                           
                        
                      with 
                        
                           i
                           ,
                           j
                           =
                           1
                           ,
                           2
                           ,
                           3
                        
                     ) between the two cameras is computed by retrieving the three rows of 
                        
                           R
                        
                      separately. On the one hand, the first row of 
                        
                           R
                        
                      can be obtained from the second column of 
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                     :
                        
                           (31)
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                11
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                r
                                             
                                             
                                                12
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                r
                                             
                                             
                                                13
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      32
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      42
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      52
                                                   
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   32
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   42
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   52
                                                
                                             
                                          
                                       
                                    
                                    ‖
                                 
                              
                              .
                           
                        
                     On the other hand, the second row of 
                        
                           R
                        
                      can be obtained from the first column of 
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                     :
                        
                           (32)
                           
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                21
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                r
                                             
                                             
                                                22
                                             
                                          
                                          ,
                                          
                                          
                                             
                                                r
                                             
                                             
                                                23
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    -
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      31
                                                   
                                                
                                                ,
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      41
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      51
                                                   
                                                
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                
                                                
                                                   31
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   41
                                                
                                             
                                             ,
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   51
                                                
                                             
                                          
                                       
                                    
                                    ‖
                                 
                              
                              .
                           
                        
                     Finally, the third row of 
                        
                           R
                        
                      can be computed solving a linear system derived from the first and second rows of 
                        
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                        
                     :
                        
                           (33)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      22
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      14
                                                   
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      12
                                                   
                                                
                                             
                                             
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      24
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      31
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      32
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      33
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              0
                              .
                           
                        
                     After solving the system, the norm 
                        
                           ‖
                           (
                           
                              
                                 r
                              
                              
                                 31
                              
                           
                           ,
                           
                           
                              
                                 r
                              
                              
                                 32
                              
                           
                           ,
                           
                           
                              
                                 r
                              
                              
                                 33
                              
                           
                           )
                           ‖
                        
                      is used to normalize the resultant vector 
                        
                           
                              
                                 (
                                 
                                    
                                       r
                                    
                                    
                                       31
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       r
                                    
                                    
                                       32
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       r
                                    
                                    
                                       33
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                     . The singular values of any rotation matrix are 
                        
                           {
                           1
                           ,
                           1
                           ,
                           1
                           }
                        
                     , but in general, the matrix 
                        
                           R
                        
                      computed from real data will not have exactly unitary values. This constraint can be easily enforced by using the solution obtained using the Singular Value Decomposition (SVD). Let 
                        
                           R
                        
                      be the matrix computed and 
                        
                           R
                           =
                           
                              
                                 USV
                              
                              
                                 T
                              
                           
                        
                      its singular value decomposition, where 
                        
                           S
                        
                      is a diagonal matrix 
                        
                           S
                           =
                           diag
                           (
                           
                              
                                 s
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 s
                              
                              
                                 3
                              
                           
                           )
                        
                     . Then, we compute the rotation matrix by replacing 
                        
                           S
                        
                      with the identity matrix 
                        
                           I
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                                 ×
                                 3
                              
                           
                        
                      as follows
                        
                           (34)
                           
                              R
                              =
                              U
                              
                              I
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              =
                              U
                              
                              
                                 
                                    V
                                 
                                 
                                    T
                                 
                              
                              ,
                           
                        
                     which is the closest matrix with unitary singular values to the initially estimated 
                        
                           R
                        
                      under Frobenius norm. Notice that there are two solutions for the rotation depending on the sign factor of the fundamental matrix 
                        
                           (
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                           ,
                           -
                           
                              
                                 F
                              
                              
                                 c
                              
                           
                           )
                        
                      leading to 
                        
                           (
                           R
                           ,
                           -
                           R
                           )
                        
                     . The correct solution may be selected by testing point correspondences with both solutions.

Secondly, the translation vector 
                        
                           T
                           =
                           
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       y
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       z
                                    
                                 
                                 )
                              
                              
                                 T
                              
                           
                        
                      between the two cameras is computed solving a linear system which is defined by using the entries of the conical fundamental matrix 
                        
                           
                              
                                 f
                              
                              
                                 ij
                              
                           
                        
                      with 
                        
                           i
                           ,
                           j
                           =
                           3
                           ,
                           4
                           ,
                           5
                        
                     . Then, we can write
                        
                           (35)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                             
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      z
                                                   
                                                
                                                +
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              b
                           
                        
                     with
                        
                           (36)
                           
                              b
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      33
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      31
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      21
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      33
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      43
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      32
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      22
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      33
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      53
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      34
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      11
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      33
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      31
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      44
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      12
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      33
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      32
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      54
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      35
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      21
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      11
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      45
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      22
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      13
                                                   
                                                
                                                -
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      12
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      23
                                                   
                                                
                                                )
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      55
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Solving the previous system, the translation 
                        
                           T
                        
                      can be finally obtained.

@&#EXPERIMENTS@&#

In this section, simulations and real experiments illustrating our proposal are presented.

The simulated camera system is defined with the configuration depicted in Fig. 2 using the following parameters: 
                              
                                 τ
                                 =
                                 π
                                 /
                                 6
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 40
                                 
                                 mm
                              
                            and 
                              
                                 f
                                 =
                                 10
                                 
                                 mm
                              
                           . We consider that the sensor has square pixels. The size of the acquired images is 800×600 pixels with optical center (400, 300) pixels. The scene consists of a set of 3D points projected by using our camera system.

We first test the performance of the camera calibration procedure presented when the assumption of vertical alignment of the camera with respect the mirror does not hold. We use the projection of a set of points in the space following the procedure described in Section 2.3 to obtain the camera system parameters f and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                              
                           . The calibration procedure is repeated varying the misalignment of the camera, and the results are shown in Fig. 5
                           . In particular, the values of f and 
                              
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                              
                            are depicted when the camera is translated perpendicular to the axis of the mirror from 0 to 5mm (top row), and when there is rotation between the camera axis and the mirror axis of 0 to 5deg (bottom row). For null misalignment, the actual parameters are correctly obtained and increasing misalignment originates increasing calibration errors. The resultant trend in the calibration errors, because of the camera-mirror misalignment, is reasonable and shows that the method is robust assuming usual uncertainties in the camera-mirror system configuration in real scenarios.

The misalignment of the camera with respect to the mirror can be directly detected in the image plane. In particular, we can check on the one hand if the projection of the mirror rim is a circle in the image plane, and not an ellipse, and on the other hand we can check if the projection of the mirror tip lies in the center of that circle. In the third column of Fig. 5 we show the error distance in pixels between the mirror tip projection and the center of the extracted mirror rim when there is a translational or rotational misalignment. Notice that the effect of the translational and rotational misalignments is coupled. A practical procedure to align the camera optical axis and the mirror axis could consist in reducing these errors detected in the image plane to zero pixels. Although we could also use as measurement of the error alignment the eccentricity of the mirror rim projection, we found that this measurement has less resolution in practice.

In the second simulation, the camera system is translated and rotated providing a set of correspondences between the two images. The conical fundamental matrix is computed from the set of correspondences and the camera motion is obtained following the procedure presented in Section 4. The effect of an error in the value of f in the accuracy of the result has been tested. Fig. 6
                            shows the position and rotation error in percentage obtained when the value of f used in the method is modified, being its nominal real value 
                              
                                 f
                                 =
                                 10
                                 
                                 mm
                              
                           . The results show that the errors increase as the error in the value of f increases. Additionally, we have tested the effect on the computed motion from the conical fundamental matrix when there is a misalignment between the camera axis and the vertical axis of the conical mirror, which was assumed to be vertically aligned. The results of position and rotation error in percentage obtained in this case are shown in Fig. 7
                           . As expected, the errors increase as the misalignment increases.

The next experiment evaluates the estimation performance of the conical fundamental matrix in the presence of image noise. Gaussian image noise is added to the image points with standard deviation σ from 0 to 3 pixels. From the set of points available (200 points), half have been used for the estimation of the conical fundamental matrix and the rest are used to compute the reprojection error. Fig. 8
                            shows that the obtained reprojection error increases in an approximately linear trend with the image error. It would be desirable to obtain a homogeneous radial distribution of the reprojection error. In Fig. 9
                           , the radial distribution of the reprojection error for the case of image noise σ
                           =1 pixel is depicted. Only radial distribution is shown as we assume the rotational symmetry of the sensor. It can be seen that the error is correctly distributed over the image. Notice that the proposed linear formulation is useful for an initial solution, which could be refined using a non-linear optimization method such as bundle adjustment.

The catadioptric system used in the following experiments is shown in Fig. 10
                           . This system mounts a camera Chamaleon CMLN-13S2M with Tamron lens (focal length between 4 and 12mm) and conical mirror from Neovision. The dimensions of the mirror consists of a slope of τ
                           =55deg (see Fig. 2) and diameter of the base of the cone D
                           =60mm (and then, by using 
                              
                                 h
                                 =
                                 D
                                 tan
                                 (
                                 τ
                                 )
                                 /
                                 2
                              
                           , height of the cone h
                           =21mm). The pixel size of the CCD is 3.75μm/pixel and the size of the images is 1280×960 pixel.

The desired camera-mirror configuration requires alignment of the camera optical axis and mirror axis, and this is not an easy task in general catadioptric cameras. This is especially relevant in central systems, where the single viewpoint feature cannot be maintained if there is misalignment. However, in the case of conical mirrors the aligned assembly of the system is easier than in other catadioptric systems such as hyperbolic. On the one hand, from the 6 degrees of freedom, only 4 need to be considered: the rotation around the vertical axis is not considered and, since by definition this is a non-central system, the vertical translation is not relevant. On the other hand, due to the particular shape of the conical mirror, we can use for the system alignment not only the rim of the mirror projected in the image plane but also the tip of the mirror, which can be easily detected in the image. In particular, the tip of the mirror is detected through the intersection of radial lines. By using this image information feedback, the construction of the system is highly simplified by ensuring that the rim of the mirror is a circle in the image, and that the tip of the mirror lies in the center of this circle. Additionally, the camera and the mirror are attached to a metal holder that provides good precision in the assembly. In particular, translational and rotational DOF are enforced by construction to lie in a vertical plane. Thus, only the left translational and rotational DOF are required to be adjusted by hand while checking that the image constraints on the mirror rim and tip hold. The metal holder is shown in Fig. 10, and it can be seen in the base of the camera a thin bolt attaching the camera to the holder. This bolt is used to adjust these two DOF (one translation along the direction of the bolt and one rotation about the bolt axis).

The procedure we used for the assembly of the system consists in detecting and extracting the rim and tip of the mirror in the image with the goal of ensuring that the rim is a circle in the image, and that the tip of the mirror lies in the center of this circle. We first translate the camera by turning the nut of the holder bolt and secondly, the camera is slightly rotated. This adjustment is carried out in such a way that eventually the mirror rim is a circle in the image and the mirror tip lies in the center of that circle. Notice that both degrees of freedom, translation and rotation are decoupled, since the rotation is performed in the axis of translation, which supposes an advantage from a practical point of view.


                           Fig. 11
                            shows an image taken with the described catadioptric camera system. The rim of the mirror projects onto the circle depicted in red, and the tip of the mirror projects onto the center of the circle, marked with a red point. The circle has been automatically detected by using Hough transform. The estimated mirror radius on the image is 521.14 pixels, and the coordinates of center of the circle (projection of the mirror tip) in the image are (644.69, 498.50) pixels. The image depicted in Fig. 11 captures a square calibration pattern used to select three equidistant points in a radial line of the image. These points are depicted with red marks. This squared pattern was moved around the camera system to acquire data covering the whole image plane, also at different distances to the camera. The triplets extracted were first checked to guarantee that they lie in radial lines and then, the median of the data is used to compute the result. We know from (2) that α
                           =35deg, and using (18) we obtain that f
                           =6.61mm. This value of the focal length has been also compared by estimating the internal camera parameters (without mirror) using a standard calibration method, and the resultant value was f
                           =6.49mm which is close to the obtained with our procedure (camera and mirror). Finally, using (19) we obtain 
                              
                                 
                                    
                                       f
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 80.52
                                 
                                 mm
                              
                           .

In the next experiment, the camera system shown in Fig. 10 is manually translated and rotated on a planar surface in a room. In particular, the motion consists of a translation of 60cm following a straight line and different rotations from 0 to 90 degrees, in steps of 15 degrees. Examples of the images acquired are given in Fig. 12
                           . The example on the left corresponds to a translation of 60cm without rotation, whereas the example image on the right adds a rotation of 60deg. Harris corners have been used to obtain the 34 point correspondences, which are depicted with white lines in Fig. 12. Using the estimated camera parameters and the set of point correspondences, the conical fundamental matrix is computed and then, the relative motion between the cameras is obtained. The estimated orientation with respect to the real one is shown in Fig. 13
                           . The percentage of translational error is also depicted with respect to rotation in Fig. 13. It can be seen that very good results have been obtained. Additionally, the radial distribution of the reprojection errors of the estimated conical fundamental matrixes and used for the relative motion computation are shown in Fig. 14
                           . Each different color corresponds to a different conical fundamental matrix, and the figure shows that the errors are correctly distributed over the image.

For the next experiment, the camera system has been attached to the hand of a robot in order to perform a smooth and precise motion. The robot with the camera is shown in Fig. 15
                            (top-left), the camera is directly plugged into the laptop on the table below the robot. The first joint of the robot is rotated resulting in a planar circular motion where the orientation of the camera system follows the radial direction of the circle. The robot is rotated with a velocity of 0.06rad/s and 500 images are acquired during the motion at 15 frames per second. Some of the images acquired during this circular motion are shown in Fig. 16
                           . Notice that two objects keep constant in the images during the motion: The pole that holds together the mirror and the camera (The black pole that can be seen from the image center to the bottom part of the images), and the arm of the robot. (The radial gray links from the image center to the right of the images.)

A set of 100 points have been extracted and tracked along the sequence of images following the Lucas and Kanade algorithm [33,34]. The resultant evolution of the tracked points on the images during the camera motion is shown in Fig. 15 (top-right). The camera system has been calibrated with the method previously described and the conical fundamental matrix is computed with the tracked points between each of the images of the sequence and the last image. The resultant evolution of the conical fundamental matrix entries along the motion is depicted in Fig. 15 (bottom-left). As long as the images get closer to the last one the system reaches the particular configuration in which the relative motion across the views tends to zero. This is the reason for some of the entries of the fundamental matrix to be null in the end of the experiment. Note also that this final particular configuration without relative motion between the views is a degenerated case of the conical fundamental matrix. This situation is similar to the fundamental matrix with standard cameras, which also degenerates with short baseline and its computation becomes ill-conditioned, providing unstable results. The short baseline problem is not addressed here and we just compute relative fundamental matrices guaranteeing enough baseline across images (i.e. we use the first and last images as targets alternatively), and then we plot them in the same scale reference. The motion is finally computed and the result is also shown. In particular, the evolution of the camera orientation obtained from the decomposition of the fundamental matrix is depicted with short blue lines over the path provided by the robotic arm in Fig. 15 (bottom-center). Since the camera system is attached to the robot hand in such a way that the camera and mirror axis are vertical and parallel to the first robot joint, which is rotated in the experiment, the motion is a circular arc and the image reference axis is always tangent to it. Then, correctness of the estimated orientation can be seen by checking if the short blue lines are effectively perpendicular to the circular path, Fig. 15 (bottom-center). The evolution of the estimated camera positions along the image sequence is shown in Fig. 15 (bottom-right). Notice that the proposed formulation can compute the camera motion without scale ambiguity. However, the scale and 3D reconstruction from a non-central single image is in general an ill-posed problem. In practice, there exist limitations involving the ratio between the dimensions of the system and the dimensions of the scene. Actually, they are related to the existing limitations in short baseline stereo systems [35]. Here, the camera positions are estimated up to an arbitrary scale and depicted as 
                              
                                 ψ
                                 =
                                 arctan
                                 (
                                 y
                                 ,
                                 x
                                 )
                              
                           . This plot follows approximately a linear trend, which corresponds with the actual motion carried out by the robotic arm. Therefore, correctness of the estimated translation can be seen by checking if the result in this plot is a straight line. The resultant motion agrees with the circular planar motion carried out, and the estimated orientation of the system follows the radial direction of the circular motion. The results show good performance. In particular, the obtained mean error of the estimated orientation is 1.97°, the median is 1.47°, being the maximum error 6.89° and the standard deviation 1.69°. The results of this experiment, in which the camera system covers a distance of around 2m, shows the good behavior in a real environment. Regarding the efficiency of the approach presented, notice that our linear algorithm requires 20 correspondences as minimal set, while it is known that a minimal of 6 correspondences encapsulates the motion across two views with general cameras [31]. Therefore, the system performance is reduced since, in a RANSAC-based approach, the minimal set of correspondences required directly affects to the computation time. In contrast, the simplicity of the linear-based procedure outperforms in general the time cost of non-linear approaches. In particular, the execution time of our algorithm is around 10ms on a CPU at 2.6GHz.

@&#CONCLUSION@&#

A novel model for catadioptric camera systems with conical mirror has been presented. The contributions are the conical mirror imaging model based on the unitary torus model, the method to calibrate this catadioptric system, the conical fundamental matrix definition and the procedure to compute relative motion across two views. We believe that the main advantage of using the torus model with conical mirrors is that this model allows working with this non-central system similarly to using the sphere model with central systems. The interest of the proposal is that the definition of the model allows to use the non-central camera system with conical mirror in a simple and robust way. Several simulations and real experiments have been presented to validate our proposal showing good performance in simulation and real experiments.

@&#ACKNOWLEDGMENT@&#

This work was supported by Ministerio de Economía y Competitividad and European Union (projects DPI2012-32100 and DPI2012-31781).

@&#REFERENCES@&#

