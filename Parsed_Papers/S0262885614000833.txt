@&#MAIN-TITLE@&#Simultaneous active camera array focus plane estimation and occluded moving object imaging

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This is a novel work to solve camera array auto focusing and occluded object imaging simultaneously.


                        
                        
                           
                           A unified framework is proposed to achieve seamless interaction between focusing and imaging.


                        
                        
                           
                           An optimization algorithm is presented to dynamically estimate the focus plane.


                        
                        
                           
                           A visibility analysis is proposed to remove the occluder and improve the imaging quality.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Camera array

Occluded object imaging

Focus plane estimation

Synthetic aperture imaging

@&#ABSTRACT@&#


               
               
                  Automatically focusing and seeing occluded moving object in cluttered and complex scene is a significant challenging task for many computer vision applications. In this paper, we present a novel synthetic aperture imaging approach to solve this problem. The unique characteristics of this work include the following: (1) To the best of our knowledge, this work is the first to simultaneously solve camera array auto focusing and occluded moving object imaging problem. (2) A unified framework is designed to achieve seamless interaction between the focusing and imaging modules. (3) In the focusing module, a local and global constraint-based optimization algorithm is presented to dynamically estimate the focus plane of the moving object. (4) In the imaging module, a novel visibility analysis based active synthetic aperture imaging approach is proposed to remove the occluder and significantly improve the quality of occluded object imaging. An active camera array system has been set up and evaluated in challenging indoor and outdoor scenes. Extensive experimental results with qualitative and quantitative analyses demonstrate the superiority of the proposed approach compared with state-of-the-art approaches.
               
            

@&#INTRODUCTION@&#

Occluded moving object imaging is a challenging problem in the field of computer vision and pattern recognition. It plays an important role especially in surveillance, remote sensing and underwater filming. Since high level understanding of a scene relies heavily on accurate low level imaging of objects, developing a high performance occluded moving object imaging system has become a subject of great scientific and commercial interests.

Although many algorithms and systems have been developed in the literature, to the best of our knowledge few works have been done in occluded moving object imaging possibly due to several challenges: (1) Visibility varies significantly over frames, ranging from occlusion-free to complete occlusion due to complex interaction among objects and surroundings. (2) The out of focus problem caused by the movements of the camera and the object adds huge uncertainty to the automatic focus plane estimation.

To address the problems above, we present a novel active synthetic aperture imaging approach in this paper. Fig. 1
                         displays our camera array system and examples of auto-focusing and occluded object imaging results. Please note that the reason why the synthetic aperture images look dark is that image wrapping will then change the size of the image and the region where there is no mapping will be dark (Fig. 1, bottom row).

Our first contribution is a unified framework with two interactive modules (see Fig. 2
                        ), which can estimate the focus plane and see object even under occlusion and depth variations. Our second contribution is an active camera array auto focusing approach, which estimates the best focus plane through global optimization of spatial and temporal feature correspondences. Our third contribution is improvement of occluded object imaging quality based on visibility analysis.

To evaluate our method, we construct an active camera array system as the main acquisition device. Our motivation to develop an active camera array mainly comes from two parts: (1) Although the camera array has been well studied in the literatures, most of the existing systems are static and lack the pan tilt ability to monitor a large area and auto focusing on certain object. (2) Another motivation is straightforward, inspired by the traditional active pan-tilt-zoom camera, we want to design a more powerful pan-tilt-focus camera array. In our camera array system, the synchronous data acquisition, storage and processing are completely managed by a single workstation. A set of video sequences with various occlusions have been captured in challenging indoor and outdoor scenes. We test the proposed approach on these sequences and observe promising auto focusing and imaging results in comparison with several state-of-the-art approaches.

@&#RELATED WORK@&#

Multi-view approach or system is a natural solution for occluded object imaging because of its ability of decreasing the occluded regions and recovering 3D space information [1–8]. Among the existing multiple camera techniques, recently the camera array [9–17] proves to be a powerful way to see objects through occlusion. The camera array technique is firstly made famous by the 1999 movie The Matrix, in which a 1D camera array is used to create an impression of orbiting around a scene that has been frozen in time. The pioneer work of synthetic aperture imaging is proposed by Levoy et al. [9–12]. They set up a two dimensional Stanford light field camera array which consists of 128 FireWire cameras, and align multiple cameras to a focus plane to approximate a camera with a very large aperture. The constructed synthetic aperture image has very limited depth of field, so that objects off the plane of focus would disappear due to significant blur. The MIT computer graphics group [13] uses 64 USB webcams for synthesizing dynamic depth of field effects. Lei et al. [14] develop a cluster-based system for camera array application, which consists of 8 nodes and 16 cameras. Ding et al. [15] construct a 3×3 camera array to recover fluid surface. Maitre et al. [16] use a planar camera array to perform surface reconstruction. Schuchert et al. [17] estimate the 3D object structure, motion and rotation based on 4D affine optical flow using a multi-camera array. In our previous work [18], we present a novel hybrid synthetic imaging system to track multiple people in cluttered and crowded scenes with severe occlusion.

There are two major differences between our work and previous research. First, compared with previous camera array systems, we seek to continuously focus and see occluded objects even with object moving and occlusion, which is a more general and difficult problem than those solved by standard camera array system. Second, although single camera based auto focusing problem has been well studied, few works have been done on camera array. Our work is the first time to solve this camera array auto-focusing and imaging problem.

The rest of the paper is structured as follows: Section 2 introduces the algorithm framework. The dynamic optimal focus plane estimation model and active synthetic aperture imaging is discussed in Section 3 and Section 4 respectively. Qualitative and quantitative evaluation results are given in Section 5, where the proposed algorithm is applied to challenging indoor and outdoor datasets. Finally future directions are discussed, along with the conclusions in Section 6.

Our algorithm mainly includes two parts (see Fig. 2), auto-focusing module and occluded moving object imaging module. In the focusing module, temporal and spatial feature correspondences as well as visibility information are combined together to dynamically estimate optimal focus plane. Given the optimal focus plane, our imaging module can project the multi-view images to the focus plane and generate the final synthetic image based on a cascade visibility analysis.

The seamless interaction between these two modules refers to that auto focusing module provides dynamic focus plane estimation for the imaging module at the current frame, while imaging module supplies dynamic visibility information as feedback for optimal focus plane estimation of the next frame in auto-focusing module.

Auto-focusing methods have been well studied in recent years, especially in single camera area. However, few works have been done in the field of camera array. In this paper, we propose a novel camera array optimal focus plane estimation method.

Our approach introduces a unified framework which could obtain the optimal focus plane through global optimization of spatial and temporal homography wrappings inside and across different camera views. This optimization framework mainly consists of three constraints: temporal local constraint, spatial multi-view constraint and global loop constraint.

The first constraint is from temporal local feature correspondences, which enforces a constraint on temporal homography of each camera individually. Same with the single camera method, it minimizes mapping disparity between each frame. The second constraint is to satisfy spatial feature correspondences, which demonstrates merits of camera array that it can acquire multi-view mapping even when parts of views are accidentally occluded. The third constraint is based on the fact that temporal and spatial homographies would establish a loop between each camera matching pair (see Fig. 3
                     ), which can strictly control cumulative error mentioned above.

In the above framework there is no requirement that all the cameras should be in a line, thus it is straightforward to extend our camera array to N by M camera array, and we believe that using N by M camera array should give better results as more camera views from different altitudes and angles are used. We will provide auto-focusing and imaging results with linear array and planar array respectively in Experimental results section.

As shown in Fig. 3, H
                     
                        t(t
                        −1)
                     
                        i
                      is the temporal local homography from frame t to frame t
                     −1 of camera i and H
                     
                        t
                     
                     
                        ir
                      is the spatial homography from camera i to camera r at frame t. For simplicity, we choose one camera as reference and the first frame of this camera as the reference focus plane. In the initialization step, we manually label a bounding box of the object in the first frame of the reference camera. Since the camera array has been calibrated, the initial mapping H
                     
                        t
                     
                     
                        ir
                      can be used to register other camera views to the reference camera. Let H
                     
                        t
                     
                     
                        i
                      represents the homography from frame t of camera i to the reference focus plane, then we have
                        
                           (1)
                           
                              
                                 
                                    H
                                    t
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                H
                                                
                                                   t
                                                   −
                                                   1
                                                
                                                i
                                             
                                             
                                                H
                                                
                                                   t
                                                   
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                i
                                             
                                             ,
                                          
                                          
                                             t
                                             >
                                             1
                                          
                                       
                                       
                                          
                                             
                                                H
                                                1
                                                ir
                                             
                                             ,
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Object focus plane refers to the object plane which is parallel to the camera array. Actually, the specific focus plane is trivial as we can focus on any focus plane once H
                     
                        t
                     
                     
                        i
                      is given. Dynamical optimal focus plane estimation is therefore identical in some sense to temporal and spatial homography optimization. To illustrate, in this paper we mainly focus on synthetic aperture imaging on the reference focus plane.

Integrating the above three constraints, spatial and temporal homography wrappings can be optimized inside and across different camera views.

Thus, we define objective function at frame t as:
                           
                              (2)
                              
                                 
                                    
                                       E
                                       t
                                    
                                    
                                       
                                          H
                                          
                                             t
                                             
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          H
                                          t
                                          r
                                       
                                    
                                    =
                                    
                                       E
                                       l
                                    
                                    
                                       
                                          H
                                          
                                             t
                                             
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       E
                                       s
                                    
                                    
                                       
                                          H
                                          t
                                          r
                                       
                                    
                                    +
                                    
                                       E
                                       g
                                    
                                    
                                       
                                          H
                                          
                                             t
                                             
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          H
                                          t
                                          r
                                       
                                    
                                 
                              
                           
                        where the data term E
                        
                           l
                        (
                           H
                        
                        
                           t(t
                           −1)) with 
                           H
                        
                        
                           t(t
                           −1)
                        ={H
                        
                           t(t
                           −1)
                        1,H
                        
                           t(t
                           −1)
                        2,⋯,H
                        
                           t(t
                           −1)
                        
                           n
                        } measures how well 
                           H
                        
                        
                           t(t
                           −1) fits the feature mapping between successive frames inside each camera, the term E
                        
                           s
                        (
                           H
                        
                        
                           t
                        
                        
                           r
                        ) with 
                           H
                        
                        
                           t
                        
                        
                           r
                        
                        ={H
                        
                           t
                        
                        1r
                        ,H
                        
                           t
                        
                        2r
                        ,⋯,H
                        
                           t
                        
                        
                           nr
                        } encodes spatial consistence between each camera and reference camera, while the term E
                        
                           g
                        (
                           H
                        
                        
                           t(t
                           −1);
                        
                           H
                        
                        
                           t
                        
                        
                           r
                        ) reveals the inconsistence of temporal mappings 
                           H
                        
                        
                           t(t
                           −1) and spatial mappings 
                           H
                        
                        
                           t
                        
                        
                           r
                        . We elaborate these terms below followed by discussion of solving the objective function.

By calculating the optical flow of KLT [19] features x
                        
                           t
                        
                        
                           i
                         of the object at frame t to corresponding candidate features x
                        
                           t
                           −1
                        
                           i
                         at previous frame t
                        −1 inside camera i, we could estimate the mapping 
                           H
                        
                        
                           t(t
                           −1) by minimizing E
                        
                           l
                        (
                           H
                        
                        
                           t(t
                           −1)), which is defined as follows:
                           
                              (3)
                              
                                 
                                    
                                       E
                                       l
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                   i
                                                
                                                
                                                   
                                                      
                                                         x
                                                         
                                                            t
                                                            −
                                                            1
                                                         
                                                         i
                                                      
                                                      −
                                                      
                                                         H
                                                         
                                                            t
                                                            
                                                               
                                                                  t
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         i
                                                      
                                                      
                                                         x
                                                         t
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where n represents the number of cameras in our multi-view system, the superscript i indicates the index of the camera and the subscript reveals the frame number. H
                        
                           t(t
                           −1)
                        
                           i
                         is the homography from frame t to frame t
                        −1 of camera i, and w
                        
                           t
                           −1
                        
                           i
                         is the dynamic weight image of the pixels of camera i at frame t
                        −1 (see Fig. 3). The updating process of w
                        
                           t
                           −1
                        
                           i
                         will be discussed elaborately at active synthetic aperture imaging module.

Our spatial multi-view constraint is defined between each camera and dynamic reference camera. Reference camera is updated mainly according to current matching result of all cameras. Specifically, the view with most matching features is selected as the reference. Due to this updating mechanism, we can handle occlusion problems by dynamically choosing different camera pairs. In this work the spatial homography is estimated by SIFT [20] feature matching.

Similarly, x
                        
                           t
                        
                        
                           i
                         and x
                        
                           t
                        
                        
                           r
                         are the corresponding points between camera i and dynamic reference camera at frame t, the homography H
                        
                           t
                        
                        
                           ir
                         between camera i and camera r could be estimated by minimizing E
                        
                           s
                        (
                           H
                        
                        
                           t
                        
                        
                           r
                        ), which is defined as:
                           
                              (4)
                              
                                 
                                    
                                       E
                                       s
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      t
                                                      r
                                                   
                                                   −
                                                   
                                                      H
                                                      t
                                                      ir
                                                   
                                                   
                                                      x
                                                      t
                                                      i
                                                   
                                                
                                             
                                             2
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

As Fig. 3 shows, temporal homography and spatial multi-view homography between each camera pair form a loop through the reference focus plane. For instance, given a specific point of the object at the current frame of camera i, it can firstly be transformed to reference focus plane, then current reference frame and finally back to itself.

From this loop, we have the following equation:
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             H
                                             t
                                             ir
                                          
                                       
                                       
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             H
                                             
                                                t
                                                
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                             
                                             r
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             H
                                             
                                                t
                                                −
                                                1
                                             
                                             r
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       H
                                       
                                          t
                                          −
                                          1
                                       
                                       i
                                    
                                    
                                       H
                                       
                                          t
                                          
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                       
                                       i
                                    
                                    
                                       x
                                       t
                                       i
                                    
                                    =
                                    
                                       x
                                       t
                                       i
                                    
                                 
                              
                           
                        
                        
                           Algorithm 1
                           Alternative least-squares minimization


                           
                              
                                 
                                    1.
                                    Compute initial value of temporal local mapping 
                                          
                                             
                                                H
                                                
                                                   t
                                                   
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                        by minimizing E
                                       
                                          l
                                       (
                                          H
                                       
                                       
                                          t(t
                                          −1)).

Select the camera with most matching points as reference camera r and compute initial 
                                          H
                                       
                                       
                                          t
                                       
                                       
                                          r(0) by minimizing E
                                       
                                          s
                                       (
                                          H
                                       
                                       
                                          t
                                       
                                       
                                          r
                                       ).

Compute initial value H
                                       
                                          t(t
                                          −1)
                                       
                                          r(0) by minimizing 
                                          
                                             
                                                E
                                                g
                                             
                                             
                                                
                                                   
                                                      H
                                                      
                                                         t
                                                         
                                                            
                                                               t
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   H
                                                   t
                                                   
                                                      r
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                       .

for k
                                       =1,…,K do
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  arg
                                                                  
                                                                  min
                                                               
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               E
                                                               l
                                                            
                                                            
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               E
                                                               g
                                                            
                                                            
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  H
                                                                  t
                                                                  
                                                                     r
                                                                     
                                                                        
                                                                           k
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             


                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  H
                                                                  t
                                                                  r
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  arg
                                                                  
                                                                  min
                                                               
                                                               
                                                                  H
                                                                  t
                                                                  r
                                                               
                                                            
                                                            
                                                               E
                                                               s
                                                            
                                                            
                                                               
                                                                  H
                                                                  t
                                                                  r
                                                               
                                                            
                                                            +
                                                            
                                                               E
                                                               g
                                                            
                                                            
                                                               
                                                                  
                                                                     H
                                                                     
                                                                        t
                                                                        
                                                                           
                                                                              t
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               
                                                                  H
                                                                  t
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             


                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  r
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  arg
                                                                  
                                                                  min
                                                               
                                                               
                                                                  H
                                                                  
                                                                     t
                                                                     
                                                                        
                                                                           t
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  r
                                                               
                                                            
                                                            +
                                                            
                                                               E
                                                               g
                                                            
                                                            
                                                               
                                                                  
                                                                     H
                                                                     
                                                                        t
                                                                        
                                                                           
                                                                              t
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                               
                                                                  H
                                                                  t
                                                                  
                                                                     r
                                                                     
                                                                        k
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             

end for

To avoid the matrix inverse operation, we rewrite Eq. (5) as:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             H
                                             
                                                t
                                                −
                                                1
                                             
                                             r
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       H
                                       
                                          t
                                          −
                                          1
                                       
                                       i
                                    
                                    
                                       H
                                       
                                          t
                                          
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                       
                                       i
                                    
                                    
                                       x
                                       t
                                       i
                                    
                                    =
                                    
                                       H
                                       
                                          t
                                          
                                             
                                                t
                                                −
                                                1
                                             
                                          
                                       
                                       r
                                    
                                    
                                       H
                                       t
                                       ir
                                    
                                    
                                       x
                                       t
                                       i
                                    
                                    .
                                 
                              
                           
                        
                     

Thus, the global loop constraint term could be written as
                           
                              (8)
                              
                                 
                                    
                                       E
                                       g
                                    
                                    =
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      H
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                      r
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                H
                                                
                                                   t
                                                   −
                                                   1
                                                
                                                i
                                             
                                             
                                                H
                                                
                                                   t
                                                   
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                i
                                             
                                             
                                                x
                                                t
                                                i
                                             
                                             −
                                             
                                                H
                                                
                                                   t
                                                   
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                r
                                             
                                             
                                                H
                                                t
                                                ir
                                             
                                             
                                                x
                                                t
                                                i
                                             
                                          
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

The main advantage of introducing this constraint is that the solution is guaranteed to be consistent with the camera array and therefore more accurate and stable.

Since temporal local mappings and spatial multi-view mappings are related together in the global loop constraint term, the objective function cannot be solved directly. We introduce an initialization step to estimate temporal local mappings and spatial multi-view mappings separately based on E
                        
                           l
                        (
                           H
                        
                        
                           t(t
                           −1)) and E
                        
                           s
                        (
                           H
                        
                        
                           t
                        
                        
                           r
                        ). Then an alternative least-squares algorithm is applied for refinement. The total algorithm is shown in Algorithm 1. All the minimization process in Algorithm 1 is calculated by DLT (direct linear transform).


                        Fig. 4
                         shows the procedure of dynamic optimal focus plane estimation module. In Fig. 4(a), the first row shows the input image sequence from 4 views (e.g. Camera #ref, #1, #5 and #8) at frame 1 and the second row is at frame 156. Through the process of enforcing temporal constraint as the feature mapping at the first row in Fig. 4(b), we yield the initial warped images to reference plane. Combined with multi-view constraint by calculating feature correspondences between each camera pair, the wrapping images are more stable in Fig. 4(c). In Fig. 4(d-1), the synthetic aperture image will suffer from severe out of focusing problem without the auto focusing process. This problem can be solved slightly with the temporal constraint (see Fig. 4(d-2)). Compared with former two results, our global loop optimization approach yields a perfectly well focused synthetic image (see Fig. 4(d-3)).

The word active in our algorithm refers to the fact that cameras are actively selected for each pixel in the bounding box subimage, mentioned in Section 3, during synthetic aperture imaging. In order to select right cameras for each pixel, we need to analyze visibility information in all cameras. Actually, there is another reason why visibility analysis is essential. As mentioned in Section 3, the visibility information represented by w
                     
                        t
                     
                     
                        t
                     , should be utilized to make sure that temporal local correspondences are from the correct object in each camera.

Although visibility analysis has been well developed in stereo reconstruction literature, few works have been done in active camera array. Here we present a cascade clustering based visibility analysis approach for our camera array. Different from methods in stereo reconstruction literature, where the problem is formulated as global optimization of object color and shape information, our approach solves the problem by a procedure of cascaded clustering. Firstly, a spatial clustering is performed according to the parallax on dynamic focus plane, which is estimated in Section 3. Then color clustering is applied to differentiate objects from appearance. Finally the visibility map is inferred from cascaded cluster result based on previous frame.

Once refocusing the camera array on the occluded moving object, the synthetic aperture image can be calculated by averaging rays from each camera view. However, due to the front occlusion of the moving object, blurs may occur on the synthetic image. An intuitive idea to eliminate the blurs is to average rays from the fraction of cameras in which it is visible. With the visibility information, we could actively choose appropriate fraction of cameras for pixels according to different visibility situations.

The idea of cascade clustering comes from two consistencies: spatial consistency and color consistency. Supposing temporal homography mappings from the current frame to reference focus plane have been estimated accurately in the focusing module, corresponding pixels of the true object will be mapped to the same position when registered on to the reference focus plane, otherwise pixels will be mapped to different positions. As a result, there is no parallax for object pixels when registered to the reference focus plane, but for other parts the parallax is not zero. This is what we call spatial consistency. Based on this observation, whether a pixel belongs to the object can be differentiated by calculating the residual flow [19] between transformed subimage of each camera. Color consistency stems from the fact that corresponding object pixels should have similar RGB values after camera array color calibration [21].

According to the above two consistencies, our cascade clustering method mainly consists of two clustering methods, spatial clustering and color clustering. Firstly, optical flow between different registered images are calculated. For instance, if there are 8 cameras, we have 28 optical flow images in total. For each pixel, hierarchical spatial clustering is performed based on these 28 optical flow vector lengths. Secondly, for each spatial cluster G
                        
                           si
                        (i
                        =1,2,…,M), hierarchical color clustering is applied. Clustered sets after color clustering is denoted as G
                        
                           cj
                        (j
                        =1,2,…,L), which is a subdivision of Gsi
                        . Finally, given active synthetic aperture image in the last frame I
                        
                           syn
                        
                        
                           t
                           −1, the clustered class having most similar color with I
                        
                           syn
                        
                        
                           t
                           −1 is classified as true object, while others are negatives. Visibility weights w
                        
                           t
                        
                        
                           i
                         of pixels related with objects are assigned 1, otherwise 0.

Let I
                        
                           t
                        
                        
                           i
                         denotes the warped image to reference focus plane by homography H
                        
                           t
                        
                        
                           ir
                         at frame t, and O
                        
                           t
                        
                        
                           i
                         denotes the sub-image of I
                        
                           t
                        
                        
                           i
                         which contains the object in focus. Active synthetic aperture image can be calculated as follows:
                           
                              (9)
                              
                                 
                                    
                                       I
                                       t
                                       syn
                                    
                                    
                                       p
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            n
                                                         
                                                         
                                                      
                                                      
                                                      
                                                         w
                                                         t
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                
                                                
                                                
                                                   O
                                                   t
                                                   i
                                                
                                                
                                                   p
                                                
                                                ⋅
                                                
                                                   w
                                                   t
                                                   i
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                p
                                                ∈
                                                
                                                   O
                                                   t
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   n
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                
                                                
                                                
                                                   I
                                                   t
                                                   i
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     


                        Fig. 5
                         shows the results of visibility analysis and active synthetic aperture imaging. In the first row, a standing volunteer is partially (Fig. 5(a), camera #1, #3) or completely occluded (Fig. 5(a), camera #2) by another front-standing volunteer. Visibility analysis is employed on the sub-image inside the bounding box. Fig. 5(b) shows the magnitude of optical flow results for each specific camera with the other cameras. By cascade clustering of spatial and color consistency, we could actively select visible fraction of cameras and remove false rays from occluder. The active synthetic aperture imaging result is shown in Fig. 5(d). In traditional synthetic aperture imaging method, rays from all cameras in the array are averaged to achieve the synthetic image. Thus in Fig. 5(c), the left bottom of the object is dark. An outline of the occluders shoulder can be seen and this outline is from camera #3 (as shown Fig. 5(a)). As we discussed in the paper, our synthetic aperture imaging method is based on visibility analysis while traditional methods usually don't take visibility into consideration. Therefore, with traditional approach front occluder will cast shadows on the synthetic image of focusing object. In comparison, our solution can effectively remove shadows of occluder by analyzing the visibility of each pixel (as shown in Fig. 5(d)).

@&#EXPERIMENTAL RESULTS@&#

Since existing public multi-view datasets do not satisfy the active synthetic aperture imaging requirements of our approach, to evaluate the performance of our algorithm we have set up two camera arrays in our lab, one is a linear camera array with 8 cameras and the other is a 3 by 4 planar camera array. We mount the camera array on a pan tilt motor so that we can easily control the orientation of the camera array. The camera array is connected to a single workstation via 4 PCI-E FireWire adaptors (see Fig. 1). We use plane+parallax in [12] and color calibration in [21] to calibrate the camera array.

In order to evaluate the performance of our algorithm, we collect video sequences in indoor and outdoor scenes. We create a tracking ground truth for quantitative evaluation by manually annotating the data. In total there are 2000 frames used in the experiments, among which around 40% have significant occlusion. Examples of some challenging frames can be seen in Figs. 6 and 8
                     .

As our algorithm can focus on any focus plane as we like, we can track moving occluded object by focusing on current object plane. To demonstrate the imaging and tracking performance of our algorithm, we use several state-of-the-art methods for comparison, including: conventional synthetic aperture imaging (SAI) [11], FragTracker (FT) [22], IVTracker (IVT) [23], PNTracker (PNT) [24], ContextTracker (CT) [25]. All codes come from the original authors.

Focusing and imaging results of our algorithm with linear and planar camera array are shown in Figs. 6, 7 and 8
                        
                         respectively. For linear camera array, we test our method on three different sequences, including one indoor and two outdoor sequences (see Fig. 6). The object in first sequence is a moving calibration board, which is carried by a freely moving person. The second sequence is a moving person in outdoor scene. The last sequence is a person moving around a tree. Fig. 6 shows the focusing and imaging results of our algorithm and conventional SAI [11]. Please note that due to lack of the ability of auto focusing, the conventional SAI approach fails when the depth of the object changes (Fig. 6, bottom sequence of each row). In contrast, through dynamic optimal focus plane estimation, our approach can automatically focus on the object with free motion (Fig. 6, first row), depth variation (Fig. 6, second row) and occlusion (Fig. 6, third row).

Results of our planar camera array are shown in Figs. 7 and 8. Corresponded with the configuration of the 3 by 4 array, Figs. 7(a) and 8(a) gives the input multi-view images of a certain frame respectively. In the sequence of Fig. 7, a volunteer holds a teddy bear moving in front of the camera array. Traditional synthetic aperture imaging results and our auto-focusing imaging results are shown in Fig. 7(c) and (d) respectively. It can be seen that traditional method will fail once the depth of the object changes (see the red dotted box, Fig. 7(c)). In contrast, our method can continuously auto-focusing and seeing (see the yellow dotted box, Fig. 7(d)).


                        Fig. 8 gives the auto-focusing result of occluded object via planar camera array. Different from the calibration board sequence used in Fig. 6, in this sequence two people move freely in the environment and frequently occludes the calibration board, making it much more challenging. Input images of different frames in reference view are shown in Fig. 8(b), where it can be seen that there is severe occlusion from frame to frame. Standard synthetic aperture imaging results and our auto-focusing imaging results are shown in Fig. 8(c) and (d) respectively. It can be seen that although both these two methods can successfully focus and obtain sharp synthetic imaging results in the beginning, traditional method will fail as long as the depth of the object changes (see the red dotted box, Fig. 8(c)). However, due to the dynamic focusing and visibility analysis, our method can automatically update the temporal and spatial homography within and across different cameras, and therefore can continuously track and see through occlusions (see the yellow dotted box, Fig. 8(d)).

Besides, the tracking performance of our algorithm with the linear camera array is tested on two sequences, as shown in Fig. 9(a) and (b). In Fig. 9(a), one object and other two occluders simultaneously move in a small calibrated area of 4m×4m. Fig. 9(b) shows the tracking results on an outdoor occlusion sequence. We can see from frame #155 and #180 in first sequence and frame #270 and #285 in second sequence. The state-of-the-art single camera trackers fail during severe or complete occlusion, while our algorithm tracks the object successfully through global optimization of the information from the entire camera array.

Our method mainly includes four steps, as summarized in Algorithm 1 (please see Page 8). The most time consuming part is the initialization processing, including: (1) compute initial value of temporal local mapping 
                           
                              
                                 H
                                 
                                    t
                                    
                                       
                                          t
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                                 0
                              
                           
                         by minimizing E
                        
                           l
                        (
                           H
                        
                        
                           t(t
                           −1)), and (2) select the camera with most matching points as reference camera r and compute initial 
                           
                              H
                              t
                              
                                 r
                                 
                                    0
                                 
                              
                           
                         by minimizing E
                        
                           s
                        (
                           H
                        
                        
                           t
                        
                        
                           r
                        ) (as shown in Algorithm 1, step 1 and step 2). In the first step, temporal homography between current frame and previous frame within each camera is calculated using optical flow while in the second step spatial homography is estimated by SIFT feature matching. Compared with the following optimization and the iteration in step 3 and step 4, the initialization processing is much slower due to the complexity of feature detection, description, matching and RANSAC iteration. Based on the object bounding box of previous frame, we can speed up the initialization by processing the small bounding box subimage instead of the entire image in the experiment.

To quantitatively evaluate all the trackers, we manually label the ground truth bounding box of the object in each frame. The error is measured using the Euclidian distance of two center points, which has been normalized by the size of the target from the ground truth. From Fig. 9(c) and (d) we can see that our algorithm can track occluded objects more robustly than other trackers. The average tracking error of our approach is 0.097, which is lower than other trackers. The reason is that our algorithm can simultaneously estimate the object focus plane and remove the occlusion, while other single camera tracking algorithms fails due to severe occlusion.

To further evaluate the effectiveness of our optimal focus estimation module, we manually label the depth ground truth in the sequence Fig. 9(a). The focus depth error of our algorithm is illustrated in Fig. 9(e). Please note that the focus error of our algorithm is under 0.15m throughout the sequence, which is accurate enough considering the depth variation of the person's surface.

@&#CONCLUSIONS AND FUTURE WORK@&#

Although the single camera based auto-focusing problem has been well studied in the literature, few works have been done in the field of camera array. In this paper we present a novel synthetic aperture imaging algorithm for automatically focusing and seeing moving object through occlusion with an active camera array. In the focusing module, the spatial, temporal and global constraints of moving object and the camera array are integrated into a unified inference procedure, which can be robustly performed by solving an optimization problem. In the imaging module, a spatial and color constancy based visibility analysis method is presented to significantly improve the quality of occluded object imaging result. Experiments with qualitative and quantitative analysis demonstrate the unique auto-focusing ability and its great potential in visual tracking through occlusion compared with many state-of-the-art methods. In future work we plan to explore our work to challenging surveillance scenarios.

@&#ACKNOWLEDGMENTS@&#

We are very appreciative to the editor and anonymous reviewers for the valuable suggestions. This work is supported by the Project of National Natural Science Foundation of China (No. 61272288, No. 61231016, No. 61301192), Funding of China Scholarship Council (No. 201303070083), NPU Foundation for New People and New Directions (No. 13GH014604), NPU Foundation for Fundamental Research (No. JC201120), NPU and Foundation for Plan of Soaring Star (No. 12GH0311).

@&#REFERENCES@&#

