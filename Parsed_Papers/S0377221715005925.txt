@&#MAIN-TITLE@&#Tracking the market: Dynamic pricing and learning in a changing environment

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study dynamic pricing in an unknown, changing, market environment.


                        
                        
                           
                           We show how a price manager can hedge against changes in the market.


                        
                        
                           
                           We provide analytical bounds on the performance of this policy.


                        
                        
                           
                           We apply our method to the well-known Bass model, and to oligopoly pricing.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dynamic pricing

Learning

Varying parameters

@&#ABSTRACT@&#


               
               
                  Dynamic pricing of commodities without knowing the exact relation between price and demand is a much-studied problem. Most existing studies assume that the parameters describing the market are constant during the selling period. This severely reduces their practical applicability, since, in reality, market characteristics may change all the time, without the firm always being aware of it. In the present paper we study dynamic pricing and learning in a changing market environment. We introduce a methodology that enables the price manager to hedge against changes in the market, and provide explicit upper bounds on the regret - a measure of the performance of the firm’s pricing decisions. In addition, this methodology guides the selection of the optimal way to estimate the market process. We provide numerical examples from practically relevant situations to illustrate the methodology.
               
            

@&#INTRODUCTION@&#

Firms selling products or delivering services face the complex task of determining which selling price to charge to their customers. Generally, firms aim at choosing selling prices that maximize certain performance indicators, such as revenue, profit, market share, or utilization rate. An intrinsic property of this decision problem is lack of information: the seller does not know how consumers respond to different selling prices, and thus does not know the optimal price. The problem of the firm is not merely about optimization, but also about learning the relation between price and market response.

The presence of digitally available and frequently updated sales data makes this problem essentially an online learning problem: after each sales occurrence, the firm can use the newly obtained sales data to update its knowledge (for example, via statistical estimation methods). If, in addition, selling prices can quickly be modified, without much costs or effort - as often is the case in web-based sales channels or in brick-and-mortar stores with digital price tags - the firm can immediately exploit its improved knowledge on consumer behavior by appropriately adapting the selling prices.

Optimal pricing policies for these type of problems have been researched extensively. Here we only list a sample of the recent OR/MS literature; for a more elaborate discussion, including relevant studies from the economics literature, we refer to den Boer (2015).


                        Lobo and Boyd (2003), Carvalho and Puterman (2005b), Carvalho and Puterman (2005a), Bertsimas and Perakis (2006), Besbes and Zeevi (2009), Broder and Rusmevichientong (2012), den Boer and Zwart (2014) and Keskin and Zeevi (2014) are all studies that assume that the price-demand relation belongs to a parametric family, estimate the unknown parameters by classical estimation methods (such as linear regression or maximum likelihood estimation), and study optimal pricing policies. Similar approaches with Bayesian estimation methods, can be found in Lin (2006), Araman and Caldentey (2009), Farias and van Roy (2010) and Harrison, Keskin, and Zeevi (2012). Robust or nonparametric approaches are taken by Kleinberg and Leighton (2003), Cope (2007), Lim and Shanthikumar (2007), Eren and Maglaras (2010) and Besbes and Zeevi (2009).

A main conclusion from this stream of literature is that, in general, firms should properly balance learning and instant optimization. That means that not always the price should be chosen that is optimal according to current parameter estimates, but some price variation should be induced to guarantee sufficient quality of future parameter estimates.

All these studies have the assumption in common that the relation between price and expected sales is stable during the time horizon under consideration: the unknown parameters that describe this relation do not change. This is a rather strong assumption, which makes these studies less applicable in practical situations. Markets are generally not stable, but may vary over time, without the seller immediately being aware of it (cf. Dolan and Jeuland, 1981; Wildt and Winer, 1983, and Section 2 of Elmaghraby and Keskinocak, 2003). These changes may have various causes: shifts in consumer tastes, competition (Wildt & Winer, 1983), appearance of technological innovations (Chen & Jain, 1992), market saturation and product diffusion effects related to the life cycle of a product (Bass, 1969; Dolan & Jeuland, 1981; Raman & Chatterjee, 1995), marketing and advertisement efforts (Horsky & Simon, 1983), competitors entering or exiting the market, appearance of new sales channels, and many more.


                        Wildt and Winer (1983) argued already in 1983 that “constant-parameter models are not capable of adequately reflecting such changing market environments”. In fact, this issue has been known since longtime in the historical literature on statistical economics, as illustrated by the following quotation of Schultz (1925) on the law of demand:

                           “The validity of the theoretical law [of demand] is limited to a point in time. But in order to derive concrete, statistical laws our observations must be numerous; and in order to obtain the requisite number of observations, data covering a considerable period must be used. During the interval, however, important dynamic changes take place in the condition of the market. In the case of a commodity like sugar, the principal dynamic changes that need be considered are the changes in our sugar-consuming habits, fluctuations in the purchasing power of money, and the increase of population.” page 409 of Schultz (1925).
                        
                     

Although the literature on dynamic pricing and learning has increased rapidly in recent years, models with a varying market have hardly been considered. This motivates the current study of dynamic pricing and learning in a changing environment.

In the present paper we study the problem of dynamic pricing and learning in a changing environment. We study the situation where a monopolist firm is selling a single type of product with unlimited inventory. We consider an additive demand model, where the expected demand for the product in a certain time period is the sum of a stochastic market process and a known function depending on the selling price. The characteristics of this stochastic process are unknown to the firm. Its value at a certain point in time may be estimated from accumulated sales data; however, since the market may be changing over time, estimation methods are needed that are designed for time-varying systems. We deploy two such estimators, namely estimation with a forgetting factor, and estimation based on a “sliding window” approach. For both estimators we derive an upper bound on the expected estimation error.

Next, we propose a simple, intuitive pricing policy: at each decision moment, the firm estimates the market process with one of the just mentioned estimators, and subsequently sets the next selling price equal to the price that would be optimal if the firm’s market estimate were correct. This is a so-called myopic or certainty equivalent policy: at each decision moment the firm acts as if being certain about its estimates. To measure the quality of this pricing policy, we define AverageRegret(T), which measures the expected costs of not choosing optimal prices in the first T periods, and LongRunAverageRegret, which equals the limit superior of AverageRegret(T) as T grows large. We derive upper bounds on AverageRegret(T) and LongRunAverageRegret. These bounds are not only stated in terms of the variables associated with the used estimation method (the forgetting factor, or the size of the sliding window), but also in terms of a measure of the impact that market fluctuations have on the estimation error. Clearly, if the market is very unstable and inhibits very large and frequent fluctuations, the impact may become extremely large, which negatively affects the obtained revenue.

The novel, key idea of this study is that (i) this impact can be bounded using assumptions on the market process that the firm makes a priori, (ii) the resulting upper bounds on AverageRegret(T) and LongRunAverageRegret can be used by the firm to determine the optimal estimator of the market (i.e. the optimal value of the forgetting factor or window size), (iii) this provides the firm explicit guarantees on the maximum expected revenue loss. This framework enables the firm to hedge against change: the firm is certain that the expected regret does not exceed a certain known value, provided the market process satisfies the posed assumptions. These assumptions may be very general and cover many important cases; for example, bounds on the probability that the market value changes in a certain period, bounds on the maximum difference between two consecutive market values, or bounds on the maximum and minimum value that the market process may attain. We provide numerical examples to illustrate the methodology, in two practically relevant settings: in the first we make use of the well-known Bass model to model the diffusion of an innovative products; and in the second we consider an oligopoly where price changes by competitors causes occasional changes in the market. The application of our methodology on the Bass model makes this the first study that incorporates learning and pricing in this widely used product-diffusion model; thus far, only deterministic settings (Dolan & Jeuland, 1981; Kalish, 1983; Robinson & Lakhani, 1975), or random settings where no learning is present (Chen & Jain, 1992; Kamrad, Lele, Siddique, & Thomas, 2005; Raman & Chatterjee, 1995) have been considered in the literature.

Summarizing, in one of the first studies on dynamic pricing and learning in a changing environment, our contributions are as follows.

                           
                              (i)
                              We introduce a model of dynamic pricing and learning in a changing market environment, using a very generic description of the market process.

We discuss two estimators of time-varying processes, and prove upper bounds on the estimation error.

We propose a methodology that enables the decision maker to hedge against change. This results in explicit upper bounds on the regret, and guides the choice of the optimal estimator.

We show the application of the methodology in several concrete cases, and offer numerical examples to illustrate its use and performance. These examples show that incorporating the changing nature of the market process can significantly improve a firm’s revenue.

The combination of dynamic pricing and learning in a changing market is a rather unexplored area. Chen and Jain (1992) consider optimal pricing policies in models where the demand not only depends on the selling price, but also on the cumulative amount of sales; in this way diffusion effects are modeled. In addition, the demand is influenced by an observable state variable, which models unpredictable events that change the demand function, and whose dynamics are driven by a Poisson process. Apart from these random events, the demand is fully deterministic and known to the firm, and learning by the firm is not considered. Hanssens, Parsons, and Schultz (2001) and Section 2.3 of Leeflang et al. (2009) discuss several dynamic market models, as well as estimation methods, but do not integrate this with the problem of optimal dynamic pricing. Besbes and Zeevi (2011) study a pricing problem where the willingness-to-pay (WtP) distribution of the customers changes at some unknown point in time. The WtP distribution before and after the change are assumed to be known, only the time of change is unknown to the seller. Lower bounds on the worst-case regret are derived, and pricing strategies are developed that achieve the order of these bounds. Besbes and Sauré (2014) consider dynamic pricing with finite selling season and finite inventory that cannot be replenished. The demand function is unknown and subject to abrupt changes. The authors focus on the trade-off between gaining revenue before and after the change-point, and derive in various settings structural properties of the optimal price policy. Perhaps closest to our work is Keskin and Zeevi (2013), who study learning-and-earning in a setting similar to ours, but with different assumptions on the information known to the seller. The authors consider asymptotically optimal policies in different settings, and prove lower and upper bounds on the regret. A relevant study from the control literature is from Godoy, Goodwin, Aguero, and Rojas (2009). They consider an estimation problem in a linear system, where the parameters are subject to shock changes, and analyze the performance of a sliding-window linear regression method. A major assumption is that the controls are deterministic. This differs from pricing problems, where the prices (the controls) usually depend in a non-trivial way on all previously observed sales realizations. We also refer to recent work by Garivier and Moulines (2011) on multi-armed bandit problems with time-varying parameters. Two differences between their and our work are (i) they consider a discrete action set, whereas, in our setting, prices can be chosen from a continuum, and (ii) they restrict themselves to abruptly changing environments, whereas our analysis is more generic, including slowly changing environments. Finally, we mention the recent work by Rana and Oliveira (2014), who consider dynamic pricing of a finite inventory in a non-stationary environment. The authors propose two variants of Q-learning to learn the optimal price policy, and compare the performance of these learning algorithms using Monte-Carlo simulations.

The rest of this paper is organized as follows. Section 2 introduces the model, discusses estimation methods for the market process, gives bounds on the estimation error, and provides a discussion on various model assumptions. Section 3 introduces the methodology for hedging against change: we formulate the pricing myopic policy and provide performance bounds in Section 3.1, we show in Section 3.2 how assumptions on the market process can be used to find the optimal estimator that minimizes these regret bounds, and provide in Section 3.3 three examples of the methodology. The results of two numerical studies are described in Section 4, and conclusions and directions for future research are discussed in Section 5. All mathematical proofs are contained in Section 6.

We consider a monopolist firm selling a single type of product. In each time period 
                           
                              t
                              ∈
                              N
                              ,
                           
                         the firm decides on a selling price pt
                         ∈ [pl, ph
                        ], where 0 ≤ pl
                         < ph
                         < ∞ denote the lowest and highest admissible price. After choosing the price, the seller observes demand dt
                        , which is a realization of the random variable Dt
                        (pt
                        ). Conditional on the selling prices, the demand in different time periods is independent. The expected demand in period t, against a price p, is of the form

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                [
                                                
                                                   D
                                                   t
                                                
                                                
                                                   (
                                                   p
                                                   )
                                                
                                                ]
                                             
                                             =
                                             M
                                             
                                                (
                                                t
                                                )
                                             
                                             +
                                             
                                                g
                                                t
                                             
                                             
                                                (
                                                p
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here 
                           
                              
                                 (
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                         is a stochastic process called the market process, unobservable for the firm, and taking values in a (possibly infinite) interval 
                           
                              M
                              ⊂
                              R
                           
                        . Let 
                           
                              F
                              t
                           
                         be the σ-algebra generated by 
                           
                              
                                 d
                                 1
                              
                              ,
                              
                                 p
                                 1
                              
                              ,
                              M
                              
                                 (
                                 1
                                 )
                              
                              ,
                              …
                              ,
                              
                                 d
                                 t
                              
                              ,
                              
                                 p
                                 t
                              
                              ,
                              M
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                        
                        
                           
                              F
                              0
                           
                         the trivial σ-algebra, and write 
                           
                              
                                 ϵ
                                 t
                              
                              =
                              
                                 d
                                 t
                              
                              −
                              
                                 g
                                 t
                              
                              
                                 (
                                 
                                    p
                                    t
                                 
                                 )
                              
                              −
                              M
                              
                                 (
                                 t
                                 )
                              
                           
                        ; then we assume that M(t) and 
                           
                              ϵ
                              t
                           
                         are 
                           
                              F
                              
                                 t
                                 −
                                 1
                              
                           
                        -measurable, for all 
                           
                              t
                              ∈
                              N
                           
                        . In addition we impose the following mild conditions on the moments of M(t) and 
                           
                              ϵ
                              t
                           
                        : there are positive constants σM
                         and σ, such that

                           
                              (2)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                sup
                                                
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             E
                                             
                                                [
                                                M
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   2
                                                
                                                ∣
                                                
                                                   F
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                ]
                                             
                                             ≤
                                             
                                                σ
                                                M
                                                2
                                             
                                             
                                             a.s.
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             and
                                             
                                             
                                             
                                                sup
                                                
                                                   t
                                                   ∈
                                                   N
                                                
                                             
                                             E
                                             
                                                [
                                                
                                                   ϵ
                                                   t
                                                   2
                                                
                                                ∣
                                                
                                                   F
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                ]
                                             
                                             ≤
                                             
                                                σ
                                                2
                                             
                                             
                                             a.s.
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The functions gt
                         in (1) model the dependence of expected demand on selling price. They are assumed to be known by the seller. After observing demand, the seller collects revenue ptdt
                        , and proceeds to the next period. The purpose of the seller is to maximize expected revenue.

Let 
                           
                              
                                 r
                                 t
                              
                              
                                 (
                                 p
                                 ,
                                 M
                                 )
                              
                              =
                              p
                              ·
                              
                                 (
                                 M
                                 +
                                 
                                    g
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 )
                              
                           
                         denote the expected revenue in period 
                           
                              t
                              ∈
                              N
                              ,
                           
                         when the market process equals M and the selling price is set at p. The price that generates the highest amount of expected revenue, given that the current market equals M, is denoted by 
                           
                              
                                 p
                                 t
                                 *
                              
                              
                                 (
                                 M
                                 )
                              
                              =
                              
                                 
                                    arg
                                    
                                    max
                                 
                                 
                                    p
                                    ∈
                                    [
                                    
                                       p
                                       l
                                    
                                    ,
                                    
                                       p
                                       h
                                    
                                    ]
                                 
                              
                              
                                 r
                                 t
                              
                              
                                 (
                                 p
                                 ,
                                 M
                                 )
                              
                           
                        .

We impose some mild conditions to ensure that this optimal price exists and is uniquely defined. In particular, we assume that for all admissible prices p and all 
                           
                              t
                              ∈
                              N
                              ,
                           
                         
                        gt
                        (p) is decreasing in p, and twice continuously differentiable w.r.t. p, with first and second derivative denoted by 
                           
                              
                                 g
                                 t
                                 ′
                              
                              
                                 (
                                 p
                                 )
                              
                           
                         and 
                           
                              
                                 g
                                 t
                                 
                                    ′
                                    ′
                                 
                              
                              
                                 (
                                 p
                                 )
                              
                           
                        . These two properties immediately carry over to the expected demand, and in fact are quite natural conditions for demand functions to hold. In addition, we assume that for all 
                           
                              M
                              ∈
                              M
                           
                         and all 
                           
                              t
                              ∈
                              N
                           
                         the revenue function rt
                        (p, M) is unimodal with unique optimum 
                           
                              
                                 p
                                 t
                                 #
                              
                              
                                 (
                                 M
                                 )
                              
                              ∈
                              R
                           
                         satisfying 
                           
                              
                                 r
                                 t
                                 ′
                              
                              
                                 (
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 ,
                                 M
                                 )
                              
                              =
                              0
                              ,
                           
                         and in addition

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             sup
                                             
                                                {
                                                
                                                   r
                                                   t
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      #
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                ∣
                                                t
                                                ∈
                                                N
                                                ,
                                                M
                                                ∈
                                                M
                                                ,
                                                
                                                   p
                                                   t
                                                   #
                                                
                                                
                                                   (
                                                   M
                                                   )
                                                
                                                ∈
                                                
                                                   [
                                                   
                                                      p
                                                      l
                                                   
                                                   ,
                                                   
                                                      p
                                                      h
                                                   
                                                   ]
                                                
                                                }
                                             
                                             <
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 r
                                 t
                                 ′
                              
                              
                                 (
                                 p
                                 ,
                                 M
                                 )
                              
                           
                         and 
                           
                              
                                 r
                                 t
                                 
                                    ′
                                    ′
                                 
                              
                              
                                 (
                                 p
                                 ,
                                 M
                                 )
                              
                           
                         denote the first and second derivative of rt
                        (p, M) w.r.t. p.

The value of the market process and the corresponding optimal price are unknown to the seller. As a result, the decision maker might choose sub-optimal prices, which incurs a loss of revenue relative to someone who would know the market process and the optimal price. The goal of the seller is to determine a pricing policy that minimizes this loss of revenue. With a pricing policy we here mean a sequence of (possibly random) prices 
                           
                              
                                 (
                                 
                                    p
                                    t
                                 
                                 )
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                         in [pl, ph
                        ], where each price pt
                         may depend on all previously chosen prices 
                           
                              
                                 p
                                 1
                              
                              ,
                              …
                              ,
                              
                                 p
                                 
                                    t
                                    −
                                    1
                                 
                              
                           
                         and demand realizations 
                           
                              
                                 d
                                 1
                              
                              ,
                              …
                              ,
                              
                                 d
                                 
                                    t
                                    −
                                    1
                                 
                              
                           
                        .

To assess the quality of a pricing policy Φ, we define the following two quantities.

                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             AverageRegret
                                             (
                                             Φ
                                             ,
                                             T
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             
                                                1
                                                
                                                   T
                                                   −
                                                   1
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   =
                                                   2
                                                
                                                T
                                             
                                             E
                                             
                                                [
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                   
                                                   ,
                                                   M
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             LongRunAverageRegret
                                             (
                                             Φ
                                             )
                                          
                                       
                                       
                                          
                                             =
                                             
                                                lim sup
                                                
                                                   T
                                                   →
                                                   ∞
                                                
                                             
                                             AverageRegret
                                             
                                                (
                                                Φ
                                                ,
                                                T
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Each term in the summand of (4) measures the expected revenue loss caused by not using the optimal price in period t. The expectation operator is because both pt
                         and M(t) may be random variables. We start measuring the average regret from the second period. This simplifies several expressions that appear in further sections; in addition, in the first period, no data is available to estimate M(1), and minimizing the instantaneous regret encountered in the first period is not possible. Furthermore, note that AverageRegret(Φ, T) and LongRunAverageRegret(Φ) are not observed by the seller, and thus can not directly be used to determine an optimal pricing policy.

Estimating the value of the market process gives vital information that is needed to determine the selling price. Since the market may change over time, the firm needs an estimation method that can handle such changes. In this section we describe two such methods: (I) estimation with forgetting factor, and (II) estimation with a sliding window.

(I) Estimation of M(t) with forgetting factor. Let λ ∈ [0, 1] be the forgetting factor, to be determined by the decision maker. The estimate 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 λ
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                         with forgetting factor λ, based on demand realizations 
                           
                              
                                 d
                                 1
                              
                              ,
                              …
                              ,
                              
                                 d
                                 t
                              
                           
                         and prices 
                           
                              
                                 p
                                 1
                              
                              ,
                              …
                              ,
                              
                                 p
                                 t
                              
                              ,
                           
                         is equal to

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                λ
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   arg
                                                   
                                                   min
                                                
                                                
                                                   M
                                                   ∈
                                                   R
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                t
                                             
                                             
                                                
                                                   (
                                                   
                                                      d
                                                      i
                                                   
                                                   −
                                                   M
                                                   −
                                                   
                                                      g
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         i
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             
                                                λ
                                                
                                                   t
                                                   −
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        The factor 
                           
                              λ
                              
                                 t
                                 −
                                 i
                              
                           
                         acts as a weight on the data (pi, di
                        )1≤i≤t
                        . Data that lies further in the past gets a lower weight; data from the recent past receives more weight (unless 
                           
                              λ
                              =
                              1
                              ,
                           
                         in which case all available data gets equal weight, or 
                           
                              λ
                              =
                              0
                              ,
                           
                         in which case only the most recent observation is taken into account). This captures the idea that the longer ago data has been generated, the likelier it is that the corresponding value of the market process differs from its current value. Accordingly, data from longer ago is assigned a smaller weight than data from the more recent past. Whether this intuition is true depends of course on the specific characteristics of M(t).

By differentiating the righthandside of (6) w.r.t. M, we obtain the following explicit expression for 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 λ
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        :

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                λ
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         d
                                                         i
                                                      
                                                      −
                                                      
                                                         g
                                                         i
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            i
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      λ
                                                      
                                                         t
                                                         −
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      t
                                                   
                                                   
                                                      λ
                                                      
                                                         t
                                                         −
                                                         i
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

(II) Estimation of M(t) with a sliding window. Let 
                           
                              N
                              ∈
                              
                                 N
                                 
                                    ≥
                                    2
                                 
                              
                              ∪
                              
                                 {
                                 ∞
                                 }
                              
                           
                         be the window size, determined by the decision maker. The estimate 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 N
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                         with sliding window size N, based on demand realizations 
                           
                              
                                 d
                                 1
                              
                              ,
                              …
                              ,
                              
                                 d
                                 t
                              
                           
                         and prices 
                           
                              
                                 p
                                 1
                              
                              ,
                              …
                              ,
                              
                                 p
                                 t
                              
                              ,
                           
                         is equal to

                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                N
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   arg
                                                   
                                                   min
                                                
                                                
                                                   M
                                                   ∈
                                                   R
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   max
                                                   {
                                                   t
                                                   −
                                                   N
                                                   +
                                                   1
                                                   ,
                                                   1
                                                   }
                                                
                                                t
                                             
                                             
                                                
                                                   (
                                                   
                                                      d
                                                      i
                                                   
                                                   −
                                                   M
                                                   −
                                                   
                                                      g
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         i
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Here only data from the N most recent observations is used to form an estimate. All data that is generated longer than N time periods ago, is neglected (if 
                           
                              N
                              =
                              ∞
                              ,
                           
                         then all available data is taken into account). Similar to the estimate with forgetting factor, the rationale behind the estimate 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 N
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         is the idea that for data generated long ago, it is more likely that the corresponding market value differs from its current value. This is captured in the fact that only the N most recent observations are used to estimate M(t). Whether this idea is correct depends again on the specifics of M(t).

Differentiating the righthandside of (8) w.r.t. M, we obtain the following expression:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                   ^
                                                
                                                N
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                1
                                                
                                                   min
                                                   {
                                                   N
                                                   ,
                                                   t
                                                   }
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   max
                                                   {
                                                   t
                                                   −
                                                   N
                                                   +
                                                   1
                                                   ,
                                                   1
                                                   }
                                                
                                                t
                                             
                                             
                                                (
                                                
                                                   d
                                                   i
                                                
                                                −
                                                
                                                   g
                                                   i
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      i
                                                   
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           Remark 1
                           Both estimation methods (I) and (II) depend on a decision variable (λ resp. N) that can be interpreted as a measure for the responsiveness to changes in the market. A high value of λ resp. N means that much information from the historical data is used to form estimates; this is advantageous in case of a stable market, but disadvantageous in case of many or large recent changes in the market process. Similarly, a low value of λ resp. N implies that the estimate of M(t) is mainly determined by recent data; naturally, this is more beneficial in a volatile market than in a stable market.

Market fluctuations influence the accuracy of the estimates 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 λ
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    M
                                    ^
                                 
                                 N
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        . The following quantities Iλ
                        (t) and IN
                        (t) measure this impact of market variations on the estimates. Observe that this impact is not solely determined by the market process, but also by the choice of λ and N:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                                λ
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             
                                                [
                                                
                                                   |
                                                   
                                                      (
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      +
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         =
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         t
                                                      
                                                      
                                                         (
                                                         M
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                ]
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                I
                                                N
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             E
                                             
                                                [
                                                
                                                   
                                                      |
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                            +
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         t
                                                      
                                                      
                                                         (
                                                         M
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                ]
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The following proposition gives a bound on the expected estimation error of (I) and (II), in terms of λ, N, and the impact measures Iλ
                        (t) and IN
                        (t).

                           Proposition 1
                           
                              For all
                              
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  M
                                                                  ^
                                                               
                                                               λ
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                   ≤
                                                   2
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ×
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            λ
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            λ
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      +
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         =
                                                         1
                                                         )
                                                      
                                                      ]
                                                   
                                                   +
                                                   2
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and
                              
                                 
                                    (11)
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  M
                                                                  ^
                                                               
                                                               N
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   2
                                                   
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         min
                                                         {
                                                         N
                                                         ,
                                                         t
                                                         }
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              If the processes
                              
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               
                              are independent, then
                              
                                 
                                    (12)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  M
                                                                  ^
                                                               
                                                               λ
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                   ≤
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ×
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            λ
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            λ
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      +
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         =
                                                         1
                                                         )
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and
                              
                                 
                                    (13)
                                    
                                       
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      
                                                         
                                                            |
                                                            
                                                               
                                                                  M
                                                                  ^
                                                               
                                                               N
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                
                                             
                                             
                                                
                                                   ≤
                                                   
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         min
                                                         {
                                                         N
                                                         ,
                                                         t
                                                         }
                                                      
                                                   
                                                   +
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              with equality in 
                              
                                 (12)
                              
                              and 
                              
                                 (13)
                               
                              if the disturbance terms are homoscedastic, i.e.
                              
                                 
                                    E
                                    
                                       [
                                       
                                          ϵ
                                          t
                                          2
                                       
                                       ∣
                                       
                                          F
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       σ
                                       2
                                    
                                 
                               
                              for all
                              
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                              .
                           

The first terms of the righthandsides of (10)–(13) are related to the natural fluctuations in demand. The lower these fluctuations, measured by σ
                              2, the lower this part of the estimation error becomes. The second terms of the righthandsides of (10)–(13) relate to the impact that market fluctuations have on the quality of the estimate of M(t). These terms are nonnegative, and equal zero if the market value does never change.

Our demand model is of the additive form 
                           
                              E
                              
                                 [
                                 
                                    D
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 ]
                              
                              =
                              M
                              
                                 (
                                 t
                                 )
                              
                              +
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              ,
                           
                         where M(t) is unknown and gt
                        (p) is known. The term M(t) can be regarded as capturing various time-varying aspects of the true demand model, with possibly complex behavior that is not fully known or understood by the decision maker. If we would only assume that M(t) lies in some known uncertainty 
                           
                              M
                              ,
                           
                         then a typical approach would be to optimize the price given the worst-case value of M(t) in 
                           M
                        . A disadvantage of this robust optimization approach is that the accumulating observations of 
                           
                              
                                 (
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 )
                              
                              
                                 t
                                 ∈
                                 N
                              
                           
                         are not used by the firm to improve its price decisions. Our work distinguishes itself from the ‘static’ robust optimization approach by allowing some way learning or tracking the market process.

An alternative way of viewing the demand model is to regard gt
                        (p) as the firm’s local approximation of a more complex demand model, and M(t) as the time-dependent deviation between this approximation and the true demand. In this way M(t) may capture (unavoidable) model errors made by the firm.

Note that instead of an additive model one could also assume a multiplicative demand model, where the expected demand is the product of the two parts: 
                           
                              E
                              
                                 [
                                 
                                    D
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 ]
                              
                              =
                              M
                              
                                 (
                                 t
                                 )
                              
                              ·
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                           
                        . An advantage of a multiplicative model is that, under some additional assumptions, the aggregate demand in a time period may be explained in terms of the buying behavior of individual customers. For example, one could assume that individual customers have a willingness-to-pay (WtP) distribution F(p): if the selling price equals p, a randomly selected customer buys a product with probability 
                           
                              1
                              −
                              F
                              (
                              p
                              )
                           
                        . If there are M(t) customers present, and their buying-decisions are mutually independent, then the expected aggregated demand E[D(p)] has the multiplicative form 
                           
                              M
                              (
                              t
                              )
                              ·
                              (
                              1
                              −
                              F
                              (
                              p
                              )
                              )
                           
                        . Such demand model can thus be explained in terms of the behavior of individual customers, but only using the strong assumptions that the customers behave independently and buy only a single product. In our setting it would be inappropriate to pose such strong assumptions on consumer behavior: we study how a seller can handle a volatile, unstable market while making only minor assumptions on its behavior.

Another motivation for the additive demand model is related to the optimal price. By differentiating the revenue function w.r.t. p, one can easily show that the optimal price in a multiplicative demand model is the solution to the equation 
                           
                              p
                              
                                 g
                                 t
                                 ′
                              
                              
                                 (
                                 p
                                 )
                              
                              /
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              −
                              1
                           
                        . This equation is independent of the market process, and as a result, the firm does not need to know or estimate the market in order to determine the optimal selling price. Intuitively it is clear that for many products such a model does not accurately reflect reality.

An important subclass of our demand model is the setting where 
                           
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              g
                              
                                 (
                                 p
                                 )
                              
                              ,
                           
                         i.e. the expected demand is the sum of a time-dependent part and a price-dependent time-homogeneous part. Such demand models appear frequently in the literature: for example, in models that incorporate competition (Cooper, de Mello, & Kleywegt, 2014; Puu, 1991; Tuinstra, 2004), or models that capture market diffusion and saturation effects (Section IV of Chen and Jain (1992), Section 4.3 of Raman and Chatterjee (1995), Section 3.3.1 of Kalish (1983)). Some of the numerical examples in Section 4 apply our pricing policy to these two settings.

The fact that the price-dependent part gt
                        (p) is assumed to be known by the seller is an arguably strong assumption made in this study. In practice, sellers may have some level of ambiguity about gt
                        . An alternative approach could be to estimate gt
                         from data; for example, one could assume a parametric form 
                           
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              −
                              
                                 b
                                 t
                              
                              p
                              ,
                           
                         for some bt
                         > 0, estimate bt
                         with least-squares linear regression, and analyze pricing policies similar to those proposed in this paper. The main drawback of this approach, however, is that it may be possible to derive upper bounds on the regret, as in Theorem 1, but it is very difficult to show, analogous to Proposition 2, that these bounds are sharp. We are able to derive these sharp results; this comes at the expense of stronger assumptions.

The technical assumptions on gt
                         and rt
                         are fairly standard conditions on demand and revenue functions, and ensure that the revenue function is locally strictly concave around the optimum. Clearly, if 
                           
                              
                                 p
                                 t
                                 #
                              
                              
                                 (
                                 M
                                 )
                              
                           
                         lies in the interval [pl, ph
                        ] then 
                           
                              
                                 p
                                 t
                                 *
                              
                              
                                 (
                                 M
                                 )
                              
                              =
                              
                                 p
                                 t
                                 #
                              
                              
                                 (
                                 M
                                 )
                              
                              ,
                           
                         and if 
                           
                              
                                 p
                                 t
                                 #
                              
                              
                                 (
                                 M
                                 )
                              
                              ∉
                              
                                 [
                                 
                                    p
                                    l
                                 
                                 ,
                                 
                                    p
                                    h
                                 
                                 ]
                              
                              ,
                           
                         then 
                           
                              
                                 p
                                 t
                                 *
                              
                              
                                 (
                                 M
                                 )
                              
                           
                         is the projection of 
                           
                              
                                 p
                                 t
                                 #
                              
                              
                                 (
                                 M
                                 )
                              
                           
                         on the interval [pl, ph
                        ]. It is not difficult to show that the conditions on gt
                         are satisfied for the linear demand model with 
                           
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              −
                              b
                              p
                           
                         for some b > 0. For nonlinear demand functions with 
                           
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              −
                              b
                              
                                 p
                                 c
                              
                           
                         for some b > 0, c > 0, c ≠ 1, or 
                           
                              
                                 g
                                 t
                              
                              
                                 (
                                 p
                                 )
                              
                              =
                              −
                              b
                              log
                              
                                 (
                                 p
                                 )
                              
                           
                         for some b > 0, the conditions are satisfied if the market process is bounded.

In this section we show how a price manager can hedge against changes in the market. The key idea is that a simply myopic policy can be used (which means that one always chooses the price that is optimal according to current estimates of the market process), but that the parameter λ of the market estimator 
                        
                           
                              
                                 M
                                 ^
                              
                              λ
                           
                           
                              (
                              t
                              )
                           
                        
                      (or N, for the estimator 
                        
                           
                              
                                 M
                                 ^
                              
                              N
                           
                           
                              (
                              t
                              )
                           
                        
                     ) is chosen in a smart way.

As already alluded to in Section 2.2, the optimal value of λ or N depends on the nature of changes in the market process. If changes are frequent and/or large, λ and N should be chosen small, whereas in case of infrequent and small changes in the market one intuitively expects that λ should be chosen close to one, and N large.

Thus, in order to find a good choice of λ resp. N, the firm needs assumptions on the type of changes in the market that it is anticipating. Such assumptions can be translated into bounds on the behavior of the influence measures Iλ
                     (t), IN
                     (t), which in turn lead to bounds on the regret of the myopic policy. These regret bounds depend on λ or N, and minimizing them leads to the optimal value of λ or N w.r.t. the assumptions on the market imposed by the firm.

The following two subsections elaborate this approach. Section 3.1 formulates the myopic policy and studies how the regret depends on the influence measures Iλ
                     (t), IN
                     (t). Section 3.2 explains the methodology in more detail, and Section 3.3 provides three illustrative examples.

We consider the following simple, myopic pricing policy: at each decision moment the seller estimates the market value with one of the two estimation methods described in Section 2.2, and subsequently chooses the selling price that is optimal w.r.t. this estimate. In other words, the seller always acts as if the current estimate of the market is correct.

We denote this policy by Φλ
                         if the market is estimated by method (I), with forgetting factor λ, and by ΦN
                         if the market is estimated by method (II), with sliding window of size N. The formal description of Φλ
                         and ΦN
                         is as follows.


                        
                           
                              
                                 
                                 
                                 
                                    
                                       Myopic pricing policy 
                                             
                                                
                                                   Φ
                                                   λ
                                                
                                                /
                                                
                                                   Φ
                                                   N
                                                
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                          Initialization: Choose 
                                             
                                                λ
                                                ∈
                                                [
                                                0
                                                ,
                                                1
                                                ]
                                                
                                                or
                                                
                                                N
                                                ∈
                                                
                                                   N
                                                   
                                                      ≥
                                                      2
                                                   
                                                
                                                ∪
                                                
                                                   {
                                                   ∞
                                                   }
                                                
                                             
                                          .
                                       
                                    
                                    
                                       Set 
                                             
                                                
                                                   p
                                                   1
                                                
                                                ∈
                                                [
                                                
                                                   p
                                                   l
                                                
                                                ,
                                                
                                                   p
                                                   h
                                                
                                                ]
                                             
                                           arbitrarily.
                                       
                                    
                                    
                                       For all 
                                             
                                                t
                                                ∈
                                                N
                                             
                                          :
                                       
                                    
                                    
                                       
                                          Estimation: Let 
                                             
                                                
                                                   
                                                      M
                                                      ^
                                                   
                                                   ·
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                           denote either 
                                             
                                                
                                                   
                                                      M
                                                      ^
                                                   
                                                   λ
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                           (for policy 
                                             
                                                Φ
                                                λ
                                             
                                          ) or 
                                             
                                                
                                                   
                                                      M
                                                      ^
                                                   
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                           (for policy 
                                             
                                                Φ
                                                N
                                             
                                          ).
                                       
                                    
                                    
                                       
                                          Pricing: Set 
                                             
                                                
                                                   p
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   p
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                         ^
                                                      
                                                      ·
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                             
                                          .
                                       
                                    
                                 
                              
                           
                        
                     

The following theorem provides upper bounds on the (long run) average regret for the myopic pricing policies, in terms of the influence measures Iλ
                        (t) and IN
                        (t).

                           Theorem 1
                           
                              There is a K
                              0 > 0 such that for all T ≥ 2,

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   AverageRegret
                                                   
                                                      (
                                                      
                                                         Φ
                                                         λ
                                                      
                                                      ,
                                                      T
                                                      )
                                                   
                                                   ≤
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            +
                                                            λ
                                                         
                                                      
                                                      +
                                                      
                                                         2
                                                         
                                                            T
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                      
                                                      ×
                                                      
                                                         (
                                                         
                                                            
                                                               λ
                                                               log
                                                               (
                                                               λ
                                                               )
                                                               +
                                                               (
                                                               1
                                                               −
                                                               λ
                                                               )
                                                               log
                                                               (
                                                               1
                                                               −
                                                               λ
                                                               )
                                                            
                                                            
                                                               (
                                                               1
                                                               +
                                                               λ
                                                               )
                                                               log
                                                               (
                                                               λ
                                                               )
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                   1
                                                   
                                                      (
                                                      λ
                                                      <
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            1
                                                            +
                                                            log
                                                            (
                                                            T
                                                            −
                                                            1
                                                            )
                                                         
                                                         
                                                            T
                                                            −
                                                            1
                                                         
                                                      
                                                      ]
                                                   
                                                   1
                                                   
                                                      (
                                                      λ
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      1
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              and 
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   AverageRegret
                                                   (
                                                   
                                                      Φ
                                                      N
                                                   
                                                   ,
                                                   T
                                                   )
                                                
                                             
                                             
                                                ≤
                                             
                                             
                                                
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            log
                                                            (
                                                            min
                                                            {
                                                            T
                                                            −
                                                            1
                                                            ,
                                                            N
                                                            }
                                                            )
                                                         
                                                         
                                                            T
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                +
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            T
                                                            −
                                                            1
                                                            }
                                                         
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      
                                                         2
                                                         
                                                            K
                                                            0
                                                         
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              Consequentially,
                              
                                 
                                    (14)
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   LongRunAverageRegret
                                                   (
                                                   
                                                      Φ
                                                      λ
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≤
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      [
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            +
                                                            λ
                                                         
                                                      
                                                      +
                                                      
                                                         lim sup
                                                         
                                                            T
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         1
                                                         T
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         T
                                                      
                                                      
                                                         I
                                                         λ
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              for all λ ∈ [0, 1], and
                              
                                 
                                    (15)
                                    
                                       
                                          
                                             
                                                
                                                   LongRunAverageRegret
                                                   (
                                                   
                                                      Φ
                                                      N
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ≤
                                                   2
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      [
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         1
                                                         N
                                                      
                                                      +
                                                      
                                                         lim sup
                                                         
                                                            T
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         1
                                                         T
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         T
                                                      
                                                      
                                                         I
                                                         N
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              for all
                              
                                 
                                    N
                                    ∈
                                    
                                       N
                                       
                                          ≥
                                          2
                                       
                                    
                                    ∪
                                    
                                       {
                                       ∞
                                       }
                                    
                                    ,
                                 
                               
                              where we write
                              
                                 
                                    1
                                    /
                                    ∞
                                    =
                                    0
                                 
                              
                              .
                           

The main idea of the proof is to show that there is a K
                        0 > 0 such that for any M and M′, the instantaneous regret in period t satisfies 
                           
                              
                                 r
                                 t
                              
                              
                                 (
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 ,
                                 M
                                 )
                              
                              −
                              
                                 r
                                 t
                              
                              
                                 (
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 ,
                                 M
                                 )
                              
                              ≤
                              
                                 K
                                 0
                              
                              
                                 
                                    (
                                    M
                                    −
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 2
                              
                           
                        . Subsequently we apply the bounds derived in Proposition 1.

                           Remark 3
                           By (12) and (13), if the processes 
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               and 
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               are independent, then all four inequalities of Theorem 1 are still valid if all righthandsides are divided by 2.

An explicit expression for K
                              0 is derived in the proof of Theorem 1. To obtain the most sharp bounds, one could also define K
                              0 directly as 
                                 
                                    
                                       K
                                       0
                                    
                                    =
                                    
                                       sup
                                       
                                          t
                                          ∈
                                          N
                                       
                                    
                                    
                                       inf
                                       
                                          M
                                          ≠
                                          
                                             M
                                             ′
                                          
                                       
                                    
                                    
                                       (
                                       
                                          r
                                          t
                                       
                                       
                                          (
                                          
                                             p
                                             t
                                             *
                                          
                                          
                                             (
                                             M
                                             )
                                          
                                          ,
                                          M
                                          )
                                       
                                       −
                                       
                                          r
                                          t
                                       
                                       
                                          (
                                          
                                             p
                                             t
                                             *
                                          
                                          
                                             (
                                             
                                                M
                                                ′
                                             
                                             )
                                          
                                          ,
                                          M
                                          )
                                       
                                       )
                                    
                                    /
                                    
                                       
                                          (
                                          M
                                          −
                                          
                                             M
                                             ′
                                          
                                          )
                                       
                                       2
                                    
                                 
                              . For the important special case of a stationary linear demand function, with 
                                 
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    −
                                    b
                                    p
                                 
                               for some b > 0 and M(t) > 0 for all 
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                               it is not difficult to show 
                                 
                                    
                                       p
                                       t
                                       *
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    =
                                    min
                                    
                                       {
                                       max
                                       
                                          {
                                          M
                                          /
                                          
                                             (
                                             2
                                             b
                                             )
                                          
                                          ,
                                          
                                             p
                                             l
                                          
                                          }
                                       
                                       ,
                                       
                                          p
                                          h
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       K
                                       0
                                    
                                    =
                                    1
                                    /
                                    
                                       (
                                       4
                                       b
                                       )
                                    
                                 
                              .

In dynamic pricing and learning studies that assume a stable market, one often considers the asymptotic behavior of 
                                 
                                    Regret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    (
                                    T
                                    −
                                    1
                                    )
                                    ·
                                    AverageRegret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    ,
                                 
                               where Φ denotes the pricing policy that is used. Typically one proves bounds on the growth rate of Regret(Φ, T) for a certain policy, e.g. 
                                 
                                    Regret
                                    
                                       (
                                       Φ
                                       ,
                                       T
                                       )
                                    
                                    =
                                    O
                                    
                                       (
                                       
                                          T
                                       
                                       )
                                    
                                 
                               or 
                                 
                                    Regret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    O
                                    (
                                    log
                                    (
                                    T
                                    )
                                    )
                                 
                              . A policy is considered ‘good’ if the speed of convergence of the regret is close the best achievable rate, cf. Broder and Rusmevichientong (2012), Keskin and Zeevi (2014) and den Boer and Zwart (2014). In the setting with a changing market, a simple example makes clear that one cannot do better than 
                                 
                                    Regret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    O
                                    (
                                    T
                                    )
                                 
                               or 
                                 
                                    AverageRegret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    O
                                    (
                                    1
                                    )
                                 
                              . Suppose M(t) is a Markov process taking values in 
                                 
                                    
                                       {
                                       
                                          M
                                          1
                                       
                                       ,
                                       
                                          M
                                          2
                                       
                                       }
                                    
                                    ∈
                                    
                                       R
                                       +
                                       2
                                    
                                    ,
                                 
                               with M
                              1 ≠ M
                              2, and suppose 
                                 
                                    P
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          +
                                          1
                                          )
                                       
                                       =
                                       
                                          M
                                          i
                                       
                                       ∣
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       
                                          M
                                          j
                                       
                                       )
                                    
                                    =
                                    
                                       1
                                       2
                                    
                                    ,
                                 
                               for all i, j ∈ {1, 2} and 
                                 
                                    t
                                    ∈
                                    N
                                 
                              . Let 
                                 
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    −
                                    b
                                    p
                                 
                               for some b > 0 and all 
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                               and choose [pl, ph
                              ] such that 
                                 
                                    
                                       p
                                       t
                                       #
                                    
                                    
                                       (
                                       
                                          M
                                          i
                                       
                                       )
                                    
                                    =
                                    
                                       M
                                       i
                                    
                                    /
                                    
                                       (
                                       2
                                       b
                                       )
                                    
                                    ∈
                                    
                                       (
                                       
                                          p
                                          l
                                       
                                       ,
                                       
                                          p
                                          h
                                       
                                       )
                                    
                                    ,
                                 
                               for 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    2
                                 
                              . Then for all 
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                               the instantaneous regret incurred in period t satisfies

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            t
                                                            *
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            )
                                                         
                                                         ,
                                                         M
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            t
                                                         
                                                         ,
                                                         M
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≥
                                                   
                                                      inf
                                                      
                                                         p
                                                         ∈
                                                         [
                                                         
                                                            p
                                                            l
                                                         
                                                         ,
                                                         
                                                            p
                                                            h
                                                         
                                                         ]
                                                      
                                                   
                                                   [
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            t
                                                            *
                                                         
                                                         
                                                            (
                                                            
                                                               M
                                                               1
                                                            
                                                            )
                                                         
                                                         ,
                                                         
                                                            M
                                                            1
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         p
                                                         ,
                                                         
                                                            M
                                                            1
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   +
                                                   
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         
                                                            p
                                                            t
                                                            *
                                                         
                                                         
                                                            (
                                                            
                                                               M
                                                               2
                                                            
                                                            )
                                                         
                                                         ,
                                                         
                                                            M
                                                            2
                                                         
                                                         )
                                                      
                                                      −
                                                      
                                                         r
                                                         t
                                                      
                                                      
                                                         (
                                                         p
                                                         ,
                                                         
                                                            M
                                                            2
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≥
                                                   
                                                      b
                                                      2
                                                   
                                                   
                                                      inf
                                                      
                                                         p
                                                         ∈
                                                         [
                                                         
                                                            p
                                                            l
                                                         
                                                         ,
                                                         
                                                            p
                                                            h
                                                         
                                                         ]
                                                      
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            
                                                               p
                                                               *
                                                            
                                                            
                                                               (
                                                               
                                                                  M
                                                                  1
                                                               
                                                               )
                                                            
                                                            −
                                                            p
                                                            )
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               p
                                                               *
                                                            
                                                            
                                                               (
                                                               
                                                                  M
                                                                  2
                                                               
                                                               )
                                                            
                                                            −
                                                            p
                                                            )
                                                         
                                                         2
                                                      
                                                      ]
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≥
                                                   
                                                      b
                                                      4
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            p
                                                            t
                                                            *
                                                         
                                                         
                                                            (
                                                            
                                                               M
                                                               1
                                                            
                                                            )
                                                         
                                                         −
                                                         
                                                            p
                                                            t
                                                            *
                                                         
                                                         
                                                            (
                                                            
                                                               M
                                                               2
                                                            
                                                            )
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≥
                                                   
                                                      1
                                                      
                                                         16
                                                         b
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            M
                                                            1
                                                         
                                                         −
                                                         
                                                            M
                                                            2
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                   >
                                                   0
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              which implies that no policy can achieve a sub-linear 
                                 
                                    Regret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    o
                                    (
                                    T
                                    )
                                 
                              . In fact, any pricing policy achieves the optimal growth rate 
                                 
                                    Regret
                                    (
                                    Φ
                                    ,
                                    T
                                    )
                                    =
                                    O
                                    (
                                    T
                                    )
                                 
                              . Thus, the challenge of dynamic pricing and learning in such a changing environment is not to find a policy with optimal asymptotic growth rate, but rather to make the (long run) average regret as small as possible.

In view of the remark above, the question raises whether the bounds from Theorem 1 are sharp. The following proposition answers this question for the case of a linear stationary demand function with homoscedastic disturbance terms independent of the market process.

                           Proposition 2
                           
                              Suppose
                              
                                 
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    −
                                    b
                                    p
                                 
                               
                              for some b > 0 and all
                              
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 
                                    E
                                    
                                       [
                                       
                                          ϵ
                                          t
                                          2
                                       
                                       ∣
                                       
                                          F
                                          
                                             t
                                             −
                                             1
                                          
                                       
                                       ]
                                    
                                    =
                                    
                                       σ
                                       2
                                    
                                 
                               
                              for all
                              
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                               
                              the processes
                              
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               
                              and
                              
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               
                              are independent, and M(t) ∈ [2bpl
                              , 2bph
                              ] a.s. for all
                              
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                              . Then, with
                              
                                 
                                    
                                       K
                                       0
                                    
                                    =
                                    1
                                    /
                                    
                                       (
                                       4
                                       b
                                       )
                                    
                                    ,
                                 
                              
                              
                                 
                                    (16)
                                    
                                       
                                          
                                             
                                                
                                                   LongRunAverageRegret
                                                   (
                                                   
                                                      Φ
                                                      λ
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                   =
                                                   
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      [
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            +
                                                            λ
                                                         
                                                      
                                                      
                                                      +
                                                      
                                                      
                                                         lim sup
                                                         
                                                            T
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         1
                                                         T
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         T
                                                      
                                                      
                                                         I
                                                         λ
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              for all λ ∈ [0, 1], and
                              
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   LongRunAverageRegret
                                                   (
                                                   
                                                      Φ
                                                      N
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   =
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      [
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         1
                                                         N
                                                      
                                                      +
                                                      
                                                         lim sup
                                                         
                                                            T
                                                            →
                                                            ∞
                                                         
                                                      
                                                      
                                                         1
                                                         T
                                                      
                                                      
                                                         ∑
                                                         
                                                            t
                                                            =
                                                            1
                                                         
                                                         T
                                                      
                                                      
                                                         I
                                                         N
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      ]
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              for all
                              
                                 
                                    N
                                    ∈
                                    
                                       N
                                       
                                          ≥
                                          2
                                       
                                    
                                    ∪
                                    
                                       {
                                       ∞
                                       }
                                    
                                    ,
                                 
                               
                              where we write
                              
                                 
                                    1
                                    /
                                    ∞
                                    =
                                    0
                                 
                              
                              .
                           

The bounds on the regret that we derive in Theorem 1 are stated in terms of the influence measures Iλ
                        (t) and IN
                        (t). That means that the seller can get an explicit upper bound on the regret in terms of λ, N, if it can find upper bounds on the influence measures in terms of λ, N; subsequently, an optimal choice of λ, N can be found by minimizing these upper bounds on the regret.

More precisely, the firm should translate its assumptions on the market process into (non-random) upper bounds on the terms 
                           
                              
                                 1
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 I
                                 λ
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 1
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 I
                                 N
                              
                              
                                 (
                                 t
                                 )
                              
                           
                        . By plugging these bounds into Theorem 1, it obtains bounds on AverageRegret(Φλ, T) and AverageRegret(ΦN, T) in terms of λ and N. The optimal choices of λ and N are then determined by simply minimizing these bounds with respect to λ and N. In some cases an explicit expression for the optimal choice may exist, otherwise numerical methods are needed to determine the optimum.

The resulting optimal optimal λ and N may depend on the length of the time horizon T. This may be undesirable to the firm, for instance because T is not known in advance, or because the time horizon is infinite. In this case it is more appropriate to minimize the LongRunAverageRegret. If the firm can translate its assumptions on the market process into upper bounds on the terms 
                           
                              
                                 lim sup
                                 
                                    T
                                    →
                                    ∞
                                 
                              
                              
                                 1
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 I
                                 λ
                              
                              
                                 (
                                 t
                                 )
                              
                           
                         and 
                           
                              
                                 lim sup
                                 
                                    T
                                    →
                                    ∞
                                 
                              
                              
                                 1
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 ∑
                                 
                                    t
                                    =
                                    1
                                 
                                 
                                    T
                                    −
                                    1
                                 
                              
                              
                                 I
                                 N
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                           
                         then these upper bounds can be plugged into (14) and (15), and the optimal λ and N can be determined by minimizing the resulting expression.

                           Remark 6
                           Observe that the optimal choices of λ and N are independent of the functions gt
                              . The relevant properties of gt
                               are captured by the constant K
                              0, but its value does not influence the optimal λ and N. In a way this separates optimal estimation and optimal pricing: the first is determined by the impact of the market process, while only the latter involves the functions gt
                              . On the other hand, the variance of the demand distribution, related to σ
                              2, does influence the optimal λ and N. In addition, note that by Remark 3, the factor 2 on the righthandsides of (14) and (15) can be removed if the processes 
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               and 
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               are independent. In practice, it may not always be known to the decision maker whether this condition is satisfied; but, fortunately, this does not influence the optimal choice of λ and N.

The above presented methodology of hedging against change has some similarities with robust optimization. There, one usually considers optimization problems whose optimal solutions depend on some parameters. These parameters are not known exactly by the decision maker, but assumed to lie in a certain “uncertainty set” which is known in advance. The optimal decision is then determined by optimizing against the worst case of the possible parameter values. An improvement of our methodology compared to robust optimization is that we allow for many different types of assumptions on the market process, as illustrated by the three examples described in Section 3.3. In contrast, robust optimization generally only assumes a setting of an uncertainty set. In addition, in robust optimization there is usually no learning of the unknown parameters, whereas our methodology allows using accumulating data to estimate the unknown process; in several instances this enables us to “track” the market process.

To illustrate the methodology, we look in more detail to three examples of assumptions on the market process: (i) bounds on the range of the market process, (ii) bounds on the maximum jump of the market process, and (iii) bounds on the probability that the market changes.

In this section we consider the assumption that the market process is contained in a bounded interval.

                              Proposition 3
                              
                                 If
                                 
                                    
                                       
                                          sup
                                          
                                             t
                                             ∈
                                             N
                                          
                                       
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          inf
                                          
                                             t
                                             ∈
                                             N
                                          
                                       
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       d
                                    
                                  
                                 a.s., for some d > 0, then
                                 
                                    
                                       (18)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         λ
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            
                                                               1
                                                               −
                                                               λ
                                                            
                                                            
                                                               1
                                                               +
                                                               λ
                                                            
                                                         
                                                         +
                                                         
                                                            d
                                                            2
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (19)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            1
                                                            N
                                                         
                                                         +
                                                         
                                                            d
                                                            2
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 for all λ ∈ [0, 1], 
                                    
                                       N
                                       ∈
                                       
                                          N
                                          
                                             ≥
                                             2
                                          
                                       
                                       ∪
                                       
                                          {
                                          ∞
                                          }
                                       
                                       ,
                                    
                                  
                                 where we write
                                 
                                    
                                       1
                                       /
                                       ∞
                                       =
                                       0
                                    
                                 
                                 .
                              

The righthandsides of (18) and (19) are minimized by taking 
                              
                                 λ
                                 =
                                 1
                              
                            and 
                              
                                 N
                                 =
                                 ∞
                              
                           .

At first sight it may seem somewhat surprising that it is beneficial to take into account all available sales data to estimate the market, including ‘very old’ data. This can be explained by noting that in a period 
                              
                                 t
                                 +
                                 1
                                 ,
                              
                            
                           all preceding values of the market 
                              
                                 M
                                 (
                                 1
                                 )
                                 ,
                                 …
                                 ,
                                 M
                                 (
                                 t
                                 )
                              
                            may differ by d from the current value 
                              
                                 M
                                 (
                                 t
                                 +
                                 1
                                 )
                              
                           . In such a volatile market situation, it is best to ‘accept’ an unavoidable error caused by market fluctuations, and instead focus on minimizing the estimation error caused by natural fluctuations 
                              
                                 
                                    ϵ
                                    1
                                 
                                 ,
                                 …
                                 ,
                                 
                                    ϵ
                                    t
                                 
                              
                            in the demand distribution. This is best done when all available data is taken into account; hence the optimality of choosing 
                              
                                 λ
                                 =
                                 1
                              
                            and 
                              
                                 N
                                 =
                                 ∞
                              
                           .

In this section we consider the assumption that the one-step changes of the market process are bounded.

                              Proposition 4
                              
                                 If
                                 
                                    
                                       
                                          sup
                                          
                                             t
                                             ∈
                                             N
                                          
                                       
                                       
                                          |
                                          M
                                          
                                             (
                                             t
                                             )
                                          
                                          −
                                          M
                                          
                                             (
                                             t
                                             +
                                             1
                                             )
                                          
                                          |
                                       
                                       ≤
                                       d
                                    
                                  
                                 a.s., for some d > 0, then
                                 
                                    
                                       (20)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         λ
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            
                                                               1
                                                               −
                                                               λ
                                                            
                                                            
                                                               1
                                                               +
                                                               λ
                                                            
                                                         
                                                         +
                                                         
                                                            d
                                                            2
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  (
                                                                  1
                                                                  −
                                                                  λ
                                                                  )
                                                               
                                                               2
                                                            
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (21)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            1
                                                            N
                                                         
                                                         +
                                                         
                                                            1
                                                            4
                                                         
                                                         
                                                            d
                                                            2
                                                         
                                                         
                                                            
                                                               (
                                                               N
                                                               +
                                                               1
                                                               )
                                                            
                                                            2
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 for all λ ∈ [0, 1], 
                                    
                                       N
                                       ∈
                                       
                                          N
                                          
                                             ≥
                                             2
                                          
                                       
                                       ∪
                                       
                                          {
                                          ∞
                                          }
                                       
                                       ,
                                    
                                  
                                 where we write
                                 
                                    
                                       1
                                       /
                                       ∞
                                       =
                                       0
                                    
                                 
                                 .
                              

Consider the upper bound (20). The derivative of 
                              
                                 
                                    σ
                                    2
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       λ
                                       )
                                    
                                 
                                 +
                                 
                                    d
                                    2
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    
                                       −
                                       2
                                    
                                 
                              
                            w.r.t. λ ∈ (0, 1) is zero if and only if 
                              
                                 
                                    
                                       (
                                       σ
                                       /
                                       d
                                       )
                                    
                                    2
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    3
                                 
                                 =
                                 
                                    
                                       (
                                       1
                                       +
                                       λ
                                       )
                                    
                                    2
                                 
                              
                           . Since 
                              
                                 
                                    (
                                    1
                                    −
                                    λ
                                    )
                                 
                                 3
                              
                            is decreasing and 
                              
                                 
                                    (
                                    1
                                    +
                                    λ
                                    )
                                 
                                 2
                              
                            is increasing in λ, we have the following possibilities:

                              
                                 1.
                                 (σ/d)2 ≤ 1. Then 
                                       
                                          
                                             σ
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                (
                                                1
                                                +
                                                λ
                                                )
                                             
                                          
                                          +
                                          
                                             d
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                −
                                                2
                                             
                                          
                                       
                                     is increasing on λ ∈ (0, 1), and the righthandside of (20) is minimized by taking 
                                       
                                          λ
                                          =
                                          0
                                       
                                    .

(σ/d)2 > 1. Then there is a unique λ
                                    * ∈ (0, 1) that minimizes 
                                       
                                          
                                             σ
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                (
                                                1
                                                +
                                                λ
                                                )
                                             
                                          
                                          +
                                          
                                             d
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                −
                                                2
                                             
                                          
                                       
                                    . Although an explicit expression exists for λ
                                    *, it is rather complicated, and it is not informative to state it here. The value of λ
                                    * can be computed by solving a cubic equation.

Now consider the upper bound (21). The expression 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    N
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 
                                    d
                                    2
                                 
                                 
                                    
                                       (
                                       N
                                       +
                                       1
                                       )
                                    
                                    2
                                 
                              
                            on the righthandside of (21) is minimized by choosing N as the solution to 
                              
                                 
                                    N
                                    2
                                 
                                 
                                    (
                                    N
                                    +
                                    1
                                    )
                                 
                                 =
                                 2
                                 
                                    
                                       (
                                       σ
                                       /
                                       d
                                       )
                                    
                                    2
                                 
                                 ,
                              
                            which follows by taking the derivative w.r.t. N and some basic algebraic manipulations. It can easily be shown that there is a unique solution N
                           * > 0, at which the minimum is attained, and that 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    N
                                 
                                 +
                                 c
                                 
                                    (
                                    N
                                    )
                                 
                              
                            is minimized by choosing N equal to either ⌊N
                           *⌋ or ⌈N
                           *⌉. If (σ/d)2 ≤ 10/4 then the optimal N equals 1, if (σ/d)2 > 10/4 then the optimal N is strictly larger than 1. Fig. 1
                            shows the relation between (σ/d)2 and the values of λ
                           *, N
                           * that minimize the righthandside of (20) and (21).

The quantity (σ/d)2 serves as a proxy for the volatility of the market process 
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            relative to the variance of the disturbance terms 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                           . Both for Φλ
                            and ΦN
                            one can show that the optimal choice of λ and N is monotone increasing in this quantity (σ/d)2. The larger the volatility of the market compared to the variance of the disturbance terms, the fewer data should be used to estimate the market. If (σ/d)2 is sufficiently small, then the market fluctuations are quite large relative to the variance of the disturbance terms, and it is optimal to take only the most recent data point into account to estimate the market.

In this section we consider assumptions on the maximum probability that the market value changes.

                              Proposition 5
                              
                                 If
                                 
                                    
                                       P
                                       
                                          (
                                          M
                                          (
                                          t
                                          +
                                          1
                                          )
                                          ≠
                                          M
                                          (
                                          t
                                          )
                                          )
                                       
                                       ≤
                                       ϵ
                                    
                                  
                                 for all
                                 
                                    
                                       t
                                       ∈
                                       N
                                    
                                  
                                 and some
                                 
                                    
                                       ϵ
                                       ≥
                                       0
                                       ,
                                    
                                  
                                 and in addition
                                 
                                    
                                       
                                          sup
                                          
                                             t
                                             ∈
                                             N
                                          
                                       
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       −
                                       
                                          inf
                                          
                                             t
                                             ∈
                                             N
                                          
                                       
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       d
                                    
                                  
                                 for some d > 0, then
                                 
                                    
                                       (22)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         λ
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            
                                                               1
                                                               −
                                                               λ
                                                            
                                                            
                                                               1
                                                               +
                                                               λ
                                                            
                                                         
                                                         +
                                                         
                                                            d
                                                            2
                                                         
                                                         ϵ
                                                         
                                                            1
                                                            
                                                               (
                                                               1
                                                               −
                                                               
                                                                  λ
                                                                  2
                                                               
                                                               )
                                                            
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (23)
                                       
                                          
                                             
                                                
                                                   
                                                      LongRunAverageRegret
                                                      (
                                                      
                                                         Φ
                                                         N
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ≤
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                      
                                                         [
                                                         
                                                            σ
                                                            2
                                                         
                                                         
                                                            1
                                                            N
                                                         
                                                         +
                                                         
                                                            d
                                                            2
                                                         
                                                         ϵ
                                                         
                                                            
                                                               (
                                                               N
                                                               +
                                                               1
                                                               )
                                                               (
                                                               2
                                                               N
                                                               +
                                                               1
                                                               )
                                                            
                                                            
                                                               6
                                                               N
                                                            
                                                         
                                                         ]
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 for all λ ∈ [0, 1], 
                                    
                                       N
                                       ∈
                                       
                                          N
                                          
                                             ≥
                                             2
                                          
                                       
                                       ∪
                                       
                                          {
                                          ∞
                                          }
                                       
                                       ,
                                    
                                  
                                 where we write
                                 
                                    
                                       1
                                       /
                                       ∞
                                       =
                                       0
                                    
                                 
                                 .
                              

Consider the upper bound (22). The derivative of 
                              
                                 
                                    σ
                                    2
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       λ
                                       )
                                    
                                 
                                 +
                                 
                                    d
                                    2
                                 
                                 ϵ
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          λ
                                          2
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                              
                            w.r.t. λ ∈ (0, 1) is zero if and only if 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    
                                       
                                          d
                                          2
                                       
                                       ϵ
                                    
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          λ
                                          2
                                       
                                       )
                                    
                                    2
                                 
                                 =
                                 λ
                                 
                                    
                                       (
                                       1
                                       +
                                       λ
                                       )
                                    
                                    2
                                 
                              
                           ; this follows from basic algebraic manipulations. Since 
                              
                                 
                                    (
                                    1
                                    −
                                    
                                       λ
                                       2
                                    
                                    )
                                 
                                 2
                              
                            is decreasing and 
                              
                                 λ
                                 
                                    
                                       (
                                       1
                                       +
                                       λ
                                       )
                                    
                                    2
                                 
                              
                            is increasing in λ, we have the following possibilities:

                              
                                 1.
                                 
                                    
                                       
                                          
                                             
                                                σ
                                                2
                                             
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                             
                                          
                                          ≤
                                          1
                                       
                                    . Then 
                                       
                                          
                                             σ
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                (
                                                1
                                                +
                                                λ
                                                )
                                             
                                          
                                          +
                                          
                                             d
                                             2
                                          
                                          ϵ
                                          
                                             
                                                (
                                                1
                                                −
                                                
                                                   λ
                                                   2
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                     is increasing on λ ∈ (0, 1), and the righthandside of (22) is minimized by 
                                       
                                          λ
                                          =
                                          0
                                       
                                    .


                                    
                                       
                                          
                                             
                                                σ
                                                2
                                             
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                             
                                          
                                          >
                                          1
                                       
                                    . Then there is a unique λ
                                    * ∈ (0, 1) that minimizes 
                                       
                                          
                                             σ
                                             2
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                λ
                                                )
                                             
                                             
                                                (
                                                1
                                                +
                                                λ
                                                )
                                             
                                          
                                          +
                                          
                                             d
                                             2
                                          
                                          ϵ
                                          
                                             
                                                (
                                                1
                                                −
                                                
                                                   λ
                                                   2
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    . It is the unique solution in (0, 1) of the quartic equation 
                                       
                                          
                                             
                                                σ
                                                2
                                             
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                −
                                                
                                                   λ
                                                   2
                                                
                                                )
                                             
                                             2
                                          
                                          =
                                          λ
                                          
                                             
                                                (
                                                1
                                                +
                                                λ
                                                )
                                             
                                             2
                                          
                                          ,
                                       
                                     which can easily be solved numerically.

Now consider the upper bound (23). The expression 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    N
                                 
                                 +
                                 
                                    d
                                    2
                                 
                                 ϵ
                                 
                                    
                                       (
                                       N
                                       +
                                       1
                                       )
                                       (
                                       2
                                       N
                                       +
                                       1
                                       )
                                    
                                    
                                       6
                                       N
                                    
                                 
                              
                            is minimized on 
                              
                                 R
                                 
                                    +
                                    +
                                 
                              
                            by choosing 
                              
                                 
                                    N
                                    *
                                 
                                 =
                                 
                                    
                                       
                                          
                                             3
                                             
                                                σ
                                                2
                                             
                                          
                                          
                                             
                                                d
                                                2
                                             
                                             ϵ
                                          
                                       
                                       +
                                       
                                          1
                                          2
                                       
                                    
                                 
                                 ,
                              
                            and the optimal N is equal to either ⌊N
                           *⌋ or ⌈N
                           *⌉. In addition, one can show that the optimal N equals 1 if 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    
                                       
                                          d
                                          2
                                       
                                       ϵ
                                    
                                 
                                 ≤
                                 
                                    1
                                    2
                                 
                                 ,
                              
                            and is strictly larger than 1 if 
                              
                                 
                                    
                                       σ
                                       2
                                    
                                    
                                       
                                          d
                                          2
                                       
                                       ϵ
                                    
                                 
                                 >
                                 
                                    1
                                    2
                                 
                              
                           .

The quantity 
                              
                                 
                                    σ
                                    2
                                 
                                 
                                    
                                       d
                                       2
                                    
                                    ϵ
                                 
                              
                            serves as a proxy for the volatility of the market process 
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            relative to the variance of the disturbance terms 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                           . The effect of 
                              
                                 
                                    σ
                                    2
                                 
                                 
                                    
                                       d
                                       2
                                    
                                    ϵ
                                 
                              
                            on λ
                           * and N
                           * is shown in Fig. 2
                           . It shows that the smaller the volatility of the market relative to natural fluctuations of demand (e.g. the larger 
                              
                                 
                                    σ
                                    2
                                 
                                 
                                    
                                       d
                                       2
                                    
                                    ϵ
                                 
                              
                           ), the more data should be taken into account to estimate the market process.

In this section, we describe two numerical experiments that illustrate the method of hedging against changes outlined in Section 3. In the first we consider pricing with the Bass model for the market process. In the second we consider pricing in a setting with price-changing competitors.

The Bass model (Bass, (1969)) is a widely-used model to describe the life-cycle or diffusion of an innovative product. An important property of this model is that the market process M(t) is dependent on the realized cumulative sales up to time t.

The model for M(t) is

                                 
                                    
                                       
                                          M
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          max
                                          
                                             {
                                             0
                                             ,
                                             a
                                             +
                                             b
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                             
                                                d
                                                i
                                             
                                             +
                                             c
                                             
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      d
                                                      i
                                                   
                                                   )
                                                
                                                2
                                             
                                             }
                                          
                                          ,
                                       
                                    
                                 
                              cf. Eq. (4) of Dodds (1973). We choose 
                                 
                                    a
                                    =
                                    33.6
                                    ,
                                 
                              
                              
                                 
                                    c
                                    =
                                    −
                                    
                                       10
                                       
                                          −
                                          6
                                       
                                    
                                 
                               and 
                                 
                                    b
                                    =
                                    0.0116
                                    ,
                                 
                               and set 
                                 
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    −
                                    p
                                 
                               for all 
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 
                                    
                                       p
                                       l
                                    
                                    =
                                    1
                                 
                               and 
                                 
                                    
                                       p
                                       h
                                    
                                    =
                                    50
                                 
                              . Let 
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               be i.i.d. realizations of a standard normal distribution. The characteristic shape of the market that arises from this model is depicted in Fig. 3
                              . The solid lines denote a sample path of M(t), the dashed lines a sample path of the estimates 
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       λ
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       N
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              .

For each 
                                 
                                    λ
                                    ∈
                                    {
                                    0.05
                                    ,
                                    0.10
                                    ,
                                    0.15
                                    ,
                                    …
                                    ,
                                    0.90
                                    }
                                 
                               we run 1000 simulations of the policy Φλ
                              , and for all 
                                 
                                    N
                                    ∈
                                    {
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    ,
                                    …
                                    ,
                                    25
                                    }
                                    ,
                                 
                               we run 1000 simulations of ΦN
                              .

@&#RESULTS@&#

The solid lines in Fig. 4
                               show the simulation-average of AverageRegret at 
                                 
                                    t
                                    =
                                    500
                                 
                               for both Φλ
                               and ΦN
                              , at different values of λ. The dashed lines show the upper bounds 
                                 
                                    2
                                    
                                       K
                                       0
                                    
                                    
                                       (
                                       
                                          σ
                                          2
                                       
                                       
                                          
                                             1
                                             −
                                             λ
                                          
                                          
                                             1
                                             +
                                             λ
                                          
                                       
                                       +
                                       
                                          c
                                          
                                             (
                                             I
                                             )
                                          
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                       )
                                    
                                 
                               for Φλ
                              , and 
                                 
                                    2
                                    
                                       K
                                       0
                                    
                                    
                                       (
                                       
                                          σ
                                          2
                                       
                                       /
                                       N
                                       +
                                       
                                          c
                                          
                                             (
                                             I
                                             I
                                             )
                                          
                                       
                                       
                                          (
                                          N
                                          )
                                       
                                       )
                                    
                                 
                               for ΦN
                              , where c
                              (I)(λ) and c
                              (II)(N) are as in Section 3.3.2, 
                                 
                                    
                                       σ
                                       2
                                    
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       K
                                       0
                                    
                                    =
                                    1
                                    /
                                    4
                                    ,
                                 
                               and 
                                 
                                    d
                                    =
                                    0.27
                                 
                               (this was the largest observed value of 
                                 
                                    |
                                    M
                                    (
                                    t
                                    +
                                    1
                                    )
                                    −
                                    M
                                    (
                                    t
                                    )
                                    |
                                 
                               over all t and all simulations. Of course, this quantity is in practice not observed by the seller, and a larger value of d just shifts the dashed lines upward in the figure).

The optimal value of λ according to our upper bound equals 
                                 
                                    λ
                                    =
                                    0.45
                                    ,
                                 
                               with a corresponding upper bound on the regret of 0.31. The simulation average of AverageRegret(Φ
                              0.45, 500) was equal to 0.27. The optimal value of λ according to the simulations, was 
                                 
                                    λ
                                    =
                                    0.60
                                    ,
                                 
                               with a simulation average of AverageRegret(Φ
                              0.60, 500) equal to 0.26.

The optimal value of N according to our upper bound equals 
                                 
                                    N
                                    =
                                    3
                                    ,
                                 
                               with a corresponding upper bound on the regret of 0.32. The simulation average of AverageRegret(Φ
                              3, 500) was equal to 0.27. The optimal value of N according to the simulations, was 
                                 
                                    N
                                    =
                                    4
                                    ,
                                 
                               with a simulation average of AverageRegret(Φ
                              4, 500) equal to 0.26.


                           Fig. 3 shows that the range of values that the market process attains can be quite large. A robust optimization approach would give very conservative prices, and would lead to an average regret that is substantially larger than what is achieved by our pricing method. Neglecting the variability of M(t) in the estimation step (by taking 
                              
                                 λ
                                 =
                                 1
                              
                            or 
                              
                                 N
                                 =
                                 ∞
                              
                           ) is detrimental as well, as illustrated by Fig. 4. Thus, in this scenario, taking into account the changing nature of the market process improves the performance of the firm significantly.

Suppose the firm is acting in an environment where several competing companies are selling substitute products on the market. The firm knows that the competitors occasionally update their selling prices, but is not aware of the moments at which these changes occur.

In particular, consider the following case. The firm assumes that in each period, the probability that the market process changes because of the behavior of competitors, is not more than 
                           ϵ
                        . If a change occurs, the maximum jump is assumed to be not more than d.

We choose 
                                 
                                    
                                       g
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    −
                                    p
                                 
                               for all 
                                 
                                    t
                                    ∈
                                    N
                                    ,
                                 
                              
                              
                                 
                                    
                                       p
                                       l
                                    
                                    =
                                    1
                                 
                               and 
                                 
                                    
                                       p
                                       h
                                    
                                    =
                                    50
                                    ,
                                 
                               and let 
                                 
                                    ϵ
                                    =
                                    0.02
                                    ,
                                 
                              
                              
                                 
                                    d
                                    =
                                    5
                                 
                              . At each period t a realization zt
                               of a uniformly distributed random variable on [0, 1] is drawn. If zt
                               ≥ 0.02 then 
                                 
                                    M
                                    (
                                    t
                                    )
                                    =
                                    M
                                    (
                                    t
                                    −
                                    1
                                    )
                                 
                              ; otherwise, M(t) is drawn uniformly from the interval [30, 35]. Let 
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               be i.i.d. realizations of a standard normal distribution. (Note that these differ from the constant 
                                 ϵ
                               determined by the firm).

For each 
                                 
                                    λ
                                    ∈
                                    {
                                    0.10
                                    ,
                                    0.15
                                    ,
                                    0.20
                                    ,
                                    …
                                    ,
                                    0.95
                                    }
                                 
                               we run 1000 simulations of the policy Φλ
                              , and for all 
                                 
                                    N
                                    ∈
                                    {
                                    2
                                    ,
                                    3
                                    ,
                                    4
                                    ,
                                    …
                                    ,
                                    25
                                    }
                                    ,
                                 
                               we run 1000 simulations of ΦN
                              .

@&#RESULTS@&#

The characteristic the shape of the market that arises from this model, is depicted in Fig. 5
                              . The solid lines denote a sample path of M(t), the dashed lines a sample path of the estimates 
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       λ
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                               and 
                                 
                                    
                                       
                                          M
                                          ^
                                       
                                       N
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                 
                              .

The solid lines in Fig. 6
                               show the simulation average of AverageRegret at 
                                 
                                    t
                                    =
                                    500
                                 
                               for both Φλ
                               and ΦN
                              , at different values of λ. The dashed lines show the upper bounds 
                                 
                                    
                                       K
                                       0
                                    
                                    
                                       (
                                       
                                          σ
                                          2
                                       
                                       
                                          
                                             1
                                             −
                                             λ
                                          
                                          
                                             1
                                             +
                                             λ
                                          
                                       
                                       +
                                       
                                          c
                                          
                                             (
                                             I
                                             )
                                          
                                       
                                       
                                          (
                                          λ
                                          )
                                       
                                       )
                                    
                                 
                               for Φλ
                              , and 
                                 
                                    
                                       K
                                       0
                                    
                                    
                                       (
                                       
                                          σ
                                          2
                                       
                                       /
                                       N
                                       +
                                       
                                          c
                                          
                                             (
                                             I
                                             I
                                             )
                                          
                                       
                                       
                                          (
                                          N
                                          )
                                       
                                       )
                                    
                                 
                               for ΦN
                              , where c
                              (I)(λ) and c
                              (II)(N) are as in Section 3.3.3, 
                                 
                                    
                                       σ
                                       2
                                    
                                    =
                                    1
                                    ,
                                 
                              
                              
                                 
                                    
                                       K
                                       0
                                    
                                    =
                                    1
                                    /
                                    4
                                    ,
                                 
                              
                              
                                 
                                    ϵ
                                    =
                                    0.02
                                    ,
                                 
                               and 
                                 
                                    d
                                    =
                                    5
                                 
                              . Note that 
                                 
                                    
                                       (
                                       
                                          ϵ
                                          t
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               and 
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                               are here independent, and thus by Remark 6, the factor 2 in the righthandsides of (14) and (15) is not present.

The optimal value of λ according to our upper bound equals 
                                 
                                    λ
                                    =
                                    0.50
                                    ,
                                 
                               with a corresponding upper bound on the regret of 0.25. The simulation average of AverageRegret(Φ
                              0.50, 500) was equal to 0.11. The optimal value of λ according to the simulations, was 
                                 
                                    λ
                                    =
                                    0.75
                                    ,
                                 
                               with a simulation average of AverageRegret(Φ
                              0.75, 500) equal to 0.08.

The optimal value of N according to our upper bound equals 
                                 
                                    N
                                    =
                                    3
                                    ,
                                 
                               with a corresponding upper bound on the regret of 0.28. The simulation average of AverageRegret(Φ
                              3, 500) was equal to 0.12. The optimal value of N according to the simulations, was 
                                 
                                    N
                                    =
                                    6
                                    ,
                                 
                               with a simulation average of AverageRegret(Φ
                              6, 500) equal to 0.09.


                           Fig. 6 illustrates that taking into account all available data (i.e. 
                              
                                 λ
                                 =
                                 1
                              
                            or 
                              
                                 N
                                 =
                                 ∞
                              
                           ) would lead to much larger regret than obtained at the optimal λ and N. Thus, similar to scenario (ii), taking into account the changing nature of the market process leads to a significant profit improvement. A robust maximin pricing policy would be to use

                              
                                 
                                    
                                       
                                          
                                             arg
                                             
                                             max
                                          
                                          
                                             p
                                             ∈
                                             [
                                             1
                                             ,
                                             50
                                             ]
                                          
                                       
                                       
                                          min
                                          
                                             M
                                             ∈
                                             [
                                             30
                                             ,
                                             35
                                             ]
                                          
                                       
                                       p
                                       
                                          (
                                          M
                                          −
                                          p
                                          )
                                       
                                       =
                                       
                                          
                                             arg
                                             
                                             max
                                          
                                          
                                             p
                                             ∈
                                             [
                                             1
                                             ,
                                             50
                                             ]
                                          
                                       
                                       p
                                       
                                          (
                                          30
                                          −
                                          p
                                          )
                                       
                                       =
                                       15
                                    
                                 
                              
                           throughout the time horizon. This leads to an average regret of 1.1509, more than three times higher than the average regret of 0.3189 achieved by our method. Even assuming that M(t) is fixed and equal to 32.5 (and using the corresponding optimal price 
                              
                                 p
                                 =
                                 16.75
                              
                            throughout the time horizon) would, in our simulations, lead to an average regret of 1.0745; still more than three times higher than what is achieved by our method.

In this paper we study the problem of dynamic pricing and learning in a changing market environment. This is a major departure from the existing literature on dynamic pricing and learning, in which one practically always assumes that the market is stable. We consider a setting where the market process is modeled as a stochastic process, whose value is not directly observed by the firm. We discuss two suitable estimation methods, with a forgetting factor and with a sliding window, and prove bounds on the expected estimation errors. Subsequently we introduce a methodology that enables the firm to hedge against changes in the market. In particular, we show how assumptions on the market process, determined in advance by the firm, translate into upper bounds on the (long run) average regret, and, in addition, how these bounds can be used to derive the optimal forgetting factor or window size. We show in three concrete scenarios how the methodology works, and provide numerical illustrations that show the good performance of the method in the Bass-market model and in a setting with price-changing competitors.

An important insight from our results is that taking into account the fluctuating nature of the market can significantly improve the pricing decisions of a firm.

Our results points to several interesting directions for future research. Related to the dynamic pricing model, an interesting extension would be to assume that both σ
                     2 and gt
                     (p) are unknown, and have to be learned as well. To begin with, one could assume the parametric form 
                        
                           
                              g
                              t
                           
                           
                              (
                              p
                              )
                           
                           =
                           g
                           
                              (
                              p
                              )
                           
                           =
                           −
                           b
                           p
                        
                      for some b > 0. One step further is to consider the case that σ
                     2 and b themselves are also varying over time. Even for the bound functions c
                     (I)(λ) and c
                     (II)(N), information about their behavior might be derived from sales data, by estimating the impact Iλ
                     (t) and IN
                     (t). An ad-hoc method to do so would be to replace all terms M(i) in the definition of Iλ
                     (t) by their estimate 
                        
                           
                              
                                 M
                                 ^
                              
                              i
                           
                           
                              (
                              t
                              )
                           
                           ,
                        
                      and a similar procedure to estimate IN
                     (t).

Finally, we believe that the methodology developed in this paper might be useful not only for the considered dynamic pricing problem, but also for other types of problems that involve simultaneous learning and optimizing in a changing environment. Two examples are stochastic inventory control problems (Huh, Levi, Rusmevichientong, & Orlin, 2011; Huh & Rusmevichientong, 2009), or dynamic pricing with finite inventories (Besbes & Zeevi, 2009; den Boer & Zwart, 2015).


                     
                        Proof of Proposition 1
                        
                           Eq. (7) can be rewritten as

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      M
                                                      ^
                                                   
                                                   λ
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                M
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         t
                                                      
                                                      
                                                         ϵ
                                                         i
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         t
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         t
                                                      
                                                      
                                                         (
                                                         M
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         t
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Note that 
                              
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          t
                                       
                                       
                                          λ
                                          
                                             t
                                             −
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          λ
                                          t
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    1
                                    −
                                    λ
                                    )
                                 
                                 1
                                 
                                    (
                                    λ
                                    <
                                    1
                                    )
                                 
                                 +
                                 
                                    1
                                    t
                                 
                                 1
                                 
                                    (
                                    λ
                                    =
                                    1
                                    )
                                 
                              
                            and 
                              
                                 E
                                 
                                    [
                                    
                                       ϵ
                                       i
                                    
                                    
                                       ϵ
                                       j
                                    
                                    ]
                                 
                                 =
                                 E
                                 
                                    [
                                    
                                       ϵ
                                       i
                                    
                                    E
                                    
                                       [
                                       
                                          ϵ
                                          j
                                       
                                       ∣
                                       
                                          F
                                          i
                                       
                                       ]
                                    
                                    ]
                                 
                                 =
                                 0
                              
                            whenever i < j. As a result,

                              
                                 
                                    
                                       
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            t
                                                         
                                                         
                                                            ϵ
                                                            i
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               −
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   t
                                                
                                                
                                                   λ
                                                   
                                                      2
                                                      (
                                                      t
                                                      −
                                                      i
                                                      )
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      ϵ
                                                      i
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            
                                                               2
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            2
                                                         
                                                      
                                                   
                                                   1
                                                   
                                                      (
                                                      λ
                                                      <
                                                      1
                                                      )
                                                   
                                                   +
                                                   t
                                                   1
                                                   
                                                      (
                                                      λ
                                                      =
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and (10) follows using 
                              
                                 
                                    
                                       |
                                       a
                                       +
                                       b
                                       |
                                    
                                    2
                                 
                                 ≤
                                 2
                                 
                                    a
                                    2
                                 
                                 +
                                 2
                                 
                                    b
                                    2
                                 
                              
                            for all 
                              
                                 a
                                 ,
                                 b
                                 ∈
                                 R
                                 ,
                              
                            and

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            
                                                               2
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         −
                                                         
                                                            λ
                                                            2
                                                         
                                                      
                                                   
                                                   1
                                                   
                                                      (
                                                      λ
                                                      <
                                                      1
                                                      )
                                                   
                                                   
                                                   +
                                                   
                                                   t
                                                   1
                                                   
                                                      (
                                                      λ
                                                      
                                                      =
                                                      
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      
                                                      +
                                                      
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         =
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                   
                                                      1
                                                      +
                                                      λ
                                                   
                                                
                                                
                                                   
                                                      1
                                                      +
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                
                                                1
                                                
                                                   (
                                                   λ
                                                   <
                                                   1
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   t
                                                
                                                1
                                                
                                                   (
                                                   λ
                                                   =
                                                   1
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           If 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            and 
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            are independent, then 
                              
                                 E
                                 [
                                 
                                    ϵ
                                    i
                                 
                                 M
                                 
                                    (
                                    j
                                    )
                                 
                                 ]
                                 =
                                 0
                              
                            for all 
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 N
                                 ,
                              
                            and (12) follows from

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            λ
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                =
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  ϵ
                                                                  i
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  (
                                                                  M
                                                                  
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                                  −
                                                                  M
                                                                  
                                                                     (
                                                                     t
                                                                     +
                                                                     1
                                                                     )
                                                                  
                                                                  )
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                ≤
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               t
                                                            
                                                            
                                                               λ
                                                               
                                                                  t
                                                                  −
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  i
                                                                  =
                                                                  1
                                                               
                                                               t
                                                            
                                                            
                                                               λ
                                                               
                                                                  t
                                                                  −
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  (
                                                                  M
                                                                  
                                                                     (
                                                                     i
                                                                     )
                                                                  
                                                                  −
                                                                  M
                                                                  
                                                                     (
                                                                     t
                                                                     +
                                                                     1
                                                                     )
                                                                  
                                                                  )
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     1
                                                                  
                                                                  t
                                                               
                                                               
                                                                  λ
                                                                  
                                                                     t
                                                                     −
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           with equality if 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            is homoscedastic.

Similarly, Eq. (9) can be rewritten as

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      M
                                                      ^
                                                   
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                −
                                                M
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   1
                                                   
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                         +
                                                         
                                                            
                                                               (
                                                               t
                                                               −
                                                               N
                                                               )
                                                            
                                                            +
                                                         
                                                      
                                                      t
                                                   
                                                   
                                                      ϵ
                                                      i
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                         +
                                                         
                                                            
                                                               (
                                                               t
                                                               −
                                                               N
                                                               )
                                                            
                                                            +
                                                         
                                                      
                                                      t
                                                   
                                                   M
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   −
                                                   M
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           Eq. (11) follows using 
                              
                                 
                                    
                                       |
                                       a
                                       +
                                       b
                                       |
                                    
                                    2
                                 
                                 ≤
                                 2
                                 
                                    a
                                    2
                                 
                                 +
                                 2
                                 
                                    b
                                    2
                                 
                              
                            for all 
                              
                                 a
                                 ,
                                 b
                                 ∈
                                 R
                                 ,
                              
                            and by noting

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               +
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         
                                                            ϵ
                                                            i
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   1
                                                   
                                                      min
                                                      
                                                         
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                      +
                                                      
                                                         
                                                            (
                                                            t
                                                            −
                                                            N
                                                            )
                                                         
                                                         +
                                                      
                                                   
                                                   t
                                                
                                                E
                                                
                                                   [
                                                   
                                                      ϵ
                                                      i
                                                      2
                                                   
                                                   ]
                                                
                                                ≤
                                                
                                                   σ
                                                   2
                                                
                                                /
                                                min
                                                
                                                   {
                                                   N
                                                   ,
                                                   t
                                                   }
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           If 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            and 
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            are independent, then 
                              
                                 E
                                 [
                                 
                                    ϵ
                                    i
                                 
                                 M
                                 
                                    (
                                    j
                                    )
                                 
                                 ]
                                 =
                                 0
                              
                            for all 
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 N
                                 ,
                              
                            and (13) follows from

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            N
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                =
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               +
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         
                                                            ϵ
                                                            i
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               +
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         M
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   
                                                      |
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                            +
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         t
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                +
                                                E
                                                
                                                   [
                                                   
                                                      |
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                            +
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         t
                                                      
                                                      M
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                         −
                                                         M
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           with equality if 
                              
                                 
                                    (
                                    
                                       ϵ
                                       t
                                    
                                    )
                                 
                                 
                                    t
                                    ∈
                                    N
                                 
                              
                            is homoscedastic.□

We prove the theorem in two steps. In step 1, we show that there exists a K
                           0 > 0 such that for all 
                              
                                 M
                                 ∈
                                 M
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    ′
                                 
                                 ∈
                                 R
                              
                            and for all 
                              
                                 t
                                 ∈
                                 N
                                 ,
                              
                           
                           
                              
                                 (24)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                ≤
                                                
                                                   K
                                                   0
                                                
                                                
                                                   
                                                      (
                                                      M
                                                      −
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           In step 2 we apply this result with 
                              
                                 M
                                 =
                                 M
                                 (
                                 t
                                 )
                                 ,
                              
                           
                           
                              
                                 
                                    M
                                    ′
                                 
                                 =
                                 
                                    
                                       M
                                       ^
                                    
                                    λ
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                            or 
                              
                                 
                                    M
                                    ′
                                 
                                 =
                                 
                                    
                                       M
                                       ^
                                    
                                    N
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ,
                              
                            to obtain the regret bounds.


                           Step 1. Fix an attainable value 
                              
                                 M
                                 ∈
                                 M
                              
                            of the market process, fix 
                              
                                 t
                                 ∈
                                 N
                                 ,
                              
                            and let 
                              
                                 
                                    r
                                    t
                                    ′
                                 
                                 
                                    (
                                    p
                                    ,
                                    M
                                    )
                                 
                              
                            and 
                              
                                 
                                    r
                                    t
                                    
                                       ′
                                       ′
                                    
                                 
                                 
                                    (
                                    p
                                    ,
                                    M
                                    )
                                 
                              
                            denote the first and second derivative of rt
                           (p, M) w.r.t. p. Let 
                              
                                 
                                    M
                                    ′
                                 
                                 ∈
                                 R
                              
                           .

Case 1: 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 =
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                           . Then by assumption 
                              
                                 
                                    r
                                    t
                                    ′
                                 
                                 
                                    (
                                    
                                       p
                                       t
                                       *
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            and a Taylor series expansion yields

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   M
                                                   )
                                                
                                                =
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   r
                                                   t
                                                   
                                                      ′
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      ˜
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         M
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           for some 
                              
                                 p
                                 ˜
                              
                            on the line segment between p and 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                           . Let

                              
                                 
                                    
                                       
                                          K
                                          t
                                       
                                       =
                                       
                                          sup
                                          
                                             p
                                             ∈
                                             [
                                             
                                                p
                                                l
                                             
                                             ,
                                             
                                                p
                                                h
                                             
                                             ]
                                          
                                       
                                       
                                          |
                                       
                                       
                                          r
                                          t
                                          
                                             ′
                                             ′
                                          
                                       
                                       
                                          
                                             (
                                             p
                                             ,
                                             M
                                             )
                                          
                                          |
                                          =
                                       
                                       
                                          sup
                                          
                                             p
                                             ∈
                                             [
                                             
                                                p
                                                l
                                             
                                             ,
                                             
                                                p
                                                h
                                             
                                             ]
                                          
                                       
                                       
                                          |
                                          2
                                          
                                             g
                                             t
                                             ′
                                          
                                          
                                             (
                                             p
                                             )
                                          
                                          +
                                          
                                             g
                                             t
                                             
                                                ′
                                                ′
                                             
                                          
                                          
                                             (
                                             p
                                             )
                                          
                                          |
                                       
                                       ,
                                    
                                 
                              
                           and note that Kt
                            is independent of M, and finite, because of the continuity of g′′(p). Then

                              
                                 (25)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   p
                                                   ,
                                                   M
                                                   )
                                                
                                                ≤
                                                
                                                   
                                                      K
                                                      t
                                                   
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      p
                                                      −
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         M
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                p
                                                ∈
                                                
                                                   [
                                                   
                                                      p
                                                      l
                                                   
                                                   ,
                                                   
                                                      p
                                                      h
                                                   
                                                   ]
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Write 
                              
                                 
                                    h
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 =
                                 −
                                 
                                    g
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 −
                                 p
                                 
                                    g
                                    t
                                    ′
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 ,
                              
                            and note that 
                              
                                 
                                    r
                                    t
                                    ′
                                 
                                 
                                    (
                                    p
                                    ,
                                    M
                                    )
                                 
                                 =
                                 M
                                 −
                                 
                                    h
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                              
                           . By assumption, for each 
                              
                                 M
                                 ∈
                                 M
                              
                            there is a unique 
                              
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                            such that 
                              
                                 
                                    h
                                    t
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 =
                                 M
                                 ,
                              
                            i.e. 
                              
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 =
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                            is well-defined. In addition, for all 
                              
                                 M
                                 ∈
                                 
                                    h
                                    t
                                 
                                 
                                    (
                                    
                                       [
                                       
                                          p
                                          l
                                       
                                       ,
                                       
                                          p
                                          h
                                       
                                       ]
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       h
                                       t
                                    
                                    
                                       (
                                       p
                                       )
                                    
                                    ∣
                                    p
                                    ∈
                                    
                                       [
                                       
                                          p
                                          l
                                       
                                       ,
                                       
                                          p
                                          h
                                       
                                       ]
                                    
                                    }
                                 
                                 ,
                              
                            we have 
                              
                                 
                                    ∂
                                    
                                       ∂
                                       M
                                    
                                 
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          h
                                          t
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    ′
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 =
                                 1
                                 /
                                 
                                    h
                                    t
                                    ′
                                 
                                 
                                    (
                                    
                                       h
                                       t
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    )
                                 
                                 =
                                 −
                                 1
                                 /
                                 
                                    r
                                    t
                                    
                                       ′
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       p
                                       t
                                       *
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 >
                                 0
                              
                           . Thus, 
                              
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                            is continuous, differentiable, and monotone increasing on M ∈ ht
                           ([pl, ph
                           ]). These properties imply the following: if there is an 
                              
                                 M
                                 ∈
                                 M
                              
                            s.t. 
                              
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 >
                                 
                                    p
                                    h
                                 
                                 ,
                              
                            then there is an Mh
                           (t) s.t. 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 >
                                 
                                    p
                                    h
                                 
                              
                            whenever M > Mh
                           (t), 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       M
                                       h
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    h
                                 
                                 ,
                              
                            and 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 <
                                 
                                    p
                                    h
                                 
                              
                            whenever M < Mh
                           (t). Similarly, if there is an 
                              
                                 M
                                 ∈
                                 M
                              
                            s.t. 
                              
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 <
                                 
                                    p
                                    l
                                 
                                 ,
                              
                            then there is an Ml
                           (t) < Mh
                           (t) s.t. 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 >
                                 
                                    p
                                    l
                                 
                              
                            whenever M > Ml
                           (t), 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       M
                                       l
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    l
                                 
                                 ,
                              
                            and 
                              
                                 
                                    h
                                    t
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 <
                                 
                                    p
                                    l
                                 
                              
                            whenever M < Ml
                           (t).

If 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 ,
                              
                            then a Taylor expansion yields

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   M
                                                   )
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             
                                                
                                                   =
                                                   |
                                                
                                                
                                                   h
                                                   t
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                −
                                                
                                                   h
                                                   t
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   M
                                                   )
                                                
                                                
                                                   |
                                                   ≤
                                                   |
                                                
                                                
                                                   M
                                                   ′
                                                
                                                
                                                   −
                                                   M
                                                   |
                                                
                                                
                                                   L
                                                   t
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    L
                                    t
                                 
                                 =
                                 
                                    sup
                                    
                                       M
                                       ∈
                                       
                                          h
                                          t
                                       
                                       
                                          (
                                          
                                             [
                                             
                                                p
                                                l
                                             
                                             ,
                                             
                                                p
                                                h
                                             
                                             ]
                                          
                                          )
                                       
                                    
                                 
                                 
                                    |
                                 
                                 
                                    
                                       (
                                       
                                          h
                                          t
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    ′
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    |
                                    =
                                    1
                                    /
                                 
                                 
                                    inf
                                    
                                       M
                                       ∈
                                       
                                          h
                                          t
                                       
                                       
                                          (
                                          
                                             [
                                             
                                                p
                                                l
                                             
                                             ,
                                             
                                                p
                                                h
                                             
                                             ]
                                          
                                          )
                                       
                                    
                                 
                                 
                                    |
                                    
                                       r
                                       t
                                       
                                          ′
                                          ′
                                       
                                    
                                    
                                       (
                                       
                                          p
                                          t
                                          *
                                       
                                       
                                          (
                                          M
                                          )
                                       
                                       ,
                                       M
                                       )
                                    
                                    |
                                 
                                 ,
                              
                            which is finite by assumption.

If 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 <
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 ,
                              
                            then 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    
                                       M
                                       h
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    h
                                 
                                 ,
                              
                            
                           M′ > Mh
                           (t), and

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   M
                                                   )
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   p
                                                   t
                                                   #
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   #
                                                
                                                
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   |
                                                   ≤
                                                   |
                                                
                                                
                                                   M
                                                   h
                                                
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   M
                                                   |
                                                
                                                
                                                   L
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   M
                                                   ′
                                                
                                                
                                                   −
                                                   M
                                                   |
                                                
                                                
                                                   L
                                                   t
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

If 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 >
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 ,
                              
                            then 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    
                                       M
                                       l
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    p
                                    l
                                 
                                 ,
                              
                            
                           M′ < Ml
                           (t), and

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   M
                                                   )
                                                
                                                
                                                   |
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   p
                                                   t
                                                   #
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      l
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   #
                                                
                                                
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   |
                                                   ≤
                                                   |
                                                
                                                
                                                   M
                                                   l
                                                
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   M
                                                   |
                                                
                                                
                                                   L
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   |
                                                
                                                
                                                   M
                                                   ′
                                                
                                                
                                                   −
                                                   M
                                                   |
                                                
                                                
                                                   L
                                                   t
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

It follows that 
                              
                                 
                                    |
                                 
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    
                                       M
                                       ′
                                    
                                    )
                                 
                                 −
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 
                                    |
                                    ≤
                                 
                                 
                                    L
                                    t
                                 
                                 
                                    |
                                    
                                       M
                                       ′
                                    
                                    −
                                    M
                                    |
                                 
                                 ,
                              
                            and thus by (25) we have

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                ≤
                                                
                                                   1
                                                   2
                                                
                                                
                                                   K
                                                   t
                                                
                                                
                                                   L
                                                   t
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      −
                                                      M
                                                      )
                                                   
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           for all M′ and all M ∈ ht
                           ([pl, ph
                           ]).

Case 2: 
                              
                                 
                                    p
                                    t
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 ≠
                                 
                                    p
                                    t
                                    #
                                 
                                 
                                    (
                                    M
                                    )
                                 
                              
                           . Then M ∉ [Ml
                           (t), Mh
                           (t)]. Suppose M > Mh
                           (t), the case M < Ml
                           (t) is treated likewise. If M′ > Mh
                           (t) then 
                              
                                 
                                    r
                                    t
                                 
                                 
                                    (
                                    
                                       p
                                       t
                                       *
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 −
                                 
                                    r
                                    t
                                 
                                 
                                    (
                                    
                                       p
                                       t
                                       *
                                    
                                    
                                       (
                                       
                                          M
                                          ′
                                       
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            suppose therefore M′ ≤ Mh
                           (t). We have

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                
                                                =
                                                
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         h
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   [
                                                   M
                                                   +
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            M
                                                            h
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   [
                                                   M
                                                   +
                                                   
                                                      g
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            M
                                                            ′
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         h
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                −
                                                
                                                   r
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                      *
                                                   
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      )
                                                   
                                                   ,
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                
                                                   +
                                                   (
                                                
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                   p
                                                   t
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   )
                                                
                                                
                                                   (
                                                   M
                                                   −
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   1
                                                   2
                                                
                                                
                                                   K
                                                   t
                                                
                                                
                                                   L
                                                   t
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      −
                                                      
                                                         M
                                                         h
                                                      
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   L
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   −
                                                   
                                                      M
                                                      ′
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   M
                                                   −
                                                   
                                                      M
                                                      h
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   (
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      K
                                                      t
                                                   
                                                   
                                                      L
                                                      t
                                                      2
                                                   
                                                   +
                                                   
                                                      1
                                                      4
                                                   
                                                   
                                                      L
                                                      t
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         ′
                                                      
                                                      −
                                                      M
                                                      )
                                                   
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where in the last inequality we use the fact 
                              
                                 x
                                 y
                                 ≤
                                 
                                    1
                                    4
                                 
                                 
                                    
                                       (
                                       x
                                       +
                                       y
                                       )
                                    
                                    2
                                 
                                 ,
                              
                           
                           
                              
                                 x
                                 ,
                                 y
                                 ∈
                                 R
                                 ,
                              
                            with 
                              
                                 x
                                 =
                                 
                                    M
                                    h
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    M
                                    ′
                                 
                                 ,
                              
                           
                           
                              
                                 y
                                 =
                                 M
                                 −
                                 
                                    M
                                    h
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                           .

This completes the proof of (24), with 
                              
                                 
                                    K
                                    0
                                 
                                 =
                                 
                                    sup
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 
                                    1
                                    2
                                 
                                 
                                    K
                                    t
                                 
                                 
                                    L
                                    t
                                    2
                                 
                                 +
                                 
                                    1
                                    4
                                 
                                 
                                    L
                                    t
                                 
                              
                           .


                           Step 2. By Proposition 1, we obtain

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                AverageRegret
                                                (
                                                
                                                   Φ
                                                   λ
                                                
                                                ,
                                                T
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         M
                                                         
                                                            (
                                                            t
                                                            
                                                            +
                                                            
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                      ,
                                                      M
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                   −
                                                   
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            λ
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      ,
                                                      M
                                                      
                                                         (
                                                         t
                                                         
                                                         +
                                                         
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            λ
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   [
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            λ
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            λ
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      
                                                      +
                                                      
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         
                                                         =
                                                         
                                                         1
                                                         )
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Since

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   λ
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      2
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   λ
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                
                                                +
                                                
                                                   ∫
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                
                                                d
                                                t
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                ≤
                                                
                                                   λ
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                
                                                +
                                                
                                                   
                                                      −
                                                      1
                                                   
                                                   
                                                      log
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                
                                                   ∫
                                                   
                                                      x
                                                      =
                                                      0
                                                   
                                                   λ
                                                
                                                
                                                   1
                                                   
                                                      1
                                                      −
                                                      x
                                                   
                                                
                                                d
                                                x
                                                
                                                =
                                                
                                                
                                                   λ
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                
                                                
                                                +
                                                
                                                
                                                   
                                                      log
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      log
                                                      (
                                                      λ
                                                      )
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           we have for λ < 1,

                              
                                 (27)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      (
                                                      1
                                                      +
                                                      λ
                                                      )
                                                   
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      +
                                                      
                                                         λ
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                      )
                                                   
                                                
                                                =
                                                
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                   
                                                      1
                                                      +
                                                      λ
                                                   
                                                
                                                +
                                                
                                                   2
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                   
                                                      1
                                                      +
                                                      λ
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ≤
                                                
                                                   
                                                      1
                                                      −
                                                      λ
                                                   
                                                   
                                                      1
                                                      +
                                                      λ
                                                   
                                                
                                                +
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         2
                                                         λ
                                                      
                                                      
                                                         1
                                                         +
                                                         λ
                                                      
                                                   
                                                   +
                                                   2
                                                   
                                                      
                                                         1
                                                         −
                                                         λ
                                                      
                                                      
                                                         1
                                                         +
                                                         λ
                                                      
                                                   
                                                   
                                                      
                                                         log
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         )
                                                      
                                                      
                                                         log
                                                         (
                                                         λ
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and thus

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                AverageRegret
                                                (
                                                
                                                   Φ
                                                   λ
                                                
                                                ,
                                                T
                                                )
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                2
                                                
                                                   K
                                                   0
                                                
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      
                                                         1
                                                         −
                                                         λ
                                                      
                                                      
                                                         1
                                                         +
                                                         λ
                                                      
                                                   
                                                   +
                                                   
                                                      1
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            2
                                                            λ
                                                         
                                                         
                                                            1
                                                            +
                                                            λ
                                                         
                                                      
                                                      +
                                                      2
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            +
                                                            λ
                                                         
                                                      
                                                      
                                                         
                                                            log
                                                            (
                                                            1
                                                            −
                                                            λ
                                                            )
                                                         
                                                         
                                                            log
                                                            (
                                                            λ
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                                1
                                                
                                                   (
                                                   λ
                                                   <
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             +
                                          
                                          
                                             
                                                2
                                                
                                                   K
                                                   0
                                                
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      
                                                         1
                                                         +
                                                         log
                                                         (
                                                         T
                                                         −
                                                         1
                                                         )
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   ]
                                                
                                                1
                                                
                                                   (
                                                   λ
                                                   =
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             +
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   λ
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In addition, we have

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                AverageRegret
                                                (
                                                
                                                   Φ
                                                   N
                                                
                                                ,
                                                T
                                                )
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         M
                                                         
                                                            (
                                                            t
                                                            
                                                            +
                                                            
                                                            1
                                                            )
                                                         
                                                         )
                                                      
                                                      ,
                                                      M
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                   −
                                                   
                                                   
                                                      r
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         p
                                                         t
                                                         *
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            N
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         )
                                                      
                                                      ,
                                                      M
                                                      
                                                         (
                                                         t
                                                         
                                                         +
                                                         
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            N
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         min
                                                         {
                                                         N
                                                         ,
                                                         t
                                                         }
                                                      
                                                   
                                                   +
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                2
                                                
                                                   K
                                                   0
                                                
                                                
                                                   σ
                                                   2
                                                
                                                
                                                   [
                                                   
                                                      
                                                         log
                                                         (
                                                         min
                                                         {
                                                         T
                                                         −
                                                         1
                                                         ,
                                                         N
                                                         }
                                                         )
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      1
                                                      
                                                         min
                                                         {
                                                         N
                                                         ,
                                                         T
                                                         −
                                                         1
                                                         }
                                                      
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   
                                                      2
                                                      
                                                         K
                                                         0
                                                      
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where we used

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   1
                                                   t
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      N
                                                      +
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   N
                                                
                                                ≤
                                                1
                                                +
                                                log
                                                
                                                   (
                                                   N
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                
                                                   
                                                      T
                                                      −
                                                      1
                                                      −
                                                      N
                                                   
                                                   N
                                                
                                                
                                                
                                                if
                                                
                                                T
                                                −
                                                1
                                                ≥
                                                N
                                                ,
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   t
                                                
                                                ≤
                                                1
                                                +
                                                log
                                                
                                                   (
                                                   T
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                
                                                if
                                                
                                                T
                                                −
                                                1
                                                <
                                                N
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and thus

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          1
                                          
                                             min
                                             {
                                             N
                                             ,
                                             t
                                             }
                                          
                                       
                                       ≤
                                       log
                                       
                                          (
                                          min
                                          
                                             {
                                             T
                                             −
                                             1
                                             ,
                                             N
                                             }
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             T
                                             −
                                             1
                                          
                                          
                                             min
                                             {
                                             N
                                             ,
                                             T
                                             −
                                             1
                                             }
                                          
                                       
                                       .
                                    
                                 
                              
                           
                           □

The condition M(t) ∈ [2bpl
                           , 2bph
                           ] a.s., for all 
                              
                                 t
                                 ∈
                                 N
                                 ,
                              
                            implies 
                              
                                 
                                    p
                                    *
                                 
                                 
                                    (
                                    M
                                    )
                                 
                                 =
                                 M
                                 /
                                 
                                    (
                                    2
                                    b
                                    )
                                 
                              
                            for all attainable values of M, and 
                              
                                 r
                                 
                                    (
                                    
                                       p
                                       *
                                    
                                    
                                       (
                                       M
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 −
                                 r
                                 
                                    (
                                    
                                       p
                                       *
                                    
                                    
                                       (
                                       
                                          M
                                          ′
                                       
                                       )
                                    
                                    ,
                                    M
                                    )
                                 
                                 
                                    )
                                    =
                                 
                                 
                                    
                                       (
                                       M
                                       −
                                       
                                          M
                                          ′
                                       
                                       )
                                    
                                    2
                                 
                                 /
                                 
                                    (
                                    4
                                    b
                                    )
                                 
                              
                            for all attainable values of M and M′. By Proposition 1 we obtain

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                LongRunAverageRegret
                                                (
                                                
                                                   Φ
                                                   λ
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   E
                                                   [
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                r
                                                (
                                                
                                                   p
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                         ^
                                                      
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                ,
                                                M
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                                )
                                                ]
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            λ
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   [
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            (
                                                            1
                                                            −
                                                            λ
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            +
                                                            λ
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            1
                                                            +
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                         
                                                            (
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                            )
                                                         
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         <
                                                         1
                                                         )
                                                      
                                                      +
                                                      
                                                         1
                                                         t
                                                      
                                                      1
                                                      
                                                         (
                                                         λ
                                                         =
                                                         1
                                                         )
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   K
                                                   0
                                                
                                                
                                                   [
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         )
                                                      
                                                      
                                                         (
                                                         1
                                                         +
                                                         λ
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      lim sup
                                                      
                                                         T
                                                         →
                                                         ∞
                                                      
                                                   
                                                   
                                                      1
                                                      T
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      T
                                                   
                                                   
                                                      I
                                                      λ
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and

                              
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                LongRunAverageRegret
                                                (
                                                
                                                   Φ
                                                   N
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   E
                                                   [
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      *
                                                   
                                                   
                                                      (
                                                      M
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                   M
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                r
                                                (
                                                
                                                   p
                                                   *
                                                
                                                
                                                   (
                                                   
                                                      
                                                         M
                                                         ^
                                                      
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   )
                                                
                                                ,
                                                M
                                                
                                                   (
                                                   t
                                                   +
                                                   1
                                                   )
                                                
                                                )
                                                ]
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               M
                                                               ^
                                                            
                                                            N
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         −
                                                         M
                                                         
                                                            (
                                                            t
                                                            +
                                                            1
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   
                                                      K
                                                      0
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         σ
                                                         2
                                                      
                                                      
                                                         min
                                                         {
                                                         N
                                                         ,
                                                         t
                                                         }
                                                      
                                                   
                                                   +
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                =
                                                
                                                   K
                                                   0
                                                
                                                
                                                   [
                                                   
                                                      σ
                                                      2
                                                   
                                                   
                                                      1
                                                      N
                                                   
                                                   +
                                                   
                                                      lim sup
                                                      
                                                         T
                                                         →
                                                         ∞
                                                      
                                                   
                                                   
                                                      1
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         T
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      I
                                                      N
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   ]
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           □

The assumption 
                              
                                 
                                    sup
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    inf
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 d
                              
                            implies 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    λ
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    d
                                    2
                                 
                              
                            and 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    N
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    d
                                    2
                                 
                              
                           . Together with Theorem 1 this proves the proposition.□

We show that the assumption 
                              
                                 |
                                 M
                                 (
                                 t
                                 )
                                 −
                                 M
                                 (
                                 t
                                 +
                                 1
                                 )
                                 |
                                 ≤
                                 d
                              
                            a.s., for some d ≥ 0 and all 
                              
                                 t
                                 ∈
                                 N
                                 ,
                              
                            implies 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    λ
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    d
                                    2
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       λ
                                       )
                                    
                                    
                                       −
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    N
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    1
                                    4
                                 
                                 
                                    d
                                    2
                                 
                                 
                                    
                                       (
                                       N
                                       +
                                       1
                                       )
                                    
                                    2
                                 
                                 ,
                              
                            for any λ ∈ [0, 1) and 
                              
                                 N
                                 ∈
                                 
                                    N
                                    
                                       ≥
                                       2
                                    
                                 
                              
                           . Together with Theorem 1 this proves the proposition.

Let λ ∈ [0, 1). Then

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                   
                                                      T
                                                      
                                                      −
                                                      
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   λ
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                =
                                                
                                                
                                             
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                
                                                   [
                                                   
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               1
                                                               −
                                                               λ
                                                            
                                                            
                                                               1
                                                               −
                                                               
                                                                  λ
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               
                                                               =
                                                               
                                                               1
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            
                                                            −
                                                            
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               
                                                               −
                                                               
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            λ
                                                            t
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      d
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         −
                                                         i
                                                         )
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                      |
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         )
                                                      
                                                      
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            λ
                                                            t
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   |
                                                   −
                                                   
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      λ
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      +
                                                      
                                                      (
                                                      1
                                                      −
                                                      
                                                         λ
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                      |
                                                   
                                                   2
                                                
                                                =
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   d
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      t
                                                      
                                                         λ
                                                         t
                                                      
                                                      
                                                         
                                                            1
                                                            −
                                                            λ
                                                         
                                                         
                                                            1
                                                            −
                                                            
                                                               λ
                                                               t
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           from which it follows that

                              
                                 
                                    
                                       
                                          lim sup
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       
                                          1
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             t
                                             −
                                             1
                                          
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          I
                                          λ
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       
                                          d
                                          2
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             λ
                                             )
                                          
                                          
                                             −
                                             2
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Let 
                              
                                 N
                                 ∈
                                 
                                    N
                                    
                                       ≥
                                       2
                                    
                                 
                                 ,
                              
                            then

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               +
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                ≤
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                            +
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         t
                                                      
                                                      d
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         −
                                                         i
                                                         )
                                                      
                                                      |
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         d
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      j
                                                      |
                                                   
                                                   2
                                                
                                                
                                                =
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   4
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   
                                                      (
                                                      min
                                                      
                                                         {
                                                         N
                                                         ,
                                                         t
                                                         }
                                                      
                                                      
                                                      +
                                                      
                                                      1
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      
                                                      −
                                                      
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      (
                                                      N
                                                      +
                                                      1
                                                      )
                                                   
                                                   2
                                                
                                                
                                                +
                                                
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      
                                                      −
                                                      
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      min
                                                      {
                                                      T
                                                      −
                                                      1
                                                      ,
                                                      N
                                                      −
                                                      1
                                                      }
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         t
                                                         +
                                                         1
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                   −
                                                   
                                                   
                                                      
                                                         (
                                                         N
                                                         +
                                                         1
                                                         )
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                =
                                                
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   
                                                      (
                                                      N
                                                      
                                                      +
                                                      
                                                      1
                                                      )
                                                   
                                                   2
                                                
                                                
                                                +
                                                
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      
                                                      −
                                                      
                                                      1
                                                   
                                                
                                                
                                                   [
                                                   −
                                                   min
                                                   
                                                      {
                                                      T
                                                      
                                                      −
                                                      
                                                      1
                                                      ,
                                                      N
                                                      −
                                                      1
                                                      }
                                                   
                                                   
                                                      
                                                         (
                                                         N
                                                         +
                                                         1
                                                         )
                                                      
                                                      2
                                                   
                                                   
                                                   +
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         =
                                                         2
                                                      
                                                      
                                                         min
                                                         {
                                                         T
                                                         ,
                                                         N
                                                         }
                                                      
                                                   
                                                   
                                                      t
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   
                                                      (
                                                      N
                                                      +
                                                      1
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   
                                                      d
                                                      2
                                                   
                                                   4
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                ·
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                [
                                                
                                                   (
                                                   1
                                                   −
                                                   min
                                                   
                                                      {
                                                      T
                                                      ,
                                                      N
                                                      }
                                                   
                                                   )
                                                
                                                
                                                   
                                                      (
                                                      N
                                                      +
                                                      1
                                                      )
                                                   
                                                   2
                                                
                                                
                                                   −
                                                   1
                                                   +
                                                   min
                                                   
                                                      {
                                                      T
                                                      ,
                                                      N
                                                      }
                                                   
                                                   (
                                                   min
                                                   
                                                      {
                                                      T
                                                      ,
                                                      N
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                +
                                                1
                                                )
                                                (
                                                2
                                                min
                                                {
                                                T
                                                ,
                                                N
                                                }
                                                +
                                                1
                                                )
                                                /
                                                6
                                                ]
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where we used 
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    t
                                    2
                                 
                                 =
                                 N
                                 
                                    (
                                    N
                                    +
                                    1
                                    )
                                 
                                 
                                    (
                                    2
                                    N
                                    +
                                    1
                                    )
                                 
                                 /
                                 6
                              
                           . After some algebraic manipulations, we derive that 
                              
                                 
                                    1
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       T
                                       −
                                       1
                                    
                                 
                                 
                                    I
                                    N
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                            can be upper bounded by

                              
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            4
                                                         
                                                         
                                                            d
                                                            2
                                                         
                                                         
                                                            
                                                               −
                                                               1
                                                               +
                                                               T
                                                               (
                                                               T
                                                               +
                                                               1
                                                               )
                                                               (
                                                               2
                                                               T
                                                               +
                                                               1
                                                               )
                                                               /
                                                               6
                                                            
                                                            
                                                               T
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      T
                                                      <
                                                      N
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         1
                                                         4
                                                      
                                                      
                                                         d
                                                         2
                                                      
                                                      
                                                         [
                                                         
                                                            
                                                               (
                                                               N
                                                               +
                                                               1
                                                               )
                                                            
                                                            2
                                                         
                                                         +
                                                         
                                                            1
                                                            
                                                               T
                                                               −
                                                               1
                                                            
                                                         
                                                         N
                                                         
                                                            (
                                                            −
                                                            4
                                                            
                                                               N
                                                               2
                                                            
                                                            −
                                                            3
                                                            N
                                                            +
                                                            7
                                                            )
                                                         
                                                         /
                                                         6
                                                         ]
                                                      
                                                   
                                                
                                                
                                                   
                                                      if
                                                      
                                                      T
                                                      ≥
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                       
                                       
                                       .
                                    
                                 
                              
                           Taking 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 ,
                              
                            we obtain

                              
                                 
                                    
                                       
                                          lim sup
                                          
                                             T
                                             →
                                             ∞
                                          
                                       
                                       
                                          1
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          ∑
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                             −
                                             1
                                          
                                       
                                       
                                          I
                                          N
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       ≤
                                       
                                          1
                                          4
                                       
                                       
                                          d
                                          2
                                       
                                       
                                          
                                             (
                                             N
                                             +
                                             1
                                             )
                                          
                                          2
                                       
                                       .
                                    
                                 
                              
                           
                           □

We show that the assumptions 
                              
                                 P
                                 
                                    (
                                    M
                                    (
                                    t
                                    +
                                    1
                                    )
                                    ≠
                                    M
                                    (
                                    t
                                    )
                                    )
                                 
                                 ≤
                                 ϵ
                              
                            for all 
                              
                                 t
                                 ∈
                                 N
                              
                            and some 
                              
                                 ϵ
                                 ≥
                                 0
                                 ,
                              
                            and 
                              
                                 
                                    sup
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 −
                                 
                                    inf
                                    
                                       t
                                       ∈
                                       N
                                    
                                 
                                 M
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 d
                              
                            for some d > 0, imply 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    λ
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    d
                                    2
                                 
                                 ϵ
                                 
                                    1
                                    
                                       (
                                       1
                                       −
                                       
                                          λ
                                          2
                                       
                                       )
                                    
                                 
                              
                            and 
                              
                                 
                                    lim sup
                                    
                                       T
                                       →
                                       ∞
                                    
                                 
                                 
                                    1
                                    T
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       1
                                    
                                    T
                                 
                                 
                                    I
                                    N
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ≤
                                 
                                    d
                                    2
                                 
                                 ϵ
                                 
                                    
                                       (
                                       N
                                       +
                                       1
                                       )
                                       (
                                       2
                                       N
                                       +
                                       1
                                       )
                                    
                                    
                                       6
                                       N
                                    
                                 
                                 ,
                              
                            for any λ ∈ [0, 1) and 
                              
                                 N
                                 ∈
                                 
                                    N
                                    
                                       ≥
                                       2
                                    
                                 
                              
                           . Together with Theorem 1 this proves the proposition.

For 
                              
                                 t
                                 ∈
                                 N
                                 ,
                              
                            define

                              
                                 
                                    
                                       X
                                       (
                                       t
                                       )
                                       =
                                       min
                                       {
                                       k
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       t
                                       +
                                       1
                                       }
                                       ∣
                                       M
                                       (
                                       k
                                       )
                                       =
                                       M
                                       (
                                       k
                                       +
                                       1
                                       )
                                       =
                                       …
                                       =
                                       M
                                       (
                                       t
                                       +
                                       1
                                       )
                                       }
                                       ,
                                    
                                 
                              
                           and note that 
                              
                                 P
                                 (
                                 X
                                 (
                                 t
                                 )
                                 =
                                 k
                                 )
                                 ≤
                                 P
                                 (
                                 M
                                 (
                                 k
                                 −
                                 1
                                 )
                                 ≠
                                 M
                                 (
                                 k
                                 )
                                 )
                                 ≤
                                 ϵ
                              
                           . for all 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 t
                                 +
                                 1
                              
                           .

For λ ∈ [0, 1), we have

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               −
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               −
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ∣
                                                   X
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   =
                                                   k
                                                   ]
                                                
                                                P
                                                
                                                   (
                                                   X
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   =
                                                   k
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               k
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               −
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ∣
                                                   X
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   =
                                                   k
                                                   ]
                                                
                                                ϵ
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   
                                                      |
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         λ
                                                         
                                                            t
                                                            −
                                                            i
                                                         
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                ϵ
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      −
                                                      2
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         (
                                                         1
                                                         
                                                         −
                                                         
                                                         
                                                            λ
                                                            2
                                                         
                                                         )
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      
                                                      −
                                                      
                                                      
                                                         λ
                                                         
                                                            2
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                   −
                                                   
                                                   2
                                                   
                                                      λ
                                                      t
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         λ
                                                         )
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         λ
                                                         t
                                                      
                                                      )
                                                   
                                                   
                                                   +
                                                   
                                                   t
                                                   
                                                      λ
                                                      
                                                         2
                                                         t
                                                      
                                                   
                                                   ]
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and thus

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   λ
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            
                                                               1
                                                               −
                                                               λ
                                                            
                                                            
                                                               1
                                                               −
                                                               
                                                                  λ
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         
                                                            λ
                                                            
                                                               t
                                                               −
                                                               i
                                                            
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   1
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         
                                                            λ
                                                            t
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   d
                                                   2
                                                
                                                
                                                   ϵ
                                                   [
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         λ
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      λ
                                                      
                                                         2
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                −
                                                2
                                                
                                                   λ
                                                   t
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      λ
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      λ
                                                      t
                                                   
                                                   )
                                                
                                                +
                                                t
                                                
                                                   λ
                                                   
                                                      2
                                                      t
                                                   
                                                
                                                
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         λ
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Let 
                              
                                 N
                                 ∈
                                 
                                    N
                                    
                                       ≥
                                       2
                                    
                                 
                                 ,
                              
                            then

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                =
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               +
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            −
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                E
                                                
                                                   [
                                                   
                                                      
                                                         |
                                                         
                                                            1
                                                            
                                                               min
                                                               {
                                                               N
                                                               ,
                                                               t
                                                               }
                                                            
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               1
                                                               
                                                               +
                                                               
                                                               
                                                                  
                                                                     (
                                                                     t
                                                                     −
                                                                     N
                                                                     )
                                                                  
                                                                  +
                                                               
                                                            
                                                            t
                                                         
                                                         
                                                            (
                                                            M
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                            
                                                            −
                                                            
                                                            M
                                                            
                                                               (
                                                               t
                                                               +
                                                               1
                                                               )
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   ∣
                                                   X
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   
                                                   =
                                                   
                                                   k
                                                   ]
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                P
                                                (
                                                X
                                                (
                                                t
                                                )
                                                =
                                                k
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                ≤
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      2
                                                   
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   
                                                      |
                                                      
                                                         1
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                            +
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         
                                                            k
                                                            −
                                                            1
                                                         
                                                      
                                                      d
                                                      |
                                                   
                                                   2
                                                
                                                ϵ
                                                =
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                ×
                                                
                                                
                                                   ∑
                                                   
                                                      k
                                                      =
                                                      1
                                                      +
                                                      
                                                         
                                                            (
                                                            t
                                                            −
                                                            N
                                                            )
                                                         
                                                         +
                                                      
                                                   
                                                   t
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            k
                                                            −
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  −
                                                                  N
                                                                  )
                                                               
                                                               +
                                                            
                                                         
                                                         
                                                            min
                                                            {
                                                            N
                                                            ,
                                                            t
                                                            }
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                =
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                                
                                                   
                                                      (
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                      +
                                                      1
                                                      )
                                                      (
                                                      2
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      6
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and thus

                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   I
                                                   N
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   lim sup
                                                   
                                                      T
                                                      →
                                                      ∞
                                                   
                                                
                                                
                                                   1
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                                
                                                   
                                                      (
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                      +
                                                      1
                                                      )
                                                      (
                                                      2
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      6
                                                      min
                                                      {
                                                      N
                                                      ,
                                                      t
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   d
                                                   2
                                                
                                                ϵ
                                                
                                                   
                                                      (
                                                      N
                                                      +
                                                      1
                                                      )
                                                      (
                                                      2
                                                      N
                                                      +
                                                      1
                                                      )
                                                   
                                                   
                                                      6
                                                      N
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           □

@&#ACKNOWLEDGMENT@&#

We kindly thank Bert Zwart for reading and commenting on the manuscript. Part of this research was done while the author was affiliated with Centrum Wiskunde & Informatica (CWI), Amsterdam, Eindhoven University of Technology, and University of Amsterdam. The author is supported by an NWO VENI grant.

@&#REFERENCES@&#

