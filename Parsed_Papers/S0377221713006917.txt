@&#MAIN-TITLE@&#Scheduling the hospital-wide flow of elective patients

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Mathematical models to schedule the flow of elective patients hospital-wide.


                        
                        
                           
                           Embedding of the models into a rolling horizon framework with stochastic data.


                        
                        
                           
                           Computational study on real-world data showing that significant improvements can be obtained.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Clinical pathways

Diagnosis-related groups

Patient flow management

@&#ABSTRACT@&#


               
               
                  In this paper, we address the problem of planning the patient flow in hospitals subject to scarce medical resources with the objective of maximizing the contribution margin. We assume that we can classify a large enough percentage of elective patients according to their diagnosis-related group (DRG) and clinical pathway. The clinical pathway defines the procedures (such as different types of diagnostic activities and surgery) as well as the sequence in which they have to be applied to the patient. The decision is then on which day each procedure of each patient’s clinical pathway should be done, taking into account the sequence of procedures as well as scarce clinical resources, such that the contribution margin of all patients is maximized. We develop two mixed-integer programs (MIP) for this problem which are embedded in a static and a rolling horizon planning approach. Computational results on real-world data show that employing the MIPs leads to a significant improvement of the contribution margin compared to the contribution margin obtained by employing the planning approach currently practiced. Furthermore, we show that the time between admission and surgery is significantly reduced by applying our models.
               
            

@&#INTRODUCTION@&#

For many years, cost reimbursement has been the standard payment scheme for hospitals. In this scheme, a hospital receives the total cost for treating the patient which is calculated by multiplying the patient’s length of stay with a (ward specific) daily rate and adding the costs for clinical procedures applied, such as diagnosis and surgery. Cost reimbursement does not provide an incentive for hospitals to operate efficiently. As a consequence, hospital costs as the largest part of total health care costs (approximately 31% in the US, see Lim, Mobasher, Kardar, & Cote (2011, chap. 3)), have increased sharply. In an effort to limit hospital costs and to create an incentive for hospitals to operate more efficiently, many countries have introduced payment schemes that are based on diagnosis-related groups (DRGs). In these schemes, patients are classified into DRGs with homogeneous clinical characteristics and resources required during treatment within each group, while between groups, the patients’ clinical characteristics and therefore costs are different. Hospitals receive payments based on the DRG instead of the applied procedures and the length of stay. The reimbursement the hospital receives for treating a patient with a specific DRG equals the average cost which accrued in a representative sample of hospitals in the year before last. For each country, there is an institution, such as the German institute for the reimbursement in hospitals INEK (see Schreyögg, Tiemann, & Busse (2006)), responsible for generating the sample, collecting, processing and distributing the cost data. With DRG-based payment schemes in place, in order to be profitable a hospital has to operate such that its patient specific costs are lower than the average costs of the hospitals in the sample. However, the cost structure in hospitals, as in many service industries, is such that the predominant share of the operational costs is fixed. Hence, costs can only be marginally reduced by operational decisions. Instead, hospitals have to use existing resources such that revenue or the total contribution margin is maximized. This approach is well-known in the service industry (see Kimes (1989) for an example in the service industry in general as well as Schütz & Kolisch (2012) for an example in the health care industry in particular).

In this paper, we propose two models to plan the patient flow in hospitals subject to scarce medical resources with the objective to maximize the contribution margin. We assume that we can classify a large enough percentage of elective patients according to DRG and clinical pathway. The clinical pathway defines the procedures (such as different types of diagnostic activities and surgery) as well as the sequence in which they have to be applied to the patient. The decision is then on which day each procedure of each patient’s clinical pathway should be done, taking into account the sequence of procedures as well as scarce clinical resources, such that the contribution margin is maximized. We consider a particular variant of the DRG-based payment scheme which is in use in Australia (see Duckett (1998)), Switzerland (see Zaugg, Gattiker, Moneta, & Reay (2012)), France and Germany (see Schreyögg et al. (2006)). In this variant, payment is not only dependent on DRG but also, to some extent, on length of stay. More precisely, the fixed reimbursement is reduced by some fixed amount per day if the length of stay (LOS) falls below a lower threshold value, referred to in the literature as low LOS trim point. In contrast, the fixed reimbursement is increased by some fixed amount per day if the medically necessary length of stay exceeds a high threshold value, denoted by high LOS trim point. By this, the payment scheme takes outliers into account (see, for example, Schreyögg et al. (2006)). The concept of trim points is described in Section 3; for more information about DRG trim points, see Busse, Geissler, Quentin, and Wiley (2011). An example of a cost, revenue and contribution margin function is given in Section 3.1, while a detailed example of two patients and their corresponding contribution margin for two specific DRGs is provided in Section 3.3. The payment scheme with fixed payment not coupled to the length of stay is a special case of the one that is treated in our study. Hence, our models can be applied to both variants.

Within the health care planning matrix of Hans, van Houdenhoven, and Hulshof (2011) our planning approach can be classified as offline operational resource capacity planning. It comprises the detailed coordination of the activities regarding current (elective) demand (see Hulshof, Kortbeek, Boucherie, Hans, & Bakker (2012)). Our models thus use planning decisions which have been made at higher planning levels such as strategic decisions on case mix, type and capacity of clinical resources as well as tactical decisions on the master surgery schedule. Then, our models generate decisions on the admission day of patients, the day-based assignment of clinical activities to hospital resources and the discharge day of patients. These results are in turn input for decisions to be made on subordinate planning levels such as bed assignment in wards, sequencing of diagnostic activities and surgical cases within a day. Contrary to most planning approaches for the offline operational level proposed so far, our model considers not only one resource such as a diagnostic device or the operating theater, but all scarce clinical resources. Correspondingly, we do not consider a single type of activity within the clinical pathway, such as the surgery, but all activities. We manage to do so by applying the right amount of aggregation in our models with a period length of one day. Since the capacity demand of a single activity in a clinical pathway is usually significantly smaller than a day, we can use expected values instead of distribution functions for most data. However, for some data such as recovery times of patients with a length of multiple days and arrival times of patients we explicitly take the stochastic nature into account by embedding our models in a rolling horizon approach with Bayesian recovery time prediction. Our computational results using real-world data demonstrate that our approaches lead to an improvement of approximately 5% in the contribution margin when compared to the planning approach currently employed in the hospital from which we obtained our data. Also, we show that the time span between admission and surgery is reduced by about 1.5days and that the length of stay is reduced by about 2days.

The remainder of this paper is structured as follows. In Section 2, we provide a survey of the relevant literature and set apart our approach. Section 3 presents the mathematical models and illustrates them by means of examples. In Section 4, we test our models on real-world data from a midsize hospital. First, we provide results for the two static deterministic models of Section 3. Then, we show how the models are embedded within a rolling horizon approach using Bayesian recovery time prediction in order to take into account uncertain information. We provide a computational comparison of the static deterministic and the dynamic stochastic planning, benchmarking both against the solution approach currently employed by the hospital. Finally, we analyze the impact of our approaches on some key figures such as time span between admission and surgery as well as length of stay. Section 5 closes the paper with conclusions.

@&#LITERATURE REVIEW@&#

There is a rich literature on offline operational capacity planning in hospitals. Table 1
                      provides an overview of offline operational capacity planning problems for surgical, inpatient and residential care services, employing the taxonomy of Hulshof et al. (2012). We selected articles based on that taxonomy and restricted our search to the application of mathematical programming as a solution technique. Moreover, we excluded staff-to-shift assignment papers and those that were published before 2000. We have classified each article with respect to the use of scarce clinical resources (single vs. multiple) and the consideration of risk (deterministic vs. stochastic). The table reveals that the majority of the papers consider a single resource such as the operating theater (for a survey see Cardoen, Demeulemeester, & Beliën (2010) and Guerriero & Guido (2011)) or wards (Demeester, Souffriau, De Causmaecker, & Vanden Berghe (2009)). The planning of diagnostic services is addressed, for example, by Patrick, Puterman, and Queyranne (2008) who, in contrast to our work, employ Markov decision processes as a solution approach. Since our paper addresses all scarce hospital resources instead of a single one, we do not present these approaches in detail. A smaller number of papers take into account multiple resources, see Vanberkel, Boucherie, Hans, Hurink, and Litvak (2010) for an overview. The majority of the papers which consider multiple resources deal with the operating room in combination with its upstream or downstream resources. Pham and Klinkert (2008) propose a mixed-integer program (MIP) for surgical case scheduling considering scarce resources at the preoperative, perioperative and postoperative stages, solved with the standard solver CPLEX. Augusto, Xie, and Perdomo (2010) consider the problem of scheduling a fixed number of elective cases subject to scarce resources in the operating theater, the post-anesthesia care unit and the patient transportation unit. The problem is modeled as a MIP and solved by using Lagrangian relaxation. Besides the scheduling decision, the model is used to explore the benefit of letting patients recover in the operating room when there is no capacity in the post-anesthesia care unit. Conforti, Guerriero, Guido, Cerinic, and Conforti (2011) address the so-called “week hospital problem” in which a decision is made if and when elective patients on a waiting list are admitted to the hospital and when the clinical activities of the admitted patients are performed. By definition, the week hospital problem ensures that all admitted patients are discharged in the week they have been admitted. The objective is to maximize the sum of the scores of admitted patients. The planning horizon of one week is divided into periods of a half day length. The paper proposes a MIP which is solved with the standard solver CPLEX.

On a tactical planning level, Min and Yih (2010) address the surgery scheduling problem for elective patients taking into account stochastic surgery durations and stochastic capacity of the surgical intensive care unit by employing a stochastic discrete program which is solved with the sample average approximation method. Vissers, Adan, and Bekkers (2005) consider the tactical patient mix optimization problem for a single specialty. Employing a MIP, for each day of the week they decide on the number of patients from different categories to be admitted into the hospital. The scarce clinical resources beds (before surgery and for recovery), the operating theater and the intensive care unit are taken into account. The objective is the minimization of the over- and underutilization of the clinical resources. Apart from the recent approaches in operational capacity planning mentioned above, Sepulveda (1985) can be regarded as an early work in evaluating DRG-based cost saving policies using simulation.

The models proposed in this paper can be categorized into and differentiated from the literature on offline capacity planning of multiple clinical resources as follows. First, an aggregated approach is followed in which clinical activities are assigned to big bucket periods with a length of one day. This is similar to Vissers et al. (2005) and Conforti et al. (2011) and differs from the detailed scheduling approaches of Min and Yih (2010) and Pham and Klinkert (2008). However, Vissers et al. (2005) decide on the admission date of patients only and assume for the latter a fixed schedule. On the contrary, in this paper patients have to be admitted and their clinical activities are scheduled. Thus, from a hierarchical planning perspective the models developed in this paper are located on a decision level below Vissers et al. (2005) but located above the detailed resource planning approaches referenced above. In this respect, our first model uses the decision of Vissers et al. (2005) on the patient’s admission dates in order to perform a contribution margin-based big bucket scheduling decision, detailing on what day which clinical activities of admitted patients will take place. The second model generalizes the first model by additionally deciding on the day of admission. The decisions made by each of the models can then be employed as input for detailed resource specific planning approaches in order to decide on more precise schedules and sequences for periods (such as hours or minutes) of less than a day.

Second, in terms of a deterministic or stochastic approach, our paper follows the aggregated approaches of Vissers et al. (2005) and Conforti et al. (2011). The problems are modeled as a deterministic MIP using expected values for resource demands of clinical activities, for recovery times and resource capacities. The usage of expected values is well aligned with the big bucket scheduling problem, since deviations of the realized values from the expected values will be mitigated due to variance reduction effects, and there will be no disturbance of detailed time lines. However, with respect to the demand for bed capacity a deviation from the expected recovery times will disrupt the schedule. Hence, we embed our deterministic models in a rolling horizon approach in order to cope with this type of variance.

Third, with respect to the objective function our approach is the only one which considers contribution margin, a management accounting measure, and not an operational substitute measure, such as weighted utilization or weighted time.

Finally, with respect to the constraints, our models are, along with Vissers et al. (2005), the only ones which consider all scarce clinical resources in an aggregated manner.

In the following, we present the two models for planning the patient flow, one with fixed and one with variable admission dates.


                        Patients and clinical pathways We consider a set of elective patients 
                           
                              P
                           
                         that have to be treated in the hospital. For each patient 
                           
                              p
                              ∈
                              P
                           
                         we know its clinical pathway which is a standardized, typically evidence based health care process (see van de Klundert, Gorissen, & Zeemering (2010)). In our models we depict the clinical pathway of a patient as an activity-on-node graph in which the set of nodes represents the clinical activities and weighted arcs represent minimum time lags between clinical activities. Let 
                           
                              A
                           
                         denote the set of all clinical activities to be performed and let 
                           
                              E
                           
                         denote the set of all minimum time lags between clinical activities. A minimum time lag 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              E
                           
                         of weight 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    min
                                 
                              
                              ∈
                              
                                 
                                    Z
                                 
                                 
                                    ⩾
                                    0
                                 
                              
                           
                         stipulates that activity j has to be performed at least 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    min
                                 
                              
                           
                         periods later than activity i; a period in our model accounts for one day. In Section 3.3 we provide a detailed example of two patients and their corresponding clinical pathways. Given the graph 
                           
                              (
                              A
                              ,
                              E
                              )
                           
                        , the admission period α
                        
                           p
                         and the discharge activity ϕ
                        
                           p
                         for each patient 
                           
                              p
                              ∈
                              P
                           
                        , we calculate for each activity 
                           
                              i
                              ∈
                              A
                           
                         the earliest period E
                        
                           i
                         and the latest period L
                        
                           i
                         in which the activity has to be performed with longest path methods (see, for example, Neumann, Schwindt, & Zimmermann (2003); details of the calculation are given in Section 4.1). Let 
                           
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              ≔
                              {
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         denote the time window of activity i and let 
                           
                              T
                           
                         be the set of periods (days) within the planning horizon. The length of the planning horizon 
                           
                              |
                              T
                              |
                           
                         is set to the maximum latest period of all activities 
                           
                              
                                 
                                    max
                                 
                                 
                                    i
                                    ∈
                                    A
                                 
                              
                              
                                 
                                    L
                                 
                                 
                                    i
                                 
                              
                           
                         which equals the latest discharge period of all patients.


                        Hospital resources Scarce hospital resources are depicted by two sets, day resources and overnight resources. The set of day resources 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         depicts all resources which are available during regular working days, such as computer tomography scanner (CT), magnetic resonance imaging scanner (MRI) and surgery room. Each day resource 
                           
                              k
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         has a capacity R
                        
                           k,t
                         in period 
                           
                              t
                              ∈
                              T
                           
                        . The capacity demand of activity 
                           
                              i
                              ∈
                              A
                           
                         on day resource 
                           
                              k
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                         is r
                        
                           i,k
                        . R
                        
                           k,t
                         and r
                        
                           i,k
                         are typically measured in minutes. The capacity demand r
                        
                           i,k
                         of clinical activities ranges between several minutes and several hours, whereas the capacity of day resources is, in the case of a single shift, 8hours. The set of overnight resources is depicted by 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        . Overnight resources represent beds available at specialties, for example, the number of beds available at the surgical specialty. The number of beds available at overnight resource 
                           
                              k
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         in period 
                           
                              t
                              ∈
                              T
                           
                         is R
                        
                           k,t
                        . If patient 
                           
                              p
                              ∈
                              P
                           
                         stays in the hospital from day t to day t
                        +1, he requires one bed from the overnight resource b
                        
                           p
                         in period t. With 
                           
                              R
                              =
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ∪
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         we denote the set of all resources which includes day and overnight resources.


                        DRG and contribution margin We consider a DRG system in which, given a patient’s DRG and his admission day, the hospital receives a specific revenue which depends on the DRG and the discharge date and thus the length of stay. Fig. 1
                        (a)–(b) shows two length of stay and DRG dependent revenue functions for a specific DRG (based on the German DRG system). The revenue (dotted line) is constant if the length of stay (LOS) is between a low LOS trim point and a high LOS trim point. The trim points, 2 and 9 in Fig. 1, represent the length of stay range for the majority of the patients with a “normal” healing process. For a length of stay within this range the hospital receives a constant revenue. In the case of a length of stay below the low LOS trim point there is a per-day reduction of the revenue. In this scenario, the health insurance company takes into account the fact that the hospital has lower costs than for the average patient with the same DRG. In contrast, if for medical reasons the length of stay of a patient is above the high LOS trim point, the hospital receives a per-day surcharge on top of the fixed revenue in order to compensate additional costs (see case (a) in Fig. 1). However, if a length of stay above the high LOS trim point is not medically justified, this surcharge will not be paid (see case (b) in Fig. 1). In practice, a claims agent of the health insurance company scrutinizes the bill, examines the medical record and then makes a decision regarding the surcharge.


                        Table 2
                         provides an overview of the DRG-based reimbursement policies of different countries. The table reveals that high LOS trim points exist in all listed countries while low LOS trim points are only in place in some of the countries. A reason for countries not to employ low LOS trim points is to provide an incentive for short-stay visits or day-cases (for example in England, see Schreyögg, Stargardt, Tiemann, & Busse (2006)). The parameter of the revenue function, low and high LOS trim points, fixed revenue as well as per day reduction and addition are DRG specific (see for example Porter & Guth (2012)). Since we measure the length of stay in discrete days, the revenue function is discrete as well. From the revenue, we subtract the variable cost not associated with clinical procedures, which are essentially costs for meals, cleaning and so on (dashed line in Fig. 1), in order to obtain the contribution margin 
                           
                              
                                 
                                    π
                                 
                                 
                                    p
                                    ,
                                    t
                                    -
                                    
                                       
                                          α
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         for patient p with admission day α
                        
                           p
                        , discharge day t and thus length of stay t
                        −
                        α
                        
                           p
                         (solid line in Fig. 1). Note that we do not subtract the cost for clinical procedures because, in accordance with the clinical pathway, the latter will be undertaken in any case and are therefore not relevant for the decision, whereas the patients’ length of stay is a function of the scheduling decision. Also note that the time-constant DRG variant is a special case of the time-variable variant and, hence, our model can be applied directly to the latter.


                        Decision variables and model formulation Using the binary variables
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   clinical
                                                   
                                                   activity
                                                   
                                                   i
                                                   ∈
                                                   A
                                                   
                                                   is
                                                   
                                                   performed
                                                   
                                                   at
                                                   
                                                   day
                                                   
                                                   t
                                                   ∈
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        originally introduced by Pritsker, Watters, and Wolfe (1969), we can model the patient flow problem with fixed admission date (PFP–FA) as follows:
                           
                              (1)
                              
                                 Maximize
                                 
                                 z
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       p
                                       ,
                                       t
                                       -
                                       
                                          
                                             α
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       t
                                    
                                 
                              
                           
                        subject to
                           
                              (2)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       ,
                                       t
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       min
                                    
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 E
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          A
                                          :
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       R
                                    
                                    
                                       k
                                       ,
                                       t
                                    
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          P
                                          :
                                          
                                             
                                                b
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          k
                                          ,
                                          t
                                          ⩾
                                          
                                             
                                                α
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   τ
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   min
                                                   {
                                                   t
                                                   ,
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                τ
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       R
                                    
                                    
                                       k
                                       ,
                                       t
                                    
                                 
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 =
                                 1
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 A
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 i
                                 ∈
                                 A
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        The objective function (1) maximizes the contribution margin of all patients who have to be admitted to the hospital. Constraints (2) ensure minimum time lags between clinical activities. Note that for 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    min
                                 
                              
                              =
                              0
                           
                         activities i and j can be performed on the same day. This might be for example the case for two diagnostic activities. Constraints (3) depict the limited capacity of day resources. For each resource and day, the capacity demand of all activities performed at that day must not exceed resource capacity. Note that the dimension of resource capacity can be, for example, time or slots in a master surgical schedule. Constraints (4) denote the resource constraints for overnight resources. For patient p, the bed allocation starts with the fixed admission date α
                        
                           p
                         and the discharge activity ϕ
                        
                           p
                         releases the bed. Constraints (5) ensure that each activity is assigned to exactly one period of its time window. Variable definitions are provided in (6).


                        Table 3
                         provides an example of the bed allocation with a planning horizon of 
                           
                              T
                              ≔
                              {
                              1
                              ,
                              …
                              ,
                              7
                              }
                           
                         days, overnight resource 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              ≔
                              {
                              1
                              }
                           
                         and a single patient 
                           
                              P
                              ≔
                              {
                              1
                              }
                           
                         with admission date α
                        1
                        =1 requiring overnight resource b
                        1
                        =1. The first row provides the decision variables 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    t
                                 
                              
                           
                         for discharge activity ϕ
                        1 of patient 1 which has to take place in exactly one period within the time window 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ≔
                              {
                              5
                              ,
                              6
                              ,
                              7
                              }
                           
                        . As can be seen, the PFP–FA selects the discharge period 6 by setting 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    6
                                 
                              
                              =
                              1
                           
                        . The second row gives the left hand side of constraints (4) for patient 1. The patient requires a bed starting with the night between days 1 and 2 until the night between days 5 and 6.

In contrast to resource-constrained project scheduling (see in Pritsker et al. (1969)), the PFP–FA does not undertake detailed scheduling in which an activity’s starting and ending time is precisely planned. Instead, the PFP–FA does aggregated planning by assigning activities to days instead of deciding on activity start and finish times during the day. This aggregated view can be illustrated by the relation between the length of periods and the duration of activities. In resource-constrained project scheduling, we typically have activity durations which are multiples of a period. Conversely, in the case of our model, activity durations are between 10minutes and several hours, whereas the length of one period is a working day with, in the case of one shift, 8hours. The approach of our model can thus be compared to assembly line balancing (see for example Boysen, Fliedner, & Scholl (2007)) in which tasks are assigned to stations but no sequencing of tasks within stations is undertaken.

Note that model (1)–(6) does not take into account a master surgery schedule (MSS) in which OR capacity is assigned on the basis of a day or half-days to specialties but assumes that surgeries from any specialty can be undertaken any day. However, the model can be generalized straightforwardly in order to take MSSs into account. For this, constraints (3) have to be defined not for the aggregated single day resource “operating theatre” but for each specialty. In consequence, the number of constraints (3) increases.

The number of binary decision variables is 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    A
                                 
                              
                              |
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              |
                           
                         while the number of constraints is 
                           
                              |
                              E
                              |
                              +
                              |
                              R
                              |
                              ·
                              |
                              T
                              |
                              +
                              |
                              A
                              |
                           
                        . For a realistic problem with a planning horizon of 
                           
                              |
                              T
                              |
                              =
                              28
                           
                         days, 
                           
                              |
                              P
                              |
                              =
                              150
                           
                         patients, 
                           
                              |
                              R
                              |
                              =
                              10
                           
                         resources, 3 activities per patient, time window size of 
                           
                              |
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              |
                              =
                              3
                           
                         days for each activity 
                           
                              i
                              ∈
                              A
                           
                         and 
                           
                              |
                              E
                              |
                              =
                              300
                           
                         precedence relations, we have 1,350 binary decision variables and 1,030 constraints. Tables 9–11 in Section 4 provide the problem sizes of real-world test instances.

In the case of elective patients, the admission date is typically negotiated between the patient or the referring physician and the hospital. Hence, α
                        
                           p
                         is no longer a parameter. Instead, we introduce for each patient p admission activity σ
                        
                           p
                         which has to be assigned by variables 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                    t
                                 
                              
                           
                         to exactly one admission day t within time window 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                        . Note that in the case of variable admission dates, the contribution margin function π
                        
                           p,t
                         for patient 
                           
                              p
                              ∈
                              P
                           
                         is defined for lengths of stay 
                           
                              t
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                           
                        , calculated by subtracting the admission date from the discharge date, formally given by
                           
                              (7)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       t
                                    
                                 
                                 .
                              
                           
                        In order to ease the readability of the model, we introduce the binary variables
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   patient
                                                   
                                                   p
                                                   ∈
                                                   P
                                                   
                                                   has
                                                   
                                                   a
                                                   
                                                   LOS
                                                   
                                                   of
                                                   
                                                   t
                                                   ∈
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                   
                                                   days
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We can now formulate the patient flow problem with variable admission dates (PFP–VA) as follows:
                           
                              (8)
                              
                                 Maximize
                                 
                                 z
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          P
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 ·
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                              
                           
                        subject to (2), (3), (5) and (6) and
                           
                              (9)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          P
                                          :
                                          
                                             
                                                b
                                             
                                             
                                                p
                                             
                                          
                                          =
                                          k
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   τ
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   min
                                                   {
                                                   t
                                                   ,
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                τ
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   τ
                                                   =
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   min
                                                   {
                                                   t
                                                   ,
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                   
                                                   }
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      p
                                                   
                                                
                                                ,
                                                τ
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       R
                                    
                                    
                                       k
                                       ,
                                       t
                                    
                                 
                                 
                                 ∀
                                 k
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 T
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                W
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             p
                                          
                                       
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 t
                                 ·
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          ∈
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 =
                                 1
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 
                                 ∀
                                 p
                                 ∈
                                 P
                                 ,
                                 t
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        Objective function (8) maximizes the contribution margin of all patients. Overnight resource constraints (9) have been modified in order to take into account flexible admission dates. Constraints (10) calculate the LOS as the difference between the start of the discharge activity and the start of the admission activity. Constraints (11) ensure that for each patient exactly one LOS is selected and the additional LOS decision variables are defined by (12).


                        Table 4
                         provides an extension of the example in Table 3 where, additionally, we assume for patient 1 admission time window 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ≔
                              {
                              1
                              ,
                              2
                              ,
                              3
                              }
                           
                        . The first row provides the decision variables for the admission activity σ
                        1 of patient 1 as well as the decision of PFP–VA to admit patient 1 in the first period (
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    1
                                 
                              
                              =
                              1
                           
                        ). The second row gives the time window for the discharge activity as well as the decision of PFP–VA to discharge patient 1 in period 5 (
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    5
                                 
                              
                              =
                              1
                           
                        ). The third row provides the left hand side of the bed allocation constraints (9).

The number of binary decision variables of model PFP–VA is 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    ∈
                                    A
                                 
                              
                              |
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              |
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    p
                                    ∈
                                    P
                                 
                              
                              |
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                              |
                           
                         and the number of constraints is 
                           
                              |
                              E
                              |
                              +
                              |
                              R
                              |
                              ·
                              |
                              T
                              |
                              +
                              2
                              ·
                              |
                              P
                              |
                              +
                              |
                              A
                              |
                           
                        . Thus, PFP–VA is considerably larger than PFP–FA. For example, consider the problem instance in Section 3.1 with an additional admission activity per patient and 
                           
                              |
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                              |
                              =
                              3
                           
                         possible LOSs for each patient 
                           
                              p
                              ∈
                              P
                           
                        . Then, the number of precedence relations is 
                           
                              |
                              E
                              |
                              =
                              450
                           
                        , the number of binary decision variables is 1,800 and the number of constraints is 1,630. For real-world instances, again, see Tables 9–11 in Section 4.

In what follows we give an example with two patients. Patient (pat.) 1 has the DRG I53Z (spinal disc surgery) and patient 2 has the DRG B04D (extracranial surgery). Consider 
                           
                              T
                              ≔
                              {
                              1
                              ,
                              …
                              ,
                              7
                              }
                           
                         time periods, activities 
                           
                              i
                              ∈
                              A
                           
                         and resources 
                           
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ≔
                              {
                              1
                              ,
                              2
                              }
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              ≔
                              {
                              3
                              }
                           
                         as shown in Table 5
                        . The overnight resource requirements are b
                        1
                        =
                        b
                        2
                        =3. Clinical pathways and resource requirements for day resources are shown in Fig. 2
                        . In Fig. 2(a), r
                        7,2
                        =100 denotes that activity 7 (stent implantation for patient 2) requires 100minutes from day resource 2 which is the operating theater. The minimum time lag 
                           
                              
                                 
                                    d
                                 
                                 
                                    3
                                    ,
                                    4
                                 
                                 
                                    min
                                 
                              
                              =
                              4
                           
                         between activity 3 and 4 in Fig. 2(b) denotes that at least four days of recovery time have to pass between the surgery and the discharge of patient 1. For the PFP–FA let the admission days for both patients be α
                        1
                        =
                        α
                        2
                        =1. Table 6
                         provides earliest and latest time periods to schedule the activities as obtained by longest path calculation.


                        Table 7
                         shows the contribution margins for the two patients. Note that with increasing t, this margin decreases.

Solving the PFP–FA and the PFP–VA with the given parameters, we obtain the optimal solutions presented in Fig. 3
                        (a)–(b).

The optimal objective function value of the PFP–FA and the PFP–VA is € 7,210.21 and € 7,271.08, respectively. Note that in the case of fixed admission dates, the length of stay of patient 1 is one day longer than in the case of variable admission dates. The admission date and the discharge date of patient 2 are postponed by one day in the case of flexible admission dates, resulting in the same length of stay as in the fixed case.

In the following, a computational and economic analysis of scheduling the hospital-wide patient flow is provided.

We evaluated our models on data from the county hospital Erding, a 400-bed sized hospital in the vicinity of Munich, Germany. We joined the hospital data with data from the German institute for the reimbursement in hospitals (see Schreyögg et al. (2006)). The latter contains the information on the DRG attributes such as low and high LOS trim point, fixed revenue as well as per day reduction and addition. Following suggestions from the hospital’s management, the 18 DRGs shown in Table 8
                         were selected because at the time a patient contacts the hospital for admission, these DRGs can be classified with sufficient accuracy. The table provides the number of patients for each DRG (n), the classification accuracy (Acc.), i.e. the probability of assigning the correct DRG at admission and the surgery lead time. The surgery lead time is the minimum number of days required for medical activities prior to surgery. Examples are laboratory tests which have to be made prior to an incision or the time required for pre-medication to take effect in the patient’s metabolism before surgery. We depict surgery lead time with a minimum time lag between the admission activity and the surgery activity. For the year 2008, the 18 selected DRGs represent 11.6% of all admitted patients. In the following, we assume that these DRGs can be classified with high accuracy at the time the patient or the referring physician contacts the hospital. For the PFP–FA, we set for each patient 
                           
                              p
                              ∈
                              P
                           
                         the admission date α
                        
                           p
                         according to the realized admission date as given by the hospital data. In the case of the PFP–VA the admission time window 
                           
                              
                                 
                                    W
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         is set according to the realized admission week. For example, if a patient was admitted on Wednesday, then for the PFP–FA we set α
                        
                           p
                         to that specific Wednesday whereas for the PFP–VA we require that the patient has to be admitted between Monday and Friday of that specific week. Only 3.8% of the patients required capacity on the ICU and of them 42.8% left the ICU within 24hours. For the sake of simplicity, we therefore model the ICU as a day resource. Pre- and post-clinical treatments are not considered. Resource capacity R
                        
                           k,t
                         is determined by using the entire capacity of resource 
                           
                              k
                              ∈
                              R
                           
                         on day 
                           
                              t
                              ∈
                              T
                           
                         minus capacity allocated to patients who do not have the selected DRGs. The order of activities 
                           
                              (
                              i
                              ,
                              j
                              )
                              ∈
                              E
                           
                         is set according to the order of time stamps in the hospital data. For the capacity demand r
                        
                           i,k
                         of clinical activity i on day resource k we use averages (avg.) of the observed distributions. As already stated above, this approach is robust because, first, the capacity demand of activities is a fraction of the available capacity per day, and, second, we benefit from variance reduction effects when summing up the capacity demands of activities assigned to the resource on the same day. The recovery time of each patient is determined by the difference between the time stamps of the discharge activity and its immediately preceding activity in the clinical pathway. For example, for patient 2 in Fig. 2(b) activity 7 (stent implementation) immediately precedes activity 8 (discharge). Note that a surgery activity is not always the immediate predecessor of the discharge activity. For example, for DRG I68C in Table 8 a pain therapy activity is the immediate predecessor of the discharge activity.

Time windows for activities are determined by using longest path calculation (see Neumann et al. (2003)). More precisely, in the case of the PFP–FA we set the earliest period of the first activity of a patient p equal to the admission date α
                        
                           p
                        . We then calculate earliest periods for all other activities of the patient using longest path methods. In doing so, the minimum surgery lead time between an activity preceding surgery and the surgery activity itself has to be taken into account for some surgeries (see column “Surgery lead time” in Table 8). In order to determine the latest periods L
                        
                           i
                        , we set 
                           
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              +
                              w
                           
                         using the time window variation parameter w and calculate the latest periods for all other activities of patient p. For the PFP–VA we set the earliest period of the admission activity σ
                        
                           p
                         to the Monday of the week in which the patient was admitted. We then calculate earliest periods as for the PFP–FA. For the latest period of the discharge activity we set 
                           
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              +
                              4
                              +
                              w
                           
                        . The “4” is added in order to allow for a time window variation parameter of w
                        =0 which ensures that the patient is admitted between Monday and Friday. The time window variation parameter w has been varied between 0 and 6 (see Fig. 4
                        ).

In total, we generated 12 test instances. Instance 1,2,…,12 represents all elective patients with the DRGs as provided in Table 8 admitted in month 1,2,…,12 of 2008. Table 9
                         provides the number of patients for each month as well as other key figures when the time window parameter w is set to w
                        =4 for the PFP–FA and w
                        =1 for the PFP–VA. As can be seen in the last two columns, this choice of w results in time windows of comparable size of the two models which are abbreviated as “FA” and “VA” in the table. The available capacity of the hospital resources has been adjusted by those patients which are not considered in the instances. These are non-elective patients and elective patients with DRGs different from the ones given in Table 8. Table 10
                         provides the daily capacity of the 12day and 3 overnight resources before subtracting the expected demand of unplanned patients. For example, the daily operating theater capacity of 3,600minutes comes from 6 operating rooms, each one opens from 8 a.m. until 6 p.m. on Monday–Friday.


                        Table 11
                         shows the number of variables and constraints as well as the computation times. All computations were performed on a 2gigahertz PC (Intel Core2 Duo T7250) with 4gigabyte RAM running Windows 7 operating system. The models were coded in Java in an ILOG Concert environment. The solver used was ILOG CPLEX 12.2 (64bit). Each instance was optimally solved in less than a second by each of the two models, with PFP–VA requiring solution times of factor 2 or more than the PFP–FA.


                        Table 12
                         provides the absolute and relative improvement of the contribution margins obtained by the models when compared to the hospital data. The hospital does not have a formal approach for dealing with the patient flow problem. Instead, it employs a heuristic procedure for deciding on the discharge date and thus patients’ LOS. The procedure works as follows. First, the medical criteria always have priority over the economic criteria. That is, a patient is not discharged until fully recovered. As soon as a patient has sufficiently recovered, the discharge decision is based on the marginal contribution margin. The patient is kept in the hospital as long as the marginal contribution margin is increasing and is discharged as soon as the marginal contribution margin is decreasing. The average relative economic improvement for solving the test instances to optimality compared to the hospital solution is 3.5% and 5.8% when employing the fixed admission date model PFP–FA and the flexible admission date model PFP–VA, respectively. This is equivalent to a monthly increase of the contribution margin of € 9,402.1 for the PFP–FA and of € 15,763.2 for the PFP–VA.

In practice, there is considerable variance in the data and therefore hospitals cannot undertake a flow management of patients for a whole month in advance. Instead, they have to embed the model into a rolling horizon approach in which the planning of the patient flow is done every day with the most recent information available. This is also done in practice. Here, the hospital undertakes daily allocation decisions for single resources, such as the operating theater and the wards. For example, each afternoon a decision is made about which of the patients will be considered for surgery on the next day. Therefore, we have embedded each of the two patient flow models in a rolling horizon approach in which each problem instance is solved each day instead of once a month. In each run, the most recent data is used. This is deterministic data which has become available at the day of planning, such as planned admissions in the PFP–FA, or stochastic data for which expected values are calculated. More precisely, we embedded the PFP–FA in the rolling horizon approach as follows. We solve the model each day with all remaining, i.e. not yet undertaken, clinical activities of patients admitted at that day or patients not yet discharged. The available resource capacity per day is calculated by subtracting the average week-day dependent demand of patients not considered in our planning approach (non elective patients and elective patients with DRGs different from the ones given in Table 8) from the overall capacity. For the first day of each planning horizon we subtract the observed capacity demand of all patients not considered in our model from the overall capacity. The duration of the recovery activities is calculated with Bayesian updating. We employed the approach of Tu, Jaglal, and Naylor (1995) which successfully used Bayesian methods to predict recovery times. We added the attribute DRG and so far realized recovery time to the attributes age, gender and type of surgery. When embedding the PFP–VA in the rolling horizon approach, we considered all patients which were admitted in the week under consideration instead of all patients which were admitted at the day of planning as in the PFP–FA. Thereby, we assumed that all requests of elective patients are known at the beginning of the week. Using data of the first half of 2008 to initialize the probability tables of the Bayesian classifier and to forecast available capacity, we run the rolling horizon approach for the third quarter of 2008. When calculating the activity time windows for the rolling horizon approach, we proceeded similarly to the static approach with the following modifications. First, for both models, the PFP–FA and the PFP–VA, we employ recovery times as calculated with the Bayesian classifier instead of using realized recovery times. Second, for calculating latest time periods we set the latest period of the discharge activity 
                           
                              
                                 
                                    L
                                 
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         of patient p equal to the maximum DRG-dependent recovery time. With this approach we obtain time windows which are on average larger than in the static case. In order to make the results comparable we adjusted the time window variation parameter to w
                        =6 for the fixed admission and to w
                        =5 for the variable admission model leading to a negligible difference between the static and the rolling horizon approach of 0.1 and 0.5days for the PFP–FA and the PFP–VA, respectively (see Table 9).

For the PFP–FA, when running the model for day t, we admit all patients with α
                        
                           p
                        
                        =
                        t. For the PFP–VA, when running the model for day t, we allow the model to admit all patients which were admitted at that day or some day later in the week. For example, if t is a Monday, the model schedules the admission activity σ
                        
                           p
                         of all patients in the hospital data admitted in that week on exactly one day between Monday and Friday. However, only the decision of patients scheduled on Monday will be fixed. If t is a Tuesday, the model schedules the admission activities of all patients in the hospital data admitted in that week who were not scheduled for Monday and so forth.


                        Table 13
                         gives the gain in contribution margin for the PFP–FA and the PFP–VA when implemented in a static vs. a rolling horizon approach for the third quarter of 2008. Note that the improvement for the static approach is larger than the sum of the improvements for the instances 7–9 (July–September) given in Table 12. This is due to the larger time windows which were used in the rolling horizon approach. From Table 13 one can see that the improvement of both models compared to the hospital solution is reduced for the more realistic rolling horizon approach. This holds true to a larger extent for PFP–FA. Nevertheless, both approaches and in particular PFP–VA still provide significant improvements compared to the hospital solution. The inferior results of the rolling horizon approach are due to incomplete information. More precisely, for the rolling horizon approach a forecast of the recovery times is used rather than deterministic recovery times. Furthermore, the stochastic resource availability for the first period of each planning run is also considered.


                        Influence of the time window size 
                        Fig. 4(a)–(b) shows the impact of the time window variation parameter w on the computation time and the relative improvement of PFP–FA and PFP–VA.

For increasing time window variation parameter values w the computation time and the economic improvement, compared to the hospital solution, are increasing as well. The increase of the computation time can be observed in particular for the PFP–VA, which considers, when compared to the PFP–FA, the same number of patients but larger networks due to more activities and more precedence constraints. The increase in the improvement is particularly strong for the PFP–FA. The impact on the improvement of the PFP–VA is only small because the latter uses, by definition, larger time window sizes due to the admission time window whereas the PFP–FA uses smaller ones. For both approaches, the PFP–FA and the PFP–VA, the marginal improvement beyond a time window variation parameter of w
                        =3 is small.


                        Length of stay and time admitted patients wait for surgery 
                        Fig. 5
                        (a)–(b) provide the frequency distribution for the time span between admission and surgery as well as the length of stay in the hospital. Our models reduce the time span between admission and surgery compared to the hospital solution. In the hospital solution the difference between the surgery and the admission date is on average 1.8days. In both, the solutions of the static PFP–FA and the PFP–VA, the average time span between admission and surgery is 0.2days while it is 0.1 and 0.2days for the rolling horizon PFP–FA and PFP–VA, respectively. Employing our models also leads to a reduction in the length of stay. Compared to the hospital solution with an average LOS of 6.5days, the static PFP–FA and PFP–VA reduce the length of stay to 4.2days. The rolling horizon implementation results in a slightly longer length of stay of 4.3days for the PFP–FA and 4.6days for the PFP–VA, respectively.

@&#CONCLUSION@&#

In this paper we have presented two discrete optimization models for the problem of scheduling elective patients hospital-wide with the objective to maximize the contribution margin. For the first model, we assumed a fixed admission date whereas in the second model this assumption is relaxed. We embedded both models into a rolling horizon approach in order to cope with stochastic data. Using real-world data from a mid-size hospital we performed an elaborate computational study in order to study the applicability and the impact of the models. The results show that the test instances can be solved to optimality within a very moderate time of a fraction of a second on average. The obtained results are clearly superior to the current solution of the hospitals which are derived with a simple heuristic. Analyzing our solutions we observed that the time span between admission and surgery and the length of stay in the hospital can be decreased substantially.

@&#REFERENCES@&#

