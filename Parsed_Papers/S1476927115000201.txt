@&#MAIN-TITLE@&#A time and space complexity reduction for coevolutionary analysis of trees generated under both a Yule and Uniform model

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Introduces a more efficient data structure for coevolutionary analysis.


                        
                        
                           
                           Presents the first sub quadratic space approach for cophylogenetic reconstruction.


                        
                        
                           
                           Provides a logarithmic time complexity reduction for cophylogenetic reconstruction.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Coevolution

Phylogeny

Tree topology

NP-Hard

@&#ABSTRACT@&#


               
               
                  The topology or shape of evolutionary trees and their unbalanced nature has been a long standing area of interest in the field of phylogenetics. Coevolutionary analysis, which considers the evolutionary relationships between a pair of phylogenetic trees, has to date not considered leveraging this unbalanced nature as a means to reduce the complexity of coevolutionary analysis. In this work we apply previous analyses of tree shapes to improve the efficiency of inferring coevolutionary events. In particular, we use this prior research to derive a new data structure for inferring coevolutionary histories. Our new data structure is proven to provide a reduction in the time and space required to infer coevolutionary events. It is integrated into an existing framework for coevolutionary analysis and has been validated using both synthetic and previously published biological data sets. This proposed data structure performs twice as fast as algorithms implemented using existing data structures with no degradation in the algorithm's accuracy. As the coevolutionary data sets increase in size so too does the running time reduction provided by the newly proposed data structure. This is due to our data structure offering a logarithmic time and space complexity improvement. As a result, the proposed update to existing coevolutionary analysis algorithms outlined herein should enable the inference of larger coevolutionary systems in the future.
               
            

@&#BACKGROUND@&#

Species often place selective pressures on one another driving the evolutionary process (Anderson and May, 1982). The study of these selective pressures and their impact on the overall evolutionary process is encompassed in the field of coevolution. Coevolution considers two or more species that have an evolutionary dependence on one another (Juan et al., 2008). This dependence may come in the form a mutalistic coevolutionary relationship where both species harmoniously coexist, both benefiting from one another, such as figs and their pollinator wasps (Cruaud et al., 2012). Alternatively, this evolutionary dependence may be in the form of a parasitic coevolutionary relationship, where the evolutionary changes in the host species aim to combat their invasive parasites, while the parasites evolve specific traits to exploit their host's defences, such as pocket gophers and their parasitic chewing lice (Hafner and Nadler, 1988).

Coevolutionary analysis is not only limited to these two systems, in fact coevolutionary analysis has the potential of providing insight into a number of other biological phenomena such as mimicry between species (Cuthill and Charleston, 2012), biogeography (Ronquist, 1997), host/pathogen interactions (Mu et al., 2005), predator/prey networks (Brodie et al., 2002), herbivore/plant dynamics (Fox, 1981), and inferring species trees from gene trees (Page and Charleston, 1997). Although encompassing a diverse range of evolutionary systems, coevolutionary analysis is often considered in terms of an independent and dependent evolutionary network, the host and parasite respectively (Charleston and Perkins, 2006).

Macro scale coevolutionary analysis considers the host (H) and parasite (P) as a pair of bifurcating phylogenetic trees with known associations (φ) between their extant taxa (Libeskind-Hadas and Charleston, 2009). Coevolutionary analysis often restricts the number of associations such that each parasite may only infect a single host species, while host species may be infected by any number of parasite species (Poulin, 2011). This restriction is the form of coevolutionary analysis considered herein. The construction of a coevolutionary system in terms of H, P and φ is often visualised as a Tanglegram as seen in Fig. 1
                     .

One common methodology for macro scale coevolutionary analysis is the technique of cophylogeny mapping, which aims to reconstruct the evolutionary history of the parasite with respect to the host tree (Charleston, 2003). This is achieved by mapping the parasite tree into the host tree where the initial associations (φ) are conserved (Jackson, 2005). This process requires four biological events, codivergence, divergence, host switch and loss, which represent all permitted evolutionary interactions between the host and the parasite (Ronquist, 1995).

A codivergence event is a concurrent divergence of both the host and parasite species. A high concentration of codivergence events is seen as a strong signal that the host and parasite have a coevolutionary dependence (Page, 2002). A duplication, conversely, is an independent divergence of the parasite which is not in response to a divergence of its host species. Following the parasite's divergence both new parasite species continue to infect the initial host (Charleston, 2003). A host switch, similar to a duplication, is independent of the evolutionary changes in its host species. Rather than both new parasite species continuing to infect a common host, as is the case for a duplication event, only one of the new parasites continues to infect the initial host, while the second parasite species establishes itself on a new independent host species (Charleston and Perkins, 2003). These three events are divergence events and are used to infer all possible parasite evolutionary events with respect to the host. A loss event, unlike a divergence event, is the case where the parasite fails to codiverge (Paterson et al., 2003). Following the host divergence only one of the two new host species remains infected by the initial parasite species.

The cophylogeny reconstruction problem aims to apply the process of cophylogeny mapping to recover a minimum cost map (Φ(P)) using the four recoverable events. The recovery of such a map has been proven to be NP-Hard (Ovadia et al., 2011). An example of a minimum cost map, Φ(P), which includes all four permitted events can be seen in Fig. 1.

The computational intractability of the cophylogeny reconstruction problem is due to the exponential number of node orderings possible for a bifurcating tree and the exponential number of host switch events that this gives rise to (Libeskind-Hadas and Charleston, 2009). Due to the difficult nature of this problem, significant research has been undertaken to approximate the cophylogeny reconstruction problem. Primarily, research has focused on imposing restrictions on the relative node ordering of the host or parasite tree (Conow et al., 2010; Libeskind-Hadas and Charleston, 2009; Merkle and Middendorf, 2005; Merkle et al., 2010).

One approach applied in both Tarzan (Merkle and Middendorf, 2005) and CoRe-PA (Merkle et al., 2010) is to ignore the relative ordering of the nodes in the parasite tree, allowing for a map to be recovered in quadratic time (Yodpinyanee et al., 2011). The issue with this approach, however, is that it has the potential of inducing time inconsistent solutions (Doyon et al., 2011b).

A time inconsistent map is a solution where the order of evolutionary events inferred from the map contradicts the order of evolutionary events evident in the parasite's phylogenetic history. Such a result is deemed to be biologically infeasible (Doyon et al., 2011b).

As a result of Tarzan and CoRe-PA's potential for recovering biologically infeasible solutions, recent research has focused primarily on traversing the exponential number of fixed node orderings using a metaheuristic (Conow et al., 2010; Doyon et al., 2011a,b; Libeskind-Hadas and Charleston, 2009). This approach has been shown to be effective, as solving the cophylogeny reconstruction problem where the internal node ordering is fixed can be solved in polynomial time (Libeskind-Hadas and Charleston, 2009). The initial implementation, known as Node Mapping, ran in O(n
                     7) (Conow et al., 2010), but has been subsequently replaced by Edge Mapping (Yodpinyanee et al., 2011), Slicing (Doyon et al., 2011a,b) and improved node mapping (Drinkwater and Charleston, 2014a), all running in cubic time. Of this set of cubic time algorithms, Edge Mapping and improved node mapping offer the best space complexity as both require only quadratic space (Yodpinyanee et al., 2011; Drinkwater and Charleston, 2014a) as opposed to Slicing which requires cubic space (Doyon et al., 2011a,b).

These algorithms are able to run in cubic time by leveraging certain topological properties of bifurcating trees. This is evident when considering each algorithm's computational complexity increase when the host phylogeny is a directed acyclic graph rather than a bifurcating tree. For this problem instance Node Mapping runs in O(n
                     7) (Conow et al., 2010) while Edge Mapping and Slicing currently cannot solve this more difficult problem (Doyon et al., 2011a,b; Yodpinyanee et al., 2011). This problem is even more difficult if the parasite phylogeny is a directed acyclic graph, with no published algorithm to date able to solve this problem in polynomial time even if the internal node ordering is known (Libeskind-Hadas and Charleston, 2009).

While a number of specialised characteristics for bifurcating trees have been applied that reduce the computational complexity of cophylogeny mapping, such as leveraging constant time queries for recovering the most recent common ancestor (Doyon et al., 2011a), and utilising that the number of edges in a tree is O(n) (Yodpinyanee et al., 2011), as far as we know no prior research has considered tree topology as a means to decrease the computational complexity of the cophylogeny reconstruction problem.

Evolutionary trees have long been identified as often having an unbalanced structure (Gregory, 2008). Modelling this unbalanced nature dates back at least to Yule's (1924) proposed model in 1924. While no synthetic model can capture the diversity of evolutionary behaviour, it has been shown that the topology of trees produced by the evolutionary process converges between the topology of trees produced by the Yule and Uniform models (Aldous, 2001; Mooers and Heard, 1997).

The Yule model, also known as the equal-rates-Markov model (Cavalli-Sforza and Edwards, 1967; Harding, 1971), is a synthetic bifurcating tree generation model which applies a continuous-time pure birth process starting with a single node (Aldous, 1996). Under this model the length of each branch in the phylogenetic tree has no bearing on the likelihood of speciation (Harding, 1971), where each leaf exists for a random period of time before speciating (Aldous, 1996). This process continues until the tree has n leaves where the model assumes that all speciation events are bifurcating and two species may not interbreed (Harding, 1971). This model can be extended further to consider extinction events, by modifying the rate of divergence (Aldous, 2001). The Yule model is often applied to simulate evolutionary systems as this model generates trees with a topology which represents the most balanced phylogenetic trees (Aldous, 2001).

The Uniform model, also known as proportional-to-distinguishable arrangements (PDA), is a synthetic tree generation model which produces trees through uniform sampling of all possible tree topologies (Rosen, 1978). This is not an explicit model of the evolutionary process, nor does this model grow trees (Mooers and Heard, 1997). Rather, the trees generated by the Uniform model are constructed by sampling uniformly from trees with n leaves (Aldous, 2001). Although this model does not simulate the evolutionary process directly, this model is often used as it appears to provide a bound for the most unbalanced phylogenetic trees (Aldous, 1993, 1991). As a result, Yule and Uniform trees provide a topological bound for expected evolutionary data (Aldous, 2001)

This research proposes a new data structure for cophylogeny analysis using improved node mapping. This data structure is shown to recover an optimal map, Φ(P), in subquadratic space, where the topologies of the host and parasite phylogenies are bounded by the topology of trees produced under the Yule and Uniform models. This topological boundary is in the sense that the evolutionary trees’ height and degree of balance are bounded by these synthetic models. This result is then used to prove a subcubic time complexity bound for improved node mapping. In both cases the time and space complexity bound reductions presented herein are shown to be in terms of a logarithmic factor.

@&#METHODOLOGY@&#

The most space efficient algorithms for solving the cophylogeny reconstruction problem where the internal node ordering is fixed require quadratic storage. The space complexity bound is due to the size of the dynamic programming tables which store linear subsolutions, where each subsolution consists of up to a linear number of mapping sites. A subsolution in this context is a list of possible mapping sites for the parasite node in question.

In this paper we prove that the traditional dynamic programming table used for this problem can be replaced to allow for a space complexity reduction. In particular, this work proves that when the host and parasite phylogenies’ structure, in the sense of balance and height, is bound between the topology of trees produced by the Yule and Uniform model (the majority of evolutionary data) (Aldous, 2001), that the proposed method provides a logarithmic factor reduction in the required space to solve the cophylogeny reconstruction problem optimally. This result, in turn, provides a logarithmic reduction in the time complexity as well.

The presented method may, at a later stage, be extended to Edge Mapping, however, this was not considered herein, as Edge Mapping also requires quadratic storage for preprocessing (Yodpinyanee et al., 2011), which would negate the space efficiency gains in terms of a worst case space complexity bound. This is not the case for the Improved Node Mapping algorithm, however, due to its preprocessing requirement of only linear time and space (Drinkwater and Charleston, 2014a).

Improved Node Mapping in its current form incrementally maps each parasite node into the host phylogeny from the leaves up to the root. Under this approach, the first pass of the algorithm maps the parasite leaves to their respective host leaves based on the input association set, (φ). Following this step, the internal parasite nodes are incrementally mapped into the host, if and only if, their children have already been mapped.

This approach therefore, lends itself to being implemented where all the nodes from each level of the parasite tree are processed before progressing to the next level (Conow et al., 2010). A node's level is the height of the node in the tree, that is, the length of the longest path between the current node and its descendents. Therefore, the leaves of the parasite tree are at level 0.

It has previously been shown that the subsolutions constructed for the leaves of the parasite tree, subsolutions at level 0, only require O(1) space (Drinkwater and Charleston, 2014a). As the algorithm continues to map parasite nodes into the host tree, the required space incrementally increases for each level of the parasite tree. The amount of space increases until it will require O(n) space for the set of mapping sites for each subsolution (Drinkwater and Charleston, 2014a). The proposed data structure takes advantage of the rate at which the number of mapping sites increases, to allow for a subquadratic space solution for the cophylogeny reconstruction problem where the internal node ordering is fixed.

The proposed data structure replaces the currently used two dimensional matrix for storing each subsolution with an array of lists. The array itself is O(n) in size, where each element represents a single parasite node. The lists stored in each array element consists of a list of unique mapping locations for the parasite node (p
                        
                           i
                        ) in the host, which is bounded by O(n), the number of internal nodes in the host tree. The worst case reconstruction using this data structure offers the same worst case space complexity bound as the dynamic programming matrix used by both Edge Mapping and improved node mapping.

The unique aspect of this data structure compared to a two dimensional array is that each list stored in the array is not fixed to the size of the host tree (2n
                        −1). This follows from the differences between the representation of a graph as either an adjacency matrix or an adjacency list. For sparse graphs an adjacency list has the potential to offer a significant reduction in the space complexity, while the worst case complexity bound in both cases is the same. Similarly, this work proves that phylogenetic trees which are bounded by the topologies produced by the Yule or Uniform models have sufficiently many subsolutions which require less than O(n) mapping sites, such that the overall storage requirement is subquadratic.


                        Fig. 2
                         is a visualisation of the proposed data structure where the subsolutions (p
                        0, …, p
                        2n−2) have been added to the array in increasing order based on their height in the tree, where (p
                        0, …, p
                        
                           n−1) are the subsolutions for the leaves of the parasite tree while p
                        2n−2 stores the root's subsolution. What is important to note is that for the first n (0, ..., n
                        −1) subsolutions only one mapping site is stored; the corresponding leaf node in the host tree for which the parasite, p
                        
                           i
                        , is associated. For the remaining (n
                        −1) internal nodes there are up to O(n) possible mapping sites. Initially, however, the subsolutions will have fewer than O(n) mapping sites, such as the mapping sites generated for the parasite nodes at level one, which will only have three possible mapping sites, as discussed in the following section. This is represented by the subsolution stored at index n, (m
                        0, m
                        1, m
                        2). The number of mapping sites will strictly increase (See Lemma 1) as the index increases until the number of required sites is bound by O(n); the case where each subsolution may be mapped to all nodes in the host tree.

The recovery of a map where internal node ordering is fixed has previously required the storage of linear subsolutions, where each subsolution consists of up to a linear number of mapping sites (Yodpinyanee et al., 2011). Although previous research has identified that mapping algorithms may not require linear mapping sites to be considered (Drinkwater and Charleston, 2014a), no prior analysis has proven any bound less than O(n).

To prove that the required number of mapping sites is less than O(n) for trees produced under the Yule and Uniform models, we first identify the number of mapping sites required at each level of a bifurcating tree, which allows for a map to be incrementally reconstructed. To establish this bound we consider the number of mapping sites for the leaves of the parasite phylogeny. These mapping sites represent the direct mapping formed by the associations between the parasite and host phylogenies, which is always one by our initial assumption. These are the first set of subsolutions reconstructed as the Node Mapping algorithm reconstructs an optimal map from the leaves to the root (Libeskind-Hadas and Charleston, 2009).

The next set of subsolutions to recover are for the parasite's internal nodes at level one. These are the internal nodes where both children have previously been mapped. These nodes have three possible mapping sites, which include the two minimum cost host switch events and either a codivergence or a duplication event (Drinkwater and Charleston, 2014a). Only one of these two events needs to be considered, as the optimal codivergence and duplication events both map to the same host node, the most recent common ancestor (Doyon et al., 2011a), and therefore only the most cost efficient solution needs to be stored to recover an optimal map.

The trend identified for level one can be used to compute the storage requirement for the nodes at level two. In this case, however, there may be potentially more than one optimal mapping site for the left and right child of the parasite node in question. We therefore must consider each mapping site for the left child and compare it to all other mapping sites for the right child. Each mapping site pair may have up to three possible mapping sites, giving rise to the recurrence relation, a
                        
                           i
                        ; the maximum number of mapping sites required for the subsolution of a parasite node at level i.


                        
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             a
                                             0
                                          
                                       
                                       
                                          =
                                          1
                                       
                                       
                                    
                                    
                                       
                                          
                                             a
                                             1
                                          
                                       
                                       
                                          =
                                          3
                                       
                                       
                                    
                                    
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       
                                          =
                                          3
                                          ×
                                          
                                             
                                                (
                                                
                                                   a
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             2
                                          
                                          
                                          for all
                                          
                                          i
                                          ≥
                                          1
                                       
                                       
                                    
                                 
                              
                           
                        
                     

It is important to note that the recursive function in Eq. (1) is the representation of the worst case, as it assumes that the children have an equivalent worst case cost and that each mapping site pair gives rise to a unique set of mappings. This can occur in the case where the host and parasite phylogenies are congruent balanced binary trees. As a tree becomes more unbalanced, however, there will be an increased number of cases where the left and right child will not have an equal number of mapping sites, as there are fewer cases where both children reside at the previous level. This results in a reduced number of mapping sites and a lower rate of growth for the function a
                        
                           i
                        . Therefore, Eq. (1) represents the worst case growth for the number of mapping sites for all bifurcating trees.


                        
                           Lemma 1
                           
                              The storage requirement for each subsolution, where i is the current level in the parasite phylogeny for which the subsolution is associated, is 
                              
                                 O
                                 (
                                 
                                    3
                                    
                                       (
                                       
                                          2
                                          i
                                       
                                       −
                                       1
                                       )
                                    
                                 
                                 )
                               
                              for all i
                              ≥1.
                           


                        
                           Proof
                           
                              
                                 
                                    (2)
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                                =
                                                3
                                                ×
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            −
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                                =
                                                
                                                   3
                                                   3
                                                
                                                ×
                                                
                                                   
                                                      (
                                                      
                                                         a
                                                         
                                                            i
                                                            −
                                                            2
                                                         
                                                      
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                                =
                                                …
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                                =
                                                
                                                   3
                                                   
                                                      
                                                         2
                                                         i
                                                      
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   a
                                                   i
                                                
                                                =
                                                
                                                   3
                                                   
                                                      
                                                         2
                                                         i
                                                      
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Lemma 1 provides a closed form function for a
                        
                           i
                         and can therefore be used to provide a tighter bound for the required storage, f(i), to solve the cophylogeny reconstruction problem. When combined with the existing worst case bound for the number of mapping sites required to solve this problem optimally, O(n), (Drinkwater and Charleston, 2014a) we get:


                        
                           
                              (3)
                              
                                 f
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                   if
                                                   
                                                   i
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   min
                                                   (
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   ,
                                                   n
                                                   )
                                                
                                                
                                                   
                                                   if
                                                   
                                                   i
                                                   ≥
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This result is of more interest if we can explicitly identify all values of i where 
                           
                              3
                              
                                 (
                                 
                                    2
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                           <
                           n
                        . If this value is in terms of n then there is the possibility of reconstructing an optimal map in subquadratic space. We show that there is such a strict set of values where 
                           
                              3
                              
                                 (
                                 
                                    2
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                           <
                           n
                        , defined as:


                        
                           Lemma 2
                           
                              
                                 
                                    3
                                    
                                       (
                                       
                                          2
                                          i
                                       
                                       −
                                       1
                                       )
                                    
                                 
                                 ≤
                                 n
                               
                              for all i
                              ≤log
                              2(log
                              3
                              n
                              +1)


                        
                           Proof
                           
                              
                                 
                                    (4)
                                    
                                       
                                          
                                             
                                                
                                                   3
                                                   
                                                      (
                                                      
                                                         2
                                                         i
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                ≤
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                   
                                                      (
                                                      
                                                         2
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                ≤
                                                3
                                                n
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   i
                                                
                                             
                                             
                                                ≤
                                                
                                                   log
                                                   3
                                                
                                                n
                                                +
                                                1
                                             
                                          
                                          
                                             
                                                i
                                             
                                             
                                                ≤
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   n
                                                   +
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Using Lemma 2 we redefine f(i) as.


                        
                           
                              (5)
                              
                                 f
                                 (
                                 i
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   i
                                                   =
                                                   0
                                                
                                             
                                             
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                
                                                   if
                                                   
                                                   0
                                                   <
                                                   i
                                                   ≤
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   n
                                                
                                                
                                                   if
                                                   
                                                   i
                                                   >
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To derive the total storage requirement for the proposed data structure requires that the number of nodes at each level is known along with the height of the tree. If we assume a function, g(i), exists which can calculate the number of nodes at each level and that h is the height of the tree, then we can define the storage requirement for solving the cophylogeny reconstruction problem using the proposed data structure as a geometric series (Eq. (6)).


                        
                           
                              (6)
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    h
                                 
                                 (
                                 f
                                 (
                                 i
                                 )
                                 ×
                                 g
                                 (
                                 i
                                 )
                                 )
                              
                           
                        
                     

The height of all trees is bound between log
                        n and (n
                        −1). For this proof we will show that if in the case where the height is (n
                        −1) and the function f(i) as defined in Eq. (5) is applied, both of which will over count the number of required mapping sites, that the space required to solve the cophylogeny reconstruction problem is subquadratic in size.

To derive the number of nodes at each level for trees produced under a Yule and Uniform model requires the introduction of a random variable L and the function C(x). L
                        
                           i
                         is the number of nodes at a level i in a tree, where L
                        0 is the number of leaves in the tree, n. C(j) is the number of cherries in a tree with j leaves, where a cherry is a pair of leaf nodes which are adjacent to a common ancestor node (McKenzie and Steel, 2000).

As trees produced under the Yule and Uniform models have previously been shown to append levels within their respective models at a constant rate (McKenzie and Steel, 2000), it is possible to construct a recurrence relation for the number of nodes expected at each level within a constructed tree in terms of L and the function C(x), as seen in Eq. (7).


                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             L
                                             1
                                          
                                       
                                       
                                          =
                                          C
                                          (
                                          
                                             L
                                             0
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             L
                                             2
                                          
                                       
                                       
                                          =
                                          C
                                          (
                                          
                                             L
                                             0
                                          
                                          −
                                          
                                             L
                                             1
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             L
                                             3
                                          
                                       
                                       
                                          =
                                          C
                                          (
                                          
                                             L
                                             0
                                          
                                          −
                                          
                                             L
                                             1
                                          
                                          −
                                          
                                             L
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             L
                                             i
                                          
                                       
                                       
                                          =
                                          C
                                          (
                                          
                                             L
                                             0
                                          
                                          −
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          
                                             L
                                             j
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Eq. (7) is of particular value as the initial number of cherries for trees constructed under a Yule or Uniform model has been proven by McKenzie and Steel to be 
                           
                              n
                              3
                           
                         and 
                           
                              n
                              4
                           
                         respectively (McKenzie and Steel, 2000). Therefore, using this prior result, we prove the following two Theorems (see Proof for Theorem A and Proof for Theorem B).


                        
                           Theorem 1
                           
                              The expected number of internal nodes at each level of a tree generated under a Yule process is 
                              
                                 
                                    
                                       
                                          2
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       n
                                    
                                    
                                       
                                          3
                                          i
                                       
                                    
                                 
                              
                              , where n is the number of leaves in the tree and i is the level for all i
                              ≥1.
                           


                        
                           Theorem 2
                           
                              The expected number of internal nodes at each level of a tree generated under a Uniform process is 
                              
                                 
                                    
                                       
                                          3
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                       n
                                    
                                    
                                       
                                          4
                                          i
                                       
                                    
                                 
                              
                              , where n is the number of leaves in the tree and i is the level for all i
                              ≥1.
                           


                        Theorems 1 and 2 provide a closed-form function for g(i) from Eq. (6). Combining these two results with the storage requirement function, f(i), provides a space complexity bound for trees produced under the expected Yule and Uniform models.

From the prior results we are able to define a pair of geometric series for the space required to solve the cophylogeny reconstruction problem for trees constructed under either the Yule or Uniform model. These definitions provide a worst case bound for the space requirements in both cases.


                        
                           Definition 1
                           The number of mapping sites required to recover an optimal map, Φ(P), for a tree constructed under an expected Yule process is 
                                 O
                                 
                                    
                                       
                                          n
                                          
                                             ∑
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                f
                                                (
                                                i
                                                )
                                             
                                             
                                                
                                                   3
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              , where f(i) defines the total number of nodes which need to be stored at each level.


                        
                           Definition 2
                           The number of mapping sites required to recover an optimal map, Φ(P), for a tree constructed under an expected Uniform process is 
                                 O
                                 
                                    
                                       (
                                    
                                 
                                 n
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          3
                                          
                                             (
                                             i
                                             −
                                             1
                                             )
                                          
                                       
                                       f
                                       (
                                       i
                                       )
                                    
                                    
                                       
                                          4
                                          i
                                       
                                    
                                 
                                 
                                    
                                       )
                                    
                                 
                              , where f(i) defines the total number of nodes which need to be stored at each level.

As a closed-form solution exists for f(i) (see Eq. (5)), the geometric series from Definitions 1 and 2 can be expanded to provide a worst case space complexity result for both Yule (ϒ(n)) and Uniform (Ψ(n)) trees.


                        
                           
                              (8)
                              
                                 ϒ
                                 (
                                 n
                                 )
                                 =
                                 O
                                 
                                    
                                       
                                          n
                                          +
                                          n
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                ⌋
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   3
                                                   
                                                      (
                                                      
                                                         2
                                                         i
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   3
                                                   i
                                                
                                             
                                          
                                          +
                                          n
                                          
                                             ∑
                                             
                                                i
                                                =
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                   ⌋
                                                
                                                +
                                                1
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                n
                                             
                                             
                                                
                                                   3
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 Ψ
                                 (
                                 n
                                 )
                                 =
                                 O
                                 
                                    
                                       
                                          n
                                          +
                                          n
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                ⌋
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   3
                                                   
                                                      (
                                                      
                                                         2
                                                         i
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   4
                                                   i
                                                
                                             
                                          
                                          +
                                          n
                                          
                                             ∑
                                             
                                                i
                                                =
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      n
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                ⌋
                                                +
                                                1
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   3
                                                   
                                                      (
                                                      i
                                                      −
                                                      1
                                                      )
                                                   
                                                
                                                n
                                             
                                             
                                                
                                                   4
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

By simplifying Eqs. (8) and (9) a new lower bound for the space complexity required for the cophylogeny reconstruction problem, where the internal node ordering is fixed, may be established. The proofs for both reductions can be seen in the Appendix (Proof for Theorem C and Proof for Theorem D), which give rise to the following Theorems.


                        
                           Theorem 3
                           
                              The required space for solving the cophylogeny reconstruction problem where the internal node ordering is fixed for trees constructed under the expected Yule process is bounded by 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      log
                                                      n
                                                      )
                                                   
                                                   
                                                      log
                                                      3
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Theorem 4
                           
                              The required space for solving the cophylogeny reconstruction problem where the internal node ordering is fixed for trees constructed under the expected Uniform process is bounded by 
                              
                                 O
                                 
                                    
                                       
                                          
                                             
                                                
                                                   n
                                                   2
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      log
                                                      n
                                                      )
                                                   
                                                   
                                                      2
                                                      −
                                                      log
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Theorems 3 and 4 prove that the proposed data structure provides the first subquadratic space algorithm which solves the cophylogeny reconstruction problem optimally when the internal node ordering is fixed for any tree topology. While the proposed algorithm offers no worst case improvement for all trees, this result shows that the proposed update to the underlying data structure of the improved node mapping algorithm provides a logarithmic reduction to the required space for the two models which bound the topology of evolutionary data (Aldous, 2001).


                        Theorems 3 and 4 provide a new worst case bound for space required to solve the cophylogeny reconstruction problem, where the internal node ordering is fixed. In this section we apply these two results to provide a reduction to the cubic time complexity bound faced by Improved Node Mapping.

A subquadratic space requirement is achieved for trees produced by the Yule and Uniform models by reducing the number of mapping sites stored for each subsolution. This result asserts that the total number of mapping sites which are stored for each subsolution is sublinear in size. From Theorems 3 and 4 we can derive the average number of mapping sites stored for each subsolution for trees produced by both the expected Yule (ψ(n)) and Uniform (υ(n)) models as:


                        
                           
                              (10)
                              
                                 ψ
                                 (
                                 n
                                 )
                                 =
                                 
                                    n
                                    
                                       
                                          
                                             (
                                             log
                                             n
                                             )
                                          
                                          
                                             log
                                             3
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 υ
                                 (
                                 n
                                 )
                                 =
                                 
                                    n
                                    
                                       
                                          
                                             (
                                             log
                                             n
                                             )
                                          
                                          
                                             2
                                             −
                                             log
                                             3
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The functions for the number of mapping sites stored for trees produced by the Yule (ψ(n)) and Uniform (υ(n)) models is constructed by dividing the total storage requirement for each tree by n, the number of subsolutions required to solve the cophylogeny reconstruction problem using improved node mapping. As a result, ψ(n) and υ(n) are the average number of mapping sites stored for each subsolution.

Node Mapping (Drinkwater and Charleston, 2014a) solves the cophylogeny reconstruction problem by executing n steps, where for each step a new subsolution is constructed. This process requires the generation of all the mapping sites possible from all the permutations of the previously recovered mapping sites for both children. Therefore, the total worst case running time for Yule and Uniform models is defined as:


                        
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          O
                                          (
                                          n
                                          
                                             
                                                (
                                                ψ
                                                (
                                                n
                                                )
                                                )
                                             
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          =
                                          O
                                          
                                             
                                                
                                                   n
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           log
                                                                           n
                                                                           )
                                                                        
                                                                        
                                                                           log
                                                                           3
                                                                           −
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               log
                                                               n
                                                               )
                                                            
                                                            
                                                               2
                                                               log
                                                               3
                                                               −
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          O
                                          
                                             
                                                (
                                                n
                                                (
                                                υ
                                                (
                                                n
                                                )
                                                )
                                             
                                             2
                                          
                                          )
                                       
                                    
                                    
                                       
                                       
                                          =
                                          O
                                          
                                             
                                                
                                                   n
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  n
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           log
                                                                           n
                                                                           )
                                                                        
                                                                        
                                                                           2
                                                                           −
                                                                           log
                                                                           3
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          O
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            n
                                                            3
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               log
                                                               n
                                                               )
                                                            
                                                            
                                                               4
                                                               −
                                                               2
                                                               log
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

This result provides approximately a log
                        n speed up for Improved Node Mapping. In the next section we demonstrate the improvements offered by the proposed update to the underlying data structure for the improved node mapping algorithm in practice, by comparing its runtime over both synthetic and real data sets to an implementation of Improved Node Mapping algorithm using a standard dynamic programming matrix.

In the previous section we presented a reduction in the worst case theoretical bound for the time and space complexity required to solve the cophylogeny reconstruction problem, where the host and parasite phylogenies are bound by the expected topology of trees produced by the Yule and Uniform models. In this section we compare two implementations of the improved node mapping algorithm (Drinkwater and Charleston, 2014a) to demonstrate how these theoretical bounds translate in practice. The first applies the traditional dynamic programming matrix while the second is implemented using the newly proposed data structure consisting of an array of lists of mapping sites.

While tools such as Jane (Conow et al., 2010; Yodpinyanee et al., 2011) and the implementation of Slicing by Doyon et al. (Doyon et al., 2011a,b) are also able to solve the cophylogeny reconstruction problem, this analysis was constrained to only consider improved node mapping, as this simulation aims to evaluate the complexity improvements offered by the proposed data structure. As Edge Mapping (Jane) and Slicing are implemented in such a way that the newly proposed data structure does not lend itself to reducing their worst case complexity, they were excluded from this evaluation.

This analysis focuses on demonstrating the running time reduction offered by the newly proposed data structure, as this is the limiting factor in the analysis of larger coevolutionary systems (Drinkwater and Charleston, 2014). The simulation was therefore constructed where both algorithms were implemented using a common code base for cophylogenetic reconstruction, where the data structure used to store mapping sites was the only code not shared by each approach. Implementing both algorithms in this manner ensured that any complexity differences were due to the data structure applied.

Both implementations of the improved node mapping algorithm were evaluated using two data sets. The first was an existing set of synthetic coevolutionary systems produced using CoRe-Gen (Cophylogeny Generation Model) (Keller-Schmidt et al., 2011). This data set has been previously used for coevolutionary analysis (Rosenblueth et al., 2012; Liu et al., 2014) and contains 1000 coevolutionary instances where both the host and parasite phylogenies were generated using the Yule model. Of the 1000 data sets, 47 contain trees with only a single node. These data sets were excluded, consistent with previous analysis (Drinkwater and Charleston, 2014).

The second data set contains 102 previously published coevolutionary instances (Drinkwater and Charleston, 2014). This set includes evolutionary data from a number of fields including but not limited to, pathogens and their hosts (Charleston and Robertson, 2002), plant-insect relationships (McLeish et al., 2007), the evolutionary dependencies between plants and fungi (Refrégier et al., 2008), parasitic (Page et al., 2004) and mutualistic (Jackson, 2004) coevolution, and biogeography (Badets et al., 2011). The aim of this data set is to ensure that the running time improvements offered by the newly proposed data structure are consistent across the full spectrum of coevolutionary instances.


                     Fig. 3
                      is a plot of the running time required to approximate each of the 953 synthetic data sets. Each data point in the plot is the median running time of 100 replicates of the genetic algorithm used to approximate the cophylogeny reconstruction problem. The genetic algorithm in this case is configured to execute 10000 iterations of the Improved Node Mapping algorithm over a subset of the exponential number of fixed node orderings. The reported running times for each algorithm demonstrate that the newly proposed data structure is consistently faster than the previous algorithm with a median reduction in the running time over 953 data sets of 46%.

The plot of all synthetic data sets as seen in Fig. 3 displays a number of outliers which show little to no improvement (less than 20%) when applying the proposed data structure. Further analysis of this subset identified that in all cases these coevolutionary instances included a tree, either the host or parasite, with fewer than five leaf nodes.

As a result we filtered the synthetic data to only include coevolutionary instances where both the host and parasite trees have at least five leaf nodes. This data set includes 748 synthetically generated coevolutionary instances, which can be seen plotted in Fig. 4
                     . For this filtered set the median reduction in the running time was 52%.

Both Figs. 3 and 4 provide a compelling argument that as the number of nodes in a coevolutionary instance grows, so too does the reduction in running time when applying the proposed data structure. The differences in the number of outliers between Figs. 3 and 4 demonstrate, however, that for sufficiently small trees the improvements offered by the proposed data structure are potentially offset.

In the case of the real data set, a similar trend as seen in the filtered set of synthetic data was evident, as shown in Fig. 5
                     . As with the synthetic data set, 100 replicates were run for each coevolutionary instance, where the median running time was recorded on the presented plot. Over the 102 data sets there was a median reduction in the running time for the algorithm using the newly proposed data structure of approximately 48%.

Due to the change in the underlying data structure of the Improved Node Mapping algorithm, it is important to verify that the running time improvement has not come at the expense of the algorithm's accuracy. While we proved that all mapping sites required to recover an optimal map are recorded in the proposed data structure, we also confirm that there was no degradation to its accuracy in practice, by comparing the resultant map costs generated for all real and synthetic coevolutionary instances. As both algorithms are run within a metaheuristic framework, a genetic algorithm for this experiment, it is expected that there will be a slight variation for the cost of the recorded maps. This variation, however, was expected to be minimal as both algorithms were run for the same number of iterations with equal population sizes.

Over the synthetic data set there was a 0.001% difference in the reported costs across all 953 data sets, while over the real data set there was a 0.003% difference in the reported costs across the 102 data sets. In both cases the newly proposed data structure performed marginally worse, although this minimal difference showed no statistical significance.

This demonstrates that both algorithms consistently converge on cophylogeny mapping with an equivalent cost, while the algorithm applying the newly proposed data structure runs in almost half the time. This reduction grows as the coevolutionary systems considered grow in size, as the reduction achieved using the proposed data structure is in terms of a logarithmic factor. This was evident when comparing the median running time reduction for the largest coevolutionary systems for both the real and synthetic data sets. For the synthetic data set the median decrease in the running time for all coevolutionary systems with at least 100 nodes was 78%. This subset of instances had a median size of 198 nodes. For the real data set the median running time reduction for all coevolutionary systems with at least 100 nodes was 63%. This subset of instances had a median size of 129 nodes. In both cases this was a significantly larger reduction compared to the complete data sets which only showed a reduction of 46% and 48% respectively, providing further evidence of a logarithmic reduction in the running time of the improved node mapping algorithm.

@&#CONCLUSION@&#

This research emphasises the importance of data structure selection in the development of algorithms for bioinformatics applications, particularly for those processing phylogenetic data, and demonstrates the benefits possible when targeting the topology of phylogenetic data when designing new, or optimising existing algorithms. This research proves that not only is a reduction in running time possible when optimising algorithms to take advantage of the evolutionary data's topology, but that such a reduction can be logarithmic in terms of the size of the coevolutionary instance. As a result, the presented method provides the ability for coevolutionary analysis of larger coevolutionary systems than has previously been possible, using the fixed node ordering permutation of the cophylogeny reconstruction problem.

The authors declare that they have no competing interests.

BD is responsible for the creation and implementation of the proposed data structure along with contributing to this manuscript. MAC is responsible for the original problem definition along with contributing to this manuscript.

@&#ACKNOWLEDGEMENTS@&#

We thank Anastasios Viglas for the valuable guidance in how to approach the analysis undertaken within this work which has greatly benefited this final manuscript. This work was supported by an Australian Postgraduate Award to BD and an Australian Research Council Grant (Grant No. DP1094891) to MAC.


                     
                        Proof
                        By induction we prove that 
                              
                                 L
                                 i
                              
                              =
                              
                                 
                                    
                                       2
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    n
                                 
                                 
                                    
                                       3
                                       i
                                    
                                 
                              
                            for all trees produced by the Yule model


                           True for i
                           =1


                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                i
                                             
                                             =
                                             
                                                
                                                   
                                                      2
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   n
                                                
                                                
                                                   
                                                      3
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                                1
                                             
                                             =
                                             
                                                n
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                                1
                                             
                                             =
                                             C
                                             (
                                             
                                                L
                                                0
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        


                           Assume true for i
                           =
                           k
                        


                           
                              
                                 (15)
                                 
                                    
                                       L
                                       k
                                    
                                    =
                                    
                                       
                                          
                                             2
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          n
                                       
                                       
                                          
                                             3
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        


                           Prove true for i
                           =
                           k
                           +1


                           
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                             C
                                             
                                                
                                                   
                                                      
                                                         L
                                                         0
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         L
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             E
                                             (
                                             
                                                L
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             =
                                             E
                                             
                                                
                                                   
                                                      C
                                                      
                                                         
                                                            
                                                               
                                                                  L
                                                                  0
                                                               
                                                               −
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  k
                                                               
                                                               
                                                                  L
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                3
                                             
                                             ×
                                             
                                                
                                                   
                                                      E
                                                      (
                                                      
                                                         L
                                                         0
                                                      
                                                      )
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      E
                                                      (
                                                      
                                                         L
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                3
                                             
                                             ×
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                               
                                                                  j
                                                                  −
                                                                  1
                                                               
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               3
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                3
                                             
                                             ×
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      
                                                         n
                                                         2
                                                      
                                                      ×
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                6
                                             
                                             ×
                                             
                                                
                                                   
                                                      2
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     2
                                                                     3
                                                                  
                                                               
                                                            
                                                         
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                6
                                             
                                             ×
                                             
                                                
                                                   
                                                      2
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        
                                                                           2
                                                                           3
                                                                        
                                                                        
                                                                           k
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        2
                                                                        3
                                                                     
                                                                  
                                                               
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                6
                                             
                                             ×
                                             
                                                
                                                   
                                                      2
                                                      −
                                                      3
                                                      +
                                                      
                                                         
                                                            
                                                               2
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                               k
                                                            
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                6
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               2
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   
                                                      2
                                                      k
                                                   
                                                   n
                                                
                                                
                                                   
                                                      3
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore 
                              
                                 L
                                 i
                              
                              =
                              
                                 
                                    
                                       2
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    n
                                 
                                 
                                    
                                       3
                                       i
                                    
                                 
                              
                            for all i
                           ≥1.


                     
                        Proof
                        By induction we prove that 
                              
                                 L
                                 i
                              
                              =
                              
                                 
                                    
                                       3
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    n
                                 
                                 
                                    
                                       4
                                       i
                                    
                                 
                              
                            for all trees produced by the Uniform model


                           True for i
                           =1


                           
                              
                                 (17)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                i
                                             
                                             =
                                             
                                                
                                                   
                                                      3
                                                      
                                                         i
                                                         −
                                                         1
                                                      
                                                   
                                                   n
                                                
                                                
                                                   
                                                      4
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                                1
                                             
                                             =
                                             
                                                n
                                                4
                                             
                                          
                                       
                                       
                                          
                                             
                                                L
                                                1
                                             
                                             =
                                             C
                                             (
                                             
                                                L
                                                0
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        


                           Assume true for i
                           =
                           k
                        


                           
                              
                                 (18)
                                 
                                    
                                       L
                                       k
                                    
                                    =
                                    
                                       
                                          
                                             3
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          n
                                       
                                       
                                          
                                             4
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        


                           Prove for i
                           =
                           k
                           +1


                           
                              
                                 (19)
                                 
                                    
                                       
                                          
                                             
                                                L
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             =
                                             C
                                             
                                                
                                                   
                                                      
                                                         L
                                                         0
                                                      
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         L
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             E
                                             (
                                             
                                                L
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          
                                             =
                                             E
                                             
                                                
                                                   
                                                      C
                                                      
                                                         
                                                            
                                                               
                                                                  L
                                                                  0
                                                               
                                                               −
                                                               
                                                                  ∑
                                                                  
                                                                     j
                                                                     =
                                                                     1
                                                                  
                                                                  k
                                                               
                                                               
                                                                  L
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                4
                                             
                                             ×
                                             
                                                
                                                   
                                                      E
                                                      (
                                                      
                                                         L
                                                         0
                                                      
                                                      )
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      E
                                                      (
                                                      
                                                         L
                                                         j
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                4
                                             
                                             ×
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               3
                                                               
                                                                  j
                                                                  −
                                                                  1
                                                               
                                                            
                                                            n
                                                         
                                                         
                                                            
                                                               4
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                4
                                             
                                             ×
                                             
                                                
                                                   
                                                      n
                                                      −
                                                      
                                                         n
                                                         3
                                                      
                                                      ×
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               3
                                                               j
                                                            
                                                         
                                                         
                                                            
                                                               4
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                12
                                             
                                             ×
                                             
                                                
                                                   
                                                      3
                                                      −
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         k
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                12
                                             
                                             ×
                                             
                                                
                                                   
                                                      3
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    3
                                                                                    4
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           k
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        3
                                                                        4
                                                                     
                                                                  
                                                               
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                12
                                             
                                             ×
                                             
                                                
                                                   
                                                      3
                                                      −
                                                      4
                                                      +
                                                      
                                                         
                                                            
                                                               3
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               4
                                                               k
                                                            
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                12
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               3
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               4
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   
                                                      3
                                                      k
                                                   
                                                   n
                                                
                                                
                                                   
                                                      4
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore 
                              
                                 L
                                 i
                              
                              =
                              
                                 
                                    
                                       3
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    n
                                 
                                 
                                    
                                       4
                                       i
                                    
                                 
                              
                            for all i
                           ≥1.


                     
                        Proof
                        The worst case space complexity can be evaluated by simplifying the two geometric series first defined in Eq. (8). We define these two series as α(n) and β(n) in the form:


                           
                              
                                 (20)
                                 
                                    α
                                    (
                                    n
                                    )
                                    =
                                    n
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          ⌋
                                       
                                    
                                    
                                       
                                          
                                             2
                                             
                                                (
                                                i
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             3
                                             
                                                (
                                                
                                                   2
                                                   i
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             3
                                             i
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    β
                                    (
                                    n
                                    )
                                    =
                                    n
                                    
                                       ∑
                                       
                                          i
                                          =
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             ⌋
                                          
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             2
                                             
                                                (
                                                i
                                                −
                                                1
                                                )
                                             
                                          
                                          n
                                       
                                       
                                          
                                             3
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        

These two equations will be evaluated in terms of only n so as to evaluate the worst case space complexity for trees constructed under a Yule process.


                     Simplifying α(n)


                     
                        Lemma 3
                        
                           
                              
                                 
                                    
                                       2
                                       
                                          (
                                          i
                                          −
                                          1
                                          )
                                       
                                    
                                    
                                       3
                                       
                                          (
                                          
                                             2
                                             i
                                          
                                          −
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                       3
                                       i
                                    
                                 
                              
                            
                           is super increasing.
                        

For a function to be super increasing the following must be true:


                     
                        
                           (22)
                           
                              
                                 
                                    
                                       a
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    
                                       a
                                       n
                                    
                                 
                              
                              >
                              2
                           
                        
                     
                  

From Eq. (20) we have the following.


                     
                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                a
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                a
                                                i
                                             
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             
                                                2
                                                i
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                3
                                                
                                                   i
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                3
                                                i
                                             
                                          
                                          
                                             
                                                2
                                                
                                                   (
                                                   i
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             2
                                             ×
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                   −
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                   )
                                                
                                             
                                          
                                          3
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             2
                                             ×
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      2
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          3
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             2
                                             ×
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   )
                                                
                                             
                                          
                                          3
                                       
                                       
                                       which is greater than 2 if
                                       
                                       i
                                       ≥
                                       0
                                    
                                 
                              
                           
                        
                     
                  

Therefore, 
                        
                           
                              
                                 
                                    2
                                    
                                       (
                                       i
                                       −
                                       1
                                       )
                                    
                                 
                                 
                                    3
                                    
                                       (
                                       
                                          2
                                          i
                                       
                                       −
                                       1
                                       )
                                    
                                 
                              
                              
                                 
                                    3
                                    i
                                 
                              
                           
                        
                      is super increasing for all i
                     ≥1. As a result the geometric series α can be approximated by only computing the final term of the series and multiplying this result by 2. As the series is in terms of a super increasing function this result is guaranteed to be greater than the actual series allowing for us to derive a worst case bound for this series.


                     
                        
                           (24)
                           
                              
                                 
                                    
                                       α
                                       (
                                       n
                                       )
                                    
                                    
                                       =
                                       n
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             ⌋
                                          
                                       
                                       
                                          
                                             
                                                2
                                                
                                                   (
                                                   i
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                3
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          n
                                          2
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             ⌋
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          i
                                       
                                       ×
                                       
                                          3
                                          
                                             (
                                             
                                                2
                                                i
                                             
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       2
                                       ×
                                       
                                          n
                                          2
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             ⌋
                                          
                                       
                                       ×
                                       
                                          3
                                          
                                             
                                                2
                                                
                                                   ⌊
                                                   
                                                      
                                                         log
                                                         2
                                                      
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   ⌋
                                                
                                             
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       n
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                             
                                             ⌋
                                          
                                       
                                       ×
                                       
                                          3
                                          
                                             (
                                             
                                                log
                                                3
                                             
                                             n
                                             +
                                             1
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          n
                                          2
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         2
                                                         
                                                            ⌊
                                                            
                                                               
                                                                  log
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                            
                                                            ⌋
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                         
                                                            (
                                                            
                                                               log
                                                               2
                                                            
                                                            3
                                                            ⌊
                                                            
                                                               
                                                                  log
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               ⌋
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          n
                                          2
                                       
                                       ×
                                       
                                          2
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ⌋
                                             
                                             (
                                             1
                                             −
                                             
                                                log
                                                2
                                             
                                             3
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ≤
                                       
                                          n
                                          2
                                       
                                       ×
                                       
                                          
                                             (
                                             
                                                log
                                                3
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                             +
                                             1
                                             )
                                          
                                          
                                             1
                                             −
                                             
                                                log
                                                2
                                             
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       
                                          
                                             
                                                n
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   3
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     Simplifying β(n)


                     
                        
                           (25)
                           
                              β
                              (
                              n
                              )
                              =
                              n
                              
                                 ∑
                                 
                                    i
                                    =
                                    ⌊
                                    
                                       
                                          log
                                          2
                                       
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                       ⌋
                                    
                                    +
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       2
                                       
                                          (
                                          i
                                          −
                                          1
                                          )
                                       
                                    
                                    n
                                 
                                 
                                    
                                       3
                                       i
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       n
                                       2
                                    
                                 
                                 2
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    ⌊
                                    
                                       
                                          log
                                          2
                                       
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                       ⌋
                                    
                                    +
                                    1
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             2
                                             3
                                          
                                       
                                    
                                 
                                 i
                              
                              =
                              
                                 
                                    3
                                    
                                       n
                                       2
                                    
                                 
                                 2
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ⌋
                                             
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          n
                                       
                                    
                                 
                              
                              
                              as
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    a
                                 
                                 b
                              
                              
                                 r
                                 i
                              
                              =
                              
                                 
                                    
                                       r
                                       a
                                    
                                    −
                                    
                                       r
                                       
                                          b
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    r
                                 
                              
                              =
                              
                                 
                                    3
                                    
                                       n
                                       2
                                    
                                 
                                 2
                              
                              ×
                              
                                 
                                    
                                       
                                          2
                                          3
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ⌋
                                             
                                          
                                       
                                       −
                                       
                                          2
                                          3
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 n
                                 2
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            2
                                                            
                                                               log
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ⌋
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              ≤
                              
                                 n
                                 2
                              
                              ×
                              
                                 
                                    
                                       
                                          1
                                          
                                             
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   n
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   3
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      3
                                                   
                                                
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       n
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          n
                                          +
                                          1
                                          )
                                       
                                       
                                          
                                             log
                                             2
                                          
                                          3
                                          −
                                          1
                                       
                                    
                                 
                              
                              −
                              
                                 n
                                 2
                              
                              
                                 
                                    
                                       
                                          
                                             2
                                             3
                                          
                                       
                                    
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              ≈
                              
                                 
                                    
                                       n
                                       2
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          n
                                          +
                                          1
                                          )
                                       
                                       
                                          
                                             log
                                             2
                                          
                                          3
                                          −
                                          1
                                       
                                    
                                 
                              
                              
                              as
                              
                              
                                 lim
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              
                                 n
                                 2
                              
                              
                                 
                                    
                                       
                                          
                                             2
                                             3
                                          
                                       
                                    
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              =
                              0
                           
                        
                     
                  


                     Combining the result
                  


                     
                        
                           (26)
                           
                              O
                              
                                 
                                    
                                       n
                                       +
                                       n
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             ⌊
                                             
                                                
                                                   log
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ⌋
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                                
                                                   (
                                                   i
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                3
                                                i
                                             
                                          
                                       
                                       +
                                       n
                                       
                                          ∑
                                          
                                             i
                                             =
                                             
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   ⌋
                                                
                                                +
                                                1
                                             
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             
                                                2
                                                
                                                   (
                                                   i
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             n
                                          
                                          
                                             
                                                3
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              O
                              
                                 
                                    
                                       n
                                       +
                                       
                                          
                                             
                                                n
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   
                                                      (
                                                      n
                                                      )
                                                   
                                                   +
                                                   1
                                                   )
                                                   )
                                                
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   3
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                n
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      log
                                                      3
                                                   
                                                   n
                                                   +
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   3
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

As log
                     3
                     n is equal to 
                        
                           
                              
                                 
                                    
                                       log
                                    
                                    2
                                 
                                 n
                              
                              
                                 
                                    
                                       log
                                    
                                    2
                                 
                                 3
                              
                           
                        
                      by removing all constant factors we can derive the following worst case complexity of:


                     
                        
                           (27)
                           
                              O
                              
                                 
                                    
                                       
                                          
                                             
                                                n
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   log
                                                   n
                                                   )
                                                
                                                
                                                   log
                                                   3
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Proving Theorem 3.


                     
                        Proof
                        The worst case space complexity can be evaluated by simplifying the two geometric series first defined in Eq. (9). We define these two series as γ(n) and δ(n) in the form:


                           
                              
                                 (28)
                                 
                                    γ
                                    (
                                    n
                                    )
                                    =
                                    n
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             ⌋
                                          
                                       
                                    
                                    
                                       
                                          
                                             3
                                             
                                                (
                                                i
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             3
                                             
                                                (
                                                
                                                   2
                                                   i
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             4
                                             i
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    δ
                                    (
                                    n
                                    )
                                    =
                                    n
                                    
                                       ∑
                                       
                                          i
                                          =
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             ⌋
                                          
                                          +
                                          1
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             3
                                             
                                                (
                                                i
                                                −
                                                1
                                                )
                                             
                                          
                                          n
                                       
                                       
                                          
                                             4
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        

These two equations will be evaluated in terms of only n so as to evaluate the worst case space complexity for trees constructed under the Uniform model.


                           Simplifying γ(n)


                           
                              Lemma 4
                              
                                 
                                    
                                       
                                          
                                             
                                                3
                                                
                                                   (
                                                   i
                                                   −
                                                   1
                                                   )
                                                
                                             
                                             
                                                3
                                                
                                                   (
                                                   
                                                      2
                                                      i
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                4
                                                i
                                             
                                          
                                       
                                    
                                  
                                 is super increasing.
                              

For a function to be super increasing the following must be true:


                           
                              
                                 (30)
                                 
                                    
                                       
                                          
                                             a
                                             
                                                n
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             a
                                             n
                                          
                                       
                                    
                                    >
                                    2
                                 
                              
                           
                        

From Eq. (28) we have the following.


                           
                              
                                 (31)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             =
                                             
                                                
                                                   
                                                      3
                                                      i
                                                   
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      4
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      4
                                                      i
                                                   
                                                
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   3
                                                   ×
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         −
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         −
                                                         1
                                                         )
                                                         )
                                                      
                                                   
                                                
                                                4
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   3
                                                   ×
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            2
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                
                                                4
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   3
                                                   ×
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         )
                                                      
                                                   
                                                
                                                4
                                             
                                             
                                             which is greater than 2 if
                                             
                                             i
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                              
                           
                        

As 
                              
                                 
                                    
                                       
                                          3
                                          
                                             (
                                             i
                                             −
                                             1
                                             )
                                          
                                       
                                       
                                          3
                                          
                                             (
                                             
                                                2
                                                i
                                             
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                          4
                                          i
                                       
                                    
                                 
                              
                            is super increasing for all i
                           ≥1. As a result the geometric series can be approximated by only computing the final term of the series and multiplying this result by 2. As the series is in terms of a super increasing function this result is guaranteed to be greater than the actual series allowing for us to derive a worst case bound for this series.


                           
                              
                                 (32)
                                 
                                    γ
                                    (
                                    n
                                    )
                                    =
                                    n
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          ⌋
                                       
                                    
                                    
                                       
                                          
                                             3
                                             
                                                (
                                                i
                                                −
                                                1
                                                )
                                             
                                          
                                          
                                             3
                                             
                                                (
                                                
                                                   2
                                                   i
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          
                                             4
                                             i
                                          
                                       
                                    
                                    =
                                    
                                       n
                                       3
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          ⌋
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   3
                                                   4
                                                
                                             
                                          
                                       
                                       i
                                    
                                    ×
                                    
                                       3
                                       
                                          (
                                          
                                             2
                                             i
                                          
                                          −
                                          1
                                          )
                                       
                                    
                                    ≤
                                    2
                                    ×
                                    
                                       n
                                       3
                                    
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   3
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          ⌋
                                       
                                    
                                    ×
                                    
                                       3
                                       
                                          
                                             2
                                             
                                                ⌊
                                                
                                                   
                                                      log
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         log
                                                         3
                                                      
                                                      
                                                         (
                                                         n
                                                         )
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                                ⌋
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    ≤
                                    
                                       
                                          2
                                          n
                                       
                                       3
                                    
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   3
                                                   4
                                                
                                             
                                          
                                       
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                          
                                          ⌋
                                       
                                    
                                    ×
                                    
                                       3
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          n
                                          +
                                          1
                                          −
                                          1
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             n
                                             2
                                          
                                       
                                       3
                                    
                                    ×
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         (
                                                         
                                                            log
                                                            2
                                                         
                                                         3
                                                         ⌊
                                                         
                                                            
                                                               log
                                                               2
                                                            
                                                            
                                                               (
                                                               
                                                                  log
                                                                  3
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               +
                                                               1
                                                               )
                                                            
                                                            ⌋
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         (
                                                         2
                                                         ⌊
                                                         
                                                            
                                                               log
                                                               2
                                                            
                                                            
                                                               (
                                                               
                                                                  log
                                                                  3
                                                               
                                                               
                                                                  (
                                                                  n
                                                                  )
                                                               
                                                               +
                                                               1
                                                               )
                                                            
                                                            ⌋
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             n
                                             2
                                          
                                       
                                       3
                                    
                                    ×
                                    
                                       2
                                       
                                          ⌊
                                          
                                             
                                                log
                                                2
                                             
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             ⌋
                                          
                                          (
                                          
                                             log
                                             2
                                          
                                          3
                                          −
                                          2
                                          )
                                       
                                    
                                    ≤
                                    
                                       
                                          2
                                          
                                             n
                                             2
                                          
                                       
                                       3
                                    
                                    ×
                                    
                                       
                                          (
                                          
                                             log
                                             3
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                          +
                                          1
                                          )
                                       
                                       
                                          
                                             log
                                             2
                                          
                                          3
                                          −
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          2
                                          
                                             n
                                             2
                                          
                                       
                                       
                                          3
                                          
                                             
                                                (
                                                
                                                   log
                                                   3
                                                
                                                
                                                   (
                                                   n
                                                   )
                                                
                                                +
                                                1
                                                )
                                             
                                             
                                                2
                                                −
                                                
                                                   log
                                                   2
                                                
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           Simplifying δ(n)


                           
                              
                                 (33)
                                 
                                    
                                       
                                          
                                             δ
                                             (
                                             n
                                             )
                                          
                                          
                                             =
                                             n
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   ⌊
                                                   
                                                      
                                                         log
                                                         2
                                                      
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                      ⌋
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   n
                                                
                                                
                                                   
                                                      4
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                3
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   ⌊
                                                   
                                                      
                                                         log
                                                         2
                                                      
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                      ⌋
                                                   
                                                   +
                                                   1
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            4
                                                         
                                                      
                                                   
                                                
                                                i
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   4
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                3
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⌊
                                                            
                                                               
                                                                  log
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               ⌋
                                                            
                                                            +
                                                            1
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         n
                                                      
                                                   
                                                
                                             
                                             
                                             as
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   a
                                                
                                                b
                                             
                                             
                                                r
                                                i
                                             
                                             =
                                             
                                                
                                                   
                                                      r
                                                      a
                                                   
                                                   −
                                                   
                                                      r
                                                      
                                                         b
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                   −
                                                   r
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   4
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                3
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         3
                                                         4
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⌊
                                                            
                                                               
                                                                  log
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               ⌋
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         3
                                                         4
                                                      
                                                      ×
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            n
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                n
                                                2
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           2
                                                                           
                                                                              
                                                                                 log
                                                                                 2
                                                                              
                                                                              3
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           2
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ⌊
                                                            
                                                               
                                                                  log
                                                                  2
                                                               
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  
                                                                     (
                                                                     n
                                                                     )
                                                                  
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               ⌋
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            n
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≤
                                             
                                                n
                                                2
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     log
                                                                     3
                                                                  
                                                                  n
                                                                  +
                                                                  1
                                                                  )
                                                               
                                                               
                                                                  2
                                                                  −
                                                                  
                                                                     log
                                                                     2
                                                                  
                                                                  3
                                                               
                                                            
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     3
                                                                     4
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            n
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         n
                                                         +
                                                         1
                                                         )
                                                      
                                                      
                                                         
                                                            log
                                                            2
                                                         
                                                         3
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                n
                                                2
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             ≈
                                             
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         n
                                                         +
                                                         1
                                                         )
                                                      
                                                      
                                                         
                                                            log
                                                            2
                                                         
                                                         3
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                             as
                                             
                                             
                                                lim
                                                
                                                   n
                                                   →
                                                   ∞
                                                
                                             
                                             
                                                n
                                                2
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            3
                                                            4
                                                         
                                                      
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                          
                                       
                                    
                                 
                              
                           
                        


                           Combining the result
                        


                           
                              
                                 (34)
                                 
                                    O
                                    
                                       
                                          
                                             n
                                             +
                                             n
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   ⌊
                                                   
                                                      
                                                         log
                                                         2
                                                      
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                      ⌋
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      3
                                                      
                                                         (
                                                         
                                                            2
                                                            i
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      4
                                                      i
                                                   
                                                
                                             
                                             +
                                             n
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   
                                                      ⌊
                                                      
                                                         
                                                            log
                                                            2
                                                         
                                                         
                                                            (
                                                            
                                                               log
                                                               3
                                                            
                                                            
                                                               (
                                                               n
                                                               )
                                                            
                                                            +
                                                            1
                                                            )
                                                         
                                                         ⌋
                                                      
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      3
                                                      
                                                         (
                                                         i
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   n
                                                
                                                
                                                   
                                                      4
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    =
                                    O
                                    
                                       
                                          
                                             n
                                             +
                                             
                                                
                                                   2
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                
                                                   3
                                                   
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         
                                                            (
                                                            n
                                                            )
                                                         
                                                         +
                                                         1
                                                         )
                                                         )
                                                      
                                                      
                                                         2
                                                         −
                                                         
                                                            log
                                                            2
                                                         
                                                         3
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            log
                                                            3
                                                         
                                                         n
                                                         +
                                                         1
                                                         )
                                                      
                                                      
                                                         2
                                                         −
                                                         
                                                            log
                                                            2
                                                         
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

As log
                           3
                           n is equal to 
                              
                                 
                                    
                                       
                                          
                                             log
                                          
                                          2
                                       
                                       n
                                    
                                    
                                       
                                          
                                             log
                                          
                                          2
                                       
                                       3
                                    
                                 
                              
                            by removing all constant factors we can derive the following worst case complexity of:


                           
                              
                                 (35)
                                 
                                    O
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      n
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         log
                                                         n
                                                         )
                                                      
                                                      
                                                         2
                                                         −
                                                         log
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Proving Theorem 4.

@&#REFERENCES@&#

