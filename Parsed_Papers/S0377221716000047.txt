@&#MAIN-TITLE@&#Benders decomposition and an IP-based heuristic for selecting IMRT treatment beam angles


@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We apply two Bender decomposition algorithms for intensity modulated radiation therapy treatment planning.


                        
                        
                           
                           We develop a novel two-stage heuristic for intensity modulated radiation therapy treatment planning.


                        
                        
                           
                           All methods are tested using real patient data to evaluate their effectiveness.


                        
                        
                           
                           Best results were provided by our two-stage heuristic with local branching.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Intensity modulated radiation therapy (IMRT)

Radiation therapy

Benders decomposition

Local branching

Integer programming

@&#ABSTRACT@&#


               
               
                  In this paper, two Benders decomposition algorithms and a novel two-stage integer programming-based heuristic are presented to optimize the beam angle and fluence map in Intensity Modulated Radiation Therapy (IMRT) planning. Benders decomposition is first implemented in the traditional manner by iteratively solving the restricted master problem and then identifying and adding the violated Benders cuts. We also implemented Benders decomposition using the “lazy constraint” feature included in CPLEX. In contrast, the two-stage heuristic first seeks to find a good solution by iteratively eliminating the least used angles in the linear programming relaxation solution until the size of the formulation is manageable. In the second stage of the heuristic, the solution is improved by applying local branching. The various methods were tested on real patient data to evaluate their effectiveness and runtime characteristics. The results indicated that implementing Benders using the lazy constraint usually led to better feasible solutions than the traditional approach. Moreover, the LP rounding heuristic was seen to generate high-quality solutions within a short amount of time, with further improvement obtained with the local branching search.
               
            

@&#INTRODUCTION@&#

Intensity modulated radiation therapy (IMRT) is one of the most commonly used procedures to treat cancer patients because of its demonstrated capability to deliver a highly conformal dose of radiation to tumors while minimizing damage to nearby healthy organs. During the procedure, the patient lies on a specially designed couch while a linear accelerator (LINAC) generates photon beams to irradiate the target volume. The movable arm, called the gantry, of the LINAC can rotate 360º in a plane perpendicular to the couch. In sequence, it stops at a predetermined set of angles to deliver the radiation. If need be the couch can also rotate. At each angle, various two-dimensional beam shapes are constructed by a computer controlled multi-leaf collimator (MLC) in the LINAC to conform to the beam's-eye-view of the target volume. An open radiation beam consists of hundreds of beamlets or pencil beams that are defined by the specification of the MLC. Each beamlet is assigned a radiation intensity level called a beamlet weight, which can be modulated (the result is a fluence intensity map). Because it can be time consuming to control one beamlet at a time for radiation delivery, subfields are often constructed and the same intensity is assigned so that the resulting dose delivery is close to the optimized fluence map. For more detail about the procedure and equipment, see Lim, Choi, and Mohan (2008).

Before designing an IMRT treatment plan, the geometry of the tumor region is captured using a medical imaging technique such as computed tomography or magnetic resonance imaging, depending on the type of tumor. The three-dimensional information obtained from the digital image representing the tumor as well as the surrounding healthy organs is then used for developing the treatment plan. Two types of volumes are typically considered at this stage. The first is the planning target volume (PTV), which consists of the gross tumor volume and a fixed margin around the tumor to account for treatment planning parameter and data uncertainties. Unfortunately, some healthy organs can be damaged by the radiation due to their proximity to the tumor. These are referred to as organs-at-risk (OARs), the second type of volume. The PTV corresponds to the area of the cancer while the OARs are healthy organs or tissues of the body. A well-designed IMRT plan should deliver the desired amount of radiation to the tumor while limiting the amount to the healthy organs.

For planning purposes, the PTV and the involved OARs are divided into three-dimensional treatment cubes called voxels (for more detail, see Lim, Ferris, Wright, Shepard, & Earl, 2007). The total dose that each voxel receives is defined by the weighted sum of the beamlet dose delivered to the voxel. In IMRT plans, a hot spot is the region that receives a higher dose than the desired level, and a cold spot is the region receiving a dose below its desired level. For voxels in the PTV, we want to control both the hot spots and cold spots to guarantee the desired treatment effect. For voxels in OARs, we only control hot spots in an effort to spare the healthy organs. Both hot and cold spot control can be modeled by either enforcing hard constraints or by penalizing deviations from the desired dose.

The purpose of this study is to explore solution techniques that can help planners select the optimal radiation delivery angles and fluence intensity maps. Various mixed-integer programming (MIP) formulations have been proposed to solve this problem (e.g., see Aleman et al., 2013; Lee, Fox, & Crocker, 2000; Lim et al., 2007; Yarmand et al. 2013). Because solving the MIPs with commercial software has proven difficult, if not impossible, researchers have proposed various heuristics. Decomposition methods such as Lagrangian relaxation and Benders, which have been successfully applied in other areas, have not been applied to the treatment angle selection problem associated with IMRT planning to the best of our knowledge. In this study, we show that Benders decomposition may find better solutions than a standard MIP solver when the computation time is limited. In addition, we develop a two-stage heuristic that uses (i) a standard MIP solver to construct a good initial solution in the first stage, and (ii) local branching (Fischetti & Lodi, 2003) to improve the incumbent in the second stage. The first stage of the heuristic reduces the solution space of the original problem by iteratively eliminating unpromising angles identified in the linear programming solution until the remaining problem is easy to solve. In the second stage, the solution is used as a starting point for local branching. Our results show that the LP rounding heuristic is fast and can generate good feasible solutions, which may be further improved by local branching in the second stage.

The rest of the paper is organized as follows. In the next section, we summarize the related literature concentrating on algorithm methods for obtaining solutions. Section 3 introduces the problem formulation and Section 4 discusses our Benders implementations. In Section 5, we develop an LP rounding heuristic and couple it with local branching to improve the solution. Section 6 presents the computational results and Section 7 concludes with a number of observations from the research.

@&#LITERATURE REVIEW@&#

IMRT is currently the mainstream treatment modality worldwide for irradiating tumors. Its application and efficacy have been extensively discussed by the medical research community (e.g., Milano et al., 2006; Zelefsky et al., 2000).

An IMRT plan specifies the angles at which the doses are to be delivered, along with the fluence intensity map. Accordingly, planners face three interrelated problems: the beam angle optimization (BAO) problem, the fluence intensity optimization (FMO) problem, and the beam segmentation problem. Since the 1970s, researchers have developed various methods to solve FMO. Depending on the penalty function for the undesired dose delivered to voxels in the PTV or OARs, the resulting model may be a linear or nonlinear (usually quadratic) mathematical program. Ehrgott, Güler, Hamacher, and Shao (2008) present an extensive survey. When the objective function is linear or can be linearized, the program can be solved with standard commercial software (Lim et al., 2007; Lim et al., 2014; Romeijn, Ahuja, Dempsey, Kumar, & Li, 2003; Saka, Rardin, & Langer, 2013; Saka, Rardin, Langer, & Dink, 2011). Otherwise, researchers have developed their own the problem-specific algorithms. For example, Spirou and Chui (1998) developed a gradient inverse planning algorithm to determine the intensity-modulated beams.

The joint problem of angle selection and FMO entails selecting a subset of angles and specifying the fluence map for the selected angles. The BAO problem is a very large-scale optimization problem that can be formulated as mixed-integer linear program if the objective function is linear (Lee et al., 2000; Lim et al., 2007, 2008; Wang, Dai, & Hu, 2003; Yarmand, Winey, & Craft, 2013). Optimally selecting a small subset of angles from a 360 degree circumference using a MIP model, however, can be a daunting task and it is clinically not useful due to long computation times. Consequently, researchers have developed practical approaches using metaheuristics such as simulated annealing (SA) (Bortfeld & Schlegel, 1993), genetic algorithms (GA) (Ezzell, 1996; Lei & Li, 2009), nested partitions (NP) (Zhang, Shi, Meyer, Nazareth, & D'Souza, 2009), particle swarm (Li, Yao, Yao, & Chen, 2005), response surface (Aleman, Romeijn, & Dempsey, 2009), data mining (Price, Golden, Wasil, & Zhang, 2014), and neural networks (Rowbottom, Webb, & Oldham, 1999). When the FMO objective function is nonlinear, the problem is usually solved using neighborhood search (Aleman, Kumar, Ahuja, Romeijn, & Dempsey, 2008; Djajaputra, Wu, Wu, & Mohan, 2003; Mišić, Aleman, & Sharpe, 2010; Rowbottom, Nutting, & Webb, 2001). That is, a metaheuristic is applied to explore the neighborhood of a given angle selection solution, and then a series of FMO problems are solved to evaluate the quality of angles selected.

Researchers have also investigated other models and solution strategies to concurrently optimize the angle selection and fluence intensity map. Rocha, Dias, Ferreira, and Lopes (2013) used a pattern search method. Bertsimas, Cacchiani, Craft, and Nohadani (2013) proposed a nonconvex mathematical programming model that uses continuous variables to denote the beam angles. To solve the problem, they designed a hybrid heuristic that exploits gradient information to quickly find a local minimum and simulated annealing to search for the global minimum. Lee, Aleman, and Sharpe (2011) transformed the beam orientation optimization problem, whose objective is limited to only selecting the beam angles, into a set covering problem. Beam intensities were not part of the solution, only the requirement that each voxel be covered by at least a prespecified number of beam angles.

More recently, Lim, Kardar, and Cao (2014) examined the strengths and weaknesses of six optimization methods for selecting beam angles: branch and bound, SA, GA, NP, branch and prune (BP), and local neighborhood search (LNS). They concluded that it is more effective to apply hybrid approaches that first find a good feasible solution using SA, GA, NP, or BP, and then use the resulting solution as a starting point for LNS to arrive at a local optimum. Although some hybrid approaches can solve larger scale BAO problems to within a small percentage of the global optimal, they still require a substantial amount of time to converge.

Devising an IMRT plan involves selecting a subset of angles and constructing the associated fluence map to apply the desired dose to the planning target volume without damaging the healthy organs. Accordingly, we need to penalize both hot and cold spots for voxels in the PTV and penalize the hot spots for voxels in OARs. The following notation is used in the developments.


                     
                        Indices and sets


                        
                           a
                        
                        
                           index for a beam angle

set of candidate beam angles

index for OAR

set of OARs

index for a voxel

set of voxels in the PTV

set of voxels in organ i; i ∈ O
                           

set of all voxels in the PTV and OARs

index for a beamlet

set of beamlets in angle a
                           

maximum number of treatment angles in a treatmentplan; η < |A|

dose deposition coefficient for voxel v and beamlet b(when beamlet b has unit intensity, its relative dosecontribution to voxel v is dvb
                              )

upper bound on the dose applied to voxel v ∈ T
                           

lower bound on the dose applied to voxel v ∈ T
                           

hot spot control parameter on voxels in the PTV

cold spot control parameter on voxels in the PTV

hot spot control parameter on voxels in OAR i
                           

nonnegative penalty coefficient for hot spots in the PTV

nonnegative penalty coefficient for cold spots in the PTV

nonnegative penalty coefficient for hot spots in OARs

maximum intensity of beamlet b ∈ Ba
                              
                           

1 if angle a is selected, 0 otherwise

intensity of beamlet b ∈ Ba
                               for angle a ∈ A
                           

total relative dose applied to voxel v ∈ V
                           

With slight abuse of notation, we use DT
                      to denote the vector of dose values for voxels in the PTV, 
                        
                           D
                           
                              S
                              i
                           
                        
                      for the vector of dose values applied to organ i, and 
                        
                           D
                           =
                           
                              (
                              
                                 
                                    D
                                    T
                                 
                                 ,
                                 
                                    
                                       (
                                       
                                          D
                                          
                                             S
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       i
                                       ∈
                                       O
                                    
                                 
                              
                              )
                           
                           =
                           
                              (
                              
                                 D
                                 v
                              
                              )
                           
                        
                     , that is, the vector of dose values for all voxels. Now, given the total dose Dv
                      applied to each voxel v ∈ V, 
                     Lim et al. (2007) use the following penalty function:

                        
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          D
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             λ
                                             t
                                             +
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         D
                                                         T
                                                      
                                                      −
                                                      
                                                         θ
                                                         U
                                                      
                                                      
                                                         e
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                +
                                             
                                             
                                                
                                                   ∥
                                                
                                                ∞
                                             
                                          
                                          +
                                          
                                             λ
                                             t
                                             −
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         θ
                                                         L
                                                      
                                                      
                                                         e
                                                         T
                                                      
                                                      −
                                                      
                                                         D
                                                         T
                                                      
                                                   
                                                   )
                                                
                                                +
                                             
                                             
                                                
                                                   ∥
                                                
                                                ∞
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                O
                                             
                                          
                                          
                                             
                                                λ
                                                s
                                             
                                             
                                                
                                                   
                                                      ∥
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               D
                                                               
                                                                  S
                                                                  i
                                                               
                                                            
                                                            −
                                                            
                                                               ϕ
                                                               i
                                                            
                                                            
                                                               e
                                                               
                                                                  S
                                                                  i
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      +
                                                   
                                                   
                                                      ∥
                                                   
                                                
                                                1
                                             
                                             /
                                             
                                                |
                                                
                                                   S
                                                   i
                                                
                                                |
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where ||x||∞ and ||x||1 respectively denote the infinity and 1-norm of vector x, (y)+  max{y,0}, and eT
                      and 
                        
                           e
                           
                              S
                              i
                           
                        
                      are vectors of 1’s with dimensions |T| and |Si
                     |, respectively. The first and second terms in f(D) control the hot and cold spots for voxels in the PTV by penalizing the maximum excess dose and maximum shortage of dose, respectively; the third term controls the hot spot for voxels in OAR i by penalizing a dose that is more than ϕi
                     , a control parameter given by the oncologist. Because 
                        
                           λ
                           t
                           +
                        
                     , 
                        
                           λ
                           t
                           −
                        
                     , and λs
                      are nonnegative parameters, f(D) is a convex function of D. The full model is as follows.

                        
                           (1a)
                           
                              
                                 minimize
                                 
                                 f
                                 (
                                 D
                                 )
                              
                           
                        
                     
                     
                        
                           (1b)
                           
                              
                                 subject
                                 
                                 to
                                 
                                 
                                    D
                                    v
                                 
                                 =
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       A
                                    
                                 
                                 
                                 
                                    ∑
                                    
                                       b
                                       ∈
                                       
                                          B
                                          a
                                       
                                    
                                 
                                 
                                    
                                       d
                                       
                                          v
                                          b
                                       
                                    
                                    
                                       w
                                       
                                          a
                                          b
                                       
                                    
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (1c)
                           
                              
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       A
                                    
                                 
                                 
                                    ψ
                                    a
                                 
                                 ≤
                                 η
                              
                           
                        
                     
                     
                        
                           (1d)
                           
                              
                                 0
                                 ≤
                                 
                                    w
                                    
                                       a
                                       b
                                    
                                 
                                 ≤
                                 
                                    M
                                    
                                       a
                                       b
                                    
                                 
                                 
                                    ψ
                                    a
                                 
                                 
                                 ∀
                                 a
                                 ∈
                                 A
                                 ,
                                 
                                 b
                                 ∈
                                 
                                    B
                                    a
                                 
                              
                           
                        
                     
                     
                        
                           (1e)
                           
                              
                                 
                                    L
                                    v
                                 
                                 ≤
                                 
                                    D
                                    v
                                 
                                 ≤
                                 
                                    U
                                    v
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (1f)
                           
                              
                                 
                                    ψ
                                    a
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    
                                    1
                                    }
                                 
                                 
                                 ∀
                                 a
                                 ∈
                                 A
                              
                           
                        
                     
                  

The objective function (1a) minimizes the total penalty from the radiation doses applied to both the PTV and the neighboring organs. Constraint (1b) calculates the total dose that each voxel receives, which is the sum of beamlet intensities weighted by their corresponding dose deposition coefficient. Constraint (1c) limits the number of angles that can be used to the maximum specified. Next, constraint (1d) guarantees the nonnegativity of the beamlet intensity and ensure that a beamlet can only carry a positive intensity if the angle is selected. We refer to Lim et al. (2007) for more detail on how to refine the value of Mab
                     , the maximum intensity of beamlet b ∈ Ba
                     . Finally, bounds are placed on the total dose applied to the PTV in (1e) and the angle selection variable, ψa
                     , is defined to be binary in (1f).

To solve the problem, it is first necessary to create an equivalent linear formulation of model (1). To do so, define 
                        
                           
                              y
                              v
                           
                           =
                           
                              
                                 (
                                 
                                    
                                       D
                                       v
                                    
                                    −
                                    
                                       ϕ
                                       i
                                    
                                 
                                 )
                              
                              +
                           
                        
                      for each v ∈ Si
                     , 
                        
                           
                              z
                              +
                           
                           =
                           
                              
                                 ∥
                              
                              
                                 
                                    (
                                    
                                       
                                          D
                                          T
                                       
                                       −
                                       
                                          θ
                                          U
                                       
                                       
                                          e
                                          T
                                       
                                    
                                    )
                                 
                                 +
                              
                              
                                 
                                    ∥
                                 
                                 ∞
                              
                           
                        
                     , and 
                        
                           
                              z
                              −
                           
                           =
                           
                              
                                 ∥
                              
                              
                                 
                                    (
                                    
                                       
                                          θ
                                          L
                                       
                                       
                                          e
                                          T
                                       
                                       −
                                       
                                          D
                                          T
                                       
                                    
                                    )
                                 
                                 +
                              
                              
                                 
                                    ∥
                                 
                                 ∞
                              
                           
                        
                     , and note that f(D) in (1a) is a piecewise linear convex function. For such functions, a solution to model (1) can be found by solving the following mixed-integer linear program:

                        
                           (2a)
                           
                              
                                 minimize
                                 
                                 
                                    λ
                                    t
                                    +
                                 
                                 
                                    z
                                    +
                                 
                                 +
                                 
                                    λ
                                    t
                                    −
                                 
                                 
                                    z
                                    −
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       O
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          
                                             S
                                             i
                                          
                                       
                                    
                                    
                                       
                                          λ
                                          s
                                       
                                       
                                          y
                                          v
                                       
                                       /
                                       
                                          |
                                          
                                             S
                                             i
                                          
                                          |
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2b)
                           
                              
                                 subject
                                 
                                 to
                                 
                                 
                                    z
                                    +
                                 
                                 ≥
                                 
                                    D
                                    v
                                 
                                 −
                                 
                                    θ
                                    U
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (2c)
                           
                              
                                 
                                    z
                                    −
                                 
                                 ≥
                                 
                                    θ
                                    L
                                 
                                 −
                                 
                                    D
                                    v
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (2d)
                           
                              
                                 
                                    y
                                    v
                                 
                                 ≥
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       A
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          
                                             B
                                             a
                                          
                                       
                                    
                                    
                                       
                                          d
                                          
                                             v
                                             b
                                          
                                       
                                       
                                          w
                                          
                                             a
                                             b
                                          
                                       
                                    
                                 
                                 −
                                 
                                    ϕ
                                    i
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    S
                                    i
                                 
                                 ,
                                 i
                                 ∈
                                 O
                              
                           
                        
                     
                     
                        
                           (2e)
                           
                              
                                 
                                    L
                                    v
                                 
                                 ≤
                                 
                                    D
                                    v
                                 
                                 ≤
                                 
                                    U
                                    v
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (2f)
                           
                              
                                 
                                    D
                                    v
                                 
                                 =
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       A
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          b
                                          ∈
                                          
                                             B
                                             a
                                          
                                       
                                    
                                    
                                       
                                          d
                                          
                                             v
                                             b
                                          
                                       
                                       
                                          w
                                          
                                             a
                                             b
                                          
                                       
                                    
                                 
                                 
                                 ∀
                                 v
                                 ∈
                                 T
                              
                           
                        
                     
                     
                        
                           (2g)
                           
                              
                                 
                                    ∑
                                    
                                       a
                                       ∈
                                       A
                                    
                                 
                                 
                                    ψ
                                    a
                                 
                                 ≤
                                 η
                              
                           
                        
                     
                     
                        
                           (2h)
                           
                              
                                 0
                                 ≤
                                 
                                    w
                                    
                                       a
                                       b
                                    
                                 
                                 ≤
                                 
                                    M
                                    
                                       a
                                       b
                                    
                                 
                                 
                                    ψ
                                    a
                                 
                                 
                                 ∀
                                 a
                                 ∈
                                 A
                                 ,
                                 b
                                 ∈
                                 
                                    B
                                    a
                                 
                              
                           
                        
                     
                     
                        
                           (2i)
                           
                              
                                 
                                    ψ
                                    a
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    
                                    1
                                    }
                                 
                                 
                                 ∀
                                 a
                                 ∈
                                 A
                              
                           
                        
                     
                     
                        
                           (2j)
                           
                              
                                 
                                    y
                                    v
                                 
                                 ≥
                                 0
                                 
                                 ∀
                                 v
                                 ∈
                                 
                                    S
                                    i
                                 
                                 ,
                                 i
                                 ∈
                                 O
                              
                           
                        
                     
                     
                        
                           (2k)
                           
                              
                                 
                                    z
                                    +
                                 
                                 ,
                                 
                                 
                                    z
                                    −
                                 
                                 ≥
                                 0
                              
                           
                        
                     
                  

Because we have a minimization objective, (2a) is equivalent to (1a) when constraints (2b)–(2d), (2j), and (2k) are enforced. Note that although it is possible to substitute out the variables Dv
                      for all v ∈ T, keeping them in the formulations improved computational performance. The constraint matrix is sparser with them but the difference is insignificant. A more effective way to reduce the number of variables and constraints is as follows:

                        
                           •
                           In the third term in (2a), we only penalize the excess dose applied to the voxels in OAR, i.e., the dose beyond ϕi
                              . Thus, if some beamlet b ∈ Ba
                               does not affect the voxels in the PTV, i.e., dvb
                               = 0 for all v ∈ T, then we must have an optimal solution with 
                                 
                                    
                                       w
                                       
                                          a
                                          b
                                       
                                    
                                    =
                                    0
                                 
                              . Making wab
                               > 0 only increases the penalty associated with the voxels in OAR. Therefore, we can exclude these variables from model (2). In our data sets, this observation only eliminates a very small number of variables.

For any two voxels v
                              1, v
                              2 ∈ T, if 
                                 
                                    
                                       d
                                       
                                          
                                             v
                                             1
                                          
                                          b
                                       
                                    
                                    ≥
                                    
                                       d
                                       
                                          
                                             v
                                             2
                                          
                                          b
                                       
                                    
                                 
                               for all b ∈ Ba
                               and a ∈ A, then we have 
                                 
                                    
                                       D
                                       
                                          v
                                          1
                                       
                                    
                                    −
                                    
                                       θ
                                       U
                                    
                                    ≥
                                    
                                       D
                                       
                                          v
                                          2
                                       
                                    
                                    −
                                    
                                       θ
                                       U
                                    
                                 
                              ; accordingly, 
                                 
                                    
                                       z
                                       +
                                    
                                    ≥
                                    
                                       D
                                       
                                          v
                                          1
                                       
                                    
                                    −
                                    
                                       θ
                                       U
                                    
                                 
                               is implied by constraints 
                                 
                                    
                                       z
                                       +
                                    
                                    ≥
                                    
                                       D
                                       
                                          v
                                          2
                                       
                                    
                                    −
                                    
                                       θ
                                       U
                                    
                                 
                              , and is thus redundant. Similarly, we can show that constraint 
                                 
                                    
                                       z
                                       −
                                    
                                    ≥
                                    
                                       θ
                                       L
                                    
                                    −
                                    
                                       D
                                       
                                          v
                                          2
                                       
                                    
                                 
                               can be removed.

If 
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             b
                                             ∈
                                             
                                                B
                                                a
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                v
                                                b
                                             
                                          
                                          
                                             M
                                             
                                                a
                                                b
                                             
                                          
                                       
                                    
                                    −
                                    
                                       ϕ
                                       i
                                    
                                    ≤
                                    0
                                 
                               for some v ∈ Si, i ∈ O, then the constraint 
                                 
                                    
                                       y
                                       v
                                    
                                    ≥
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             b
                                             ∈
                                             
                                                B
                                                a
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                v
                                                b
                                             
                                          
                                          
                                             w
                                             
                                                a
                                                b
                                             
                                          
                                       
                                    
                                    −
                                    
                                       ϕ
                                       i
                                    
                                 
                               is redundant. Accordingly, we can exclude this constraint and corresponding variable yv
                               from the model.

Benders decomposition is an algorithm for solving MIPs that has been widely applied since 1960s. It is best suited for models of the form: min{cx + dy : Ax + By ≥ b, x ∈ 
                        
                           
                              Z
                              +
                              n
                           
                           ,
                        
                      
                     y ∈ 
                        
                           ℜ
                           +
                           p
                        
                     }, where n is relatively small and when fixed, the constraints By ≥ b − Ax divide into independent subsets in the y variables. An integer master problem is set up that is equivalent to the original problem when all its constraints are included. None of those constraints are known at the outset, though, so they are generated iteratively one or two at a time by solving the dual of the LP subproblems that result when x is fixed. Each subproblem provides an optimality cut and perhaps a feasibility cut which are added to the restricted master problem. Convergence is finite but may require many iterations. Cordeau, Stojković, Soumis, and Desrosiers (2001) applied Benders to simultaneously solve the aircraft routing and crew scheduling problems, while Binato, Pereira, and Granville (2001) used it to solve power transmission network design problems. Costa (2005) gives an extensive survey on applications to fixed-charge network design problems, while Taşkın, Sasaki, Segawa, and Ando (2012) used Benders to solve the problem of decomposing an IMRT fluence map into deliverable apertures. In this section, we apply Benders decomposition to model (2).

For fixed values of ψa
                         for all a ∈ A, and after a few substitutions, (2a)–(2k) reduce to an LP whose constraints are given in the model below. Their corresponding dual variables are specified on the right,

                           
                              
                                 
                                    minimize
                                    
                                    
                                       λ
                                       t
                                       +
                                    
                                    
                                       z
                                       +
                                    
                                    +
                                    
                                       λ
                                       t
                                       −
                                    
                                    
                                       z
                                       −
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          O
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             v
                                             ∈
                                             
                                                S
                                                i
                                             
                                          
                                       
                                       
                                          
                                             λ
                                             s
                                          
                                          
                                             y
                                             v
                                          
                                          /
                                          
                                             |
                                             
                                                S
                                                i
                                             
                                             |
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             subject
                                             
                                             to
                                          
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                   +
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      a
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            b
                                                            ∈
                                                            
                                                               B
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               v
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               a
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                ≥
                                                −
                                                
                                                   θ
                                                   U
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             v
                                             ∈
                                             T
                                          
                                       
                                       
                                          
                                             μ
                                             v
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   z
                                                   −
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      a
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            b
                                                            ∈
                                                            
                                                               B
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               v
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               a
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                ≥
                                                
                                                   θ
                                                   L
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             v
                                             ∈
                                             T
                                          
                                       
                                       
                                          
                                             μ
                                             v
                                             −
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                   v
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      a
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            b
                                                            ∈
                                                            
                                                               B
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               v
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               a
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                ≥
                                                −
                                                
                                                   ϕ
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             v
                                             ∈
                                             
                                                S
                                                i
                                             
                                             ,
                                             
                                             i
                                             ∈
                                             O
                                          
                                       
                                       
                                          
                                             μ
                                             v
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      a
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            b
                                                            ∈
                                                            
                                                               B
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               v
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               a
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                ≥
                                                
                                                   L
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             v
                                             ∈
                                             T
                                          
                                       
                                       
                                          
                                             σ
                                             v
                                             −
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                −
                                                
                                                   ∑
                                                   
                                                      a
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            b
                                                            ∈
                                                            
                                                               B
                                                               a
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               v
                                                               b
                                                            
                                                         
                                                         
                                                            w
                                                            
                                                               a
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                                ≥
                                                −
                                                
                                                   U
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             v
                                             ∈
                                             T
                                          
                                       
                                       
                                          
                                             σ
                                             v
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             −
                                             
                                                w
                                                
                                                   a
                                                   b
                                                
                                             
                                             ≥
                                             −
                                             
                                                M
                                                
                                                   a
                                                   b
                                                
                                             
                                             
                                                ψ
                                                a
                                             
                                          
                                       
                                       
                                          
                                             ∀
                                             a
                                             ∈
                                             A
                                             ,
                                             b
                                             ∈
                                             
                                                B
                                                a
                                             
                                          
                                       
                                       
                                          
                                             π
                                             
                                                a
                                                b
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                w
                                                
                                                   a
                                                   b
                                                
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             ∀
                                             a
                                             ∈
                                             A
                                             ,
                                             b
                                             ∈
                                             
                                                B
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For simplicity, we will use the vector ψ to denote the angle section variables ψa
                         for all a ∊ A. Model (3) is the corresponding dual formulation of the LP after fixing the angle selection vector ψ.

                           
                              (3a)
                              
                                 
                                    
                                       
                                          
                                             h
                                             (
                                             ψ
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             maximize
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   −
                                                   
                                                      θ
                                                      U
                                                   
                                                   
                                                      μ
                                                      v
                                                      +
                                                   
                                                   +
                                                   
                                                      θ
                                                      L
                                                   
                                                   
                                                      μ
                                                      v
                                                      −
                                                   
                                                   +
                                                   
                                                      L
                                                      v
                                                   
                                                   
                                                      σ
                                                      v
                                                      −
                                                   
                                                   −
                                                   
                                                      U
                                                      v
                                                   
                                                   
                                                      σ
                                                      v
                                                      +
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   O
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      v
                                                      ∈
                                                      
                                                         S
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                      i
                                                   
                                                   
                                                      μ
                                                      v
                                                   
                                                
                                             
                                             −
                                             
                                                ∑
                                                
                                                   a
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      b
                                                      ∈
                                                      
                                                         B
                                                         a
                                                      
                                                   
                                                
                                                
                                                   
                                                      M
                                                      
                                                         a
                                                         b
                                                      
                                                   
                                                   
                                                      ψ
                                                      a
                                                   
                                                   
                                                      π
                                                      
                                                         a
                                                         b
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3b)
                              
                                 
                                    subject
                                    
                                    to
                                    
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          T
                                       
                                    
                                    
                                       μ
                                       v
                                       +
                                    
                                    ≤
                                    
                                       λ
                                       t
                                       +
                                    
                                 
                              
                           
                        
                        
                           
                              (3c)
                              
                                 
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          T
                                       
                                    
                                    
                                       μ
                                       v
                                       −
                                    
                                    ≤
                                    
                                       λ
                                       t
                                       −
                                    
                                 
                              
                           
                        
                        
                           
                              (3d)
                              
                                 
                                    0
                                    ≤
                                    
                                       μ
                                       v
                                    
                                    ≤
                                    
                                       λ
                                       s
                                    
                                    /
                                    
                                       |
                                       
                                          S
                                          i
                                       
                                       |
                                    
                                    
                                    ∀
                                    v
                                    ∈
                                    
                                       S
                                       i
                                    
                                    ,
                                    i
                                    ∈
                                    O
                                 
                              
                           
                        
                        
                           
                              (3f)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                π
                                                
                                                   a
                                                   b
                                                
                                             
                                             +
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                
                                                   d
                                                   
                                                      v
                                                      b
                                                   
                                                
                                                
                                                   (
                                                   
                                                      −
                                                      
                                                         σ
                                                         v
                                                         +
                                                      
                                                      +
                                                      
                                                         σ
                                                         v
                                                         −
                                                      
                                                      −
                                                      
                                                         μ
                                                         v
                                                         +
                                                      
                                                      +
                                                      
                                                         μ
                                                         v
                                                         −
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   O
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      v
                                                      ∈
                                                      
                                                         S
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         v
                                                         b
                                                      
                                                   
                                                   
                                                      μ
                                                      v
                                                   
                                                
                                             
                                             ≤
                                             0
                                             
                                             ∀
                                             a
                                             ∈
                                             A
                                             ,
                                             b
                                             ∈
                                             
                                                B
                                                a
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (3g)
                              
                                 
                                    
                                       μ
                                       v
                                       +
                                    
                                    ,
                                    
                                       μ
                                       v
                                       −
                                    
                                    ,
                                    
                                       σ
                                       v
                                       +
                                    
                                    ,
                                    
                                       σ
                                       v
                                       −
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    v
                                    ∈
                                    T
                                 
                              
                           
                        
                        
                           
                              (3h)
                              
                                 
                                    
                                       μ
                                       v
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    v
                                    ∈
                                    
                                       S
                                       i
                                    
                                    ,
                                    
                                    i
                                    ∈
                                    O
                                 
                              
                           
                        
                        
                           
                              (3i)
                              
                                 
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    a
                                    ∈
                                    A
                                    ,
                                    b
                                    ∈
                                    
                                       B
                                       a
                                    
                                 
                              
                           
                        
                     

Evidently, model (3) is feasible. To see this, consider that a solution with πab
                         = 0 for all a ∊ A, b ∊ Ba
                        , 
                           
                              
                                 μ
                                 v
                                 +
                              
                              =
                              
                                 μ
                                 v
                                 −
                              
                              =
                              
                                 σ
                                 v
                                 +
                              
                              =
                              
                                 σ
                                 v
                                 −
                              
                              =
                              0
                           
                         for all v ∊ T, and 
                           
                              
                                 μ
                                 v
                              
                              =
                              0
                           
                         for all v ∈ Si, i ∈ O satisfies constraints (3b)–(3i). Thus, model (3) must have either an extreme point solution or an unbounded optimal value. For a given angle selection vector ψ, having an unbounded optimal value, i.e., h(ψ) = ∞, indicates that the treatment plan with angle selection vector ψ is not feasible. Let Ψ denote the set of angle selection vectors that give an unbounded objective function value in model (3), i.e., 
                           
                              h
                              (
                              δ
                              )
                              =
                              ∞
                           
                         for all δ ∊ Ψ. To prevent selecting any δ ∊ Ψ, the standard Benders decomposition requires applying feasibility cuts based on extreme rays of polyhedral defined by (3b)–(3h). Alternatively, we can apply the following Benders feasibility cuts.

                           
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          δ
                                          a
                                       
                                       
                                          ψ
                                          a
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                δ
                                                a
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                ψ
                                                a
                                             
                                          
                                          )
                                       
                                    
                                    ≤
                                    
                                       |
                                       A
                                       |
                                    
                                    −
                                    1
                                    
                                    ∀
                                    δ
                                    ∈
                                    
                                       Ψ
                                       *
                                    
                                 
                              
                           
                        which ensure that h(ψ) < ∞ when ψ ∉ Ψ.

Let Q be the set of extreme points for the feasible region (3b)–(3h). For any extreme point q ∊ Q, with 
                           
                              q
                              =
                              (
                              
                                 μ
                                 v
                                 +
                              
                              ,
                              
                                 μ
                                 v
                                 −
                              
                              ,
                              
                                 σ
                                 v
                                 −
                              
                              ,
                              
                                 σ
                                 v
                                 +
                              
                              ,
                              
                                 μ
                                 v
                              
                              ,
                              
                                 π
                                 
                                    a
                                    b
                                 
                              
                              )
                           
                        , we define the linear function g(ψ, q) as

                           
                              
                                 
                                    
                                       
                                          
                                             g
                                             (
                                             ψ
                                             ,
                                             q
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   v
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                (
                                                
                                                   −
                                                   
                                                      θ
                                                      U
                                                   
                                                   
                                                      μ
                                                      v
                                                      +
                                                   
                                                   +
                                                   
                                                      θ
                                                      L
                                                   
                                                   
                                                      μ
                                                      v
                                                      −
                                                   
                                                   +
                                                   
                                                      L
                                                      v
                                                   
                                                   
                                                      σ
                                                      v
                                                      −
                                                   
                                                   −
                                                   
                                                      U
                                                      v
                                                   
                                                   
                                                      σ
                                                      v
                                                      +
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   ∈
                                                   O
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      v
                                                      ∈
                                                      
                                                         S
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      ϕ
                                                      i
                                                   
                                                   
                                                      μ
                                                      v
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   a
                                                   ∈
                                                   A
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      b
                                                      ∈
                                                      
                                                         B
                                                         a
                                                      
                                                   
                                                
                                                
                                                   
                                                      M
                                                      
                                                         a
                                                         b
                                                      
                                                   
                                                   
                                                      ψ
                                                      a
                                                   
                                                   
                                                      π
                                                      
                                                         a
                                                         b
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that g(ψ, q) defines the objective function in (3a). Thus, if ψ ∉ Ψ, the objective function of model (3) is equivalent to

                           
                              
                                 
                                    minimize
                                    
                                    max
                                    
                                    {
                                    g
                                    (
                                    ψ
                                    ,
                                    
                                    
                                       q
                                       )
                                       :
                                    
                                    
                                    q
                                    ∈
                                    
                                       Q
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

Hence, model (2) can be reformulated as follows:

                           
                              (4a)
                              
                                 
                                    minimize
                                    
                                    W
                                 
                              
                           
                        
                        
                           
                              (4b)
                              
                                 
                                    subject
                                    
                                    to
                                    
                                    W
                                    ≥
                                    g
                                    (
                                    ψ
                                    ,
                                    
                                    q
                                    )
                                    
                                    ∀
                                    q
                                    ∈
                                    Q
                                 
                              
                           
                        
                        
                           
                              (4c)
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          δ
                                          a
                                       
                                       
                                          ψ
                                          a
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                δ
                                                a
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                ψ
                                                a
                                             
                                          
                                          )
                                       
                                    
                                    ≤
                                    
                                       |
                                       A
                                       |
                                    
                                    −
                                    1
                                    
                                    ∀
                                    δ
                                    ∈
                                    
                                       Ψ
                                       *
                                    
                                 
                              
                           
                        
                        
                           
                              (4d)
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       ψ
                                       a
                                    
                                    ≤
                                    η
                                 
                              
                           
                        
                        
                           
                              (4e)
                              
                                 
                                    
                                       ψ
                                       a
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       
                                       1
                                       }
                                    
                                    
                                    ∀
                                    a
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (4f)
                              
                                 
                                    W
                                    ≥
                                    0
                                 
                              
                           
                        
                     

In model (4), constraint (4b) corresponds to Benders’ optimality cuts and constraint (4c) corresponds to the feasibility cuts.


                        
                           Lemma 1
                           Let q
                              1 and q
                              2 be two solutions to model (3) and assume that all their components are the same with the exception of πab
                              . Let 
                                 
                                    π
                                    
                                       a
                                       b
                                    
                                    1
                                 
                               and 
                                 
                                    π
                                    
                                       a
                                       b
                                    
                                    2
                                 
                               be the corresponding components of q
                              1 and q
                              2, respectively. If 
                                 
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                       1
                                    
                                    ≥
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                       2
                                    
                                 
                              , then constraint g(ψ, q
                              2) ≤ W dominates g(ψ, q
                              1) ≤ W.


                        
                           Proof
                           Since 
                                 
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                       1
                                    
                                    ≥
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                       2
                                    
                                 
                              , we have g(ψ, q
                              1) ≤ g(ψ, q
                              2), which proves the result.□

As demonstrated by Magnanti and Wong (1981), the performance of Benders decomposition can be improved by strengthening the Benders cuts. Lemma 1 indicates that we would like to have a value of πab
                         that is as small as possible to get a stronger Benders optimality cut. When ψa
                         > 0, optimality of (3) ensures that the corresponding constraints (3f) are binding for all b ∊ Ba
                         (otherwise, we could decrease the objective function and maintain feasibility by decreasing πab
                        ), which means that we cannot decrease πab
                         without affecting the feasibility of the solution. When ψa
                         = 0, the optimal solution may have

                           
                              
                                 
                                    
                                       π
                                       
                                          a
                                          b
                                       
                                    
                                    >
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          T
                                       
                                    
                                    
                                       
                                          d
                                          
                                             v
                                             b
                                          
                                       
                                       
                                          (
                                          
                                             −
                                             
                                                σ
                                                v
                                                +
                                             
                                             +
                                             
                                                σ
                                                v
                                                −
                                             
                                             −
                                             
                                                μ
                                                v
                                                +
                                             
                                             +
                                             
                                                μ
                                                v
                                                −
                                             
                                          
                                          )
                                       
                                    
                                    −
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          O
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             v
                                             ∈
                                             
                                                S
                                                i
                                             
                                          
                                       
                                       
                                          
                                             d
                                             
                                                v
                                                b
                                             
                                          
                                          
                                             μ
                                             v
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

In this case, we can state the value of πab
                         as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             π
                                             
                                                a
                                                b
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             max
                                             
                                                {
                                                0
                                                ,
                                                
                                                   ∑
                                                   
                                                      v
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         v
                                                         b
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         −
                                                         
                                                            σ
                                                            v
                                                            +
                                                         
                                                         +
                                                         
                                                            σ
                                                            v
                                                            −
                                                         
                                                         −
                                                         
                                                            μ
                                                            v
                                                            +
                                                         
                                                         +
                                                         
                                                            μ
                                                            v
                                                            −
                                                         
                                                      
                                                      )
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      O
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                      
                                                         v
                                                         ∈
                                                         
                                                            S
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         d
                                                         
                                                            v
                                                            b
                                                         
                                                      
                                                      
                                                         μ
                                                         v
                                                      
                                                   
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Benders optimality cuts can be slightly strengthened when a lower bound for model (4) is known. One possible way to generate a lower bound is by solving the LP relaxation of model (2), which is what we do. Given any extreme point q ∊ Q, where 
                           
                              q
                              =
                              (
                              
                                 μ
                                 v
                                 +
                              
                              ,
                              
                                 μ
                                 v
                                 −
                              
                              ,
                              
                                 σ
                                 v
                                 −
                              
                              ,
                              
                                 σ
                                 v
                                 +
                              
                              ,
                              
                                 μ
                                 v
                              
                              ,
                              
                                 π
                                 
                                    a
                                    b
                                 
                              
                              )
                           
                        , let 
                           
                              
                                 c
                                 a
                              
                              =
                              
                                 ∑
                                 
                                    b
                                    ∈
                                    
                                       B
                                       a
                                    
                                 
                              
                              
                                 
                                    M
                                    
                                       a
                                       b
                                    
                                 
                                 
                                    π
                                    
                                       a
                                       b
                                    
                                 
                              
                           
                         and 
                           
                              b
                              =
                              
                                 ∑
                                 
                                    v
                                    ∈
                                    T
                                 
                              
                              
                                 
                                    (
                                    −
                                    
                                       θ
                                       U
                                    
                                    
                                       μ
                                       v
                                       +
                                    
                                    +
                                    
                                       θ
                                       L
                                    
                                    
                                       μ
                                       v
                                       −
                                    
                                    +
                                    
                                       L
                                       v
                                    
                                    
                                       σ
                                       v
                                       −
                                    
                                    −
                                    
                                       U
                                       v
                                    
                                    
                                       σ
                                       v
                                       +
                                    
                                    )
                                 
                                 −
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       O
                                    
                                 
                                 
                                    
                                       ∑
                                       
                                          v
                                          ∈
                                          
                                             S
                                             i
                                          
                                       
                                    
                                    
                                       
                                          ϕ
                                          i
                                       
                                       
                                          μ
                                          v
                                       
                                    
                                 
                              
                           
                         for all a ∈ A. As such, we have 
                           
                              g
                              
                                 (
                                 ψ
                                 ,
                                 q
                                 )
                              
                              =
                              b
                              −
                              
                                 ∑
                                 
                                    a
                                    ∈
                                    A
                                 
                              
                              
                                 
                                    c
                                    a
                                 
                                 
                                    ψ
                                    a
                                 
                              
                           
                         with corresponding Benders optimality cut given by

                           
                              (5)
                              
                                 
                                    W
                                    +
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          c
                                          a
                                       
                                       
                                          ψ
                                          a
                                       
                                    
                                    ≥
                                    b
                                    .
                                 
                              
                           
                        
                     


                        
                           Lemma 2
                           If W
                              1 is a lower bound on the optimal objective function value W* in model (4), i.e., W* ≥ W
                              1, then constraint (5) is equivalent to

                                 
                                    (6)
                                    
                                       
                                          W
                                          +
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                c
                                                a
                                                1
                                             
                                             
                                                ψ
                                                a
                                             
                                          
                                          ≥
                                          b
                                       
                                    
                                 
                              where 
                                 
                                    
                                       c
                                       a
                                       1
                                    
                                    =
                                    min
                                    
                                       {
                                       
                                          c
                                          a
                                       
                                       ,
                                       b
                                       −
                                       
                                          W
                                          1
                                       
                                       }
                                    
                                 
                              .


                        
                           Proof
                           We will show that the set of solutions associated with (5) and (6) are the same. First we note that given 
                                 
                                    
                                       c
                                       a
                                       1
                                    
                                    ≤
                                    
                                       c
                                       a
                                    
                                 
                              , any solution that satisfies constraint (6) also satisfies (5). To show the opposite, we define A
                              1 = {a ∊ A : b − W
                              1 ≤ ca
                              }. Now consider a solution 
                                 
                                    (
                                    
                                       W
                                       ^
                                    
                                    ,
                                    
                                       ψ
                                       ^
                                    
                                    )
                                 
                               that satisfies (5). If 
                                 
                                    
                                       
                                          ψ
                                          ^
                                       
                                       a
                                    
                                    =
                                    0
                                 
                               for all a ∊ A
                              1, then we must have

                                 
                                    
                                       
                                          
                                             W
                                             ^
                                          
                                          +
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                c
                                                a
                                                1
                                             
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                a
                                             
                                          
                                          =
                                          
                                             W
                                             ^
                                          
                                          +
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                c
                                                a
                                             
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                a
                                             
                                          
                                          ≥
                                          b
                                          .
                                       
                                    
                                 
                              
                           

Otherwise, we can find an angle e ∊ A
                              1 with 
                                 
                                    
                                       
                                          ψ
                                          ^
                                       
                                       e
                                    
                                    =
                                    1
                                 
                              . Since e ∊ A
                              1, we have 
                                 
                                    
                                       c
                                       e
                                       1
                                    
                                    =
                                    b
                                    −
                                    
                                       W
                                       1
                                    
                                    ≤
                                    
                                       c
                                       e
                                    
                                 
                              . Now, noting that model (4) is a minimization problem, we must have 
                                 
                                    
                                       W
                                       ^
                                    
                                    ≥
                                    
                                       W
                                       *
                                    
                                    ≥
                                    
                                       W
                                       1
                                    
                                 
                              . Accordingly,

                                 
                                    
                                       
                                          
                                             W
                                             ^
                                          
                                          +
                                          
                                             ∑
                                             
                                                a
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                c
                                                a
                                             
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                a
                                             
                                          
                                          ≥
                                          
                                             W
                                             ^
                                          
                                          +
                                          
                                             c
                                             e
                                          
                                          ≥
                                          
                                             W
                                             1
                                          
                                          +
                                          b
                                          −
                                          
                                             W
                                             1
                                          
                                          =
                                          b
                                          .
                                       
                                    
                                 
                              
                           

Thus, any solution that satisfies constraint (5) also satisfies constraint (6), and vice versa, which means that they are equivalent.□

Since constraint (6) is stronger, we use (6) rather than (5) for Benders optimality cuts in the subsequent developments,.

We start the algorithm with a restricted master problem and add constraints on the fly when they are indicated. Specifically, we initialize model (7) with Q*
                         = Ø and Ψ
                           *
                         = Ø which gives an initial solution W = − ∞.

                           
                              (7a)
                              
                                 
                                    minimize
                                    
                                    W
                                 
                              
                           
                        
                        
                           
                              (7b)
                              
                                 
                                    subject
                                    
                                    to
                                    
                                    W
                                    ≥
                                    g
                                    
                                       (
                                       ψ
                                       ,
                                       q
                                       )
                                    
                                    
                                    ∀
                                    q
                                    ∈
                                    
                                       Q
                                       *
                                    
                                 
                              
                           
                        
                        
                           
                              (7c)
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          δ
                                          a
                                       
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                ψ
                                                a
                                             
                                          
                                          )
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          (
                                          
                                             1
                                             −
                                             
                                                δ
                                                a
                                             
                                          
                                          )
                                       
                                       
                                          ψ
                                          a
                                       
                                    
                                    ≤
                                    
                                       |
                                       A
                                       |
                                    
                                    −
                                    1
                                    
                                    ∀
                                    δ
                                    ∈
                                    
                                       Ψ
                                       *
                                    
                                 
                              
                           
                        
                        
                           
                              (7d)
                              
                                 
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       ψ
                                       a
                                    
                                    ≤
                                    η
                                 
                              
                           
                        
                        
                           
                              (7e)
                              
                                 
                                    
                                       ψ
                                       a
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    ∀
                                    a
                                    ∈
                                    A
                                 
                              
                           
                        
                        
                           
                              (7f)
                              
                                 
                                    W
                                    ≥
                                    0
                                 
                              
                           
                        
                     

Adding a Benders cut to (7) has traditionally meant restarting the IP solver from scratch, which is computationally expensive. To improve performance, it is advantageous to start with a set of promising Benders cuts. McDaniel and Devine (1977) introduced the idea of relaxing the integrality requirements in the master problem and generating cuts from the fractional solution. Since these cuts are also defined by feasible solutions of model (3), they are valid for model (4). Thus, we adopt a two-phase approach: in the first phase, we relax the integrality constraint on the ψa
                         variables in model (7) and apply Benders decomposition until its objective function is within 5% of the value obtained by solving the LP relaxation of model (2); in the second phase, we start with the Benders cuts found in the first phase and continue in the traditional manner. Fig. 1
                         describes the procedure of implementing the Benders decomposition in this traditional way. Step 1 of the procedure initializes the set Q*
                         and Ψ∗, Step 2 corresponds to the first phrase, and Steps 3 and 4 correspond to the second phrase.

More recently, Rubin (2011) proposed a more efficient approach to implementing Benders decomposition. Instead of starting branch and bound from scratch after each cut is added, the modern approach adds the cuts as “lazy” constraints in the MIP solver (e.g., CPLEX). Lazy constraints are a set of inequalities specified by the user that are required to define the feasible region of the model but are not part of the model when the solver is initiated. Instead, they are only checked when a good integer feasible solution is identified, and any of those constraints that turn out to be violated are added to the model currently being solved. Note that branch and bound is not restarted when violated lazy constraints are added. More discussion can be found in CPLEX (2011).

Essentially, the presence of lazy constraints requires a modification of the incumbent update procedure in branch and bound. At each node of the traditional branch and bound search tree, the LP relaxation at the current node (note, this is not the Benders LP subproblem) is solved and one or more heuristics are typically applied to convert the fractional solution to a feasible (integer) solution. If a better feasible solution results, then the incumbent, i.e., the best feasible solution found so far, is updated. With lazy constraints, the solver must make sure that any candidate feasible solution satisfies all the lazy constraints before updating the incumbent. If there are no violations then the incumbent is updated. Otherwise, the solver adds the violated lazy constraints to the model being solved and does not update the incumbent. This logic ensures that branch and bound finds the optimal solution to the original model while only enforcing lazy constraints when violations are detected.

The procedure is similar to the branch-and-check algorithm of Thorsteinsson (2001) which also can be viewed an extension of traditional Benders when the feasible region contains nonlinear constraints. His algorithm solves a relaxation of the original problem by branch and bound but in the search tree, subproblems are solved to check the feasibility of solutions and correctness of the objective function value. The check is based on the cuts added to the relaxed master problem, which are similar to Benders optimality cuts.

We also adopt the two-phase approach in our implementation of the modern Benders decomposition. The same first phase (Step 2 in Fig. 1) as in the traditional approach is used to find a set of promising Benders cuts. In the second phase, we start the MIP solver with this set of cuts and treat all other constraints (4b) and (4c) as lazy constraints; however, because there are generally too many constraints to explicitly enumerate and check, a separation procedure is necessary to identify violations. Fig. 2
                        
                         depicts the flowchart for the separation procedure as well as the logic for updating the incumbent.

In particular, given any candidate solution 
                           
                              ψ
                              ^
                           
                         and its objective function value 
                           
                              W
                              ^
                           
                         in the restricted master problem, model (3) is solved with 
                           
                              ψ
                              =
                              
                                 ψ
                                 ^
                              
                           
                         to identify violated Benders cuts, if any. If the resulting problem is unbounded, then the feasibility cut corresponding to 
                           
                              ψ
                              ^
                           
                         is added to the current restricted master problem. This represents the separation procedure. If the resulting solution is bounded and 
                           
                              
                                 W
                                 ^
                              
                              =
                              h
                              
                                 (
                                 
                                    ψ
                                    ^
                                 
                                 )
                              
                           
                        , then the incumbent is updated as in traditional branch and bound. Otherwise, the indicated optimality cut is added to the master problem.

After solving the restricted master problem in the modern Benders decomposition, the optimal solution satisfies all constraints (4b)–(4c) although only a subset of them typically needs to be included in (4). The modern approach makes better use of the existing information in the current search tree because it exploits all the information gathered in previous runs rather than discarding it (Rubin, 2011). A single search tree is used. When the modern approach identifies a violated Benders cut and applies it as a lazy constraint to the restricted master problem, a state-of-the-art solver like CPLEX is able to resume the enumerations without reinitializing the search.

Another point to make is that the modern approach can generate many more Benders cuts than the traditional approach. The former generates a Benders cut whenever a candidate solution is found in the restricted master problem, while the latter only generates a Benders cut when the optimal solution of the restricted master problem is found. Nevertheless, adding Benders cuts that are derived from a non-optimal solution could be a double-edged sword: additional cuts increase the size of the problem and thus increase its difficulty, but they can also help to improve its lower bound (Rei, Cordeau, Gendreau, & Soriano, 2009).

In this section, we present a two-stage optimization-based heuristic to solve model (1). In the first stage, a feasible solution is found by LP rounding. In the second stage, this solution is used as a starting point for local branching, which is designed to find improved solutions in the neighborhood of the incumbent.

The angle selection problem is difficult since there is an exponential number of angle combinations from which to choose. Thus, a natural heuristic is to eliminate some angles so that the problem size is manageable. Several researchers have proposed heuristics aimed at eliminating unpromising choices. Lim et al. (2008), for example, developed an iterative scheme that removes angles based on scores derived from the LP solution of the original problem. Here, we discuss a heuristic that iteratively eliminates angles not likely to be in the optimal solution until the remaining problem is manageable as an IP. Specifically, we solve the LP relaxation and eliminate the angle whose variable take the smallest value in each iteration. Ties are broken arbitrarily. The process terminates when a given number of angles, denoted by U
                        *, is removed. At that point, the reduced IP is solved with only the remaining set of angles. Fig. 3 describes the procedure.

The size of the feasible region that remains after eliminating U*
                         angles depends on the magnitude of U*
                        . However, because the heuristic only eliminates the least used angles in the LP solution, it is likely that the reduced feasible region still contain good, if not the optimal, solution, especially when U*
                         is relatively small. Thus, by selecting an appropriate value for U*
                        , the heuristic is expected to generate a good solution within reasonable amount of time.

To improve the quality of a given feasible solution, Fischetti and Lodi (2003) proposed the idea of local branching, which sets up an outer search tree that may be partially or fully explored depending on the time available for the computations and the desired accuracy of the solution. They use a generic MIP solver as a black-box tool to explore the neighborhood of a given feasible solution in hopes of finding a better one. In this section, we describe the local branching heuristic we implemented to improve the solutions found by the rounding heuristic.

Let us start with the neighborhood used. One key observation of the solution space is that there exists an optimal solution to model (1) in which exactly η angles are chosen. To see this, assume there is an optimal solution ψ
                        * with n < η angles. We can always find an equivalent solution with n angles in solution ψ
                        * and an additional η − n angles whose beamlets carry zero intensity. Our computational experience confirms that local optima always contain η angles. Given a solution 
                           
                              ψ
                              ¯
                           
                         with η angles selected, Fischetti and Lodi define the k-OPT neighborhood of 
                           
                              ψ
                              ¯
                           
                         as the set of feasible angles that satisfy the additional local branching constraint

                           
                              (8)
                              
                                 
                                    Δ
                                    
                                       (
                                       ψ
                                       ,
                                       
                                          ψ
                                          ¯
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          a
                                          ∈
                                          A
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                ψ
                                                ¯
                                             
                                             a
                                          
                                          )
                                       
                                       
                                          ψ
                                          a
                                       
                                    
                                    ≤
                                    k
                                 
                              
                           
                        
                     

Intuitively, constraint (8) permits at most k of the η angles selected in 
                           
                              ψ
                              ¯
                           
                         to be replaced by angles not in the solution.

Local branching can be used as a heuristic or as an exact method. Given the incumbent solution 
                           
                              ψ
                              ¯
                           
                        , we introduce an outer search tree that is constructed by enforcing 
                           
                              Δ
                              (
                              ψ
                              ,
                              
                                 ψ
                                 ¯
                              
                              )
                              ≤
                              k
                           
                         on the left branch and 
                           
                              Δ
                              (
                              ψ
                              ,
                              
                                 ψ
                                 ¯
                              
                              )
                              ≥
                              k
                              +
                              1
                           
                         on the right branch as in depth-first search. This procedure represents a high level partition of the solution space. Denote the set of left branch constraints as L and the set of right branch constraints as R. We start the procedure with 
                           
                              R
                              =
                              ∅
                           
                        , 
                           
                              L
                              =
                              ∅
                           
                        , and a feasible solution 
                           
                              ψ
                              ¯
                           
                        . At each iteration, we seek to find better solutions in the neighborhood of the incumbent ψ* by solving model (2) with additional sets of constraints L = {Δ(ψ, ψ*) ≤ k} and the existing sets R. To control the time spent on each subproblem, we impose a limit of τ hours on each.

Three situations may arise when solving a node: (i) if a better solution is found within time τ, then the incumbent is updated and used as the new starting point to search for better solutions; (ii) if the subproblem is solved to optimally within time τ but the solution is no better than the incumbent, then we expand the local branching neighborhood by putting k ← k + 1 and continue; and (iii) if the subproblem is not solved to optimality within time τ and no better solution is found, then we terminate the procedure and return the best solution found so far. In the latter case, the solution space of the current subproblem is too large to be fully explored within time τ. Larger values of k in the local branching constraint Δ(ψ, ψ*) ≤ k correspond to larger neighborhoods and result in more difficult instances. When the value of k is too large, the subproblem approaches the original problem and becomes difficult to solve optimally. In our case, we terminate the computations when the value of k reaches the threshold kmax
                        . The procedure is outlined in Fig. 4
                        . For simplicity, we will use the function h(ψ) discussed in Section 4.1 to denote the objective function value given by solution angle ψ.

Three data sets associated with prostate tumors were used to test the effectiveness of our algorithms. Parameter values are summarized in Table 1
                     . Instances PX-12 and PX-36, with X = 1, 2, 3, correspond to the same clinical case, but with a different number of candidate angles. Instance P2-36 has many more voxels for the PTV than instance P1-36, although the number of voxels for OARs is slightly smaller. Instance P3-36 has the largest number of voxels for the PTV but the smallest number of voxels for OARs. For convenience, the bladder is the only OAR considered in instance P3-36. This is a well-studied test case that is known to be difficult to optimize within clinical treatment specifications even without the bladder.

The number of positive dvb
                      in Table 1 is roughly proportional to the density of the constraint matrix in model (1), and is thus a good indicator of problem instance difficulty. As indicated in constraints (1b), the total dose Dv
                      delivered to each voxel v is the weighted sum of dvb
                      with beamlet intensity wab
                      as the weight. Thus, if the number of positive dvb
                      is reduced, it is reasonable to expect that the solution space of Dv
                      is also reduced. Accordingly, the number of positive dvb
                      can affect the feasible region of the dose value applied to each voxel. Table 2
                     
                     
                      lists the dose-volume requirements for all organs.

All algorithms were implemented in JAVA and run under Ubuntu Linux on a Dell Poweredge T610 workstation with two 6-core hyperthreading 3.33-gigahertz Xeon processors and 24 gigabytes of memory. CPLEX 12.4 was used as the MIP solver. In the computations, we followed the convention in Lim et al. (2007) and used the following parameter values for instances P1 and P2: θU
                      = 1.05, θL
                      = 0.97, Lv
                      = 0.94 and Uv
                      = 1.15 for all v ∊ T. Because the P3 instances have a large PTV, we used the following parameter values to better control cold and hot spots: θU
                      = 1.05, θL
                      = 0.97, Lv
                      = 0.96, Uv
                      = 1.15 for all v ∊ T. In all instances, we used η = 6, ϕi
                      = 0.3 for all i ∊ O, 
                        
                           
                              λ
                              t
                              +
                           
                           =
                           
                              λ
                              t
                              −
                           
                           =
                           
                              λ
                              s
                           
                           =
                           1
                        
                     . We chose these values to be consistent with our past work (Lim & Cao, 2012, Lim et al., 2008, Lim et al., 2014). With respect to η, the results given below confirm that we are able to obtain clinically acceptable treatment plans as defined by the dose volume histogram (DVH0 requirements when η = 6.

In our initial testing, we discovered that the largest problems that we could solve to optimality with CPLEX and Benders decomposition within a reasonable amount of time, say, 30 minutes, where those with 12 angles. This observation provided the motivation for the LP rounding heuristic which reduces the 36-angle problems to 12-angle problems and then calls CPLEX to find the corresponding integer solution. Table 3 highlights these results for P1-12, P2-12 and P3-12, which have |A| = 12. CPLEX and both Benders decomposition algorithms converged within 30 minutes giving optimal objective function values. The solution times confirm that a 12-angle problem can be solved quickly with commercial software. Although not as efficient as CPLEX for instances P1-12 and P2-12, either Benders approach can still find optimal solutions within 28 minutes.

As a point of comparison, we also ran these instances for the case where the six angles are equidistant from each other starting at 0 degree. The results in Table 3 show that the corresponding objective function values are far from optimal. With carefully selected angles, the optimal solution provides better objective functions since it can (i) control the hot and cold spots for the PTV and (ii) control the hot spots for OARs.

For instances with more angles, CPLEX, Benders decomposition, and the two-stage heuristic were applied to find feasible solutions, although the former did not always converge (we tried to warm-start CPLEX with the LP rounding solution but little improvement in solution quality was observed within 5 hours). Also, because local branching subproblems with k ≥ 4 are too difficult to solve to optimality, we used parameter values kmin
                      = 1, kmax
                      = 3 in the implementation. The subproblem time limit τ was set to 2 hours to control the total local branching time. Finally, given that the 12-angle problems are usually well-solved, we used U*
                      = 24 in the LP-based heuristic.


                     Table 4 compares the solution times and solution quality of the different methods, including the SA-LNS approach discussed in Lim et al. (2014). Table 5
                      summarizes the statistics associated with the MIP models. One key observation from the computations is that problem instances become more difficult as the number of voxels in the PTV grows. For problems with small PTV (e.g., instance P1-36), CPLEX can solve model (2) directly; for problems with large PTV, CPLEX has a hard time closing the optimality gap (e.g., instance P3-36) although the results are only a few percentage points from the best solution found. In contrast, the number of voxels in the OARs does not have a noticeable impact.

Another implication of the results is that the magnitude of dvb
                      plays an important role in determining the problem difficulty. As we can see, P3-36, which has only 1000 more voxels in the PTV than P2-36, has a much larger optimality gap (74.41 percent) than P2-36 (14.59 percent). This is probably due to the relative magnitude of dvb
                     . Because the doses per beamlet are much smaller in P3-36 than in P2-36, the bound provided by the LP relaxation for P3-36 is weaker, leading to a larger optimality gap. Although reducing dvb
                      for a subset of v and b can make the LP relaxation easier to solve, it also leads to a weaker relaxation. In summary, the results suggest that the number of voxels in the PTV and the magnitude of dvb
                      are key indicators of problem difficulty.


                     Table 4 also indicates that modern Benders decomposition can find better feasible solutions than traditional Benders decomposition. Moreover, for instances P2-36 and P3-36, both methods generated a better feasible solution with a smaller optimality gap than CPLEX, while for P1-36 only
                      modern Benders outperformed CPLEX. It is also worth noting that neither Benders approach required feasibility cuts.


                     Table 6 compares the computational aspects of the two approaches. The results indicate that the modern approach generates many more optimality cuts than the traditional approach. That is, many more subproblems are solved to identify violated cuts, and thus many more feasible solutions are examined. However, the optimality gap associated with the modern approach, obtained by solving the restricted master problem, is not as small as the optimality gap accompanying the traditional approach. This implies that the Benders cuts generated in the modern approach are not as effective in improving the bounds. Given that our focus is on finding good feasible solutions rather than closing the optimality gap, the modern approach is the better choice.

Returning to Table 4, we see that the solutions obtained from the LP rounding heuristic are either close to (for instance P1-36) or better than (for instances P2-36 and P3-36) the solutions given by CPLEX and both Benders decompositions. Moreover, the solution times are only a small fraction of those of the latter methods. By design, the LP rounding heuristic involves solving an IP formulation with 12 angles in Step 2. The corresponding solutions were seen to be better than those found by solving the problem with 12 equidistant angles, as reported in Table 3. This result suggests that the information obtained from the LP relaxation is helpful in selecting good candidate angles.

Of the newly proposed methods, the two-stage heuristic (LP-rounding with local branching) provided the best results in the least amount of time. Nevertheless, the computations still took much longer than desired, especially for P2-36. As the problem size grows, especially with respect to the number of voxels in the PTV, runtimes become excess for CPLEX, Benders decomposition, and local branching. When a good solution is needed quickly, the best approach is to use the LP rounding heuristic.


                     Table 4 also compares our methods with the two-stage SA-LNS approach discussed in Lim et al. (2014). Similar to our two-stage heuristic, SA-LNS first develops an initial solution but with simulated annealing, and then improves it using local neighborhood search. Their computational work demonstrated the general superiority of SA-LNS over the other methods tested, including branch and bound, genetic algorithms, and branch and prune.

Although our two-stage heuristic may require longer runtimes than SA-LNS for some instances, Table 3 shows that solution quality is comparable: LP rounding with local branching provides a better solution for instance P1-36, SA-LNS provides a better solution for P2-36, while both provide the same solution for P3-36. With respect to Benders, SA-LNS provides better solutions than the traditional approach for all three instances and better solutions than the modern approach for P2-36 and P3-36. One conclusion that can be drawn from these results is that specifically designed methods like our two-stage heuristic and SA-LNS are likely to outperform Benders decomposition, at least when it comes to developing IMRT treatment plans.

As previously mentioned, our LP-rounding heuristic without local branching can provide good solutions quickly. To further demonstrate the quality of the generated treatment plans, we have plotted the DVH for the PTV and each OAR obtained from the LP rounding heuristic in Fig. 5. The horizontal axis represents the dose value and the vertical axis represents the fraction of volume. The DVH contains one curve for the PTV and one for each of the OARs. Each point on the curve specifies the percentage of volume (in the corresponding OAR or the PTV) that receives a dose greater than a given value. For example, point (23.51, 21.83 percent) on the curve for the bladder (OAR) in Fig. 5a indicates that 21.83 percent of voxels in the bladder receive a dose more than 23.51 Gy. Note that the DVH plots for the other methods tested look nearly identical to those in Fig. 5 and are available from the authors.


                     Fig. 5 shows three DVHs corresponding to instances P1-36, P2-36 and P3-36. Table 7
                      summarizes the key metrics for the treatment plans. As can be seen in Fig. 5a and Table 7, all PTV voxels receive 76 Gy or higher and the dose for OARs P1-36 is well within the prescribed bounds: only 10.31 percent of the voxels in the bladder receive a dose higher than 70 Gy, and only 0.89 percent of the voxels in the rectum receive a dose value higher than 60 Gy. Similarly, Fig. 5b shows that only 0.25 percent of the voxels in the bladder receive a dose higher than 70 Gy and none of the voxels in the rectum receive a dose higher than 60 Gy in the solution for instance P2-36. For the PTV, more than 95 percent of its voxels have a dose value higher than 76 Gy.

For P3-36, because the number of voxels in the bladder is 0, Fig. 5c only plots the DVH for the PTV and rectum. The figure shows that 0.88 percent of the voxels in the rectum receive doses higher than 60 Gy. Also, 95 percent of the voxels in the PTV receive a dose value more than 76 Gy. This indicates that the majority of the radiation is delivered to the PTV while largely sparing the OARs.

This study explored the use of Benders decomposition and optimization-based heuristics to solve the beam angle and fluence map problem for IMRT treatment planning. The results showed that instances with 12 angles can all be solved quickly with any of the proposed methods. For the larger instances with 36 angles, Benders decomposition can generate good feasible solutions, at least with respect to CPLEX, but after 5 hours of computations large optimality gaps still remained. Comparatively speaking, we also found that modern Benders decomposition, which generates more optimality cuts than the traditional approach, can produce slightly better solutions within the same amount of time; on the other hand, traditional Benders generates cuts with higher quality and thus produces a superior lower bound.

The best results were obtained with the LP rounding heuristic in conjunction with local branching. By itself, the former was seen to provide good solutions quickly. When runtimes are critical, the best compromise would be to just use the LP rounding heuristic. For future research, it might be beneficial to investigate ways of strengthening Benders feasibility cuts or to identify stronger Benders cuts. So doing would increase the lower bound provided by the restricted master problem and hence speed convergence. Since Benders decomposition has performed well on other types of problems, there is likely room for improvement in our implementation. In addition, it may be worthwhile experimenting with other local search procedures to improve the solutions generated by the LP rounding heuristic.

@&#ACKNOWLEDGMENT@&#

The authors are grateful for the valuable comments and suggestions made by the three anonymous referees.

@&#REFERENCES@&#

