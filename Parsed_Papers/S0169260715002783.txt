@&#MAIN-TITLE@&#
               dfcomb: An R-package for phase I/II trials of drug combinations

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           R package “dfcomb” available for phase I combination clinical trials according to previous methodological paper.


                        
                        
                           
                           Implement a single prospective clinical trial or simulation studies of phase I combination trials in oncology.


                        
                        
                           
                           Features and illustration of the functions.


                        
                        
                           
                           Promote the use of innovative adaptive design for early phase combination trials.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Dose-finding

Phase I

Combination

Adaptive design

R package

@&#ABSTRACT@&#


               
               
                  In this paper, we present the dfcomb R package for the implementation of a single prospective clinical trial or simulation studies of phase I combination trials in oncology. The aim is to present the features of the package and to illustrate how to use it in practice though different examples. The use of combination clinical trials is growing, but the implementation of existing model-based methods is complex, so this package should promote the use of innovative adaptive designs for early phases combination trials.
               
            

@&#INTRODUCTION@&#

Most phase I cytotoxic dose-finding studies seek to establish a dose high enough to be able to observe potential efficacy while maintaining the toxicity rate within certain pre-defined acceptable limits. Phase I studies in oncology focus on determining the maximum tolerated dose (MTD) that will be used in further experiments [1–3]. However, nowadays, it is rare to find new agents that perform much better than existing therapeutic strategies. When combining two or more agents, there may be a synergistic effect in terms of efficacy. That is why investigators wish to increase overall anti-tumor action and survival by combining several agents: cytotoxics or targeted molecules or both. As a result, it is difficult to suppose that each agent will act independently in terms of toxicity.

When combining two agents, either a cytotoxic with a cytotoxic or a cytotoxic with a molecularly targeted agent (MTA), the underlying modeling assumptions diverge. Indeed, these two types of combinations differ in the shape of the dose-efficacy curves. For cytotoxic agents, a higher dose yields a greater response, but also leads to higher toxicity. However, the dose-efficacy relationship of the MTA may not follow the same monotonic pattern. The efficacy of some MTAs often increases at low dose levels and then plateaus (or approximately plateaus) at higher dose levels once a saturation level has been reached [4–7]. Recently, we proposed two novel statistical designs for each combination type [8,9]. In practice, these methods are based on Bayesian approaches that require high statistical and programming skills.

Many of the newly developed statistical methods for combination designs do not include software for their implementation. Some exceptions include POCRM [10] and PIPE [11]. As a result, many combination studies are still conducted with methods used for single agents [12].

In this article, we present a new R [13] package dfcomb, which provides functions for the conduct of a prospective single trial and simulation studies of the combination of two cytotoxics or a cytotoxic and an MTA in phase I dose-finding trials [8,9]. The primary features of dfcomb are as follows:
                        
                           •
                           Generates simulation replicates of phase I/II clinical trials for combination studies of two cytotoxic agents or a cytotoxic with an MTA.

Determines the next or recommended combination in a phase I/II combination clinical trial.

The primary objective of this paper is to present the features of each method and to describe how to use the R dfcomb package in practice. Section 2 describes the models and computational methods of the package. Section 3 presents the R functions with simulations and examples of two dataset clinical trials, and in Section 4 we conclude with a discussion.

Riviere et al. [8] proposed a Bayesian phase I dose-finding design for clinical trials combining two agents where the toxicity of both agents is assumed to increase with dose levels. As in classic phase I design, the design only accounted for toxicity because the efficacy was assumed to be correlated with toxicity and to increase with dose levels. Therefore, the aim was to determine the maximum tolerated dose (MTD) in the context of the two-drug combination, defined as the combination associated with a toxicity closest to a maximum pre-defined dose-limiting toxicity (DLT) rate.

The combination toxicity probability at dose (j, k), π
                        
                           j,k
                        , composed of dose level j of agent 1 (j
                        =1, …, J) and dose level k of agent 2 (k
                        =1, …, K), was modeled using a 4-parameter logistic model:
                           
                              
                                 logit
                                 (
                                 
                                    π
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 )
                                 =
                                 
                                    β
                                    0
                                 
                                 +
                                 
                                    β
                                    1
                                 
                                 
                                    u
                                    j
                                 
                                 +
                                 
                                    β
                                    2
                                 
                                 
                                    v
                                    k
                                 
                                 +
                                 
                                    β
                                    3
                                 
                                 
                                    u
                                    j
                                 
                                 
                                    v
                                    k
                                 
                                 ,
                              
                           
                        where u
                        
                           j
                         and 
                           
                              v
                              k
                           
                         denote the standardized doses of agents 1 and 2, β
                        0, β
                        1, β
                        2 and β
                        3 are unknown parameters such that β
                        1
                        >0, β
                        2
                        >0, 
                           ∀
                           k
                           ,
                           
                              β
                              1
                           
                           +
                           
                              β
                              3
                           
                           
                              v
                              k
                           
                           >
                           0
                         and ∀j, β
                        2
                        +
                        β
                        3
                        u
                        
                           j
                        
                        >0, ensuring that the toxicity probability increases with the dose levels of both agents, and intercept 
                           
                              β
                              0
                           
                           ∈
                           
                              
                                 ℝ
                              
                           
                        . Gibbs sampling was used to sample in posterior distributions and estimate all posterior probabilities and parameters.

During the trial, determination of dose escalation and de-escalation to adjacent combinations was based on the uncertainty in P(π
                        
                           j,k
                        
                        <
                        θ|data), that is on the probability that the current combination is safe enough. At the end of the trial, the MTD was selected as the tested combination with highest posterior probability, P(π
                        
                           j,k
                        
                        ∈[θ
                        −
                        δ
                        ;
                        θ
                        +
                        δ]), of being in a pre-defined interval around the targeted toxicity θ. We implemented an algorithm-based start-up phase to gather enough information at the beginning of the trial in order to have reliable estimates of posterior probabilities. Moreover, we added stopping rules in cases where all dose levels were too toxic or all dose levels were far from the targeted toxicity (and therefore potentially ineffective). The details of the method can be found in [8].

Riviere et al. [9] proposed a Bayesian phase I/II dose-finding design for clinical trials combining two agents where the toxicity and efficacy of both agents are assumed to increase with dose levels, but the efficacy of one agent can plateau (e.g. molecularly targeted agent).

The toxicity is assumed to be a binary outcome (1 if DLT, 0 otherwise), and the toxicity probability at combination (j, k) was modeled using a logistic model:
                           
                              
                                 logit
                                 (
                                 
                                    p
                                    jk
                                 
                                 )
                                 =
                                 
                                    β
                                    0
                                 
                                 +
                                 
                                    β
                                    1
                                 
                                 
                                    u
                                    j
                                 
                                 +
                                 
                                    β
                                    2
                                 
                                 
                                    v
                                    k
                                 
                              
                           
                        where and u
                        
                           j
                         and 
                           
                              v
                              k
                           
                         are standardized doses ascribed to the jth dose level of agent 1 and the kth dose level of agent 2, β
                        0, β
                        1, and β
                        2 are unknown parameters such that β
                        1
                        >0 and β
                        2
                        >0, so that toxicity monotonically increases with the dose levels of both agents 1 and 2.

In contrast, the efficacy response may require a longer follow-up time to be scored and was therefore considered as a time-to-event outcome. When combining an MTA with a cytotoxic agent, efficacy is expected to increase monotonically with the dose of the cytotoxic agent, but initially increases and then plateaus with the dose of the MTA, after the MTA reaches a level of saturation. We modeled the time to efficacy for the combination (j, k) using a proportional hazard model, λ
                        
                           jk
                        (t), augmented with a plateau parameter τ:
                           
                              
                                 
                                    λ
                                    jk
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    λ
                                    0
                                 
                                 (
                                 t
                                 )
                                 exp
                                 {
                                 
                                    γ
                                    1
                                 
                                 
                                    w
                                    j
                                 
                                 +
                                 
                                    γ
                                    2
                                 
                                 (
                                 
                                    z
                                    k
                                 
                                 
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 <
                                 τ
                                 )
                                 +
                                 
                                    z
                                    τ
                                 
                                 
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 ≥
                                 τ
                                 )
                                 )
                                 }
                                 ,
                              
                           
                        where λ
                        0(t) is the baseline hazard, 
                           
                              
                                 1
                              
                           
                           (
                           .
                           )
                         denotes the indicator function, and 
                           
                              w
                              j
                           
                         and z
                        
                           k
                         are standardized doses. We assume that γ
                        1
                        >0 and γ
                        2
                        >0, and therefore efficacy increases monotonically with the dose of the cytotoxic agent 1. The plateau parameter τ is an integer between 1 and K and indicates at which dose level of agent 2 efficacy reaches a plateau. We assume an exponential distribution for the time to efficacy with a constant baseline hazard, i.e., λ
                        0(t)=
                        λ
                        0, resulting in the following survival function for the time to efficacy:
                           
                              
                                 
                                    S
                                    jk
                                 
                                 (
                                 t
                                 )
                                 =
                                 exp
                                 [
                                 −
                                 
                                    λ
                                    0
                                 
                                 t
                                 
                                 exp
                                 {
                                 
                                    γ
                                    1
                                 
                                 
                                    w
                                    j
                                 
                                 +
                                 
                                    γ
                                    2
                                 
                                 (
                                 
                                    z
                                    k
                                 
                                 
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 <
                                 τ
                                 )
                                 +
                                 
                                    z
                                    τ
                                 
                                 
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 ≥
                                 τ
                                 )
                                 )
                                 }
                                 ]
                                 .
                              
                           
                        
                     

Then, the response rate, q
                        
                           jk
                        , at the end of the full follow-up time T for patients treated at the combination (j, k), is given by q
                        
                           jk
                        
                        =1−
                        S
                        
                           jk
                        (T).

Gibbs sampling was used to sample in toxicity and efficacy posterior distributions and to estimate all posterior probabilities and parameters. The next optimal combination to be administered was selected as the admissible (safe: P(p
                        
                           jk
                        
                        >
                        θ)<
                        C
                        T, and effective: P(S
                        
                           jk
                        (T)>
                        ξ)≥
                        C
                        E; where C
                        T and C
                        E are probability thresholds that need to be calibrated through a simulation study) combination with the highest estimate of efficacy, along with the lowest estimate of toxicity (if plateau reached).

We implemented an algorithm-based start-up phase to gather enough information at the beginning of the trial in order to have reliable estimates of posterior probabilities. If during the trial, all combinations were inadmissible, the trial was stopped without a recommendation of combination. The details of the method can be found in [9]
                     

In this section, for each of the two methods described above, we present code examples and the corresponding outputs for: (1) simulation replicates of clinical trials, and (2) application to data of an ongoing clinical trial.

We will illustrate the features of the CombIncrease_sim function. We considered 5 dose levels for the first agent (ndose_a1=5) and 3 dose levels for the second agent (ndose_a2=3). Then we defined our scenario representing the true toxicity probabilities of the combination. True toxicity probabilities should be entered in a matrix with agent 1 in rows and agent 2 in columns, with increasing toxicity probabilities with both row and column numbers, as for example: 
                              
                           
                        

We chose a targeted toxicity probability (target) of 0.30, which is common in oncology due to the aggressiveness of the disease, and a targeted interval ([target_min;target_max]) of [0.20;0.40]. We then provided initial guesses for toxicity probabilities for the dose levels of agent 1, and agent 2. Typically, if information from phase I clinical trials for these agents individually is available, it can be incorporated to set up the prior toxicity probabilities. 
                              
                           
                        

In this example, if there is no early termination of the trial, a maximum total number of 20 cohorts (n_cohort) of 3 patients (cohort) should be included (that is 60 patients). The toxicity outcome was binary (tite=FALSE), 1 if a DLT is observed, 0 otherwise. We performed 2000 replicates of phase I clinical trials (nsim).

In order to determine the combination of drugs for the next cohort of patients, probability thresholds c
                           
                              e
                            and c
                           
                              d
                            have to be defined. They are critical for the performance of the design as they control the dose escalation and de-escalation. When setting up a new clinical trial, the values of c
                           
                              e
                            and c
                           
                              d
                            should be carefully calibrated through simulation, to ensure good operating characteristics of the design. In practice, this can be performed as follows. First, define a set of representative dose-toxicity scenarios that may be encountered in the trial, and then perform simulations using different values of c
                           
                              e
                            and c
                           
                              d
                            to evaluate the performance of the design. This is a trial-and-error process and may involve repeatedly tuning the values of c
                           
                              e
                            and c
                           
                              d
                            based on the simulation results. The goal is to find the values of c
                           
                              e
                            and c
                           
                              d
                            that yield good overall performance across different scenarios (e.g., the percentage of correct selection of the MTD, the number of patients exposed to over-toxic combinations or under-toxic combinations). We fixed these settings to default values, which seems to give good performance in a large variety of scenarios [8].

Finally, investigators may wish to stop a trial early when all combinations are estimated to be unacceptable in terms of toxicity. Therefore, we propose a stopping rule when the lowest combination is too toxic. In our example, to stop the trial early at least 6 patients should have been included in the lowest combination (n_min) and the probability that the estimated toxicity probability at that combination is above the target (0.30) should be greater than 0.95, meaning that the probability of over-dosing is high. Again, for a simpler use, these arguments were set by default to values giving, in general, good performances for inexperienced users. Then users can choose to calibrate them by simulation studies.

This results in the following call to the function: 
                              
                           
                        

A progress bar appears that indicates the progress of the number of simulations chosen. The simulation can be long, and it is normal to wait some time before the bar changes. Calculation time will clearly depend on the computer resources the user has at his or her disposal, but this example takes about 3h 45min to run on a single portable computer with an Intel Core i7. If the call to the function is stopped before its end, the results for the current number of simulations ended are displayed. The generated output is as follows: 
                              
                           
                        

True toxicity probabilities entered are recalled, and then the results show at each combination (1) the percentage of selection, (2) the mean number of patients included, and (3) the mean number of observed toxicities. Therefore, the percentage of correct selection of a true MTD (combination associated with the toxicity target of 30%) is 28.30+40.65+6.90=75.85%. The mean number of patients and toxicities of each combination can be used to evaluate the number of patients exposed to over-dosing or under-dosing. 
                              
                           
                        

The trials did not stop early and included the total sample size of 60 patients. Other entries are also recalled as follows: 
                              
                            
                           
                              
                           
                        

In a real clinical trial, the CombIncrease_next function determines the next combination to administer. As with CombIncrease_sim, the number of dose levels for each agent, targeted toxicities, initial guesses for toxicity probabilities, and minimum number of patients for early termination should be specified. 
                              
                           
                        

In this example, we considered that the trial is still ongoing (final=FALSE), and currently 18 patients have been enrolled (pat_incl). For each of these 18 patients, two vectors corresponding to the dose levels of each agent administered to the patient should be given, as for example: 
                              
                           
                        

In the following example, the last three patients have received dose 4 of agent 1 and dose 1 of agent 2. The toxicity outcome is binary (tite=FALSE), so the user have to input a vector of toxicity containing for each patient: 1 if a dose-limiting toxicity is observed and 0 otherwise. 
                              
                           
                        

If the toxicity is considered as a time-to-event (tite=TRUE), then two vectors containing the time-to-toxicity and the follow-up time for each patient as well as the value corresponding to the full follow-up time window should be given. The detailed example results in the following call to the function: 
                              
                           
                        

Another possible option include in_startup (set at TRUE by default). If FALSE the start-up phase is forced to be ended and thus estimation can be performed even if the clinical trial did not follow the start-up phase recommended by the original design. This code takes less than one second to run. The generated output is composed as the recalled number of patients and toxicities at each combination: 
                              
                            
                           
                              
                           
                        

The estimated posterior probabilities for toxicity, under/over-dosing are reported. They are used to evaluate the safety of combinations and lead to the recommendation of the next most appropriate combination: 
                              
                            
                           
                              
                           
                        

The next recommended combination is (4, 1) (dose level 4 of agent 1, and dose level 1 of agent 2). Entries as well as accumulated information are reported. 
                              
                            
                           
                              
                           
                        

We will illustrate the features of the CombPlateau_sim function. We considered 3 dose levels for the cytotoxic agent (ndose_a1) and 4 dose levels for the molecularly targeted agent (ndose_a2). We defined the true toxicity and efficacy probabilities of the combination. They should be entered in rows for the cytotoxic agent and in columns for the MTA, with increasing toxicity/efficacy probabilities with both row and column numbers: 
                              
                           
                        

We chose a maximum targeted toxicity probability of 0.30 (tox_max) and a minimum efficacy probability of 0.20 (eff_min). We then provided initial guesses for toxicity/efficacy probabilities for the dose levels of both agents: 
                              
                            
                           
                              
                           
                        

Again, if information from phase I clinical trials for these agents used as single-agents is available, it can be incorporated to set up the prior toxicity probabilities. In this example, if there is no early termination of the trial, a maximum sample size of 75 enrolled patients is needed (n), with a cohort of 3 patients throughout the trial (cohort_start, cohort). As efficacy is considered as a time-to-event outcome (time-to-progression), the full follow-up time to assess efficacy should be specified (time_full). In this example we chose a follow-up time of 7 weeks. The patient accrual is simulated using a Poisson process. We chose a rate of 0.28 (poisson_rate) meaning that on average 1 patient arrives every 3.5 weeks. Even if toxicity should be quickly ascertainable, it is possible to consider that before dose determination the cohort should be followed up for a minimum time to assess toxicity. Usually in oncology, 3 weeks are needed to evaluate toxicity. In the following example, we did not constrain a minimum follow-up time before dose determination and set cycle to 0. We performed 2000 replicates of phase I/II clinical trials (nsim).

In order to determine the combination of drugs for the next cohort of patients, toxicity and efficacy thresholds c
                           
                              tox
                            and c
                           
                              eff
                            have to be defined. These probabilities are used to define combinations that are admissible in terms of toxicity and efficacy. A smaller c
                           
                              tox
                            will be more stringent and require a safer combination in terms of toxicity, and a higher c
                           
                              eff
                            will require a more effective combination. When setting up a new clinical trial, the values of c
                           
                              tox
                            and c
                           
                              eff
                            should be calibrated through simulation depending on the desired operating characteristics of the design. The following call to the function was performed: 
                              
                            
                           
                              
                           
                        

The seed for simulations can be chosen. Finally, as these simulations are computationally intensive, the run time can be long. The argument threads is used to specify the number of threads of the computer to use; by default 0 uses all threads. As this design deals with both toxicity and efficacy, simulations in general take longer to execute than for the previous design. We run this code in a little over 2 days (52h).

The generated output is first composed of the recalled toxicity and efficacy probabilities: 
                              
                            
                           
                              
                            
                           
                              
                           
                        

The results show that the percentage of correct selection of the optimal combination (3, 1) is 73.25%. The trial was stopped at 2.95% because no combination was found that was acceptable in terms of both toxicity and efficacy. 
                              
                            
                           
                              
                           
                        

The mean trial duration was 268 weeks, that is about 5 years, if only one center is recruiting, with on average one patient enrolled every 3.5 weeks. Entries and accumulated data are reported.

When used for a real clinical trial, the CombPlateau_next function determines the next combination to administer. As with CombPlateau_sim, the number of dose levels for each agent, maximum toxicity, minimum efficacy, and initial guesses for toxicity/efficacy probabilities should be specified: 
                              
                            is an integer with value 0 if less than half of the total sample size has been included, 1 if more than half of the total sample size has been included but the trial is still ongoing, and 2 if the trial is over and the dose recommendation should be made. We considered that the trial is ongoing with less than half of the total sample size included, setting stage to 0, and the start-up phase is finished (in_startup=FALSE). After the start-up phase, patients were included by cohorts of 3 patients (cohort). Currently, 18 patients have been enrolled (pat_incl). For each patient, two vectors corresponding to the dose levels of each agent administered to the patient should be given: 
                              
                           
                        

A vector containing the binary toxicity outcome for each patient has to be defined. 
                              
                           
                        

The full follow-up time for efficacy assessment was set to 7 weeks. As efficacy is assessed as a time-to-progression, for each patient, the follow-up time (maximum equal to the full follow-up time) as well as the time-to-progression are required. If no progression is observed for the patient, then the value should be set to +Inf. 
                              
                           
                        

The example detailed above results in the following call to the function: 
                              
                           
                        

This code takes two seconds to run. The output reports the number of patients included, observed toxicities and progressions at each combination according to the entries: 
                              
                            
                           
                              
                           
                        

Then estimated toxicities and efficacies leading to recommendation of combinations are given: 
                              
                            
                           
                              
                           
                        

The next recommended combination is (3, 2). With the current data, the plateau location for the MTA is estimated at dose level 4 (highest posterior probability), which means that with the dose involved, the efficacy plateau should not be reached. Other entries are also recalled: 
                              
                           
                        

@&#CONCLUSIONS@&#

The dfcomb package implements two methods for phase I clinical trials in oncology for the combination of two agents depending on the underlying assumptions: either both toxicity and efficacy increase with the dose of each agent involved (e.g. combination of two cytotoxic agents), or the efficacy can plateau with the dose of one agent (e.g. combination of a cytotoxic agent with a molecularly targeted agent). For each method, the package implements a single prospective clinical trial or simulation studies. In this package, several flexible inputs can be used, such as: (1) prior information on each agent gathered before the trial, (2) the cohort size of patients allocated at each combination level as well as the total sample size, (3) the targeted toxicity, (4) binary or censured data among other possible entries. In the last decade some innovative methods have been proposed for combination studies. However, the implementation of such complex approaches is difficult as most commercial software programs do not provide functions or macros for these approaches. Indeed, many early phase clinical trial methods are not used in practice as programs or scripts are not available. Our R package enables statisticians and physicians to implement adaptive model-based dose-finding designs when two anti-cancer agents are studied.

@&#REFERENCES@&#

