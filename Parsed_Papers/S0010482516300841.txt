@&#MAIN-TITLE@&#Gray level co-occurrence and random forest algorithm-based gender determination with maxillary tooth plaster images

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In this study, GLCM and RF based gender determination has been performed.


                        
                        
                           
                           Maxillary tooth plaster model images have been used to determine gender.


                        
                        
                           
                           Automatic segmentation was carried out by using image processing methods.


                        
                        
                           
                           The features were extracted automatically without requiring any manual measurement.


                        
                        
                           
                           This study is a multi-disciplinary study.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Gender determination

Feature extraction

Image processing

Random forest algorithm

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           fx1
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Teeth are important for breaking down food and chewing, as well as producing correct sounds while talking, providing development of supportive tissues by simultaneously protecting them, and determining identity information about a person. Teeth have durable, resistant features, and can protect their own structure despite catastrophes thus being helpful in identification in forensic and archeology science. Gender is one of the properties of identity, even while improvements can be made by reduction in the cluster when a search is being performed.

In the literature, it has been seen that teeth have differences depending on gender. Parekh et al. [1] stated that the width of the canine arch in males was significantly larger than that of females. In the study of Hasanreisoğlu et al. [2], it was indicated that the size of the central incisors and canines in males was wider than those of females. It was concluded by Forster et al. [3] that the width of the dental arch was related to gender and vertical morphology of the face. In the study of Louly et al. [4], when the dental arch was investigated in a population of Brazilian children, it was found that males had more maxillary depth. In another study by Olmez and Doğan [5], it was discovered that the dental arch of males had more depth and width when compared to females. Horvath et al. [6] found the correlation between maxillary anterior form and gender in 3D data indicated that the maxillary anterior had differences according to gender. In the study of Shin [7], eighteen properties of Principle Component Analysis of maxillary tooth plaster models were classified according to k Nearest Neighbors (kNN) and its algorithm, with a 76% success rate.

When the literature was further investigated, gender determination from teeth can be seen by manual measurements in forensic science and dentistry. However, in the computer sciences, there are inadequate studies on this subject. The purpose of this study is to identify gender determination with features extracted automatically from maxillary tooth plaster model images, without requiring manual measurement. The main contributions of our study to the literature are as follows:
                        
                           •
                           Automatic segmentation was carried out with image processing methods, with features being extracted automatically. Rapid gender determination was performed with this fully automatic designed system.

This study is multi-disciplinary, one in which there are benefits in dentistry, forensic science, and computer sciences.

Size of teeth vary from one population to another. Our proposed method is an automatic system in which every population can adapt to it.

The manuscript is organized as follows: materials and methods used for the proposed system are discussed in the second part. The experimental results are presented in the third part. Finally, the manuscript is finalized with focused remarks.

To perform fully automated gender determination from maxillary tooth plaster model images of individuals, a system is designed where steps can be seen in 
                     Fig. 1.

In the first stage of the system, the segmentation process is handled by standard image. Gray Level Co-occurrence Matrix (GLCM) of segmented image is formed, with specific features extracted from this matrix. The extracted features are classified by the RF algorithm, at which point gender determination is performed.

The first stage of the proposed automated system is the process of image acquisition. In order to get a standard image without shading, a lighting mechanism is used. The maxillary tooth plaster model images of individuals are used, and then a standard image is obtained for each model.

As shown in 
                        Fig. 2, the top inner part of the mechanism is equipped with light sources in the shape of a cube, in order to absorb light from every direction; next, a camera is fixed on top to take a picture. Thus, standard tooth plasters are taken without any shade. All images are taken under identical conditions. In addition, the models are trimmed by making a pedestal for the underside of the model to eliminate problems in the model caused by the angular displacement of teeth. The models were placed parallel to the floor in order to see the dental arch and teeth with a complete steep-angle of the camera. Thus, different perspectives are prevented in the plaster model, as all of them are used with the same angle. Ruler and angle measurement cards are placed under the model to display them at the same level.

After taking images of each maxillary tooth plaster model by using the lighting mechanism to get standard images, the image segmentation process begins.

The image of the plaster model was examined in R (Red), G (Green), and B (Blue) color channels to distinguish them from background images. It was observed that the plaster model in the image had distinctive features in the B color channel than the background. First, the colored image was a transformed binary image according to the B channel threshold level. Dilation, erosion, and median filters were applied to delete background noise after transforming the binary image format. As shown in 
                        Fig. 3, plaster images were cleaned from background noise. The plaster model was segmented by cropping area that obtained from the above process. The segmented plaster image was transformed into a gray level image for features with GLCM. Converting the gray level does not cause any loss of information, in that color information in a plaster model image does not determine gender.

After segmentation of a plaster model, three points were determined automatically for each of the segmented plaster pictures to obtain the dental arch. These points were found to be yellow in 
                        Fig. 4. The first point was located 450 pixels to the right from the lower left-hand corner of the picture, while the second point was located 450 pixels to the left from the lower right-hand corner; the third point was located 300 pixels lower than the upper center pixel. As indicated in Fig. 4, a semi-elliptical area passing through these points was clipped from the picture, such that the dental arch was automatically obtained.

Gender classification by features from anterior teeth and especially those from canine teeth have been observed in the literature. In addition, only some people have wisdom teeth and some do not; thus, molars will generally have much more deformation, such that these factors will negatively affect our classification. Therefore, as shown in 
                        Fig. 5, we clipped half of the dental arch containing anterior teeth. The half-dental arch image that was found contains anterior teeth and canines. The width of the arch image has been reformatted to standard size of 50 pixels, by maintaining the original height/width ratio after the clipping process.

We automatically extracted classification features from the image using the GLCM method. There were no measurements from the plaster model or image.

After the segmentation process, the GLCM method suggested by Haralick [8] automatically extracted features from gray level images. Using this method, pixel pairs were observed in the image and calculated within certain values and spatial relationships, once the GLCM was formed. At that point, features were extracted from this matrix to be used for the analysis.

GLCM is a square matrix of a gray-level pair in a specific direction, and a specific distance between them. It shows the probability of pixels from a gray level ‘i’ to a gray level ‘j,’ when the distance between pixels is d and the angle is θ. Investigations are generally done in four directions, with θ=0°, 45°, 90°, and 135° on the matrix.

In this study, the graycoprops
                           1
                        
                        
                           1
                           
                              http://www.mathworks.com/help/images/ref/graycoprops.html.
                         function of Matlab was used. Graycoprops allows contrast, correlation, energy, and homogeneity GLCM features. Features such as contrast and homogeneity are a function of the probability of each matrix, given differences of the ‘i’ and ‘j’ grey levels. Likewise, features such as energy and entropy measure regularity of the gray value distribution. Contrast, correlation, and homogeneity can measure local variations in the image [9]. In this study, the features found by measuring local variations in the image were used.
                           
                              i)
                              
                                 Contrast:
                                  Contrast features indicate local variations present in the image. It is the intensity contrast between one pixel and its neighbor, with the contrast being 0 for stable images.
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      |
                                                      
                                                         i
                                                         −
                                                         j
                                                      
                                                      |
                                                   
                                                   2
                                                
                                                p
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                          
                                       
                                    
                                 
                              


                                 Correlation:
                                  The correlation feature is a measure of gray-level linear dependencies in the image. It indicates how a pixel and its neighbor are correlated. This feature is 1 for completely positive-correlated images, whereas it is −1 for completely negative correlated images.
                                    
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      i
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                      (
                                                      j
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                      p
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 Homogeneity:
                                  The homogeneity feature is a measure of closeness belonging to distribution of elements in GLCM to that of elements in the diagonal GLCM.

The ensemble learning methods produce multiple classifiers and classify new observations with votes from them. The RF algorithm is one of the ensemble learning methods, and is known as one of the most successful classification methods. By definition, since it addresses very different disciplines, RF draws attention of researchers working in different fields.

The RF algorithm was presented by Brierman [10] and can be defined as a tree-type classification society. In the algorithm, two parameters must be determined; these are m and N. m is the number of variables to be used for each node and N is the number of trees to be created.

In the first stage of the algorithm, 2/3 of the training data set (inBag) is used to build the decision tree, while the remaining 1/3 (out-of-the bag, OOB) is used to calculate internal error rate. The decision tree is created with inBag, and is not pruned. The m variables are selected randomly for creating the tree, while the total number of variables is p (m<p). Best split is calculated based on m variables. This process is continued until there is enough of a large tree. These steps are repeated N times.

The steps are performed for each tree, and may be summarized as follows:

1.The training dataset is divided in two parts, including inBag and OOB.

2.The m variables are selected randomly (m<p).

3.Best split is calculated based on the m variables. This process is repeated to create a large enough tree.

4.Internal error rate is calculated with OOB.

The new observation is labeled as the class with the highest vote from N trees.

In the literature survey, we found positive results with the RF algorithm in binary problems [11,12]. RF is, at the same time, rapid, resistant to overfit, and can be used as desired: in this way, many trees can be studied at once [13]. The RF algorithm was acceptable for gender determination system with binary problems.

To create a data set, a working group consisted of 40 people (20 females, 20 males) belonging to the Turkish population between 21–24 years old by taking 2015/002 numbered Ethics Committee approval from Necmettin Erbakan University Faculty of Dentistry. Maxillary tooth plaster models of each person were used.

The tooth's shape, size, and position can be altered by prosthetic treatment, such that the prosthesis is harmonized with dentofacial and dentoalveolar structures. Prosthodontists can make them inclined or outside the arch, and longer than normal teeth; this can be done in dental anatomy and dentoalveolar bone structure under the teeth. A prosthesis must be compatible with surrounding teeth, and dental anatomy. Therefore, individuals with a prosthesis on one tooth were accepted in our study. However, individuals with prostheses on two or more teeth are not included in the data set to avoid adverse effects.

Those with normal teeth combinations, i.e., without missing and/or redundancy anterior teeth, or crowding were included in the data set, while those with extreme crowding, or double row sequences were not included in the data set, as the teeth cannot be fully seen.

@&#EXPERIMENTAL RESULTS@&#

In this study, a smart system was proposed for automatic gender determination by using images of maxillary tooth plaster models. To achieve this, a lighting mechanism was mentioned in the Materials and Method section. Standard images of each plaster model were obtained with this mechanism.

After producing images of maxillary teeth plaster models, the plaster model in the image was clipped via automatic segmentation. After clipping the plaster model image, the area where the dental arch was segmented. Half of the dental-arch image in a vertical direction was clipped from its original size, described in Section 2.2. Width of the half-dental arch image was resized to create a standard size of 50 pixels by maintaining the original height/width ratio.

After the segmentation process, GLCM was formed in 3 different directions as θ=0°, 45° and 135° and d=1 for each image. A total of 9 features were extracted from 3 tissue properties (contrast, correlation, and homogeneity) of each formed matrix.

Since selecting a suitable value for parameter d is closely related with roughness or fineness of the texture present in the image, it is extremely important. In this study, the distance parameter was selected as 1 to determine fine, detailed texture as well. The calculation of GLCM in 3 directions (θ=0°, 45°, and 135°) was due to the dental arch images having significant features in these directions.

Nine features were obtained from each image through GLCM, and a data set was created for classification of them. The RF algorithm was used for classification, with the Orange 2.7. Software program
                           2
                        
                        
                           2
                           Orange 2.7. is available at www.orange.biolab.si.
                         used. This software uses Gain Ratio as a feature selection criterion to determine a split in the RF algorithm. As the result of the experiments, the optimum parameters were determined for RF. The number of trees, consider exactly random attributed each split and seed for random generator was selected 100, 5 and 5, respectively.

The RF algorithm as well as the Support Vector Machine (SVM), Artificial Neural Network (ANN), Naive Bayes (NB), and kNN algorithms were applied to compare the success of the system. The optimum type of SVM was v-SVM, complexity bound was 0.70, and kernel function was determined as RBF. For ANN, it was found that the optimum number of hidden layers was 10, regularization factor was 1, and the maximum iteration number was 300. For kNN, the distance measure was determined as Manhattan, and the value of k was 18. These method performances were tested through a 10-fold cross validation. The results of classification can be seen in 
                        Table 1.

As seen in Table 1, the highest success rate was achieved by using RF. The classification system yielded a 95% success rate in females, 85% success rate in males, and 90% success rate in general.

According to the results of classification, the ROC curve for RF was drawn. This ROC curve was based on a class of females as shown in 
                        Fig. 6.

The area under the ROC curve (AUC) was calculated at a rate of 92.5%. The results indicated that the proposed system had an acceptable high success rate.

@&#CONCLUSION@&#

Gender determination is one of the most popular fields in computer science. Gender determination studies were carried out with face, walking, and signature patterns when the literature was investigated [14–16].

Since teeth have a hard and resistant structure, they are important sources for gender determination in situations such as accidents and disasters. Gender determination studies through teeth are generally performed in dentistry and forensic science. In this study, a multi-disciplinary study was carried out, with a system to perform gender determination automatically via maxillary tooth plaster images, as proposed.

Features were extracted automatically from images taken by a designed mechanism and classified by the RF algorithm. The rate of success was found to be 90% and AUC was found to be 92.5%. With this system, gender determination was rapidly performed from teeth images without additional effort and measurement.

Classification with certain features was automatically extracted from images via the GLCM method. Studies in other fields achieved successful results as well, and found features from images with the GLCM method [17–20]. Successful results were also seen when the GLCM method used a great amount of data [18–20].

When examining literature on gender determination from teeth, it has been observed that teeth size and the distance between those of each different population are different. The obtained features through manual measurement are only applied to the related population and not suitable for different nationalities.

Our study can be adapted for different groups, as the features will be extracted from images of the related population and suitable features will then automatically be obtained for the indigenous people. This study has the capacity to lead in the field of gender determination for computer science literature.

@&#ACKNOWLEDGMENTS@&#

The authors acknowledge TUBITAK (The Scientific and Technological Research Council of Turkey) for 2211 scholarship.

@&#REFERENCES@&#

