@&#MAIN-TITLE@&#Background subtraction for the moving camera: A geometric approach

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a geometric approach to background subtraction for freely moving cameras.


                        
                        
                           
                           We introduce a 2.5D background model that describes the background scene.


                        
                        
                           
                           The algorithm does not rely on restrictions on camera motions or scene geometry.


                        
                        
                           
                           Moving objects are detected in complex scenes with significant camera motion.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Background subtraction

Object detection

Camera motion

View geometry

@&#ABSTRACT@&#


               
               
                  Background subtraction is a commonly used technique in computer vision for detecting objects. While there is an extensive literature regarding background subtraction, most of the existing methods assume that the camera is stationary. This assumption limits their applicability to moving camera scenarios. In this paper, we approach the background subtraction problem from a geometric perspective to overcome this limitation. In particular, we introduce a 2.5D background model that describes the scene in terms of both its appearance and geometry. Unlike previous methods, the proposed algorithm does not rely on certain camera motions or assumptions about the scene geometry. The scene is represented as a stack of parallel hypothetical planes each of which is associated with a homography transform. A pixel that belongs to a background scene consistently maps between the consecutive frames based on its transformation with respect to the “hypothetical plane” it lies on. This observation disambiguates moving objects from the background. Experiments show that the proposed method, when compared to the recent literature, can successfully detect moving objects in complex scenes and with significant camera motion.
               
            

@&#INTRODUCTION@&#

Background subtraction is the process of detecting objects (foreground) residing in the static scene (background). Generally speaking, background subtraction involves building a scene representation referred to as the background model, which is compared against incoming video frames to detect the objects. In the case when camera moves, it is important to compensate the camera motion, such that the background model and a new frame are registered. This requirement imposes significant constraints on the types of motions the camera can undergo.

A typical setting commonly adopted by many in the field is when the camera is stationary. In this setting, the static background pixels maintain their locations, such that the transformation from the incoming frame to the background model is an identity transformation, which geometrically implies that the static scene can be considered a single 3D plane. There are too many papers to cite in the literature that assume a stationary camera [1–3]. These papers and many others employ similar statistical models to represent the color distributions of pixels which include parametric [1,2] and non-parametric models [3]. There are also a few studies that perform background subtraction for stationary cameras but with dynamic backgrounds [4–10]. For more detailed discussion on background subtraction for stationary cameras, we refer the reader to comprehensive surveys in [11–13].

Another typical but less studied camera setting is when the camera is restricted to only pan, tilt and zoom, such that the optical center of the camera does not move [14–17]. This limited motion imposes a rotational homography, which is also known as the plane projective transformation, between the background model and the incoming frame. Similar to the stationary camera, this setting lets construction of a panoramic background model that has a wide scene coverage. The moving object detection proceeds by first registering the video frame to the panoramic background model and employing the background subtraction with this registered model.

When the optical center of the camera moves, the one-to-one mappings between the background model and the video frame can no longer be computed. In fact, the image regions that belong to different planes in the 3D scene create parallax and require different transformations and background models. This requirement is emphasized when the 3D scene contains significant depth variations. In order to address this limitation, several methods assume existence of a dominant scene plane with wide spatial coverage [18–22]. These so-called plane
                     
                     +
                     
                     parallax methods register images to the dominant plane and use the epipolar constraint [18,19], shape constancy constraint [20] or the structure consistency constraint [21] to resolve incorrect registrations due to parallax and object motion. Authors of [22] handle parallax by applying robust statistics [23] to motion estimation [24].

While plane+parallax methods perform well for scenes that can be approximated by a single plane, such as in aerial imagery, difficulties arise in cases when the scene contains more than one dominant plane. For such cases, researchers resort to estimating a set of physical planes in the scene [25–29]. In context of background subtraction, Jin et al. [30] adopt the multi-plane representation and generate different background models for each scene plane. Given a sequence of images, the scene planes and respective homography transformations are estimated by applying a cascade of RANSAC steps. This process assumes that the scene planes contain a high number of matching salient points
                        1
                        We refer to images of static scene points as salient points.
                     
                     
                        1
                      between consecutive video frames. All the planes selected through this process, however, may not necessarily provide full spatial coverage of the scene. In addition, selecting multiple scene planes through a cascaded RANSAC process practically results in non-existing scene planes leading to incorrect background models. In order to address this shortcoming, Monnet et al. [31] formulate the problem of background subtraction as the complement of saliency detection, such that, background model becomes insensitive to the camera motion due to its locally discriminant nature. A recent study by Lim et al. [32] proposes an online iterative algorithm where the geometry of the scene is approximated by dividing the image into multiple blocks and estimating the background/foreground motion of each block using optical flow. As observed in experimental results, the background labeling in [32], however, is prone to complex scene geometry and small objects that inhibit the planar scene assumption for each the block. Similarly, Kwak et al. [33] use the same block-wise approach but adopt a non-parametric belief propagation with Gaussian mixtures for motion estimation.

Alternative to multi-layer representations, Sheikh et al. [34] applied factorization based shape from motion to a set of tracked points. They labeled the trajectories as background or foreground based on the assumption that background trajectories form a 3D subspace. Their approach, however, requires offline processing and generates a sparse model due to disjoint trajectories. A recent method proposed by Elqursh et al. [35] represents trajectories in a low-dimensional space and groups them by relearning the Gaussian Mixture Model at each frame. The decision of which trajectory groups belong to background or foreground is given by a set of heuristics such as compactness, surroundedness, and spatial closeness, which may not always hold. Another method for moving object detection with hand held cameras was proposed in [36]. The authors combine color and locality cues to detect moving objects when the object motion is sparse and insufficient. This method assumes that the global background motion can be modeled by a single homography transformation. Existence of a single homography transform, however, does not hold when the camera translation is significant for a complex scene. Zhang et al. [37] improved the single homography assumption by introducing a bilayer segmentation approach for handheld cameras. Their approach, however, requires a manual preprocessing step to indicate the foreground layer each time a new foreground object enters the scene. Background from moving cameras can also be estimated by video grounding that removes the moving objects and reconstructs the occluded parts of the background in a sequence of images. In the case of video grounding using moving cameras, Evangelidis et al. [38] exploit information obtained from multiple image sequences capturing the same scene and use a set of background/foreground classifiers with temporal coherence constraints to estimate the background.

In this paper, we adopt the idea of multi-layer representation for detecting moving objects when the camera moves freely in the space. Unlike [30], we do not select a number of scene planes. Instead, we select a single plane with the highest number of salient points as the reference plane, and generate a set of hypothetical planes that slice the 3D scene creating object cross-sections (see Fig. 1
                     ). This treatment overcomes the aforementioned problems of plane selection for multi-layer approaches. In plane-sweep stereo, researchers have used such hypothetical planes for projective 3D recovery [39] and surface visibility tests [40] in context of volumetric scene recovery. For the background subtraction problem, we conjecture that all pixels in an image are projections of 3D points lying on respective hypothetical planes. This conjecture suggests that given sufficient number of planes, pixels that are members of the static scene only register to the images of the hypothetical planes they belong. These memberships generate a 2.5D background model which contains color statistics for each hypothetical plane (see Fig. 2
                     ). The residual pixels that do not satisfy the statistics of any hypothetical plane belong to the moving objects. In our approach, a set of points lying on the same physical plane may be associated with a number of hypothetical planes. This property provides the flexibility to generate background models for nonplanar static scene structures, which is otherwise impossible for typical multi-layer based scene models. In summary, the main contributions of the paper include: (1) ability to detect moving objects for freely moving cameras; (2) generating 2.5D background model for a generic scene containing nonplanar structures; and (3) implicit disambiguation of scene structures with high parallax in consecutive video frames based on the scene geometry.

The remainder of the paper is organized as follows. In the next section, we elaborate on image transformations induced by different types of camera motion and introduce the plane topology used to model the scene. Based on this topology, the details of proposed background subtraction method are sketched in Section 3. Section 4 provides the experimental evaluations and discussions. Finally, we conclude the paper and provide future directions in Section 5.

Pinhole camera provides a simple yet powerful model that projects the 3D object space to 2D image plane. The transformation is algebraically governed by the perspective projection in the homogenous coordinates and is given by:
                        
                           (1)
                           
                              s
                              x
                              =
                              P
                              X
                              =
                              K
                              R
                              [
                              I
                              |
                              -
                              C
                              ]
                              X
                              ,
                           
                        
                     where a 3D point 
                        
                           X
                           =
                           
                              
                                 (
                                 X
                                 ,
                                 Y
                                 ,
                                 Z
                                 ,
                                 1
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      maps to a 2D point 
                        
                           x
                           =
                           
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 1
                                 )
                              
                              
                                 ⊤
                              
                           
                        
                      with scale s. Based on central projection, the 
                        
                           3
                           ×
                           4
                        
                      projection matrix 
                        
                           P
                        
                      in (1) can be decomposed into the camera calibration matrix 
                        
                           K
                        
                     , camera rotation matrix 
                        
                           R
                        
                      and the optical center vector 
                        
                           C
                        
                     . Let two images 
                        
                           x
                        
                      and 
                        
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                        
                      of a 3D point 
                        
                           X
                        
                      be acquired at consecutive time instants, as the camera rotates, translates and zooms in on objects. For relative camera motion, the initial camera center can be assumed to reside at the origin and have its principle axis aligned with the z-axis of the coordinate system, such that 
                        
                           s
                           x
                           =
                           K
                           [
                           I
                           |
                           0
                           ]
                           X
                        
                      and 
                        
                           
                              
                                 s
                              
                              
                                 ′
                              
                           
                           
                              
                                 x
                              
                              
                                 ′
                              
                           
                           =
                           K
                           
                              
                              
                                 ′
                              
                           
                           [
                           R
                           |
                           t
                           ]
                           X
                        
                      are the projections for two consecutive cameras. In the following discussion, we will analyze different camera motions to understand its effect on the static scene in context of generating background models.
                        
                           (1)
                           
                              Stationary camera: When camera is stationary, 
                                 
                                    R
                                    =
                                    I
                                 
                               and 
                                 
                                    t
                                    =
                                    0
                                 
                              , with a fixed focal length, the projection matrices between consecutive frames become identical: 
                                 
                                    P
                                    =
                                    P
                                    
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . In this setting, a 3D point projects to the same pixel in both images, 
                                 
                                    s
                                    x
                                    =
                                    K
                                    K
                                    
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              , such that the transformation between the two images simplifies to identity matrix 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    I
                                    x
                                 
                               due to the constant scale. A desired outcome of the identity transformation is that despite the complexity of the scene geometry, one can directly use the color observations at a particular pixel for generating/updating the background model without image registration.


                              Pan-tilt-zoom camera: Pan-tilt-zoom (PTZ) camera is commonly used in moving object detection. This camera undergoes only rotational changes in its external configuration due to the pan/tilt motion, and focal length changes due to zooming. Since the camera does not translate, projections from 3D to images become 
                                 
                                    s
                                    x
                                    =
                                    K
                                    X
                                 
                               and 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    K
                                    
                                       
                                       
                                          ′
                                       
                                    
                                    R
                                    X
                                 
                              . These projections result in direct image registration 
                                 
                                    s
                                    x
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                    K
                                    R
                                    
                                       
                                       
                                          ⊤
                                       
                                    
                                    
                                       
                                          
                                             
                                                K
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                               by means of rotational homography [41, p. 326], such that 
                                 
                                    s
                                    x
                                    =
                                    H
                                    
                                       
                                       
                                          R
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              . Disregarding the complexity of the scene structure, rotational homography provides a one-to-one mapping between the images which can be used to generate panoramic background models. The added complexity of this configuration compared to the stationary camera is the additional step for detecting and matching/tracking a minimum of four salient points across frames.


                              Free camera motion
                              
                              +
                              
                              planar scene: When the scene is assumed to be planar, such as in aerial imagery [15], 3D points can be conjectured to lie on a ground plane 
                                 
                                    π
                                 
                              . Without loss of generality, selecting 
                                 
                                    π
                                 
                               as 
                                 
                                    Z
                                    =
                                    0
                                 
                               plane, using the projection matrix 
                                 
                                    P
                                    =
                                    [
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                 
                               in (1), points 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          π
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          X
                                          ,
                                          Y
                                          ,
                                          1
                                          )
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                               on 
                                 
                                    π
                                 
                               are projected to image by 
                                 
                                    s
                                    x
                                    =
                                    [
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          4
                                       
                                    
                                    ]
                                    
                                       
                                          X
                                       
                                       
                                          π
                                       
                                    
                                    =
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          π
                                       
                                    
                                    )
                                 
                              , where s is the scale factor and 
                                 
                                    H
                                 
                               is the homography transform between the scene plane and the image. The registration between two frames with respect to the plane 
                                 
                                    π
                                 
                               becomes 
                                 
                                    s
                                    x
                                    =
                                    H
                                    
                                       
                                          X
                                       
                                       
                                          π
                                       
                                    
                                    =
                                    H
                                    
                                       
                                          
                                             
                                                H
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          π
                                       
                                    
                                    )
                                    
                                       
                                          x
                                       
                                       
                                          ′
                                       
                                    
                                 
                              , where 
                                 
                                    H
                                    
                                       
                                       
                                          π
                                       
                                    
                                 
                              , similar to 
                                 
                                    H
                                    
                                       
                                       
                                          R
                                       
                                    
                                 
                              , is a homography transform. The complexity of this configuration is the same as in PTZ camera case and it requires detection and matching of salient points for registration of images to detect moving objects. This approach, however, will not work for images where the scene parallax causes registration errors.


                              Free camera motion
                              
                              +
                              
                              complex scene geometry (2.5D Representation): In this configuration, we conjecture that the 3D scene can be decomposed into a stack of N “hypothetical planes” slicing the scene into a set of disjoint 2D subspaces. Considering that the choice of the coordinate system in Euclidean geometry is arbitrary, we let a reference plane 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          0
                                       
                                    
                                 
                               generating the hypothetical planes coincide with the 
                                 
                                    Z
                                    =
                                    0
                                 
                               plane: 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          0
                                          ,
                                          0
                                          ,
                                          1
                                          ,
                                          0
                                          ]
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                              . Note that the reference plane does not need to be a physical scene plane. Translating the reference plane by 
                                 
                                    k
                                    Δ
                                    Z
                                 
                               in Z direction generates a parallel hypothetical plane 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          0
                                          ,
                                          0
                                          ,
                                          1
                                          ,
                                          -
                                          k
                                          Δ
                                          Z
                                          ]
                                       
                                       
                                          ⊤
                                       
                                    
                                    :
                                    k
                                    ∈
                                    N
                                 
                               with a pencil at infinity (see Fig. 3
                              ). The points 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          ,
                                          0
                                       
                                    
                                 
                               lying on the reference plane 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          0
                                       
                                    
                                 
                               can be transferred to the hypothetical plane 
                                 
                                    
                                       
                                          π
                                       
                                       
                                          k
                                       
                                    
                                 
                               by a 
                                 
                                    4
                                    ×
                                    4
                                 
                               homography matrix:

Considering that there exists a single vanishing line for the hypothetical planes generated by translating 
                        
                           
                              
                                 π
                              
                              
                                 0
                              
                           
                        
                     , estimating the images of points for these non-existing planes becomes the problem of estimating pixel scales using (5) and (6). Using these points, the image registration with respect to any hypothetical plane is achieved by computing its respective homography transform:
                        
                           (7)
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    ′
                                 
                              
                              =
                              H
                              
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              ,
                           
                        
                     where 
                        
                           H
                           
                              
                              
                                 0
                              
                           
                           ,
                           H
                           
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           H
                           
                              
                              
                                 N
                                 -
                                 1
                              
                           
                        
                      are transformations providing one-to-one mappings between consecutive images for each plane 
                        
                           
                              
                                 π
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 π
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 π
                              
                              
                                 N
                                 -
                                 1
                              
                           
                        
                     .

The multi-layer scene model given above requires the vanishing line 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                           
                        
                      and the vertical vanishing point 
                        
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                        
                     . Vanishing lines can be estimated using different approaches. One of these approaches is to use cascaded Hough transform to first estimate vanishing points such that their join becomes the vanishing line [42] (see Fig. 3). Alternatively, vanishing line can be estimated by computing the relative camera motion between consecutive frames. In our case, since we use the ground plane as the reference plane, the camera matrices of the first few frames can be estimated using [43]. Note that the vanishing line needs to be estimated only for the first frame. Using the dual of the homography in (7), the vanishing line estimated initially simply transfers to the following frame by
                        
                           (8)
                           
                              
                                 
                                    l
                                 
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              =
                              H
                              
                                 
                                 
                                    0
                                 
                                 
                                    -
                                    ⊤
                                 
                              
                              
                                 
                                    l
                                 
                                 
                                    v
                                 
                              
                              ,
                           
                        
                     where 
                        
                           H
                           
                              
                              
                                 0
                              
                           
                        
                      is the homography transform in (7) for plane 
                        
                           
                              
                                 π
                              
                              
                                 0
                              
                           
                        
                     .

Given the vanishing line 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                           
                        
                      of the plane, the vanishing point 
                        
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                        
                      is computed in closed form using the topology illustrated in Fig. 4
                     , where 
                        
                           CC
                        
                      and 
                        
                           PP
                        
                      are the camera center and the principal point, respectively. This geometry provides the vertical point 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       v
                                    
                                 
                              
                           
                        
                      on 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                           
                        
                     , such that 
                        
                           
                              
                                 x
                              
                              
                                 
                                    
                                       l
                                    
                                    
                                       v
                                    
                                 
                              
                           
                           =
                           
                              
                                 l
                              
                              
                                 v
                              
                           
                           ×
                           
                              
                                 l
                              
                              
                                 v
                              
                              
                                 ⊥
                              
                           
                        
                     , where 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                              
                                 ⊥
                              
                           
                        
                      is the line passing through 
                        
                           PP
                        
                      and perpendicular to 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                           
                        
                     . Using this relation 
                        
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                        
                      is calculated as:
                        
                           (9)
                           
                              
                                 
                                    v
                                 
                                 
                                    z
                                 
                              
                              =
                              PP
                              +
                              (
                              PP
                              -
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                              )
                              b
                              /
                              a
                              ,
                           
                        
                     where
                        
                           (10)
                           
                              a
                              =
                              |
                              |
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          v
                                       
                                    
                                 
                              
                              -
                              PP
                              |
                              |
                              ,
                              
                              and
                              
                              b
                              =
                              
                                 
                                    f
                                 
                                 
                                    2
                                 
                              
                              /
                              a
                              .
                           
                        
                     
                  

In order to generate hypothetical planes, we use 
                        
                           
                              
                                 x
                              
                              
                                 g
                              
                           
                        
                     , which is the image of an arbitrary salient point 
                        
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 0
                              
                           
                        
                     , and 
                        
                           
                              
                                 x
                              
                              
                                 v
                              
                           
                        
                     , which is the image of the corresponding point 
                        
                           
                              
                                 X
                              
                              
                                 i
                                 ,
                                 k
                              
                           
                        
                     . The plane 
                        
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                        
                      is selected by setting an arbitrary projective scale of a point 
                        
                           
                              
                                 x
                              
                              
                                 v
                              
                           
                        
                      in the first frame lying on the line connecting the vanishing point 
                        
                           
                              
                                 v
                              
                              
                                 z
                              
                           
                        
                      to any point 
                        
                           
                              
                                 x
                              
                              
                                 g
                              
                           
                        
                      on the reference plane 
                        
                           
                              
                                 π
                              
                              
                                 0
                              
                           
                        
                     . In our experiments, we used 100 as the reference projective scale. In the next frame, the vanishing line 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                              
                                 ′
                              
                           
                        
                      is estimated using (8) and 
                        
                           
                              
                                 v
                              
                              
                                 z
                              
                              
                                 ′
                              
                           
                        
                      is calculated from 
                        
                           
                              
                                 l
                              
                              
                                 v
                              
                              
                                 ′
                              
                           
                        
                      using (9). The ground point 
                        
                           
                              
                                 x
                              
                              
                                 g
                              
                           
                        
                      is transformed using the ground homography 
                        
                           H
                           
                              
                              
                                 0
                              
                           
                        
                      to find 
                        
                           
                              
                                 x
                              
                              
                                 g
                              
                              
                                 ′
                              
                           
                        
                     . Based on the geometry illustrated in Fig. 5
                     , the vertical point 
                        
                           
                              
                                 x
                              
                              
                                 v
                              
                              
                                 ′
                              
                           
                        
                      can be estimated as the intersection of the of line 
                        
                           
                              
                                 l
                              
                              
                                 gv
                              
                              
                                 ′
                              
                           
                        
                      and the epipolar line 
                        
                           F
                           
                              
                                 x
                              
                              
                                 v
                              
                           
                        
                     , such that
                        
                           (11)
                           
                              
                                 
                                    x
                                 
                                 
                                    v
                                 
                                 
                                    ′
                                 
                              
                              =
                              (
                              
                                 
                                    v
                                 
                                 
                                    z
                                 
                                 
                                    ′
                                 
                              
                              ×
                              
                                 
                                    x
                                 
                                 
                                    g
                                 
                                 
                                    ′
                                 
                              
                              )
                              ×
                              F
                              
                                 
                                    x
                                 
                                 
                                    v
                                 
                              
                              ,
                           
                        
                     where 
                        
                           F
                        
                      is the fundamental matrix between consecutive frames.

Our objective is to estimate a binary labeling 
                        
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                           =
                           {
                           
                              
                                 l
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 l
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 l
                              
                              
                                 n
                              
                           
                           }
                        
                     , which denotes if the pixel belongs to the background or the foreground. Motivated by the MAP-MRF formulation outlined in [44,45], the labeling can be achieved by finding 
                        
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 argmin
                              
                              
                                 L
                              
                           
                           E
                           (
                           L
                           ,
                           x
                           )
                        
                     , which minimizes the energy function given by:
                        
                           (12)
                           
                              E
                              (
                              L
                              ,
                              x
                              )
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       I
                                    
                                 
                              
                              D
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       N
                                       (
                                       I
                                       )
                                    
                                 
                              
                              V
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                              .
                           
                        
                     In this equation, 
                        
                           D
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                        
                      and 
                        
                           V
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 j
                              
                           
                           )
                        
                      respectively represent the data and smoothness terms in local neighborhood 
                        
                           N
                           (
                           ·
                           )
                        
                     . The data term can be written as:
                        
                           
                              D
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              -
                              ln
                              p
                              
                                 
                                    
                                       
                                          
                                             l
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                -
                                                ln
                                                p
                                                (
                                                b
                                                |
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                if
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                             
                                                
                                                if
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           p
                           (
                           b
                           |
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                        
                      is the probability of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      being a background pixel, 
                        
                           
                              
                                 η
                              
                              
                                 f
                              
                           
                        
                      is the parameter determining the cost of labeling the pixel 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                      as foreground and 
                        
                           
                              
                                 l
                              
                              
                                 i
                              
                           
                           ∈
                           {
                           0
                           ,
                           1
                           }
                        
                      represents the label for background (0) and foreground (1).

We compute the probability 
                        
                           p
                           (
                           b
                           |
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                        
                      by representing the background scene as a stack of hypothetical planes as described in Section 2. With this representation, points in the scene belong to one of the hypothetical planes. Moreover, points belonging to the static scene structures register between consecutive frames with one of the homography transforms 
                        
                           H
                           
                              
                              
                                 0
                              
                           
                           ,
                           H
                           
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           H
                           
                              
                              
                                 N
                                 -
                                 1
                              
                           
                        
                     . Let 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      be a 3D point and 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      be its images in frames 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                        
                      and 
                        
                           
                              
                                 I
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                     , respectively. We compute N possible registrations 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 0
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 1
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 N
                                 -
                                 1
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      with respect to each plane:
                        
                           (13)
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              ,
                           
                        
                     where 
                        
                           H
                           
                              
                              
                                 k
                              
                           
                        
                      is the homography transform in (7), and the subscript k in 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      indicates that 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      is transformed with 
                        
                           H
                           
                              
                              
                                 k
                              
                              
                                 t
                              
                           
                        
                     . If 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      belongs to a plane 
                        
                           
                              
                                 π
                              
                              
                                 m
                              
                           
                        
                     , we expect 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 m
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           =
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      if 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      belongs to a static scene, and 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 m
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           
                           ≠
                           
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      if 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      belongs to a foreground region. As a result, background points will result in consistent mappings across the frames with respect to one of the hypothetical planes (see Fig. 6
                     ), while the foreground pixels will result in inconsistent mappings. We exploit this fact to distinguish background and foreground.

Finding the plane on which 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      lies is not trivial. We eliminate the requirement of implicit estimation of the plane on which a point resides by maintaining a background model for each hypothetical plane 
                        
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                        
                      as if all points in the image belongs to that plane. With this setting, a pixel 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      can be labeled as background by applying maximum a posteriori probability (MAP) estimate, such that the probability of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      being a background pixel, 
                        
                           p
                           (
                           b
                           |
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                        
                      is computed by:
                        
                           (14)
                           
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       max
                                    
                                    
                                       0
                                       ⩽
                                       k
                                       <
                                       N
                                    
                                 
                              
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                              ,
                           
                        
                     where 
                        
                           p
                           (
                           b
                           |
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                           )
                        
                      is the conditional probability of 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                        
                      being a background pixel with respect to plane 
                        
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                        
                      given the corresponding position 
                        
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 t
                                 -
                                 1
                              
                           
                        
                      computed using (13) and color value 
                        
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                        
                      of the pixel. Recall that the background model for each hypothetical plane 
                        
                           
                              
                                 π
                              
                              
                                 k
                              
                           
                        
                      models all pixels assuming that they belong to this plane. When a physical static scene point 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      resides on a plane 
                        
                           
                              
                                 π
                              
                              
                                 m
                              
                           
                        
                     , this assumption, while not valid for most of the planes 
                        
                           
                              
                                 π
                              
                              
                                 k
                                 ≠
                                 m
                              
                           
                        
                     , is guaranteed to hold for at least one plane 
                        
                           
                              
                                 π
                              
                              
                                 k
                                 =
                                 m
                              
                           
                        
                     . The use of MAP estimate requires the presence of at least one distribution modeling 
                        
                           
                              
                                 X
                              
                              
                                 i
                              
                           
                        
                      correctly. Applying the Bayes’ rule, the expression 
                        
                           p
                           (
                           b
                           |
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                           )
                        
                      in (14) becomes
                        
                           (15)
                           
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              )
                              =
                              c
                              ·
                              
                                 
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          )
                                          |
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          ,
                                          b
                                          )
                                       
                                       
                                          ︸
                                       
                                    
                                 
                                 
                                    appearance
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                             
                                                t
                                                -
                                                1
                                             
                                          
                                          |
                                          b
                                          )
                                       
                                       
                                          ︸
                                       
                                    
                                 
                                 
                                    geometry
                                 
                              
                              ,
                           
                        
                     where 
                        
                           c
                           =
                           p
                           (
                           b
                           )
                           p
                           
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 )
                              
                              
                                 -
                                 1
                              
                           
                        
                      is constant due to the fact that 
                        
                           p
                           (
                           b
                           )
                        
                      and 
                        
                           p
                           (
                           
                              
                                 x
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 t
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 t
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           )
                           )
                        
                      are drawn from uniform distributions. The first probability terms in (15) are computed from the appearance and geometry distribution introduced in Sections 3.1 and 3.2, respectively, and provide the likelihood of the observation to be a member of that distribution.

In order to enforce the spatial smoothness during the labeling process, the smoothness term can be formulated as [46]:
                        
                           (16)
                           
                              V
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              λ
                              (
                              1
                              -
                              δ
                              (
                              
                                 
                                    l
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    l
                                 
                                 
                                    j
                                 
                              
                              )
                              )
                              exp
                              
                                 
                                    
                                       
                                          
                                             -
                                             |
                                             |
                                             I
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             -
                                             I
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             |
                                             |
                                             
                                                
                                                   t
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             β
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           λ
                        
                      controls the effect of the smoothness term, 
                        
                           δ
                           (
                           ·
                           )
                        
                      is a Kronecker delta function. As suggested by [32], the constant 
                        
                           β
                        
                      represents the average of intensity variations in the neighborhood of each point and is defined as:
                        
                           (17)
                           
                              β
                              =
                              
                                 
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       G
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              |
                              |
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              )
                              |
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              ,
                           
                        
                     where 
                        
                           G
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           )
                        
                      is a set of neighboring pixels around 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                        
                     . The solution of the energy minimization can be efficiently computed using the graph-cut algorithm [47–49].

Let 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         be a static scene point and 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         be its image at frame 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is the appearance function at time t. In order to learn the underlying appearance distribution for 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                        , and compare an incoming observation to see whether it is drawn from this distribution, we need to know where 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         projects across images. This operation is not explicitly possible in case when the camera parameters are unknown. However, with our 2.5D formulation, the appearance of the background pixels can be modeled without explicit knowledge of which plane a point belongs to. We start with the assumption that 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         lies on all N hypothetical planes, such that at frame t, we have N different mappings 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    N
                                    -
                                    1
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         of a pixel 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         to pixels in frame 
                           
                              t
                              -
                              1
                           
                        , computed using the homography transforms 
                           
                              H
                              
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         from image 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                         to image 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         with respect to the plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                              :
                              k
                              =
                              0
                              ,
                              …
                              ,
                              N
                              -
                              1
                           
                        . Considering that our goal is to generate a scene model for moving object detection, this assumption is exercised by creating N appearance distributions 
                           
                              {
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    0
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    2
                                 
                                 
                                    t
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    N
                                    -
                                    1
                                 
                                 
                                    t
                                 
                              
                              }
                           
                         using the mapping given in (13) (see Fig. 2). An appearance distribution 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         for a pixel 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         is maintained with the assumption that 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         lies on a plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                        . In other words, by adding the new observations from incoming frames, 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         at frame t models distribution of values,
                           
                              (18)
                              
                                 {
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       3
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       3
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 }
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         is transformed with a corresponding homography transformation 
                           
                              H
                              
                                 
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              H
                              
                                 
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              H
                              
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                        .

In our implementation, we adopt the Gaussian mixture model of [2] as the distribution 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         for kth hypothetical plane, and estimate the posterior probability by:
                           
                              (19)
                              
                                 p
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 ,
                                 b
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                g
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 N
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       Σ
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 ,
                              
                           
                        where b denotes background label, 
                           
                              
                                 
                                    w
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    μ
                                 
                                 
                                    j
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Σ
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                              I
                           
                         are respectively the weight, mean and covariance of the 
                           
                              j
                           
                        th Gaussian distribution in 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        , and 
                           
                              I
                           
                         is 
                           
                              3
                              ×
                              3
                           
                         identity matrix. A pixel value 
                           
                              I
                              (
                              x
                              )
                           
                         is checked against each of the Gaussian components in 
                           
                              Ψ
                           
                         until a match is found. A pixel matches a component if its value is within 2.5 standard deviations [2]. The parameters of a distribution that matches the current pixel are updated as:
                           
                              (20)
                              
                                 μ
                                 ←
                                 (
                                 1
                                 -
                                 α
                                 )
                                 μ
                                 +
                                 α
                                 I
                                 (
                                 x
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 ←
                                 (
                                 1
                                 -
                                 α
                                 )
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       (
                                       I
                                       (
                                       x
                                       )
                                       -
                                       μ
                                       )
                                    
                                    
                                       ⊤
                                    
                                 
                                 (
                                 I
                                 (
                                 x
                                 )
                                 -
                                 μ
                                 )
                                 ,
                              
                           
                        where 
                           
                              α
                           
                         is the learning rate. The mean and covariance of the unmatched distributions remain unchanged. The weights of the distributions are updated as follows:
                           
                              (22)
                              
                                 w
                                 ←
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   α
                                                   )
                                                   w
                                                   +
                                                   α
                                                
                                                
                                                   
                                                   if
                                                   
                                                   the
                                                   
                                                   distribution
                                                   
                                                   matches
                                                   ,
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   α
                                                   )
                                                   w
                                                
                                                
                                                   
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If none of the 
                           
                              
                                 
                                    N
                                 
                                 
                                    g
                                 
                              
                           
                         distributions match 
                           
                              I
                              (
                              x
                              )
                           
                        , the distribution with lowest weight is replaced by a new distribution with 
                           
                              μ
                              =
                              I
                              (
                              x
                              )
                           
                        , low prior weight and initial high variance. As discussed in [2], the mixture model makes background appearance distribution multimodal and allows accounting for illumination changes, camera flicker, and repetitive motion.

The marginal updates performed by introducing observations to the model result in evolution of the background model as illustrated in Fig. 7
                         for the reference plane of the desk sequence. In this figure, the top of the desk and the bottom parts of all objects placed on it belong to the reference plane and are successfully modeled in the background distribution with highest weighted Gaussian component (Fig. 7, row 2). On the other hand, the other pixels that do not belong to the reference plane, e.g., the wall and the white box, are modeled with the lowest weighted Gaussian component.

For the stationary camera, since the transformations become identity matrices, the proposed background model reduces to the traditional background model with the added complexity of retaining the appearance models for each 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                        . For the moving camera case, 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         uniquely models the appearance of the scene feature 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         with respect to the hypothetical plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                         that it lies on. On the other hand, the appearance distributions for 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         with respect to the other hypothetical planes 
                           
                              
                                 
                                    π
                                 
                                 
                                    m
                                    ≠
                                    k
                                 
                              
                           
                         will model observations obtained due to wrong mappings between consecutive frames. In our model, moving objects change their positions from one frame to the next and their registration with respect to any of the hypothetical planes will cause misalignments and will not conform to learned appearance models. Fig. 6 presents the background model of the desk sequence for selected planes aligned with one of the frames. It can be noted that 
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                         represents the top of the desk and bottom parts of the objects residing on it. The top of the small box is a part of plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    17
                                 
                              
                           
                        . Plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    33
                                 
                              
                           
                         correctly models the hypothetical plane containing top of the large box and the top part of the mug. Plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    72
                                 
                              
                           
                         corresponds to the plane passing through the pen and papers on the top shelf of the paper rack.

The second probability term in (15) relates to the proposed 2.5D background model composed of multiple background distributions due to projections onto multiple planes as shown in Fig. 8
                        (a). Pixel 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           
                         can be drawn from a distribution of hypothetical planes defining the background, which will be referred to as the geometry distribution.

If a physical scene point 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         resides on a plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    m
                                 
                              
                           
                        , its projection in images will be mapped correctly with the homography 
                           
                              H
                              
                                 
                                 
                                    m
                                 
                              
                           
                        . This mapping consistently results in the same appearance observation, leading to a high value of 
                           
                              p
                              (
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                    =
                                    m
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              b
                              )
                           
                         and low values of 
                           
                              p
                              (
                              I
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                    ≠
                                    m
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              b
                              )
                           
                         in all the frames where the point 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                           
                         is not occluded by a foreground object. One can keep track of consistent mappings for the hypothetical planes by maintaining a 
                           
                              1
                              ×
                              N
                           
                         vector 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                              
                           
                         for each pixel 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                        . We start with a vector of 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    t
                                    =
                                    0
                                 
                              
                           
                         of all zeros. Then, for each k, we calculate the probability 
                           
                              p
                              (
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              b
                              )
                           
                         using (19). If the probability is sufficiently high, 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         is updated as following:
                           
                              (23)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 ←
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 x
                                 -
                                 k
                                 )
                                 ,
                              
                           
                        where 
                           
                              x
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                         and 
                           
                              
                                 
                                    K
                                 
                                 
                                    h
                                 
                              
                              (
                              x
                              )
                              =
                              exp
                              
                                 
                                    
                                       -
                                       
                                          
                                             |
                                             |
                                             x
                                             |
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         denotes a kernel function with bandwidth parameter h. Intuitively, h should decrease as N decreases, since with fewer planes we expect less confusion in plane association. Motivated by the model update in [2], the construction of 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         is finalized by an exponential update based on the existing model 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        :
                           
                              (24)
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ←
                                 (
                                 1
                                 -
                                 α
                                 )
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 +
                                 α
                                 
                                    
                                       Γ
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              α
                           
                         is the learning rate used for appearance model update in (20)–(22). The values of 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         are further normalized to be in the range 
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . With this design, the second probability term 
                           
                              p
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              |
                              b
                              )
                           
                         in (15) is proportional to 
                           
                              
                                 
                                    Γ
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              (
                              k
                              )
                           
                        . In Fig. 8(b), we plot the geometric distribution as a function of the plane index for the pixel marked in red color in part (c). It can be observed that the probability is maximum for the plane that the pixel belongs to.


                        
                           Algorithm 1
                           Background subtraction process. 
                                 
                                    
                                 
                              
                           

The steps of the proposed method are detailed in Algorithm 1. First, a set of coplanar pixels 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                           
                         is detected by robust homography estimation using RANSAC. In our experiments, we use dense optical flow [24] to establish point correspondences. For very low frame rates, point detection or tracking (for example, KLT tracking [50]) can also be used. To construct the 2.5D representation, we estimate the vanishing line and the vertical vanishing point for the selected plane using the procedure described in Section 2. With each new frame 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                        , the tracked set of points is augmented by introducing new points to the inlier set 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         which satisfy the homography transform 
                           
                              H
                              
                                 
                                 
                                    0
                                 
                                 
                                    t
                                 
                              
                           
                        , allowing gradual change of the scene content. The points in 
                           
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                                 
                                    t
                                 
                              
                           
                         are used to obtain the sets 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         for each hypothetical plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                         using (4). The corresponding points in 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         are used to estimate the homography 
                           
                              H
                              
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         for the plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                        .

Pixels 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                           
                         in a novel image are projected to each layer of the background model governed by N homography transforms as 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    0
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    N
                                    -
                                    1
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         using (13). To eliminate occasional small errors in homography estimation, we perform a local search in a small window around each pixel, selecting the position which induces the highest probability for each plane 
                           
                              
                                 
                                    π
                                 
                                 
                                    k
                                 
                              
                           
                        :
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       argmax
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                       
                                       ∈
                                       N
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       )
                                    
                                 
                                 p
                                 (
                                 I
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                 
                                 ,
                                 b
                                 )
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                         is the corrected position of 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                        , and 
                           
                              N
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              )
                           
                         is a set of pixels in the small window centered around 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           
                        . In our experiments, we use a 
                           
                              3
                              ×
                              3
                           
                         window. This formulation allows us to avoid erroneous updates of the background models, while the spatial smoothing using MRF affects the labeling output only.

The labeling likelihood is computed using (14). Some of the pixels 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                         may not have corresponding appearance distributions 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                           
                        . This usually happens because of new regions appearing on the boundaries of the image as the camera views unseen parts of the scene. For these regions, we start a new distribution 
                           
                              
                                 
                                    Ψ
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         and initialize it with 
                           
                              μ
                              =
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                           
                        , low prior weight and high initial variance values.

In order to ensure the temporal consistency of estimated probabilities, we compute the weighted average of the probabilities 
                           
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              )
                              ,
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              )
                           
                         and 
                           
                              p
                              (
                              b
                              |
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    t
                                    -
                                    2
                                 
                              
                              )
                           
                         from the last three frames [51] using:
                           
                              (26)
                              
                                 p
                                 (
                                 b
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 p
                                 (
                                 b
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       2
                                    
                                 
                                 p
                                 (
                                 b
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       3
                                    
                                 
                                 p
                                 (
                                 b
                                 |
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       t
                                       -
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           
                              (
                              
                                 
                                    g
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    g
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    g
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         denote the weights. In our implementation, we used 
                           
                              (
                              0.7
                              ,
                              0.2
                              ,
                              0.1
                              )
                           
                         as probability weights which emphasizes the current frame more than the previous frames. Note that application of the temporal consistency on probabilities may not guarantee consistency of labels. This is primarily due to the fact that MRF, which is applied after temporal consistency, suppresses small objects.

For hypothetical planes that are close to the plane which passes through camera center, the points converge to the horizon line (see Fig. 9
                        ). As a result, the induced homographies become degenerate and do not provide mappings between the frames. Therefore, when the vanishing line 
                           
                              
                                 
                                    l
                                 
                                 
                                    v
                                 
                              
                           
                         can be seen in the image, we ignore the image regions that are spatially close to 
                           
                              
                                 
                                    l
                                 
                                 
                                    v
                                 
                              
                           
                        , and assume that they belong to background. This assumption is not considered to be a drawback of the proposed algorithm since objects close to horizon are infinitesimally small.

@&#EXPERIMENTS@&#

We test the performance of the proposed approach using sequences acquired both indoors and outdoors from moving cameras. To initialize the appearance distributions 
                        
                           
                              
                                 Ψ
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 1
                              
                           
                        
                     , we assume that all pixels in the first frame belong to background and set the parameters of one of the Gaussians 
                        
                           
                              
                                 Ψ
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 1
                              
                           
                        
                      as 
                        
                           
                              
                                 μ
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 1
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 i
                              
                              
                                 1
                              
                           
                           )
                           ,
                           
                              
                                 σ
                              
                              
                                 1
                              
                              
                                 2
                              
                           
                           =
                           50
                           ,
                           
                              
                                 w
                              
                              
                                 1
                              
                           
                           =
                           1.0
                        
                      and the rest as 
                        
                           
                              
                                 w
                              
                              
                                 j
                              
                           
                           =
                           0.0
                        
                     , where 
                        
                           j
                           =
                           2
                           ,
                           …
                           ,
                           
                              
                                 N
                              
                              
                                 g
                              
                           
                        
                      and 
                        
                           k
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           N
                           -
                           1
                        
                     . We set 
                        
                           
                              
                                 N
                              
                              
                                 g
                              
                           
                           =
                           3
                        
                     , which is considered a practical minimum [53]. The learning rate for updating the distributions is set to 
                        
                           α
                           =
                           0.05
                        
                     . The cost of labeling a pixel as foreground is set to 
                        
                           
                              
                                 η
                              
                              
                                 f
                              
                           
                           =
                           -
                           ln
                           (
                           0.4
                           )
                        
                     , and 
                        
                           λ
                           =
                           5
                        
                      is used for spatial smoothing. The neighborhood 
                        
                           N
                           (
                           ·
                           )
                        
                      in (12) is a 4-neigborhood. All experiments are conducted on a PC with dual-core Intel i5 Ivy bridge 1.8GHz CPU. The proposed method is implemented using a combination of unoptimized C++ and MATLAB code, and the execution time for a 
                        
                           400
                           ×
                           700
                        
                      video frame with 1, 5, 10, 25 and 50 hypothetical planes is measured as 0.49, 2.42, 4.05, 10.81 and 21.67s, respectively. For comparison, the execution time of partial MATLAB and C++ implementations of state-of-the-art methods [34,32,30] is measured as 479.08, 124.02, and 36.99s, respectively. The reported timings for all methods do not include the optical flow estimation and graph-cut processes, which are measured to take 50.07s (MATLAB implementation [24]) and 1.54s (C++ implementation [47]) per frame, respectively.

In contrast to the stationary camera case, there is no benchmark dataset for evaluating performances of background subtraction methods for moving cameras. Due to this unavailability, some studies do not provide quantitative comparisons [37,36]. In this paper, we use a set of sequences from the Hopkins dataset [54] (people1–2) and from [52] (cars, person) which have been used by recent quantitative papers on the topic [32–35]. We additionally include five challenging sequences (bolz1, bolz2, oxley, garage, dreese, skating) that reflect a real world setting acquired with a smartphone camera. The sequences include both camera rotation and translation, multiple moving objects, and gradual changes in the scene content. To account for the cases where the camera motion is very fast, we use skating1 and football sequences [32]. In order to quantitatively judge the performance, we manually generate ground truth data by extracting the moving objects in all frames and measure the precision and recall for detected pixels versus ground truth pixels. The number of frames and short description for each sequence is presented in Table 1
                     . Note that only first half of the frames for garage sequence is annotated, due to its length. The frames are extracted at 10fps.

In order to analyze the effect of the number of hypothetical planes on detection performance, we generate the 2.5D background model with 2, 3, 4, 5, 10, 25 and 50 hypothetical planes. We also used different variations of the proposed approach (with 
                        
                           λ
                           =
                           0
                        
                      and 
                        
                           λ
                           >
                           0
                        
                     ) to give insight of how different steps change the performance. The results are shown in Table 2
                      for each variation. The first two rows in the table, for which 
                        
                           N
                           =
                           1
                        
                     , reflect the results for the baseline approach. We chose the baseline approach as the traditional background subtraction, where the consecutive frames are registered prior to background subtraction based on the ground plane. Different variations of our approach include (i) direct thresholding of the probabilities computed using (14) in Section 3.2 (or, the case where 
                        
                           λ
                           =
                           0
                        
                     ) and (ii) our complete method with 
                        
                           λ
                           =
                           5
                        
                     .

The results in Table 2 reflect that when the scene can be well approximated by a single plane (bolz1, person and football sequences), the performance of the method is very similar for different numbers of hypothetical planes as well as for the baseline. However, for the scenes with complex geometry containing multiple physical planes (bolz2, dreese and garage sequences), the proposed method significantly outperforms the baseline approach. Note that with complex scene geometry, there is a constant increase in precision with larger number of hypothetical planes. This increase is especially apparent when MRF is not employed. Fig. 10
                      illustrates intermediate results for different number of hypothetical planes prior to applying MRF. Evidently, the results become more precise as the number of hypothetical planes increase. However, with the use of MRF, in most of the cases the performance for 
                        
                           N
                           =
                           10
                        
                      and 
                        
                           N
                           =
                           25
                        
                      is very close to that of 
                        
                           N
                           =
                           50
                        
                     . Therefore, we suggest that 
                        
                           N
                           =
                           10
                        
                      is sufficient to model even complex scenes. Example qualitative results for the sequences with 
                        
                           N
                           =
                           50
                        
                      with MRF are displayed in Fig. 12.

Another parameter that affects the performance of the proposed method is 
                        
                           λ
                        
                     , which controls the spatial smoothing. Fig. 11
                     
                      presents the precision, recall and F-score values for varying 
                        
                           λ
                        
                      for cars, skating1, football, people1 and people2 sequences. A similar trend is observed for the rest of the sequences. As expected, as 
                        
                           λ
                        
                      increases, the precision increases and recall decreases (note that there may be slight increase in recall for the small values of 
                        
                           λ
                        
                     , as the foreground may be filled in as a result of spatial smoothing). In our experiments, we set 
                        
                           λ
                           =
                           5
                        
                     , which results in relatively high precision without sacrificing recall. After MRF, we remove very small regions (less than 100pixels), which further increases precision values (as a result, the values reported in Table 2 and Fig. 14 can differ from the ones in Fig. 11 for 
                        
                           λ
                           =
                           5
                        
                     ).

We also compare the proposed method with the methods introduced in [34,32,30], as well as a simple motion segmentation approach with the epipolar constraint, which is a segmentation based on fundamental matrix estimated with RANSAC. For fair comparison, our implementation of [34] is based on dense optical flow estimation instead of using particle video approach introduced in [52]. The qualitative and quantitative results are presented in Figs. 13 and 14
                     
                     , respectively. In most of the cases, the proposed approach outperforms other methods. We observe that [34] is susceptible to the noise in trajectories around the moving objects and incomplete trajectories around image boundaries. This method often results in inconsistent detections due to the lack of appearance models and temporal constraints. The approach introduced in [32] employs fundamental matrix to infer camera and object motion, which further guides the propagation of the corresponding appearance models. As a result, their models become corrupted when the fundamental matrix estimation is unsuccessful for a few consecutive frames. We also observed that this method is highly dependent on the correct background/foreground initialization in the first frame. Note that authors of [32] also report that small objects are generally difficult to detect by their algorithm, which explains the low recall values for the dreese and bolz2 sequences. The method introduced in [30] relies on cascaded homography estimations to detect multiple planes in the scene, and transforms the background model accordingly. The authors suggest to stop the algorithm when the remaining feature points used for homography estimation are fewer than 16. We notice that, unless the moving object is very small, it usually contains more than 16 interest points. With this formulation, a homography transform is estimated for the foreground as well, and it inevitably becomes part of background due to the nature of the mixture of Gaussians model, resulting in very low recall values. Instead of using 16 points as a threshold, we use 10% of total number of points. While it allows the detection of the moving objects, it also prevents the algorithm from learning a homography transform for small planes. Also note that, this method is still susceptible to large moving objects (for example, person sequence).

On the other hand, as it is typical in background subtraction papers, our method may fail to detect moving objects for a number of frames (depending on the speed of the object and camera) when the video first starts with a moving object in the field of view. An example of this issue can be observed in the person sequence shown in Fig. 12. Another limitation in our current implementation is that the unseen region, which is revealed as the camera moves, is introduced as part of the background to the model. This initialization results in labeling a first-time seen object on the boundary of the image as part of the background. Once the object moves, however, our algorithm detects it correctly as the foreground region. An example of this limitation is illustrated for the bolz2 sequence in Fig. 12. While our approach uses a mixture of Gaussians [2], dynamic background regions may also be labeled as foreground. For this reason, the reflections, shadows and strong illumination changes are also labeled as foreground (see sequence bolz1, where the shadow is detected and garage, where the reflections are detected, in Fig. 12).

This paper introduces a 2.5D background model for detecting moving regions for moving cameras. The proposed approach introduces two distributions: one for modeling the appearance found in many background subtraction methods, and the other for modeling the geometry of the scene. The geometric model depends on the 2.5D representation which is generated from a stack of hypothetical 3D planes slicing the 3D scene and induce a set of homography transformations between the images. The pixels projected from 3D points lying on these planes consistently map across consecutive frames. This mapping provides distributions which are later used to classify pixels as background or foreground based on their deviation from the model. Experiments on a set of images show that the proposed algorithm can successfully detect moving objects in complex scenes and with significant camera motion when compared to recent literature.

The proposed approach can be further improved by maintaining a foreground model for each pixel and developing a suitable transformation model for frame-to-frame foreground model propagation. The foreground model can be further improved by preprocessing images for shadow removal as stated in [55,56]. In addition, motion clues can be used to decide whether new regions appearing in images due to camera motion belong to the foreground.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2014.06.007.


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

