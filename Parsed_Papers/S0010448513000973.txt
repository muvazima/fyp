@&#MAIN-TITLE@&#Generalizing the advancing front method to composite surfaces in the context of meshing constraints topology

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new automatic mesh generation algorithm over composite geometry.


                        
                        
                           
                           An extension of the advancing front method.


                        
                        
                           
                           Applied in the context of meshing constraints topology (virtual topology).


                        
                        
                           
                           Allows the automatic simplification (defeaturing) of CAD models.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Advancing front

Mesh generation

Mesh adaptation

Composite geometry

Virtual topology

Defeaturing

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Progress towards a better integration between finite element analysis (FEA) and computer aided design (CAD) has greatly reduced the median time requirements to prepare FEA models  [1]. One of the key steps in the integration between CAD and FEA is automatic surface meshing, because, in most approaches, filling the FEA domain with volume elements (tetrahedrons or hexahedrons) is based on a previous discretization of the domain’s boundary and because the quality of this discretization has a major effect on the quality of the resulting three-dimensional (3D) mesh with volume elements and on the reliability of the FEA solution. Surface meshing  [2–10] has been investigated by many researchers for the last 20 years. It can basically be performed either on a collection of trimmed parametric patches (like when meshing the faces of a B-Rep model) or on a tessellated representation of geometry (an STL file for example), and it can either be directly generated on surfaces in three dimensions or indirectly generated in the parametric space and then mapped in three dimensions  [11]. However, the automatic generation of surface meshes from CAD models and consequently the way the integration between FEA and CAD still faces several problems, especially when these CAD models feature many small shape details, and when their boundary representation (B-Rep) contains a large number of faces, many of them being eventually much smaller than the desired FE size. Such configurations are likely to be at the origin of either poorly shaped elements and/or over-densified elements, not only increasing the analysis time, but also producing poor simulation results or meshes incompatible with solver requirements. Applying geometry simplification and virtual topology techniques to these configurations has proven to be a very interesting option.

Efforts have been made, aimed at avoiding poorly shaped elements and over-densified mesh elements generated from raw CAD models  [12–16]. In these approaches, well-known mesh topological transformations perform mesh element removal (e.g. decimation of surface meshes) or collapsing faces of tetrahedrons to remove these tetrahedrons. These transformations can be applied on the mesh itself or on a discrete representation of geometry, as proposed in  [17]. One limitation of these operators lies in the fact that collapsing operations are not intrinsically suited for the removal of through holes, which means that these operators require complex extensions when applied to real-life industrial parts. Therefore, removing holes may require specific processing such as manually removing these details in the CAD model. Element distortion (poorly shaped elements) and over-densified mesh elements are also closely related to the input mesh sizing objectives. Setting up appropriate mesh sizing objectives  [18–20] can actually contribute to lowering the element distortion and to avoiding over-densified mesh elements.

Other approaches consist of adapting CAD models directly. For example, feature recognition and extraction processes can be intended to simplify details like fillets and blends  [21,22], bosses, pockets  [23], and holes. Some of these approaches generate tree-structured simplified models, in which each simplification is identified as a feature. Lee et al.  [24] propose a feature removal technique which starts from a feature tree and provides the ability to suppress, and subsequently reinstate features, independently from the order in which they were suppressed, within defined limitations. Another alternative is applying geometry transformation with the use of CAD kernel operators aimed at locally modifying the topology and/or underlying geometry in the B-Rep model [22,23,25]. Overall, these approaches manage a restricted set of feature types, and interactions between features remains a major issue. Moreover, even recognized features are often difficult to suppress, which makes these approaches non-robust and very restrictive when used alone. Nevertheless, these approaches are efficient when used to remove holes and bosses prior to mesh simplification. A very good survey of simplification techniques can be found in  [26].

However, feature suppression does not guarantee that the object’s boundary decomposition can be directly used for automatic mesh generation purposes. In this context, virtual topology techniques (also referred to as virtual geometry in some papers) can be applied afterwards with the objective of adapting the boundary decomposition to the requirements of automatic mesh generation. Virtual topology approaches proposed by Sheffer et al. [27,28], Inoue et al.  [29], Wei  [30], and Tautges  [31] are aimed at the edition of the B-Rep definition of a CAD model to produce a new topology, which is more suited to mesh generation constraints and which contributes to avoid poorly shaped and over-densified mesh elements. These approaches implement split and merge operators aimed at clustering adjacent faces into nearly planar regions in order to generate a new B-Rep topology, which is better suited to mesh generation, while preserving its geometry. However, face clustering algorithms show limitations in the context of FE model preparation: they do not support the definition of edges and vertices interior to faces, while these non-manifold surface configurations are required for various needs (modeling boundary conditions, taking into account specific features and sharp curves lying inside faces).

Towards the objective of overcoming the limitations of virtual topology, we introduced meshing constraints topology (MCT) concepts  [32] in a previous work. One of the basic and most important features of MCT is that it enables non-manifold surface transformations: edge deletion, vertex deletion, edge splitting, edge to vertex collapsing, vertices merging. Starting from a given B-Rep model to be meshed, generating the MCT is based on a local analysis of B-Rep faces and edges with regard to mesh generation constraints (local face width, normal vector deviation across edges, etc.). An interesting feature of the MCT is that it enables the definition of interior edges and vertices on B-Rep faces when required. As described in more detail in the following sections, MCT models are basically defined using composite geometry. For instance, a composite face (referred to in our work as an MC face) is defined as a set of adjacent faces in the input B-Rep structure, each of which associated with an underlying surface and its parametric definition. Consequently, meshing models that have been processed with MCT concepts require the ability of automatically generating finite elements across composite geometry (typically composite edges and faces). At present, mesh generation techniques aimed at handling composite surfaces are based on the following two main approaches.

The first approach is computing a global parameterization [33,34]: this basically consists of defining a bijective mapping between any point inside sets of surface patches and a global parametric domain. The bijective transformations proposed in [33,34]are both based on a cellular decomposition of each reference (non-composite) surface mapped into the global parametric space. Each cell is associated with a specific mapping to a reference surface image, and with a global parametric space image. Any point of a cell in the global parametric space is represented using its barycentric coordinates, and projected in the equivalent cell of the corresponding reference surface using the same barycentric coordinates. This new parameterization enables a natural and transparent use of parametric meshing schemes. Unfortunately, this type of approach is limited, for the following reasons.


                     
                        
                           •
                           It is restricted to open and non-periodic surfaces: this method can only be applied to open surfaces (homeomorphic to a disc), and not to periodic surfaces and closed surfaces homeomorphic to an 
                                 n
                              -torus.

It is restricted to smooth and nearly planar domains: the parametric domain of distorted surfaces may cause high variations in the global parameterization metrics due to the surface embedding, and often results either in failures during mesh generation or highly distorted meshes  [33].

Identifying the outer loops of composite faces is not automatic.

The second approach consists of using direct 3D advancing front techniques on a tessellated (triangulated) model of composite surfaces  [10]. This type of approach also shows significant limitations, for the following reasons.


                     
                        
                           •
                           Deviation of the final triangulation from the input model depends on the tessellation’s accuracy.

More sophisticated discrete representations such as subdivision surfaces and higher-order triangulations allow curved mesh generation but still generate approximation errors.

In order to overcome these limitations, this paper introduces a new approach to automatic mesh generation over composite surfaces, which is based on an adaptation of the advancing front method (AFM) over curved surfaces  [5,8,10,35–38]. The AFM [5,7,8,10,35–41] is a very common automatic mesh generation technique, and the main features of its adaptation to the context of composite surfaces are as follows.


                     
                        
                           •
                           Elements need to be generated across multiple parametric surfaces: advancing front propagation thus needs to be adapted through the extension to composite surfaces of propagation direction, propagation length, and target point calculations,

Every mesh entity is associated with its image in each component (reference entity) of the composite surface,

Intersection tests between 3D segments are performed in the parametric domain of their images.


                     
                        
                           •
                           Section  2 presents the context of adapting CAD models for FEA and introduces meshing constraints topology (MCT), which is one of the key inputs of the mesh generation process presented in this paper.

Section  3 briefly reviews the main steps involved in the advancing front method (AFM) applied to automatic mesh generation over parametric surfaces.

Section  4 presents the extension (data-structures and algorithms) of the AFM, in the context of mesh generation over composite geometry, which is the core of this paper.

Section  5 illustrates the potential and efficiency of the method proposed through the presentation of mesh quality improvements obtained on several practical examples.

The general context of the present work is performing, as efficiently and quickly as possible, an FEA from the input of a detailed CAD model. This detailed CAD model is intended for product definition purposes and not for FEA purposes, which implies that modifications and simplifications are likely to be applied on this model before FEA. Also, prior to FEA itself, the analyst must specify mechanical hypotheses and boundary conditions on the CAD model (i.e. materials, loads, and restraints). The analyst also needs to specify an objective with regard to the desired analysis accuracy. In a priori adaptive meshing, based on his/her FEA skills and experience, the analyst specifies an FE size map that is adapted to both the geometry and the FEA objective. This size map can either be rough (to quickly obtain an approximate solution) or be featuring a certain degree of adaptive refinement (to obtain accurate results in zones of interest). This FE size map is a central issue in our automatic feature removal and topology adaptation processes because it represents the analyst’s intent with regard to the size of shape features that can be neglected for analysis purposes. This size map is likely to vary significantly throughout the analysis domain, depending on where the zones of interest are located, and it is consistent with the specification of a clear analysis objective. The automatic feature removal and topology adaptation processes are strongly driven by this FE size map.

In the specific case where the input CAD model is part of a larger assembly, the size map has to respect a smooth transition at mating faces in contact with mating components, in order to limit the mesh element size gradient during the transition. In this case, the 3D domain in which the size map is defined should enclose the whole assembly, and the same size map should be used for the mesh generation of each component in order to generate conformal meshes at mating faces.

Trying to generate a mesh with large elements on a CAD model featuring rather small entities, i.e. an over-detailed model, leads to non-convergence or to the generation of sliver (very flat) elements. Automatically meshing CAD models is typically performed through three steps, which are is closely related to the B-Rep structure’s hierarchy. First, the edges are discretized with sets of mesh segments, whose lengths are consistent with the FE size map. Then, a triangulation algorithm fills the interior of each B-Rep face with triangles; the triangulation is constrained by the prior discretization of the edge mesh and is also consistent with the FE size map required. Processing the entire B-Rep of a given part results in a closed triangulation of its boundary. The last step consists of using a tetrahedrization algorithm to fill the closed triangulation with tetrahedrons, consistently with the FE size map as for the discretization of edges and faces. Consequently, due to the fact that standard meshing procedures are constrained by the B-Rep topology (the mesh is constrained by all B-Rep edges) when trying to mesh an over-detailed CAD model, it results in the following mesh inconsistencies. 
                           
                              •
                              Mesh over-densities: e.g. small triangles are propagated from tiny segments generated on tiny edges of the B-Rep (see Fig. 1
                                 ).

Poorly shaped elements: e.g. sliver triangles are originated from small segments and narrow faces (see Fig. 1).

We present a fully automated adaptation process, which is intended to improve the efficiency and speed of preparing CAD models for FEA. The automatic simplification criteria used are based on the imposed size map and the process takes place through the following three steps.
                           
                              •
                              
                                 Step  1—Feature removal: CAD design features (holes, fillets, pockets, and protrusions) that are too small (with respect to the imposed size map) to affect analysis results in zones of interest are automatically identified as shape details (see Fig. 2
                                 (b)). Two types of operation are used to remove these details automatically.
                                    
                                       (a)
                                       Suppressing features directly in the CAD feature tree: this applies for details that have been designed as features, and for which suppression does not affect any other feature.

Using delete-face type operators: this type of operator performs the elimination of selected faces and the reconstruction of a closed solid envelope by filling holes  [23,24].


                                 Step  2—MCT adaptation: the B-Rep topology obtained after feature removal usually requires additional preparation for mesh generation. Indeed, small edges and narrow faces must be transformed to avoid over-constraining mesh generation, as mentioned above. MCT operators and criteria based on adjacency hypergraphs  [32,42] have been designed for the automatic adaptation of B-Rep topology (see Fig. 2(c)). 
                                    
                                       ∘
                                       MCT criteria, based on the size map and taking into account zones where boundary conditions are applied, automatically identify which MCT operations are required from the following. 
                                             
                                                –
                                                Removing irrelevant edges (located in narrow faces or planar surfaces) using edge deletion.

Removing irrelevant vertices (located on small edges or smooth curves) using vertex deletion or edge contraction.

Collapsing constricted sections of faces by merging vertices.

MCT operators are then automatically applied by editing the MCT topology hypergraphs and their underlying geometry  [32]: edge and vertex deletion, edge splitting, edge to vertex collapsing.


                                 Step  3—Meshing the MCT model: a mesh is automatically generated from the MCT model (see Fig. 2(d)) using the AFM. The AFM is first initialized by discretizing MC edges (which are composite edges). Then the mesh is propagated inside MC faces (composite faces). The detailed description of this automatic mesh generation process is the core of this paper.

As introduced in the previous paragraph, MCT adaptation basically consists in adapting the B-Rep topology to the requirements of mesh generation. Thus, MCT (see Ref. [32] for a detailed description) basically appears as an enhanced B-Rep structure, featuring MC entities, which are fundamentally composite entities. As for classical B-Rep structures, an MCT model includes a full description of the entities orientation and topological links, as shown in Fig. 3
                        .

In the MCT, topological links between 
                           i
                        -manifold MC entities and 
                           j
                        -manifold MC entities (
                           i
                           ∈
                           
                              [
                              1
                              ,
                              2
                              ]
                           
                         and 
                           j
                           <
                           i
                        ) are represented by adjacency hypergraphs referenced as G.i.j.


                        
                           
                              •
                              
                                 G.2.1 is the face-edge adjacency hypergraph where: 
                                    
                                       •
                                       each node represents an MC face

each arc is an MC edge connecting a set of MC faces;


                                 G.2.0 is the face-vertex adjacency hypergraph where: 
                                    
                                       •
                                       each node represents an MC face

each arc is an MC vertex connecting a set of MC faces;


                                 G.1.0 is the edge-vertex adjacency hypergraph where: 
                                    
                                       •
                                       each node represents an MC edge

each arc is an MC vertex connecting a set of MC edges.


                        
                           Definitions
                           The reference model  is the B-Rep model obtained after performing the first step of the process presented above (after feature removal and prior to topology adaptation).


                              Reference entities  (namely reference face, reference edge, reference vertex) are topological entities of the reference model. Their underlying geometry is represented through a single mathematical definition.


                              
                                 
                                    •
                                    The surface underlying a reference face is a Riemannian surface, i.e. a plane, a sphere, a torus, a NURBS, etc.

The curve underlying a reference edge is a Riemannian curve, i.e. a line, a circle, an ellipse, a NURBS, etc.

The composite surface underlying an MC face is defined as the union of its reference faces.

The composite curve underlying an MC edge is defined as the union of its reference edges.

The point underlying an MC vertex is simply a point coinciding with an underlying reference vertex.

Thus, unlike usual B-Rep curves and surfaces, composite curves and composite surfaces can feature tangency and curvature discontinuities. Fig. 4
                         illustrates an MC edge composed of a set of two adjacent reference edges. It is worth noting that MC edges and MC vertices can be located on the interior of an MC face (see Fig. 5
                        ).

This section briefly reviews the main steps involved in the AFM when applied to mesh generation over parametric surfaces (see Ref.  [5]). Section  4 will present the adaptation of this classical scheme in the context of mesh generation over composite surfaces.

Meshing a B-Rep model with the classical AFM scheme is achieved through four main steps. These steps are closely related to the B-Rep structure. First, nodes are generated on the vertices of the B-Rep structure, which is followed by the discretization of B-Rep edges (second step). The third step consists of extracting, from the former results and for each B-Rep face, the discretization of its bounding loops. This initiates the application of the AFM to the triangulation of B-Rep faces, which finally leads to a closed triangulation of the CAD model’s boundary. The tetrahedrization scheme (fourth step) completes the process and, at the end, this closed triangulation is totally filled with tetrahedrons.

When the B-Rep is triangulated, each B-Rep face is triangulated independently by propagating triangles from the discretization of its bounding loops. For a given face, the triangulation stops when the face is completely filled with triangles. For each face, this triangulation process starts with an initial front that is composed with segments issued from the discretization of the face’s bounding loops. Along the whole process, each front segment is oriented and defined by two nodes (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                      for the 
                        i
                     th segment). Starting from the initial front, a recursive process is applied for which, at each step, one triangle (two in some cases) is propagated from one (or two) of the current front segments 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                      (usually the smallest front segment), which is followed by updating the advancing front consistently with the generation of one (or two) new triangle(s). At each step, the local front configuration for candidate front segment 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                      is analyzed with respect to six possible configurations (as illustrated in Fig. 6
                     ). Then, one of six operators is applied, consistently with the local configuration. The first five local configurations and associated operators only use existing nodes, while a new node is likely to be created when using the sixth operator. The first operator applies when the front is reduced to three segments (see configuration #1 in Fig. 6). In this case, a triangle is simply generated from these three segments. Similarly, when the front is reduced to a cavity bounded by four segments (see configuration #2 in Fig. 6), two triangles are generated by creating a diagonal segment. The alternative generating two triangles with the highest quality is chosen (out of two possible diagonals). For configurations #3 to #6, angles 
                        
                           
                              α
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              α
                           
                           
                              2
                           
                        
                      between 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                      and its previous (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              −
                              1
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                     ) and next (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              2
                           
                        
                     ) front neighbors are considered. The criterion used is that a cavity in the front has to be filled with triangles if a segment features an angle that is smaller than 80°with one of its neighbors (see configurations #3 to #5 in Fig. 6). For configuration #3, the alternative (out of two possible diagonals) resulting in the highest triangle quality is also chosen.

The last configuration corresponds to the case where a new node (referred to as a candidate node) needs to be considered, and eventually created, from candidate segment 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                     . The optimal position 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      for this candidate node is defined as follows: starting from 
                        
                           
                              
                                 P
                              
                           
                           
                              M
                           
                        
                     , the middle of 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                     , 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      is located so that segment 
                        
                           
                              
                                 P
                              
                           
                           
                              M
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      is perpendicular to 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                      and the curvilinear distance 
                        d
                      from 
                        
                           
                              
                                 P
                              
                           
                           
                              M
                           
                        
                      to 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      is 
                        
                           
                              d
                              =
                              
                                 
                                    3
                                 
                              
                              /
                              2
                              ⋅
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 ⋅
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       S
                                    
                                 
                                 ⋅
                                 
                                    ‖
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ‖
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        
                           
                              w
                           
                           
                              T
                           
                        
                      and 
                        
                           
                              w
                           
                           
                              S
                           
                        
                      are two weights, with 
                        
                           
                              w
                           
                           
                              T
                           
                        
                        +
                        
                           
                              w
                           
                           
                              S
                           
                        
                        =
                        1
                     .


                     
                        H
                        
                           (
                           
                              P
                           
                           )
                        
                      represents the target size (the FE size map) at location 
                        
                           
                              
                                 P
                              
                           
                           
                              M
                           
                        
                     .

Thus, 
                        d
                      reflects a compromise made between element shape and element size requirements which can be contradictory (see Fig. 7
                     ). 
                        
                           
                              w
                           
                           
                              T
                           
                        
                      controls respecting the size map while 
                        
                           
                              w
                           
                           
                              S
                           
                        
                      controls generating elements with a good aspect ratio (the optimal aspect ratio being for an equilateral triangle where 
                        d
                        =
                        
                           
                              3
                           
                        
                        /
                        2
                        ⋅
                        
                           ‖
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           ‖
                        
                     ). Past experience has shown that 
                        
                           (
                           
                              
                                 w
                              
                              
                                 T
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 S
                              
                           
                           )
                        
                        =
                        
                           (
                           0.65
                           ,
                           0.35
                           )
                        
                      is a good practical compromise between these two requirements.

In the case where an existing node 
                        
                           
                              
                                 P
                              
                           
                           
                              F
                           
                        
                      is close enough to 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      (see Fig. 8
                     ), then the triangle (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              F
                           
                        
                     ) is generated instead of (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              +
                              1
                           
                        
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                     ). When several existing nodes are found around 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                     , 
                        
                           
                              
                                 P
                              
                           
                           
                              F
                           
                        
                      is chosen as the closest point to 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                     . The details about the way the vicinity between 
                        
                           
                              
                                 P
                              
                           
                           
                              F
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                           
                           
                              
                                 opt
                              
                           
                        
                      is computed can be found in  [43].

Collision detection tests, before validating each triangle creation, are required to avoid overlapping triangles. The front is updated at each step, and the whole process stops when the front is empty.

The main challenge in extending the AFM to MCT models is that the geometric definition of MCT components is composite (composite surfaces and composite curves). Consequently, it requires an extension of the AFM principles to composite geometry, which means being able to discretize composite curves and triangulating composite surfaces. The most challenging part of this adaptation is extending the AFM to triangulating composite surfaces. The main problems to overcome are related to the fact that each mesh segment and mesh triangle generated through the AFM progression on composite geometry is likely to lie on multiple B-Rep faces and consequently, it is likely to be associated with a composite definition across multiple parametric spaces. Collision tests between new front segments and existing mesh elements also require specific and significant adaptations of the AFM, since a given front segment is also likely to lie on multiple B-Rep faces.

In this work, the basic principles applied for this extension are as follows.


                     
                        
                           •
                           The triangulation process is performed over composite surfaces using the same overall AFM scheme as in the case of non-composite surfaces  [5,8,10,35–38]. This scheme notably allows handling non-manifold boundaries, which is an important requirement because, as mentioned previously, MCT naturally generates such configurations.

Triangles are directly generated over multiple parametric definitions of reference surfaces underlying composite surfaces. This allows avoiding the problems and limitations of using a global parameterization of composite surfaces.

The extension of the AFM to the triangulation of composite surfaces raises the following major problems.


                     
                        
                           •
                           
                              The association of mesh elements with multiple reference entities. Our extension aims at generating mesh elements over composite curves and surfaces. In this extension, most algorithms (front propagation, intersection tests, shortest path estimation, and tangent vector evaluation) require computing and handling images of mesh elements in the parametric domain (for faces and edges) of the underlying reference entities of the MCT. This information about images of mesh elements in the parametric domain of reference entities should be easily accessible from mesh data-structures.


                              The creation of explicit B-Rep data-structure featuring explicit co-edges and loops. The front initialization, which is inherent to the AFM, relies on loops and co-edges of the B-Rep data-structure. Co-edges must be sorted in loops to avoid self-overlapping problems, which is required to enable the front’s propagation initialization (from loops).


                              Front initialization. The front has to be initialized from the MCT, which is made of composite surfaces, curves, and vertices where adjacency links are described in the B-Rep data-structure. This initialization consists of two steps: composite curve discretization, and front ordering based on the orientation of co-edges and loops.


                              Normal vector evaluation at the location of first-order discontinuities. The evaluation of normal and tangent vectors is mathematically undetermined on curves and surfaces at the location of first-order discontinuities (corners and sharp edges). Pseudo-normal vectors need to be defined and computed at these locations because the AFM requires such vectors to set the front propagation direction.


                              Front propagation. Front propagation and element generation have to be processed on multiple bi-parametric surfaces (see Fig. 9
                              ).


                              Shortest path estimation on composite surfaces. Sharp edges or small details can be located inside the composite surface, and this induces important tangency discontinuities across which triangles must be generated. These surface discontinuities make it impossible to approximate curvilinear distance with Euclidean distance (see Fig. 10
                              (a)). As a result, neighboring mesh elements have to be searched by considering the curvilinear distance (in the context of multiple parametric surfaces as illustrated in Fig. 10(c)) between nodes instead of the Euclidean distance (see Fig. 10(b)). This curvilinear distance has to be estimated using a shortest path (over multiple parametric surfaces) search algorithm (see Section  4.5.2).

The following sections of the paper present how these problems can be solved. We start with the presentation of mesh generation data-structures and algorithms supporting the extension of AFM concepts to the context of composite geometry.

A crucial point when trying to generalize the AFM to composite surfaces, in the context of using MC topology, is the transformation of MCT adjacency hypergraphs into a coherent B-Rep data structure (referred to as a winged-edge structure). (See Fig. 11
                        .) 
                           
                              •
                              Any MC edge has to be associated to two partner co-edges 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                  and 
                                    
                                       
                                          C
                                       
                                       
                                          2
                                       
                                    
                                  whose orientation should be opposite  [32].

Any MC face is associated with loops which are composed of co-edges, and these loops underlie the front initialization in the AFM. These MC face loops must be built with the objective of avoiding front overlaps during the front propagation process.

Methods for the creation of partner co-edges of MC edges and loops of MC faces are proposed in Sections  4.1.1 and 4.1.2.

In the definition of a B-Rep structure, co-edges are addressing the orientation of loops surrounding B-Rep faces. Co-edges associated with a given loop of a given face are oriented so that, at a given location along the face’s boundary, the cross product of a co-edge tangent vector and the face normal vector is directed towards the interior of this face, which means towards the front propagation direction (see Fig. 12
                           (a)). In MC topology, the interior domain of an MC face is defined explicitly by reference faces being grouped into a single composite surface. Therefore, the following hold.


                           
                              
                                 •
                                 The interior domain of an MC face equals the interior domain of its underlying reference faces.

The orientation of co-edges defining the orientation of an MC face is the same as those of co-edges addressing the reference faces of this MC face (see Fig. 12(b) and Fig. 12(c)).

Let 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            be an MC edge and 
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                            an MC face adjacent to 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ,
                              ∀
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              ∈
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              ∀
                              
                                 
                                    F
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                           :


                           
                              
                                 
                                    O
                                    r
                                    i
                                    e
                                    n
                                    t
                                    a
                                    t
                                    i
                                    o
                                    n
                                    
                                       (
                                       
                                          
                                             E
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    O
                                    r
                                    i
                                    e
                                    n
                                    t
                                    a
                                    t
                                    i
                                    o
                                    n
                                    
                                       (
                                       
                                          
                                             E
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             F
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

The boundary of an MC face is defined as non-manifold when one MC vertex is connected to more than two MC edges, these MC edges being adjacent to this MC face. This configuration is not specific to MCT, as can be seen in classical B-Rep structures, as shown in Fig. 13
                           .

The AFM requires that the geodesic propagation of fronts, initiated on the loops of an MC face, over the underlying composite surface fills the interior domain completely, without front overlaps. Loops are sorted list of co-edges such as the 
                              
                                 (
                                 i
                                 +
                                 1
                                 )
                              
                           th co-edge starts at the 
                              i
                           th co-edge’s end. In order to avoid front overlaps caused by non-manifold configurations such as the one illustrated in see Fig. 13, the sequence of co-edges along a given loop of an MC face is chosen using considerations about the interior angle between two consecutive co-edges (between two alternatives, the one inducing the minimal interior angle is chosen).

The theoretical definition of interior angles is geodesic: considering an arc of geodesic circle starting from the 
                              i
                           th co-edge and ending on the 
                              i
                              +
                              1
                           th co-edge, the interior angle is defined as the curvilinear length of arc 
                              s
                            divided by its geodesic radius 
                              r
                           . Practically, interior angles are calculated from a tessellation of the MCT, where MC faces are approximated by sets of triangles and MC edges by sets of segments. The interior angle between two co-edges 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                            is computed by summing interior angles of triangles chained between these co-edges and adjacent to their common vertex 
                              v
                            (see Fig. 14
                           ). This tessellation of the MCT is derived from a tessellation of the reference B-Rep topology, which is available in any CAD kernel. The tessellation of the MCT is updated after any MC operation during MCT adaptation: for instance, merging two composite surfaces or curves is followed by merging their discretizations, and splitting a composite curve is followed by inserting a node in its discretization. The tolerance of this tessellation is set to 1/50th of the minimum value in the FE size map. This ensures that the accuracy of geometry definition is much better than the accuracy of the expected FE mesh.


                           
                              Convention
                              
                                 
                                    
                                       N
                                    
                                    
                                       (
                                       
                                          P
                                       
                                       )
                                    
                                  
                                 represents the normal vector to a surface at location 
                                 
                                    
                                       P
                                    
                                 
                                 , where 
                                 
                                    
                                       P
                                    
                                  
                                 can be an Euclidean point or a parametric coordinate.
                              

As introduced in the previous sections, the triangulation of MC faces is preceded by the discretization of MC edges. This discretization of MC edges in mesh segments sets up data required for initializing the advancing front when triangulating MC faces. This discretization of MC edges and consequently, this initialization of the advancing front respects the following properties.


                           
                              
                                 1.
                                 The front is composed of segments generated through MC edge discretization, and these segments are oriented with respect to the orientation of all co-edges surrounding the MC face. Thus, each front segment is oriented (the orientation of vector 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    ) consistently with the advancing front direction, defined as 
                                       
                                          
                                             
                                                V
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          N
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                       ∧
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     (see Fig. 15
                                    (a) and (b)). As illustrated in Fig. 15(b), 
                                       
                                          N
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                     is the normal vector at location 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             M
                                          
                                       
                                    . A detailed definition of normal vectors is given at Section  4.3.

Each front segment 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     only features two neighbors (the previous and next segments). Consequently, the advancing front is composed of one or more closed segment loops that are consistent with the loops of MC faces (see Fig. 15(c)).

There is no intersection between two segment loops of the front.


                           
                              Convention
                              
                                 Variable t designates the curve parameter associated with a reference geometry (
                                 
                                    t
                                  
                                 is dependent on the curve’s intrinsic mathematical formulation), while variable 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                  
                                 designates the curve parameter associated with a composite geometry (
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                  
                                 equals the curvilinear length along the composite curve).
                              

The generation of the initial front segments is processed as follows. A set of nodes is first generated on MC vertices and then nodes are generated along MC edges. Given the parametric function of a composite curve 
                              
                                 PolyC
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            and the size map function 
                              H
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           , the method presented in  [32] generates an optimal parametric coordinate for each node 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                           : 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            with 
                              i
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              
                                 
                                    N
                                 
                                 
                                    s
                                    e
                                    g
                                 
                              
                           , and 
                              
                                 
                                    N
                                 
                                 
                                    s
                                    e
                                    g
                                 
                              
                            being the number of segments of the MC edge discretization. When all node parameters 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            are defined, the composite curve’s mapping function provides, for any 
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                           , the corresponding reference edge 
                              E
                            and the parametric coordinate 
                              t
                            (along this specific reference edge), written as 
                              
                                 
                                    
                                       (
                                       E
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             PolyC
                                          
                                       
                                       
                                          
                                             Ref
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            As shown in Fig. 16
                           , each segment is associated with an image curve, which consists of a sequence of subsegments, each of which representing the image of the mesh segment along a reference edge and on its two adjacent faces.

As mentioned previously, MCT transformations naturally generate non-manifold boundary topologies. Fig. 17
                            illustrates two such specific non-manifold configurations, one corresponding to an MC edge or a group of MC edges that are isolated on an MC face, and the other corresponding to an MC vertex that is isolated on an MC face. In the first case, the initial front segments associated with isolated MC edges are doubled (with inverse orientations) so that a closed loop of front segments allows it to progress in both inverse directions (for example at location 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                            in Fig. 17). In the case of an isolated MC vertex, an additional front segment is automatically generated from the isolated vertex and, like in the case of isolated MC edges, it is doubled so that the front is able to progress in both directions. This specific front segment is generated arbitrarily except that it should not cross any other front segment and not be located too close to an existing front node (see Fig. 18
                           ).

A case involving an isolated MC vertex is presented in Fig. 18(a), and in Fig. 18(b) the arbitrary front segment mentioned above is generated in such a way that the front node 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    c
                                 
                              
                            is too close to other front segments. As illustrated in Fig. 18(b), a search zone is used around the candidate front segment 
                              
                                 
                                    
                                       MP
                                    
                                 
                                 
                                    c
                                 
                              
                           , and, if an existing front node is found in this zone, it is used instead of 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    c
                                 
                              
                           . In this case (see Fig. 18(c)), the advancing front is updated as [
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                           ], [
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 M
                              
                           ], [
                              
                                 
                                    
                                       MP
                                    
                                 
                                 
                                    i
                                 
                              
                           ], [
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           ], etc.

As mentioned in the previous section, the evaluation of normal vectors is crucial to compute the advancing front propagation direction when triangulating MC faces. 
                           
                              •
                              The front configurations 1–5 are validated if the directions of the normal vectors of candidate triangles generated are consistent with that of normal vector at midpoint 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          M
                                       
                                    
                                  (see Fig. 19
                                 (a)).

The front configuration 6 intends to create the optimal point 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          
                                             opt
                                          
                                       
                                    
                                  by advancing towards a direction based on the composite surface’s normal (see Fig. 19(b)).

In the context of composite surfaces, some of the normal vectors have to be evaluated at locations where the geometry is non-differentiable (sharp edges and corners featuring 
                           
                              
                                 C
                              
                              
                                 0
                              
                           
                         continuity), as well as at locations where the domain is at least 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuous (in curved regions). Like in the case of smooth rendering methods, the weighted average of normal vectors at adjacent faces smoothes the surface at points located on sharp edges and vertices of a composite surface. In this work, the weights used for the computation of the weighted average of normal vectors at the location of a sharp vertex are normalized interior angles 
                           
                              
                                 β
                              
                              
                                 j
                              
                           
                         of faces 
                           
                              
                                 F
                              
                              
                                 j
                              
                           
                         adjacent to point 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         (see Fig. 20
                        (a)). Consequently, the equivalent normal vector 
                           N
                           
                              (
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         at location 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                         is given by 
                           
                              
                                 N
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                       ⋅
                                       N
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              N
                           
                           
                              (
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the normal vector to reference face 
                           
                              
                                 
                                    F
                                 
                              
                              
                                 j
                              
                           
                         at location 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        .

For the calculation of an equivalent normal vector along a sharp edge (see Fig. 20(b)), this expression simply becomes 
                           N
                           
                              (
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       4
                                    
                                 
                              
                              
                                 2
                              
                           
                        , where 
                           
                              
                                 N
                              
                              
                                 3
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 4
                              
                           
                         are the normal vectors to the two intersecting reference faces at location 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                              
                           
                        .


                           
                              Conventions
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                  
                                 represents the parametric surface equation underlying reference face 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          j
                                       
                                    
                                 
                                 .
                              


                                 
                                    
                                       
                                          C
                                       
                                       
                                          u
                                          v
                                       
                                       
                                          F
                                          j
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  
                                 represents a 2D curve, defined in the parametric space of reference face 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          j
                                       
                                    
                                 
                                 .
                              


                                 The 3D equation of 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          u
                                          v
                                       
                                       
                                          F
                                          j
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  
                                 is given by 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          F
                                          j
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             σ
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             u
                                             v
                                          
                                          
                                             F
                                             j
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                  
                                 . By the way, 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          F
                                          j
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                  
                                 lies on the surface defined by 
                                 
                                    
                                       
                                          
                                             σ
                                          
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 
                                 .
                              

The most important obstacle to adapting the AFM to composite surfaces is adapting the method in the case of front configuration #6 (as defined in Fig. 6). Indeed, given a candidate front segment 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           , the problem is finding the optimal location of candidate node 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    
                                       opt
                                    
                                 
                              
                            from segment 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            to obtain a triangle respecting both size and shape quality requirements. In the classical implementation of the AFM, the optimal location is basically estimated with the use of a trajectory, defined in the parametric space of the surface, which starts from midpoint 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                           , and which progresses towards the advancing front direction, until matching a target distance 
                              d
                           . The adaptation of this trajectory in the context of composite surface meshing is performed using the 3D intersection curve between a plane (referred to in our work as 
                              
                                 Φ
                              
                           ) and the composite surface. This trajectory is computed as follows.


                           
                              
                                 •
                                 Midpoint 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             M
                                          
                                       
                                     lies on the curvilinear image of the candidate front segment and it is equidistant to 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     (using the Euclidean distance).

Plane 
                                       
                                          Φ
                                       
                                     is computed as the equidistant plane to 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    .

The advancing front direction 
                                       
                                          
                                             
                                                V
                                             
                                          
                                          
                                             i
                                          
                                       
                                     is 
                                       
                                          
                                             
                                                V
                                             
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          N
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   P
                                                
                                             
                                             
                                                M
                                             
                                          
                                          )
                                       
                                       ∧
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    .

Like in the classical implementation of the AFM (see Section  3), the target distance 
                                       d
                                     is calculated as a compromise between shape and size requirements.


                           
                              d
                              =
                              
                                 
                                    3
                                 
                              
                              /
                              2
                              ⋅
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 ⋅
                                 H
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          M
                                       
                                    
                                    )
                                 
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       S
                                    
                                 
                                 ⋅
                                 
                                    ‖
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    ‖
                                 
                                 )
                              
                           , where 
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    T
                                 
                              
                              ∈
                              
                                 [
                                 0
                                 ;
                                 1
                                 ]
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    T
                                 
                              
                              +
                              
                                 
                                    
                                       w
                                    
                                 
                                 
                                    S
                                 
                              
                              =
                              1
                           .

Then, the 3D intersection curve is built as follows. Midpoint 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                            is obtained by finding intersection points between 
                              
                                 Φ
                              
                            and the segment’s curvilinear image (see Section  4.2). Then, the trajectory 
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           , which is defined as the intersection curve between 
                              
                                 Φ
                              
                            and the composite surface 
                              
                                 σ
                              
                           , is obtained by creating a sequence of curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            that are defined in the parametric space of reference faces, and that are coincident to 
                              
                                 Φ
                              
                            with a given tolerance 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                           . The first curve 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    0
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            starts from 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                            and stops either if the target distance 
                              d
                            is reached, or if the boundary of the current reference face. New curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            are appended to the trajectory 
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            until the target distance 
                              d
                            is reached or the MC face boundary is met (see Figs. 21 and 22
                           
                           ). Each curve 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            along the intersection between reference faces 
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    j
                                 
                              
                            and 
                              
                                 Φ
                              
                            is computed in the parametric space associated to face 
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    j
                                 
                              
                            as a polyline (referred to as 
                              
                                 
                                    C
                                 
                                 
                                    u
                                    v
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           ).

The overall trajectory 
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       
                                          t
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            is created by concatenating the curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            until target length 
                              d
                            is reached, which means that 
                              
                                 ‖
                                 C
                                 
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 ‖
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 ‖
                                 
                                    
                                       C
                                    
                                    
                                       F
                                       j
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ‖
                              
                              =
                              d
                           .

Consequently, the curvilinear length of 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            is limited by 
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    
                                       max
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                           , which is the difference between target length 
                              d
                            and length of the curves preceding 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           : 
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    
                                       max
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              =
                              d
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    j
                                    −
                                    1
                                 
                              
                              
                                 ‖
                                 
                                    
                                       C
                                    
                                    
                                       F
                                       k
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 ‖
                              
                           . The starting point of the first curve, referred to as 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    0
                                    ,
                                    0
                                 
                              
                           , is located at midpoint 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    M
                                 
                              
                           . The path creation consists of a concatenation of parametric subsegments 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    j
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    j
                                    ,
                                    m
                                    +
                                    1
                                 
                              
                            along the intersection between 
                              
                                 Φ
                              
                            and the surface (see Fig. 23
                           ). The length of subsegments, referred to as 
                              d
                              s
                           , is small enough to locally approximate the intersection curve by a straight line segment in the parametric space. In practice, we found that 
                              d
                              s
                              =
                              
                                 
                                    d
                                 
                                 
                                    50
                                 
                              
                            is small enough to reach accuracy 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            with 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              ≈
                              
                                 
                                    d
                                 
                                 
                                    500
                                 
                              
                           .

Each subsegment 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    j
                                    ,
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    j
                                    ,
                                    m
                                    +
                                    1
                                 
                              
                            is obtained as follows. 
                              
                                 •
                                 Compute (see Fig. 23) the 3D increment vector 
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                             D
                                             
                                             j
                                             ,
                                             m
                                          
                                       
                                     (length 
                                       d
                                       s
                                     and collinear to the intersection between 
                                       
                                          Φ
                                       
                                     and the plane that is tangent to 
                                       
                                          
                                             F
                                          
                                          
                                             j
                                          
                                       
                                     at location 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             j
                                             ,
                                             m
                                          
                                       
                                    ).

Calculate the parametric increment 
                                       
                                          
                                             
                                                Δ
                                             
                                          
                                          
                                             u
                                             v
                                             
                                             j
                                             ,
                                             m
                                          
                                       
                                     by projecting 
                                       
                                          
                                             Δ
                                          
                                          
                                             3
                                             D
                                             
                                             j
                                             ,
                                             m
                                          
                                       
                                     in the parametric space associated with face 
                                       
                                          
                                             F
                                          
                                          
                                             j
                                          
                                       
                                     (with accuracy 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                    ).

Append a new point 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             j
                                             ,
                                             m
                                             +
                                             1
                                          
                                       
                                     to polyline 
                                       
                                          
                                             C
                                          
                                          
                                             F
                                             j
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    : 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             j
                                             ,
                                             m
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             j
                                             ,
                                             m
                                          
                                       
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                             v
                                             
                                             j
                                             ,
                                             m
                                          
                                       
                                    .

Following this last process, the number of parametric points constituting polyline 
                              
                                 
                                    C
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            is 
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             max
                                          
                                       
                                       
                                          F
                                          j
                                       
                                    
                                 
                                 
                                    d
                                    s
                                 
                              
                              +
                              1
                           . It appears that fewer points are actually required to respect 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                           , and, in order to reduce the number of polyline points, an additional procedure is applied during path creation, with the objective of keeping the minimum number of points that are necessary to respect 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                           .

In the classical AFM scheme, each candidate triangle creation is analyzed before being validated to avoid triangle overlaps. As mentioned above, the extension of this analysis in the case of composite surfaces requires dealing with the fact that each mesh segment and mesh triangle generated through the AFM progression on composite geometry is likely to lie on multiple B-Rep faces and is, by the way, likely to be associated with a composite definition across multiple parametric spaces. Consequently, collision tests between new front segments and existing mesh elements are much more difficult to perform than in standard AFM, and these tests require setting up specific procedures, as described in the following paragraphs.

Detecting front collisions in the validation of triangle creation in the context of composite surfaces requires computing the curvilinear image of front segments on a composite surface. Constructing the curvilinear image of a segment 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            is achieved by one of the following schemes. 
                              
                                 •
                                 The first attempt (see Section  4.5.3) consists of projecting 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     in the normal direction on the underlying composite surface 
                                       
                                          σ
                                       
                                    . This method is likely to fail when the normal projection is composed of several disconnected components (see Fig. 24
                                    ).

If this first attempt fails, the shortest path between 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     is evaluated with a method that is detailed in Section  4.5.4.

As introduced in the previous section, the normal projection method applies when the curvilinear image is composed of one single component, which is true in most front generation situations. The projection is calculated as a plane–surface intersection, which is similar to the intersection used for creating a trajectory that is perpendicular to the front (as detailed in Section  4.4.1). The intersecting plane 
                              
                                 
                                    
                                       Φ
                                    
                                 
                                 
                                    N
                                 
                              
                            is computed as follows.


                           
                              
                                 •
                                 Calculate normal vector 
                                       
                                          N
                                       
                                     by averaging normal vectors at 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     (see Fig. 24).


                                    
                                       
                                          
                                             
                                                Φ
                                             
                                          
                                          
                                             N
                                          
                                       
                                     is defined as passing through to 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                     and as collinear to vector 
                                       
                                          N
                                       
                                    .

Then, the curvilinear image of front segment 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            is generated by computing a trajectory, referred to as 
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                           , at the intersection between 
                              
                                 
                                    
                                       Φ
                                    
                                 
                                 
                                    N
                                 
                              
                            and the composite surface 
                           
                              
                                 σ
                              
                           . This trajectory (from 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                            to 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           ) is obtained by creating a sequence of curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            that are defined in the parametric space of reference faces, and that are coincident to 
                              
                                 
                                    
                                       Φ
                                    
                                 
                                 
                                    N
                                 
                              
                            with a given tolerance 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                           . The first curve 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    1
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            starts from 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                 
                              
                            and stops either if 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            is reached, or if the boundary of the current reference face is reached. New curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            are appended to continue the trajectory 
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            until 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                            is reached (see Fig. 25
                           ). Thus, each curve 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    F
                                    j
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            is constrained by 
                              
                                 
                                    
                                       Φ
                                    
                                 
                                 
                                    N
                                 
                              
                            and 
                              
                                 
                                    
                                       F
                                    
                                 
                                 
                                    j
                                 
                              
                           .

Composite surfaces singularities such as sharp edges and thin walls require a specific shortest path evaluation in the following cases.


                           
                              
                                 •
                                 When the method presented in Section  4.5.3 is affected by surface singularities (see Fig. 26
                                    ), the shortest path estimation provides a valid representation of the segment’s image.

When validating element creation by searching neighboring elements, the shortest path evaluation is a good estimator of the curvilinear distance in zones featuring singularities (see Fig. 26).

The shortest path between two points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    B
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    C
                                 
                              
                            is computed following these steps.


                           Step 1: A set of passing points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    k
                                 
                              
                            (see Fig. 26) is defined and it is composed of the following.


                           
                              
                                 ∘
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             B
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             C
                                          
                                       
                                    , the beginning and the end of the shortest path.


                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             k
                                             e
                                          
                                       
                                    , defined as points lying on reference edges of the composite surface and located in the neighborhood of linear segment 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             C
                                          
                                       
                                    , which means such as 
                                       
                                          
                                             d
                                             i
                                             s
                                             t
                                             
                                                (
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      C
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      k
                                                      e
                                                   
                                                
                                                )
                                             
                                             <
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      C
                                                   
                                                
                                                ‖
                                             
                                             ,
                                          
                                       
                                     where dist(
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             B
                                          
                                       
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             C
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             k
                                             e
                                          
                                       
                                    ) is the distance between the linear segment 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             C
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             k
                                             e
                                          
                                       
                                    .


                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             k
                                             v
                                          
                                       
                                    , defined as coincident points with reference vertices of reference faces and located in the neighborhood of linear segment 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             B
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             C
                                          
                                       
                                    , which means such as 
                                       
                                          
                                             d
                                             i
                                             s
                                             t
                                             
                                                (
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      C
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      k
                                                      v
                                                   
                                                
                                                )
                                             
                                             <
                                             
                                                ‖
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      C
                                                   
                                                
                                                ‖
                                             
                                             .
                                          
                                       
                                    
                                 


                           Step 2: The set of curves 
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    i
                                 
                              
                            connecting two passing points 
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    k
                                 
                              
                            located on a reference face or edge 
                              
                                 G
                              
                            of the composite surface.


                           Step 3: The point-curve adjacency graph is constructed as follows. 
                              
                                 ∘
                                 Each graph node represents a passing point 
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             k
                                          
                                       
                                    .

Each graph arc represents a curve 
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             i
                                          
                                       
                                     connecting two passing points.


                           Step 4: Dijkstra’s algorithm  [44] is used to compute the shortest path through curves (see Fig. 26).


                           
                              
                                 ∘
                                 In Dijkstra’s algorithm, the lengths associated with graph arcs are evaluated by calculating the lengths of curves 
                                       
                                          
                                             
                                                C
                                             
                                          
                                          
                                             i
                                          
                                       
                                    .

The length of the path is the sum of the curves’ length attached to arcs.

As mentioned in the previous section, the validation of triangle creation mainly relies on detecting collisions between mesh segments (the sides of newly created triangles) and front segments. As illustrated in Fig. 27
                           , the intersection between two segments is tested by evaluating the intersection of their curvilinear images in the parametric space of the associated reference faces.

Once a triangle creation is validated, the advancing front needs to be updated. The adaptation of front update operations to composite surfaces is straightforward, because it is identical to the process used for standard AFM. Also, like in the classical implementation of the AFM, the front progression stops when the front is empty, which means that the whole composite surfaces being triangulated is completely filled with triangles. The application of this adapted version of the AFM to all MC faces in the MCT model leads to a closed and watertight set of triangles representing the triangulation of the MCT model’s boundary. Once this triangulation generated, a 3D solid mesh can be derived using any automatic tetrahedral mesh generation scheme.

The algorithms described in this paper are validated by showing the improvement obtained, on mesh size and shape quality criteria, when using the MCT approach if compared to meshes that are directly generated from unprepared CAD models. An analysis of quality improvement shows that the mesh quality obtained, after applying the MCT preparation process followed by the automatic triangulation process as presented in this paper, is close to optimal. This clearly validates the approach by showing that, whatever the topology of the initial CAD model is, the whole process is successful in avoiding the generation of badly shaped elements or over-refined meshes.


                     Fig. 28
                      illustrates the triangle quality distributions obtained for the meshes presented in Figs. 29 and 31–33
                     . Shape quality is evaluated using a classical criterion (the radius of the inscribed circle divided by the maximum edge length) and size quality is evaluated using the geodesic size criterion  [5], which quantifies the difference between the actual area of a triangle and its optimal area with regard to the imposed size map.


                     Quarter of a piston:   Fig. 29 shows one quarter (due to symmetry) of a piston’s CAD model. The original CAD model features many narrow faces and small edges that are irrelevant for mesh generation. On this sample part, the MCT simplification process  [32] performed 60 edges deletions, 62 vertex deletions, and collapsed one edge to a vertex. Thus, the number of faces has been reduced from 71 to 21, the number of edges from 182 to 76, and the number of vertices from 113 to 63. The size and shape quality distributions are satisfying, as illustrated in Fig. 29. Fig. 29 also shows that the use of the method presented in this paper on this example completely eliminates poor quality triangles (for both shape and size).

In Fig. 29, a constant FE size is imposed, while in Fig. 30
                      the FE size required varies. In this last figure, element colors refer to the imposed element size (instead of element quality), as indicated in the color legend. This illustrates that the method proposed in this paper can handle both constant and varying FE size maps.


                     Milling cutter: results presented in Fig. 31
                      represent the initial CAD model aside an MCT model automatically generated using our adaptation process. The B-Rep entities representing the cutter size label and other irrelevant edges have been removed. Fig. 31 shows that the shape and size quality distributions are both significantly improved with the use of the approach presented in this paper. In this case, seven triangles with a shape quality inferior to 25% remain in the final triangulation. It is important to outline that, for the size map imposed, the badly shaped triangles remaining cannot be eliminated. This is due to the fact that the geometry itself still overconstrains mesh generation, even once the MCT preparation process is applied. In this case, the elimination of the few badly shaped triangles remaining could only be achieved using a local mesh refinement.


                     Carter:   Fig. 32
                      illustrates a more complex CAD model (a carter). The MCT simplification process performed 540 edge deletions, 497 vertex deletions, and collapsed 7 edges. In this case, the number of faces has been reduced from 520 to 71, the number of edges from 1256 to 301, and the number of vertices from 785 to 279.


                     Tire: This last example is issued from a CAD model generated for simulating the heating process of a tire section (courtesy MichelinTM). The MCT simplification process performed 185 edge deletions, 283 vertex deletions, and collapsed 1 edge. The number of faces has been reduced from 183 to 11, the number of edges from 569 to 134, and the number of vertices from 388 to 136. 
                  

One of the most interesting aspects of the work presented in this paper is that using composite parametric definitions avoids using a global parameterization of composite surfaces. This is an important improvement, because it overcomes the main limitations of approaches based on mapping composite surfaces into a single parametric domain.

Thus, as illustrated in Fig. 34
                        , the AFM adaptation presented in this paper is


                        
                           
                              •
                              
                                 not restricted to specific boundary topologies: closed composite surfaces that are homeomorphic to a sphere or to an 
                                    n
                                 -torus can be meshed as well as open composite surfaces;


                                 not limited by stretched geometries and steep metrics variations: highly stretched surfaces, such as the one representing a glove inspired shape, are handled easily and efficiently, and it results in very good quality elements, even in high curvature zones. In fact, with the approach presented here, these high curvature zones are handled as easily as when using the AFM on single surfaces.

@&#CONCLUSION@&#

This paper presents an extension of the advancing front method to surfaces composed of multiple parametric faces. This extension avoids the construction of a global parameterization and consequently, it overcomes the limitations of this type of approaches. This extension is intended to be used in the scope of an MCT adaptation procedure aimed at improving and automating the preparation of FEA models from CAD models. Unlike previous reparameterization-based schemes, the proposed method has no limitations concerning the type and topology of the composite surfaces involved.

However, the approach proposed shows some limitations when applied to over-featured CAD models. For example, location of the candidate point when calculated according to Fig. 21 can be inadequate in some specific configurations (in the case of a twisted intersection curve, for example). In general, the process presented in this paper requires prior feature removal when applied to such CAD models. We have set up automatic feature removal tools that are not presented in this paper, but a failure in this feature-removal preparation step often causes the presence of small features disturbing the convergence of advancing front mesh generation. The ideal feature-removal algorithm would transform the initial model into a model that conforms to the specified size map. Further work could overcome this weakness by improving the robustness of feature-removal and advancing front mesh generation processes.

CPU time is also a matter of potential improvement. Indeed, processing geometries like those presented in this paper usually takes more than one minute to be fulfilled. The classical AFM is indeed known as being quite slower than Delaunay-based methods, and the extension proposed in this paper is slower that the classical AFM for obvious reasons (computing trajectories over multiple surface patches is iterative). However, the overall quantitative benefits of using this method are also obvious. Indeed, it significantly reduces the CPU time dedicated to the FEA itself, and in some cases it allows meshing geometries that could not even be meshed without adapting boundary topology. Moreover, at this point of our research, no specific effort has been put on optimizing the CPU time, either for algorithms themselves or for data structures used, which means that potential gains are likely to be made. To reduce the CPU time, a possible enhancement would be parallelizing the method by simultaneously progressing on several MC edges when generating the initial front and then simultaneously progressing on several MC faces with our adapted AFM.

Along with improving feature removal procedures and CPU time, the future potential directions in this research include the following.


                     Extension to high-order elements, quadrangles and anisotropy. Quadratic triangles (T6) can be easily generated on the exact geometry by inserting a middle node on each segment’s image curve. This method should include a quality criterion to avoid squeezed elements in highly curved zones. The segment-swapping and node-moving optimization steps will require quality criteria that are adapted to curvilinear mesh elements. An adaptation of our method could also be foreseen towards generating quadrangular meshes. The MCT adaptation and AFM mesh generation could also be extended for anisotropic mesh generation. For instance, the criteria used for shape detail identification could be extended to compare the width of shape details with the expected FE size in the direction of element generation, as well as the size criteria used for the MCT adaptation.


                     Extension to surface models with overlaps and gaps. At the intersection between two B-Rep faces, there is a very small numerical inconsistency that cannot be avoided, because there is a tiny difference between the actual intersection curve, the 3D parametric definition of the intersection curve in the B-Rep, and the images of this intersection curves lying on both intersecting surfaces. This numerical inconsistency is handled in all our developments involving B-Reps and, by the way, if the B-Rep is consistent it is necessarily watertight. The other possible context is a model with two connecting trimmed patches featuring an actual gap or overlap at the interface (due to CAD format conversion issues, for example). This type of configuration (which cannot be considered as part of a consistent B-Rep) is not handled in our work, and handling it would require significant adaptations of the method presented. However, this could be an interesting extension.


                     Extension to mixed-dimensional models. Extending feature-removal and MCT preparation algorithms to 3D geometric models mixing curves (meshed with beam elements), surfaces (meshed with shell elements), and solids (meshed with solid elements).


                     Extension to assembly models. Even if the method proposed in this paper is not primarily intended for being applied on assembly models, it appears that it actually is one potential significant enhancement. Overall, applying our method to assembly models could be achieved by applying the following steps.


                     
                        
                           •
                           Detect faces that are in contact between B-Rep models associated with the assembly components.

Similar to what is done in  [45], pre-process B-Rep models in the assembly with an imprinting operator  [46] for splitting B-Rep faces that are in contact.

Generate the MCT for each B-Rep in the assembly: specific processing should be applied so that vertices and edges lying on faces that are in contact are preserved.

Meshing each B-Rep in the assembly while taking into account faces that are in contact: along with the previous operators, this guarantees that meshes are conformal at interfaces between parts in contact.

@&#ACKNOWLEDGMENTS@&#

This study was carried out as part of a project supported by research funding from Québec Nature and Technology Research Fund and by the Natural Sciences and Engineering Research Council of Canada (NSERC).

@&#REFERENCES@&#

