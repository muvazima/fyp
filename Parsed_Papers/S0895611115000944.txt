@&#MAIN-TITLE@&#Volumetric relief map for intracranial cerebrospinal fluid distribution analysis

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           A planar map of intracranial cerebrospinal fluid distribution is presented.


                        
                        
                           
                           Useful for fluid distribution analysis in hydrocephalus cases.


                        
                        
                           
                           Characterize fluid distributions of (non-)pathological cases.


                        
                        
                           
                           Study fluid networks of (non-)pathological cases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Volumetric relief map

Cerebrospinal fluid

Cortical subarachnoid space

Volume preserving

Computer-aided diagnosis

Hydrocephalus

@&#ABSTRACT@&#


               
               
                  Cerebrospinal fluid imaging plays a significant role in the clinical diagnosis of brain disorders, such as hydrocephalus and Alzheimer's disease. While three-dimensional images of cerebrospinal fluid are very detailed, the complex structures they contain can be time-consuming and laborious to interpret. This paper presents a simple technique that represents the intracranial cerebrospinal fluid distribution as a two-dimensional image in such a way that the total fluid volume is preserved. We call this a volumetric relief map, and show its effectiveness in a characterization and analysis of fluid distributions and networks in hydrocephalus patients and healthy adults.
               
            

@&#INTRODUCTION@&#

The central nervous system is surrounded by cerebrospinal fluid that is contained within the cerebral ventricles and subarachnoid space. Fluid is produced within the ventricles and circulates to the superior cortical subarachnoid space where it is resorbed into the circulatory system through arachnoid granulations [1]. The observation of cerebrospinal fluid plays a valuable role in the clinical diagnosis of brain disorders such as hydrocephalus and Alzheimer's disease [2,3]. One example is hydrocephalus, which is usually the result of obstructed fluid outflow in the ventricles or subarachnoid space that leads to an alteration in fluid volumes [2]. Therefore, confirmation of changes to fluid volumes can help in its diagnosis [4]. In this paper, we consider both volumes and their distributions in order to obtain additional information – in particular the distribution in the cortical subarachnoid space, which has received little attention despite its medical interest [5].

Typically, magnetic resonance imaging is used to acquire three-dimensional images of cerebrospinal fluid [6]. Experts must examine various slices on different spatial planes in order to observe the fluid distribution, which makes the interpretation very laborious. An alternative method is volume rendering, once fluid volumes have been segmented [4,7,8]. However, as the distribution of intracranial cerebrospinal fluid is complex, the analysis is not straightforward. Moreover, much useful information is contained in inner structures such as sulci. Consequently, additional manipulations such as a change in viewpoint, partial object visualization, and cross-section visualization are usually necessary, all of which is time-consuming. Finally, as reported in [9], experts must manipulate large image datasets and process numerous patients, which requires an efficient and appropriate working environment.

In order to assist experts in diagnosis and patient monitoring, we propose representing the three-dimensional fluid distribution by a two-dimensional image, which we call a volumetric relief map. To be useful, the map must be quicker and easier to process than the equivalent three-dimensional image. Specifically, the distribution of the cerebrospinal fluid in the superior cortical subarachnoid space must be immediately visible. The technique is intended to supplement volume rendering and help in three-dimensional (voxel) explorations.

Producing a two-dimensional map from a three-dimensional image requires the following two ingredients: (1) an analytically defined surface that encloses the object of the analysis and onto which features are projected and (2) a map projection technique from the enclosing surface to a plane.

With respect to the first ingredient, a sphere or upper hemisphere is often applied in brain analysis, given its shape [10–13]. Features that have been projected onto a sphere or hemisphere include, for example, gray values of the external cerebral cortex that are retrieved in [10] using a ray-casting method [14, Chapter 13], while cortex surface curvatures or depths were projected using a conformal map in [12,13].

As for the second ingredient, various cartographic methods have been studied using a sphere to generate maps or represent the Earth on a flat surface (a complete description of map projection techniques can be found in [15]). In the medical field, one example is application of the azimuthal equidistant projection to generate a “cartography” of the cerebral cortex surface [10]. This projection simplifies the map superposition of data extracted from electroencephalography and magnetoencephalography measurements. Such a map can be used as an anatomical reference, as all of the points on it are at proportionally the correct distance and direction from the center point.

Here, we use an upper hemisphere as the surrounding surface, but rather than project the gray values of the object [10], or the surface curvature or depth [11–13], we project the volume of the object onto surface points such that the inner volume distribution can be observed. We then apply a map projection technique that preserves areas rather than distances, as this maintains information about the volume distribution on the surface. In other words, each pixel of the volumetric relief map represents the amount of fluid between the chosen center of the cortical subarachnoid space and the associated point on the hemisphere. It also indicates the approximate depths of cerebral sulci (see Section 3.4).

This paper extends the preliminary study described in [16]. Section 2 outlines the method and the properties of volumetric relief maps; additional experiments for the analysis of the cerebrospinal fluid distribution are presented in Section 3; while Section 4 describes new work on the cerebrospinal fluid network.

This planar representation provides both qualitative information on the cerebrospinal fluid distribution and quantitative data, through the application of two-dimensional shape analysis techniques. We present examples of volumetric relief maps generated from healthy adults and hydrocephalus patients in Section 3. For the quantitative characterization, we carry out a moment-based shape analysis. Maps can also be used to monitor patients and show, at a glance, whether the fluid distribution has returned to a “normal” state, post-surgery.

Volumetric relief maps not only help to visualize and characterize the cerebrospinal fluid distribution within the superior cortical subarachnoid space, but also in the analysis of its topological structure. In order to study the cerebrospinal fluid network around the brain and in the cerebral sulci, we apply geodesic distance techniques. This makes it possible to trace every voxel in the fluid region, starting with points (called “seeds”) that are on its periphery, and observe fluid propagation from these seeds. In Section 4, we use volumetric relief maps to visualize this fluid propagation. We report results for healthy adults and hydrocephalus patients pre- and post-surgery, and other comparative observations.

Here, we assume that the cerebrospinal fluid is pre-segmented, for example using the methods in [4,7,8], and that the cortical subarachnoid space has been extracted [4]. Given the volume of data in the cortical subarachnoid space, i.e., a three-dimensional voxel set, the volumetric relief map is generated in the following two steps. In the first step, we enclose the superior region of the segmented cortical subarachnoid space by an upper hemisphere. Each voxel of fluid is then projected onto the hemisphere so that the distribution can be observed on its surface. In the second step, we generate a two-dimensional image by projecting every point on the hemisphere onto a plane. Note that the chosen projection preserves a point distribution on the plane that is similar to the original on the hemisphere. The key point to note is that the total fluid volume is preserved following these two projections, and thus in the volumetric relief map. The following sections describe each of these steps in detail, and outline the many useful properties of volumetric relief maps.

The center of the hemisphere should be positioned at the posterior commissure containing the pineal gland, which is considered to be the geometric center of the brain [17]. The base of the hemisphere corresponds to the plane that is orthogonal to the midsagittal plane and contains both the anterior and posterior commissures. Note that both commissures are also on the midsagittal plane. The radius of the hemisphere is set as the minimum such that the hemisphere encloses the superior cortical subarachnoid space (see Fig. 1
                        ). As these anatomical references are easily detected (see Section 3 for a detection technique), positioning and sizing can be automated, as can image registration [7,8]. Alternatively, it is possible to make manual adjustments in order to refine the technique.

Once the upper hemisphere is in position, we can generate a voxel distribution as follows. Each voxel is considered as a unit fluid volume, and this unit quantity is represented by the voxel center. Consequently, the fluid distribution can be substituted by the voxel center distribution and we only need to project voxel centers onto the hemisphere.

Let c be the center of the projection hemisphere, and r be its radius. We project each voxel center point v onto the hemisphere by drawing a three-dimensional ray [14, Chapter 14] starting at c and pointing in the direction (v
                        −
                        c) to obtain its intersection with the hemisphere. This intersection is the projected point of v on the hemisphere, denoted by p(v), as illustrated in Fig. 2a. Note that different v can have the same projected point p(v) if they are collinear.

All voxel-center points projected onto the hemisphere, p(v), are now mapped onto a two-dimensional plane as illustrated in Fig. 2b. This mapping preserves fluid distribution information, i.e., p(v). The Lambert azimuthal equal-area projection was chosen for this purpose as it has the following interesting properties: bijection, diffeomorphism, direction preservation from the point of tangency, and area preservation [15, Chapter 3]. Area preservation is particularly important as it means that the number of projected points on the plane in a unit surface area is the same as on the hemisphere in a unit area. The Lambert projection preserves neither angle nor distance, and thus shapes can be distorted on the plane when they are distant from the point of tangency. However, such distortion is minimized if the projection is restricted to the hemisphere centered at the point of tangency (here, the upper hemisphere) [18]. Fig. 3
                         illustrates the preservation of the uniform distribution.

More concretely, the following formulas are applied for each point p(v)
                        =(x, y, z) on the hemisphere, such that (x
                        −
                        c
                        
                           x
                        )2
                        +(y
                        −
                        c
                        
                           y
                        )2
                        +(z
                        −
                        c
                        
                           z
                        )2
                        =
                        r
                        2 and z
                        ≥
                        c
                        
                           z
                        , in order to obtain the two-dimensional point P(v)
                        =(X, Y) in the disk with center at the origin and radius 
                           
                              2
                           
                           r
                        :


                        
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      r
                                                   
                                                   
                                                      r
                                                      +
                                                      z
                                                      −
                                                      
                                                         c
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          x
                                          −
                                          
                                             c
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      r
                                                   
                                                   
                                                      r
                                                      +
                                                      z
                                                      −
                                                      
                                                         c
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          y
                                          −
                                          
                                             c
                                             y
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

To generate a volumetric relief map in the form of a two-dimensional image, we digitize the disk obtained by the Lambert projection. Suppose that the disk is digitized with a square grid of pixel size 
                           
                              2
                           
                           r
                           /
                           N
                         using Gaussian digitization (i.e. a pixel is considered in the digitized disk if the center point is in the original disk) [19, Chapter 2]. The two-dimensional image that is obtained contains this digitized disk thus has size (N
                        +1)×(N
                        +1) as illustrated in Fig. 2c.

For each voxel center v, its projected point P(v) is associated with the pixel that contains it (see Fig. 2d). Once all projected points have been linked to a pixel, each pixel is assigned the number of its associated voxels, i.e., its fluid volume. Each pixel value in a volumetric relief map corresponds to the amount of fluid between the chosen center of the cortical subarachnoid space and the associated point on the hemisphere and indicates the approximate depth of cerebral sulci (this is discussed in detail in Section 3.4).

A volumetric relief map has the following interesting properties:
                           Property 1
                           
                              Each voxel of a given voxel set is associated with exactly one pixel in the volumetric relief map.
                           


                        
                           Property 2
                           
                              The total amount of pixel values in a volumetric relief map is equal to the total volume of the initial three-dimensional voxel set.
                           

It is straightforward to obtain Property 2 from Property 1, which can also be induced directly using the procedure explained in Section 2.3.

Note that the map may be influenced by the two- or three-dimensional space digitizations. In fact, the Lambert equal-area projection means that every pixel has a similar voxel quantity for a digitized solid-hemispherical object centered at (c
                        
                           x
                        , c
                        
                           y
                        , c
                        
                           z
                        ), assuming that N is not too large compared to the size of the relief map, and with respect to the resolution of the original volumetric image. In other words, the pixel side length of a volumetric relief map should not be smaller than the voxel side length of the original three-dimensional image. Otherwise the map will contain empty pixels, to which no voxel can be associated.

Let us now consider a digitized solid-hemisphere with radius R (unit voxels), with volume approximately 2/3πR
                        3 (unit voxels). Assume that we generate the volumetric relief map with radius R′ (unit pixels, instead of unit voxels). Property 2 leads us to the following relation between the value of the volumetric relief map m for each pixel and the two radii R and R′:
                           
                              (1)
                              
                                 m
                                 =
                                 
                                    
                                       2
                                       
                                          R
                                          3
                                       
                                    
                                    
                                       3
                                       
                                          R
                                          ′
                                       
                                       
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        as the digitized circle on the volumetric relief map contains approximately 
                           π
                           
                              
                                 
                                    R
                                    ′
                                 
                              
                              2
                           
                         (unit pixels). In practice, however, the two- and three-dimensional space digitizations mentioned above create small variations in the value of m. In order to reduce this effect, a Gaussian filter with a small window can be applied to the volumetric relief map.

The relation (1) is illustrated in Fig. 4
                        , which contains two digitized solid demi-hemispheres of different radii R
                        =40, 60, separated by a distance of 10 (unit voxels). Its volumetric relief map with radius R′=40 has pixel values that are almost constant at around 26.7 (resp. 90) in the left (resp. right) part of the digitized disk corresponding to the demi-hemisphere with radius R
                        =40 (resp. R
                        =60). Those pixel values are a practical demonstration of the relation (1).

Hence, the following observation can be made.
                           Observation 1
                           
                              The projections of voxel centers in a voxel space are uniformly distributed in the volumetric relief map if the pixel size of the map is sufficiently large with respect to the voxel size.
                           

In order to analyze the cerebrospinal fluid distribution, volumetric relief maps were generated from a clinical dataset composed of 74 subjects (median age: 48 years; range: 18–91 years). Of these, 44 were healthy volunteers and 30 were hydrocephalus patients (25 with communicating hydrocephalus and 5 with non-communicating hydrocephalus). Eight of the hydrocephalus patients had further image acquisition post-surgery.

Magnetic resonance images of the clinical dataset were obtained using the sequence described in [6] and had an isotropic voxel resolution of 1mm. After segmentation of the superior cortical subarachnoid space, based on the method given in [4] and illustrated in Fig. 5
                     , the hemisphere was automatically positioned (see Section 2.1) before applying the two projections presented in Sections 2.2 and 2.3. With respect to determining the center of the hemisphere center, as the posterior commissure could not be easily detected due to the “fluid specific” magnetic resonance images in the dataset, we used the top rear section of the cerebral aqueduct, which is the closest visible structure [4]. The positions of eyeballs, which are also easily detected [4], made it possible to determine the base of the hemisphere. More precisely, the bisector of the centers of the two eyeballs corresponds to the midsagittal plane, which should be orthogonal to the base. In order to determine the base, the position of the anterior commissure must be located (see Section 2.1). However, as (like the posterior commissure) this is not easily detected, the midpoint between the centers of the eyeballs was used instead. In summary, the base of the hemisphere matches the plane passing through its center, i.e., the top rear section of the cerebral aqueduct, and the centers of the eyeballs (see Fig. 1 for an illustration). Note that the bisector contains the longitudinal cerebral fissure. As the vertical axis of a volumetric relief map is set as the intersection of the base of hemisphere and the bisector of the centers of the eyeballs, the longitudinal cerebral fissure should appear vertically in the middle of the map.

An important point to highlight is that maps are sensitive to errors in hemisphere positioning, and therefore it is very important to position the hemisphere correctly. In practice, if the hemispherical axis from the center to the pole does not go through the longitudinal cerebral fissure, then the volumetric relief map will not be the same as general maps, and the longitudinal cerebral fissure may appear slanted. However, automatic positioning is sufficiently precise to ensure that reference structures are easily detected, and positioning prerequisites were respected in the experiments that follow.

The volumetric relief map was generated using a conventional computer (Intel Pentium Dual Core 2.70GHz/8GB main memory, Gnu/Linux 3.8 operating system), and the application was implemented in the Java programming language using Fiji software [20]. Once a magnetic resonance image was acquired and segmented, map generation took under 1s. Volumetric relief maps were initialized with a width of 203 pixels.

The qualitative and quantitative analyses of fluid distributions from the maps that were generated are described in the following sections.


                        Fig. 6
                         shows a volumetric relief map for a healthy volunteer. This map shows that the fluid is well-distributed and sulci are well-filled. In this case, the longitudinal cerebral fissure extends over most of the map's vertical axis with a high intensity, and effectively separates it into two lateral regions, which are symmetrically distributed. In addition, the central cerebral sulcus is located close to the horizontal axis, and the lateral cerebral fissure is visible near the frontal boundary of the map with a significant intensity.

Volumetric relief map examples for non-communicating and communicating hydrocephalus patients are shown in Figs. 7 and 8a
                         respectively. Here, the distribution is very different. Compared to Fig. 6, depleted regions (shown in black and dark blue) are visible in the lower part of both maps, indicating that the distributions are unbalanced. In fact, volumetric relief maps of hydrocephalus patients can be even less symmetrical. In particular, the communicating hydrocephalus patient has less fluid in the longitudinal and lateral cerebral fissures (see Fig. 8a), while the non-communicating patient has less fluid everywhere, including the center, with the exception of the lateral cerebral fissure (see Fig. 7).


                        Fig. 8b shows a volumetric relief map for the patient shown in Fig. 8a post-surgery. The intensity in the cerebral sulci has increased, the cerebrospinal fluid has become more evenly distributed, and depleted regions have been restored. Note that, in this figure, although the longitudinal cerebral fissure does not yet appear to stretch to the entire height of the map with a high intensity, it is clearly more elongated.

It should be mentioned that, with training, experts would be able to verify at a glance whether the fluid is well-distributed with no perceptible depletion, or if it has returned to a normal state post-surgery.

For the quantitative analysis of fluid distributions, we extract the geometric characteristics of a fluid distribution from each volumetric relief map using a moment-based approach. In this paper, low-order geometric moments [21] were calculated from the volumetric relief maps that were generated; these provide the center of mass, the orientation of the principal axis, and skewness coefficients. Results based on the clinical dataset are summarized in Table 1
                        .

The distribution of the centers of mass for healthy adults and hydrocephalus patients is shown in Fig. 9
                        . This shows that healthy adults have an average center of mass that is close to the center. In contrast, in every hydrocephalus patient the y-coordinate of the center of mass is higher than that of healthy adults, and there is greater deviation around the longitudinal cerebral fissure. This is because the fluid distribution is mainly depleted in the posterior regions of the brain (as discussed in Section 3.1). The relative change in the average of the center of mass between healthy adults and hydrocephalus patients is −80% along the map's vertical axis.

Concerning the distributions of the principal axes for healthy adults and hydrocephalus patients, both averages are almost along the longitudinal cerebral fissure and oriented toward the frontal region; there were few exceptions. This shows that the principal axis of the volumetric relief map is stable even in pathological cases and indicates that it, (i.e., the orientation of the fluid distribution), may not be a relevant discriminant factor when maps are used for diagnosis.

Finally, skewness coefficients show that the fluid distribution has a small degree of deviation from symmetry about the center of mass for a healthy adult. On the other hand, hydrocephalus patients have moderate asymmetry toward the frontal region of the longitudinal cerebral fissure, indicated by a negative skewness coefficient Sk
                        
                           y
                        . Unlike Sk
                        
                           y
                        , Sk
                        
                           x
                         varies in sign and has a small degree of deviation from symmetry about the longitudinal cerebral fissure. Specifically, Fig. 10
                         illustrates that the absolute value of the skewness coefficient Sk
                        
                           y
                         increases with the distance from the center of mass to the average center of mass in healthy adults. Let d be the distance from each center of mass (C
                        
                           x
                        , C
                        
                           y
                        ) to the average center of mass in healthy adults. Given a set of skewness coefficients Sk
                        
                           y
                        , and a set of associated distances d, we perform a quadratic regression using the ordinary least squares method. This results in the following quadratic model:
                           
                              (2)
                              
                                 
                                    Sk
                                    y
                                 
                                 =
                                 −
                                 0.0448
                                 d
                                 +
                                 0.0005
                                 
                                    d
                                    2
                                 
                                 .
                              
                           
                        From this model, we can conclude that asymmetry in the fluid distribution increases with its depletion in the posterior regions of the brain.

To summarize, healthy adults have well-balanced fluid distributions corresponding to low-order moments. In contrast, hydrocephalus patients have less total volume and the fluid is mainly depleted in the posterior regions of the brain. This confirms the previous qualitative analysis.

We can also use the moment-based technique for patient monitoring. Figs. 11 and 12
                        
                        , respectively, show the distributions of centers of mass and changes in skewness coefficients for eight patients who had magnetic resonance image acquisitions pre- and post-surgery. We observe that post-surgery, the center of mass of all patients returned to acceptable values and their skewness coefficient Sk
                        
                           y
                         decreased in line with calculations presented in the previous section. This result was confirmed by two experts using the original images and the ratio assessment method described in [4]. The first requires more time as experts need to explore the three-dimensional images slice by slice, while the second (like our method) produces a quick result. However, the advantage of the volumetric relief map is that experts can also see, at a glance, the entire fluid distribution within the superior cortical subarachnoid space.

Volumetric relief maps also help in estimating the depth of cerebrospinal fluid within the principal cerebral sulci of the superior cortical subarachnoid space, i.e., sulcal depths. The idea is inspired by the observation that the main sulci tend toward the brain center, together with Property (1) described in Section 2.4. Let m be the value at a pixel of a sulcus in a volumetric relief map, and v
                        
                           f
                         be the center of the voxel that is furthest from the hemisphere center c of the volumetric relief map from all of the voxels associated with this pixel. If the space between the two points v
                        
                           f
                         and c is filled with cerebrospinal fluid, then the volumetric relief map value m′ must be given by
                           
                              
                                 
                                    m
                                    ′
                                 
                                 =
                                 
                                    
                                       2
                                       ‖
                                       
                                          
                                             
                                                v
                                             
                                          
                                          f
                                       
                                       −
                                       
                                          
                                             c
                                          
                                       
                                       
                                          ‖
                                          3
                                       
                                    
                                    
                                       3
                                       
                                          R
                                          ′
                                       
                                       
                                          
                                          2
                                       
                                    
                                 
                              
                           
                        where R′ is the radius of the volumetric relief map, according to (1). If m′>
                        m, namely, the space between v
                        
                           f
                         and c is not completely filled with cerebrospinal fluid, we assume that the fluid is positioned closer to v
                        
                           f
                         than c. With this assumption, as the empty fluid depth along the line segment between v
                        
                           f
                         and c can be calculated by
                           
                              
                                 
                                    D
                                    ′
                                 
                                 =
                                 
                                    
                                       
                                          3
                                          2
                                       
                                       
                                          R
                                          ′
                                       
                                       
                                          
                                          2
                                       
                                       (
                                       
                                          m
                                          ′
                                       
                                       −
                                       m
                                       )
                                    
                                    3
                                 
                              
                           
                        the sulcal depth D is estimated by
                           
                              
                                 D
                                 =
                                 ‖
                                 
                                    
                                       
                                          v
                                       
                                    
                                    f
                                 
                                 −
                                 
                                    
                                       c
                                    
                                 
                                 ‖
                                 −
                                 
                                    D
                                    ′
                                 
                              
                           
                        This estimate was arrived at by taking the pixel values at each sulcus in a volumetric relief map.

Prior to this step, we determined the location of each sulcus using the semi-automatic method. As sulci in the superior cortical region can be visually detected on a volumetric relief map (as shown in Fig. 6), the endpoints of each sulcus can be identified manually. We then find a path between these endpoints, represented by the shortest path shown on the volumetric relief map. In this experiment, we used the tracer tool [22] provided in the Fiji software, which is based on a bidirectional A
                        * search [23,24]. If necessary, extra points could be added between the endpoints such that the path also goes through those points.

We then estimated the sulcal depth at each pixel position on paths taken from volumetric relief maps of healthy adults in the clinical dataset. Means were calculated as the average depth of the cerebrospinal fluid along four cerebral sulci related to the superior cortical subarachnoid space (see Table 2
                        ). These values are consistent with results from recent work [25,26].

Estimates of fluid depth can also be used to monitor patients. Fig. 13
                         shows fluid depths profiles along the paths of four of the cerebral sulci, which were calculated from the volumetric relief maps of the pre- and post-surgery patient shown in Fig. 8. A comparison of these profiles indicates the depletion intensity within a sulcus for the patient.

In the previous section, we applied volumetric relief maps as a tool to visualize and characterize the cerebrospinal fluid distribution. Despite its usefulness in the visualization of geometric projection information, such a map may, however, conceal topological structures. For example, we can obtain the volumetric relief maps, shown in Fig. 14
                     , from two synthetic images that have different topological structures within the hemisphere. This figure shows that it is difficult to distinguish them by merely examining the maps.

In order to assess such topological information and analyze the fluid network, we use a geodesic distance that is only defined in the cerebrospinal fluid, rather than the Euclidean distance defined in the entire space.

Geodesic distance has been widely applied in the medical image computing field. Although its main application remains segmentation [27,28], it is also used to facilitate virtual endoscopy [29] and to parcellate the cerebral cortex from functional magnetic resonance imaging [30,31]. In this article, geodesic distance is applied to trace every voxel in the fluid region from points on the periphery of the fluid, called “seeds.” The aim is to study the cerebrospinal fluid network around the brain and in its sulci.

This section begins with a presentation of the method of geodesic propagation from one or several seeds located on the periphery of the fluid that are chosen as “fluid sources.” We then explain how to visualize such fluid propagation using volumetric relief maps. Finally, we present results for a healthy adult and a hydrocephalus patient pre- and post-surgery.

Let D be a set of seeds located in the fluid region V and on its periphery. Assuming that each seed s
                        ∈
                        D has a different label, each label is diffused in voxels v
                        ∈
                        V given a geodesic distance between the seed s and v as follows.

Let 
                           P
                           =
                           (
                           
                              
                                 
                                    v
                                 
                              
                              1
                           
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              2
                           
                           ,
                           …
                           ,
                           
                              
                                 
                                    v
                                 
                              
                              n
                           
                           )
                         be a path between voxels v
                        1 and v
                        
                           n
                         in V, such that v
                        
                           i
                         and v
                        
                           i+1 are adjacent (6-, 18- or 26-adjacent) for i
                        ∈{1, 2, …, n
                        −1}, and v
                        
                           i
                        
                        ∈
                        V for every i. Here, we set the length of 
                           P
                        , 
                           l
                           (
                           P
                           )
                         to be n
                        −1, i.e., the number of adjacent-voxel pairs in the path. Let the set Π(u, v) be all the paths between u and v in V. Then, the geodesic distance between u and v in V is defined by
                           
                              
                                 d
                                 (
                                 
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                 
                                 )
                                 =
                                 
                                    min
                                    
                                       P
                                       ∈
                                       Π
                                       (
                                       
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                       
                                       )
                                    
                                 
                                 l
                                 (
                                 P
                                 )
                                 .
                              
                           
                        The path that has the minimum length is called the “shortest path.” Note that there may be several shortest paths for a given u and v 
                        [32, Chapters 24, 26].

Now let us consider for each voxel v
                        ∈
                        V such that the seed s
                        ∈
                        D provides a shortest path to v. For each voxel v
                        ∈
                        V, we can define a distance
                           
                              
                                 
                                    Dis
                                    D
                                 
                                 (
                                 
                                    
                                       v
                                    
                                 
                                 )
                                 =
                                 
                                    min
                                    
                                       
                                          
                                             s
                                          
                                       
                                       ∈
                                       D
                                    
                                 
                                 d
                                 (
                                 
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                 
                                 )
                              
                           
                        which we call a geodesic distance map. To compute geodesic voxel propagation from a set of seeds D, we use an algorithm that is similar to the classical fast marching algorithm based on front propagation presented in [33], or the Dijkstra algorithm [32, Chapter 24]. Based on a graph-based approach, the computation can be made more efficient by using the image foresting transform framework [34].

A critical issue in the analysis of fluid propagation pathways using the geodesic propagation technique is the seed setting. It is known that cerebrospinal fluid circulates from the ventricular space to the superior cortical subarachnoid space, where it is drained through arachnoid granulations [1]. Consequently, the initial setting simulated this situation, and seeds were positioned at the lower periphery of the superior cortical subarachnoid space. However, as this setting may hinder fluid network analysis (as discussed later in this section), we considered another setting which, unlike the first, relies on a single seed positioned close to the arachnoid granulations along the longitudinal cerebral fissure. This corresponds to the “fluid resorption area” [35], i.e. the position that is furthest from the “fluid source.”

Under normal conditions, cerebrospinal fluid propagates from the inferior regions of the cortical subarachnoid space to the arachnoid granulations located along the longitudinal cerebral fissure. We therefore limited the fluid propagation analysis to the set of seeds positioned at the lower periphery of the cortical subarachnoid space. This set of seeds D is initialized as “fluid sources” as described in the following.


                           Fig. 15
                            shows that seeds are automatically positioned on the periphery of the upper hemisphere at small, regular intervals. Note that they are not in a given volume V of the cerebrospinal fluid. However, in order to apply the geodesic propagation method, seeds must belong to this fluid region V. Consequently, we draw a three-dimensional discrete ray from each original seed position toward the center of the hemisphere using the discrete ray traversal technique proposed in [36]. This enables us to find the first discrete seed s along this discrete ray, which belongs to V as the new seed position, as illustrated in Fig. 15. This ray can be defined using the connectivity of voxels [37]. In this paper, we select a 26-connectivity so that the 26-connected discrete ray encounters at least one voxel when traversing the segmented fluid region V. This is because the preprocessing method [4] ensures that V always consists of one 6-connected component. If this cannot be guaranteed, it is better to use 6-connectivity for the discrete ray, in order that it does not cross V without an intersection, in particular in thin areas.

When a discrete ray, drawn from an initial seed position p, encounters no voxel of V, we can say that p is invalid and ignore it in the following procedure.

It can also be the case that a discrete ray finds a new seed position s, located deep within the hemisphere (e.g. in a pathological case). To avoid this, we determine the search area for new seed positions as follows. We assume that new positions must be around the smallest hemiellipsoid that circumscribes the pre-segmented cerebrospinal fluid and is aligned with the anatomical axes. Next, we set a margin of several voxels within the estimated hemiellipsoid as the search area for new seed positions. In this experiment, the margin was set at 10 voxels.

Although the above multiple seed method simulates actual fluid circulation, seeds propagate in parallel and compete with each other while searching for pathways, and therefore only provide average propagation information. In order to avoid this “averaging propagation,” we consider a single seed that is positioned at a point that is most distant from actual fluid sources, i.e. close to the projection of the pole of the hemisphere.

The seed s of the single seed set D is directly initialized by the user as a unique “fluid source” on the original three-dimensional image of the cerebrospinal fluid volume. In this paper, the initial seed is near the projection of the center of the hemisphere, in the arachnoid granulations, which are regarded as “fluid flow outputs.” The location of arachnoid granulations in the superior cortical subarachnoid space is presented in detail in [35].

From each seed set D, we calculate the geodesic distance map Dis
                        
                           D
                         using the geodesic propagation technique. The geodesic distances Dis
                        
                           D
                        (x) for all x
                        ∈
                        V are thresholded at distance t in order to obtain a series of subsets of V,
                           
                              
                                 
                                    V
                                    t
                                    ′
                                 
                                 =
                                 {
                                 
                                    
                                       x
                                    
                                 
                                 :
                                 
                                    Dis
                                    D
                                 
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 ≤
                                 t
                                 }
                                 ,
                              
                           
                        where t
                        =0, 1, …, for which we generate a series of volumetric relief maps that can be viewed as an animation. Note that we obtain the volumetric relief map of the fluid region V when the threshold t is set to its maximum. This is because any point in V can be part of the geodesic propagation as the fluid regions V are guaranteed to be connected (see above). For geodesic propagation (see Section 4.1), 18-adjacency is used in the following experiments.


                           Figs. 16 and 17
                           
                           , respectively, show example sequences of cerebrospinal fluid propagation for a healthy adult (see Fig. 6 for the volumetric relief map of the same data) from multiple seeds and a single seed (illustrated by the white arrow in Fig. 17). The sequence interval used in these figures is 20. The front propagation [33] is a series of volumetric relief maps, each of which is generated from the set of voxels with an exact threshold distance t, {x
                           :
                           Dis
                           
                              D
                           (x)=
                           t}. It is highlighted in orange in the figures. We observed that, for healthy adults, the fluid propagates uniformly in every direction from seeds, filling cerebral sulci and the spaces between them. Regardless of the seed selection method, larger cerebral sulci, especially the longitudinal cerebral fissure, predominate during propagation. Note that the longest geodesic distance from the single seed (Fig. 17) is longer than for multiple seeds (Fig. 16). This is because the shortest path for any voxel from multiple seeds is smaller than that from a single seed due to the multiplicity of paths.


                           Fig. 18
                            shows a series of volumetric relief maps of geodesic propagation from multiple seeds for a hydrocephalus patient pre- and post-surgery (see Fig. 8 for the volumetric relief maps of the same patient). Compared to Fig. 16, there is asymmetrical diffusion pre-surgery. Post-surgery, this becomes more balanced and rapid. However, the multiple seeds setting leads to the loss of some seeds at the initial stage; Fig. 18a illustrates missing seeds in the lower right section, due to a lack of fluid. Missing seeds clearly influence fluid diffusion and be a cause of uneven diffusion.

The single seed setting eliminates this problem. Fig. 19
                            shows the volumetric relief maps of geodesic propagation from a single seed for the same hydrocephalus patient pre- and post-surgery. Compared to Fig. 17, Fig. 19a shows that there is asymmetrical diffusion. Furthermore, the shape of the front propagation is irregular and oscillates asymmetrically. This is caused by alterations to the fluid network. Note that both oscillations and asymmetry are less pronounced when propagating from multiple seeds, as shown in Fig. 18a. The front propagation is obtained by integrating all front propagations from the multiple seeds, which compete to find pathways. Obviously, this propagation-conflict problem does not exist for the single seed setting. Fig. 19b shows the volumetric relief maps of the same patient post-surgery, which confirms that front propagation is more consistent.


                           Fig. 20
                            illustrates changes in the centers of mass in the volumetric relief map sequences shown in Figs. 17 and 19a and b. For the healthy adult, as the initial seed is placed nearer to the center of the map, the centers of mass of the volumetric relief maps of 
                              
                                 V
                                 t
                                 ′
                              
                           , t
                           =0, 1, …, smoothly converge to a final position close to the origin, without oscillation. Similarly, for the hydrocephalus patient pre- and post-surgery the initial seed is located toward the center of the map. However, as described in Section 3.2, hydrocephalus patients are characterized by a center of mass that is shifted toward the frontal region; this is seen in Fig. 20, which shows the final position of the center of mass for the hydrocephalus patient pre-surgery. Furthermore, these changes corroborate the visual observations of asymmetric and oscillatory propagation caused by alterations in fluid pathways pre- and post-surgery. Finally, it should be noted that the maximum fluid propagation distance from a single seed is modified; it is approximately one-third greater for hydrocephalus patients compared to healthy adults. Post-surgery, propagation resembles that of healthy adults.

Given a pre-segmented image of the cerebrospinal fluid, this paper described the development of a volumetric relief map, which is a two-dimensional image of the fluid volume distribution in the superior cortical subarachnoid space. Volumetric relief maps rely on ray tracing and map projection techniques from preprocessed images. They make it possible to visualize, at a glance, a complicated structure such as the fluid volume distribution. The fluid distributions shown on the maps can be characterized using low-order image moments.

The maps were tested using a clinical dataset consisting of images of healthy adults and hydrocephalus patients. The maps that were generated showed that fluid distributions were balanced in healthy adults. This could be qualitatively and quantitatively confirmed; centers of mass were close to the center of the relief map, and skewnesses hovered around zero. In contrast, the fluid distributions of hydrocephalus patients were depleted in posterior brain regions. There were various asymmetries that increased with the extent of the depletion, and which were oriented toward the frontal section of the longitudinal cerebral fissure. The relative change in the average center of mass between healthy adults and hydrocephalus patients was −80% along the map's vertical axis. The tool also made it possible to monitor variation in the cerebrospinal fluid distribution in the superior cortical subarachnoid space, pre- and post-surgery in a hydrocephalus patient.

We also presented our work on fluid network analysis, which is still at a preliminary stage. This analysis is based on a geodesic propagation technique using one or more seeds in the cerebrospinal fluid of the superior cortical subarachnoid space. Fluid pathways were tracked by following the propagation of single or multiple seeds. This was visualized in a two-dimensional animation, where each frame was a volumetric relief map. We observed the topological alteration of the cerebrospinal fluid network in a healthy adult and a hydrocephalus patient.

Further work on the analysis of the cerebrospinal fluid network in the cortical subarachnoid space could investigate not only fluid sources, but also sinks. In this case, it may be helpful to formalize the problem as a maximum flow problem [32, Chapter 26], in order to better understand and characterize not only the fluid structure, but also the volumetric flow rate and flow velocity.

The authors have no actual or potential conflict of interest, including any financial, personal, or other relationships with other people or organizations to disclose.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.compmedimag.2015.06.001.

The following are the supplementary data to this article:


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

